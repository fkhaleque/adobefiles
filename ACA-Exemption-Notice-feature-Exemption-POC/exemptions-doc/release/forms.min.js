var cmsexemptions=cmsexemptions||{};cmsexemptions.formtheme=function(){var a=function(a){var b=window.guideBridge.resolveNode(a),c=window.guideBridge.validate([],a,!1);return $(b).trigger("postValidate",[c]),c},b=function(a,b){var c=$("#topErrors");if(0==b.newText.length?(c.addClass("hidden"),c.attr("aria-hidden",!0),c.attr("tabindex",-1)):(c.removeClass("hidden"),c.attr("aria-hidden",!1),c.attr("tabindex",0)),b.newText.length&gt;0){$("#topErrorTitle").text("Your information contains "+b.newText.length+" error(s).");var d=$("#topErrorList");d.empty(),$.each(b.newText,function(a){$("&lt;a /&gt;",{text:b.newText[a].errorText,href:"",tabindex:"0",click:function(c){c.preventDefault(),window.guideBridge.setFocus(b.newText[a].som,"firstItem")},keyup:function(a){(13==a.keyCode||32==a.keyCode)&amp;&amp;this.click()}}).wrap("&lt;li/&gt;").parent().appendTo(d)}),1==b.newText.length?window.guideBridge.setFocus(b.newText[0].som,"firstItem"):($("html, body").animate({scrollTop:0},800),c.focus())}},c=function(a){a.getDataXML({success:function(a){alert(a.data)},error:function(a){alert("Couldn't retrieve data.")},context:this,async:!0})};elementValueChangedHandler=function(a,b){if("guideRadioButton"==b.target.className){var c=$(guideBridge._getGuideDomElement(b.target.somExpression));c.find(".guideRadioButtonItem").toggleClass("selected",!1),c.find("input:checked").closest(".guideRadioButtonItem").toggleClass("selected",!0)}else"guideCheckBox"==b.target.className&amp;&amp;$(guideBridge._getGuideDomElement(b.target.somExpression)).find(".guideCheckBoxItem").toggleClass("selected",null!=b.newText)},updateNumberOfPerson2s=function(a){var b=guideBridge.resolveNode("guide[0].guide1[0].guideRootPanel[0].Person2[0]");if(null!=b&amp;&amp;null!=a){var c=b.instanceManager.instanceCount;if(c&gt;a)for(var d=c;d&gt;a&amp;&amp;d&gt;1;d--)b.instanceManager.removeInstance(b.instanceManager.instanceCount-1);else if(a&gt;c)for(var d=c;a&gt;d;d++){var e=b.instanceManager.addInstance();null!=e&amp;&amp;guideBridge.setProperty([e.FileJointly.somExpression,e.PersonalInformation.OnP1Return.somExpression,e.PersonalInformation.IsSpouse.somExpression],"value",["N","Y","N"])}if(b.visible=a&gt;0,b.visible){b.validationsDisabled=!1;var f=guideBridge.resolveNode("guide[0].guide1[0].guideRootPanel[0].HouseholdDetermination[0].IsFilingJointly[0]"),g="Y"==f.value?["Y","N","Y","SPOUSE","Y"]:["N","Y","N",null,null];guideBridge.setProperty([b.FileJointly.somExpression,b.PersonalInformation.OnP1Return.somExpression,b.PersonalInformation.IsSpouse.somExpression,b.PersonalInformation.RelationshipToFiler.somExpression,b.TaxQuestions.PlanToFile.somExpression],"value",g)}else b.resetData(),b.validationsDisabled=!0}};var d=function(){var a=guideBridge.resolveNode("guide[0].guide1[0].guideRootPanel[0].Person2[0]"),b=_.reduce(a.instanceManager.instances,function(a,b){return"Y"==b.PersonalInformation.OnP1Return.value&amp;&amp;""!=b.PersonalInformation.CommonName.value&amp;&amp;(""!=a&amp;&amp;(a+=", "),a+=b.PersonalInformation.CommonName.value),a},"");return b},e=function(a,b){if("back"==b)window.guideBridge.setFocus(null,"prevItemDeep"),window.guideBridge.validate([],window.guideBridge.resolveNode(window.guideBridge.getFocus()).panel.navigationContext.currentItem.somExpression);else if("next"==b&amp;&amp;window.guideBridge.validate([],a.panel.navigationContext.currentItem.somExpression)){var c=window.guideBridge.resolveNode("guide[0].guide1[0].guideRootPanel[0].ChooseExemption[0].ExemptionSelectionPanel[0].radioExemptions1[0]").value,d=window.guideBridge.resolveNode("guide[0].guide1[0].guideRootPanel[0].StateSelection[0].State[0]").value;if(null!=c&amp;&amp;("AFFORD"!=c||null!=d))return void f(c,d);window.guideBridge.setFocus(null,"nextItemDeep")}window.guideBridge.resolveNode(window.guideBridge.getNavigablePanel([])).toolbar.visible=window.guideBridge.resolveNode(window.guideBridge.getFocus()).panel.parent.navigationContext.hasPrevItem},f=function(a,b){if("AFFORD"==a){var c=["CA","CO","DC","HI","ID","KY","MD","MA","MN","NY","RI","VT","WA"];a=null!=b&amp;&amp;c.indexOf(b)&gt;=0?"SBM":"FFM"}switch(g(!1),a){case"HS":location.href="https://www.healthcare.gov/exemption-online-form/Hardship.html";break;case"FFM":location.href="https://www.healthcare.gov/exemption-online-form/Affordability-FFM.html";break;case"SBM":location.href="https://www.healthcare.gov/exemption-online-form/Affordability-SBM.html";break;case"TRIBAL":location.href="https://www.healthcare.gov/exemptions-tool/#/results/2015/details/tribal";break;case"SECT":location.href="https://www.healthcare.gov/exemptions-tool/#/results/2015/details/religion";break;case"HSM":location.href="https://www.healthcare.gov/exemptions-tool/#/results/2015/details/healthcare-sharing-ministry";break;case"INCARC":location.href="https://www.healthcare.gov/exemptions-tool/#/results/2015/details/incarceration";break;default:alert("Redirect to unknown exemption application: "+a)}},g=function(a){0==a?window.onbeforeunload=!1:(window.onbeforeunload=function(a){return"Are you sure you wish to leave this application?"},window.guideBridge.on("submitStart",function(){window.onbeforeunload=!1,window.guideBridge.off("submitStart")}))},h=function(a){for(;a.instanceManager.instanceCount&gt;a.instanceManager.minOccur;)a.instanceManager.removeInstance(0);for(var b=0;b&lt;a.instanceManager.instanceCount;b++)a.instanceManager.instances[b].resetData()},i=function(a){$(a).on("postValidate",j)},j=function(a,b){$(guideBridge._getGuideDomElement(this.somExpression));if(b||"Y"==this.PlanToFile.value){var c=("Y"===this.IsFilingJointly.value?1:0)+parseInt(this.NumberOfDependents.value,10);updateNumberOfPerson2s(c)}else cmsexemptions.controls.modalShow("#notfiling_modal")};return{alertGuideXML:c,elementValueChangedHandler:elementValueChangedHandler,getDependentNames:d,handleHouseholdPostValidate:j,initHouseholdPanel:i,preventAccidentalNavigation:g,redirectToExemption:f,resetMultiInstancePanel:h,screenerNavigator:e,stepCompletionHandler:a,updateNumberOfPerson2s:updateNumberOfPerson2s,validationCompleteTopErrorHandler:b}}(),window.addEventListener("bridgeInitializeStart",function(a){var b=a.detail.guideBridge;b.connect(function(){b.on("validationComplete",cmsexemptions.formtheme.validationCompleteTopErrorHandler),b.on("elementValueChanged",cmsexemptions.formtheme.elementValueChangedHandler),$("#pii").length&amp;&amp;cmsexemptions.controls.modalShow("#pii","#main")})});