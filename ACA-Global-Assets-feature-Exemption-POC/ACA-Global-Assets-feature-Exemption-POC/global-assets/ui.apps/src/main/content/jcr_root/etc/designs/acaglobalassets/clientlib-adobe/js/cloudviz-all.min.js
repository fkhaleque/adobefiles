/*
 * ************************************************************************
 *
 *  ADOBE CONFIDENTIAL
 *  ___________________
 *
 *   (c) Copyright 2015 Adobe Systems, Inc.
 *   All Rights Reserved.
 *
 *  NOTICE:  All information contained herein is, and remains
 *  the property of Adobe Systems Incorporated and its suppliers,
 *  if any.  The intellectual and technical concepts contained
 *  herein are proprietary to Adobe Systems Incorporated and its
 *  suppliers and may be covered by U.S. and Foreign Patents,
 *  patents in process, and are protected by trade secret or copyright law.
 *  Dissemination of this information or reproduction of this material
 *  is strictly forbidden unless prior written permission is obtained
 *  from Adobe Systems Incorporated.
 * ************************************************************************
 */

/*
 * CloudViz - v3.6.0 - 2015-09-22
 * Copyright (c) 2015 Adobe Systems, Inc. All Rights Reserved.
 */

d3=function(){function a(a){return null!=a&&!isNaN(a)}function b(a){return a.length}function c(a){for(var b=1;a*b%1;)b*=10;return b}function d(a,b){try{for(var c in b)Object.defineProperty(a.prototype,c,{value:b[c],enumerable:!1})}catch(d){a.prototype=b}}function e(){}function f(){}function g(a,b,c){return function(){var d=c.apply(b,arguments);return d===b?a:d}}function h(a,b){if(b in a)return b;b=b.charAt(0).toUpperCase()+b.substring(1);for(var c=0,d=lg.length;d>c;++c){var e=lg[c]+b;if(e in a)return e}}function i(){}function j(){}function k(a){function b(){for(var b,d=c,e=-1,f=d.length;++e<f;)(b=d[e].on)&&b.apply(this,arguments);return a}var c=[],d=new e;return b.on=function(b,e){var f,g=d.get(b);return arguments.length<2?g&&g.on:(g&&(g.on=null,c=c.slice(0,f=c.indexOf(g)).concat(c.slice(f+1)),d.remove(b)),e&&c.push(d.set(b,{on:e})),a)},b}function l(){Wf.event.preventDefault()}function m(){for(var a,b=Wf.event;a=b.sourceEvent;)b=a;return b}function n(a){for(var b=new j,c=0,d=arguments.length;++c<d;)b[arguments[c]]=k(b);return b.of=function(c,d){return function(e){try{var f=e.sourceEvent=Wf.event;e.target=a,Wf.event=e,b[e.type].apply(c,d)}finally{Wf.event=f}}},b}function o(a){return ng(a,sg),a}function p(a){return"function"==typeof a?a:function(){return og(a,this)}}function q(a){return"function"==typeof a?a:function(){return pg(a,this)}}function r(a,b){function c(){this.removeAttribute(a)}function d(){this.removeAttributeNS(a.space,a.local)}function e(){this.setAttribute(a,b)}function f(){this.setAttributeNS(a.space,a.local,b)}function g(){var c=b.apply(this,arguments);null==c?this.removeAttribute(a):this.setAttribute(a,c)}function h(){var c=b.apply(this,arguments);null==c?this.removeAttributeNS(a.space,a.local):this.setAttributeNS(a.space,a.local,c)}return a=Wf.ns.qualify(a),null==b?a.local?d:c:"function"==typeof b?a.local?h:g:a.local?f:e}function s(a){return a.trim().replace(/\s+/g," ")}function t(a){return new RegExp("(?:^|\\s+)"+Wf.requote(a)+"(?:\\s+|$)","g")}function u(a){return a.trim().split(/^|\s+/)}function v(a,b){function c(){for(var c=-1;++c<e;)a[c](this,b)}function d(){for(var c=-1,d=b.apply(this,arguments);++c<e;)a[c](this,d)}a=u(a).map(w);var e=a.length;return"function"==typeof b?d:c}function w(a){var b=t(a);return function(c,d){if(e=c.classList)return d?e.add(a):e.remove(a);var e=c.getAttribute("class")||"";d?(b.lastIndex=0,b.test(e)||c.setAttribute("class",s(e+" "+a))):c.setAttribute("class",s(e.replace(b," ")))}}function x(a,b,c){function d(){this.style.removeProperty(a)}function e(){this.style.setProperty(a,b,c)}function f(){var d=b.apply(this,arguments);null==d?this.style.removeProperty(a):this.style.setProperty(a,d,c)}return null==b?d:"function"==typeof b?f:e}function y(a,b){function c(){delete this[a]}function d(){this[a]=b}function e(){var c=b.apply(this,arguments);null==c?delete this[a]:this[a]=c}return null==b?c:"function"==typeof b?e:d}function z(a){return"function"==typeof a?a:(a=Wf.ns.qualify(a)).local?function(){return this.ownerDocument.createElementNS(a.space,a.local)}:function(){return this.ownerDocument.createElementNS(this.namespaceURI,a)}}function A(a){return{__data__:a}}function B(a){return function(){return rg(this,a)}}function C(a){return arguments.length||(a=Wf.ascending),function(b,c){return b&&c?a(b.__data__,c.__data__):!b-!c}}function D(a,b){for(var c=0,d=a.length;d>c;c++)for(var e,f=a[c],g=0,h=f.length;h>g;g++)(e=f[g])&&b(e,g,c);return a}function E(a){return ng(a,ug),a}function F(a){var b,c;return function(d,e,f){var g,h=a[f].update,i=h.length;for(f!=c&&(c=f,b=0),e>=b&&(b=e+1);!(g=h[b])&&++b<i;);return g}}function G(){var a=this.__transition__;a&&++a.active}function H(a,b,c){function d(){var b=this[g];b&&(this.removeEventListener(a,b,b.$),delete this[g])}function e(){var e=j(b,Yf(arguments));d.call(this),this.addEventListener(a,this[g]=e,e.$=c),e._=b}function f(){var b,c=new RegExp("^__on([^.]+)"+Wf.requote(a)+"$");for(var d in this)if(b=d.match(c)){var e=this[d];this.removeEventListener(b[1],e,e.$),delete this[d]}}var g="__on"+a,h=a.indexOf("."),j=I;h>0&&(a=a.substring(0,h));var k=wg.get(a);return k&&(a=k,j=J),h?b?e:d:b?i:f}function I(a,b){return function(c){var d=Wf.event;Wf.event=c,b[0]=this.__data__;try{a.apply(this,b)}finally{Wf.event=d}}}function J(a,b){var c=I(a,b);return function(a){var b=this,d=a.relatedTarget;d&&(d===b||8&d.compareDocumentPosition(b))||c.call(b,a)}}function K(){var a=".dragsuppress-"+ ++yg,b="click"+a,c=Wf.select(_f).on("touchmove"+a,l).on("dragstart"+a,l).on("selectstart"+a,l);if(xg){var d=$f.style,e=d[xg];d[xg]="none"}return function(f){function g(){c.on(b,null)}c.on(a,null),xg&&(d[xg]=e),f&&(c.on(b,function(){l(),g()},!0),setTimeout(g,0))}}function L(a,b){b.changedTouches&&(b=b.changedTouches[0]);var c=a.ownerSVGElement||a;if(c.createSVGPoint){var d=c.createSVGPoint();if(0>zg&&(_f.scrollX||_f.scrollY)){c=Wf.select("body").append("svg").style({position:"absolute",top:0,left:0,margin:0,padding:0,border:"none"},"important");var e=c[0][0].getScreenCTM();zg=!(e.f||e.e),c.remove()}return zg?(d.x=b.pageX,d.y=b.pageY):(d.x=b.clientX,d.y=b.clientY),d=d.matrixTransform(a.getScreenCTM().inverse()),[d.x,d.y]}var f=a.getBoundingClientRect();return[b.clientX-f.left-a.clientLeft,b.clientY-f.top-a.clientTop]}function M(a){return a>0?1:0>a?-1:0}function N(a){return a>1?0:-1>a?Ag:Math.acos(a)}function O(a){return a>1?Cg:-1>a?-Cg:Math.asin(a)}function P(a){return((a=Math.exp(a))-1/a)/2}function Q(a){return((a=Math.exp(a))+1/a)/2}function R(a){return((a=Math.exp(2*a))-1)/(a+1)}function S(a){return(a=Math.sin(a/2))*a}function T(){}function U(a,b,c){return new V(a,b,c)}function V(a,b,c){this.h=a,this.s=b,this.l=c}function W(a,b,c){function d(a){return a>360?a-=360:0>a&&(a+=360),60>a?f+(g-f)*a/60:180>a?g:240>a?f+(g-f)*(240-a)/60:f}function e(a){return Math.round(255*d(a))}var f,g;return a=isNaN(a)?0:(a%=360)<0?a+360:a,b=isNaN(b)?0:0>b?0:b>1?1:b,c=0>c?0:c>1?1:c,g=.5>=c?c*(1+b):c+b-c*b,f=2*c-g,ha(e(a+120),e(a),e(a-120))}function X(a,b,c){return new Y(a,b,c)}function Y(a,b,c){this.h=a,this.c=b,this.l=c}function Z(a,b,c){return isNaN(a)&&(a=0),isNaN(b)&&(b=0),$(c,Math.cos(a*=Fg)*b,Math.sin(a)*b)}function $(a,b,c){return new _(a,b,c)}function _(a,b,c){this.l=a,this.a=b,this.b=c}function aa(a,b,c){var d=(a+16)/116,e=d+b/500,f=d-c/200;return e=ca(e)*Qg,d=ca(d)*Rg,f=ca(f)*Sg,ha(ea(3.2404542*e-1.5371385*d-.4985314*f),ea(-.969266*e+1.8760108*d+.041556*f),ea(.0556434*e-.2040259*d+1.0572252*f))}function ba(a,b,c){return a>0?X(Math.atan2(c,b)*Gg,Math.sqrt(b*b+c*c),a):X(NaN,NaN,a)}function ca(a){return a>.206893034?a*a*a:(a-4/29)/7.787037}function da(a){return a>.008856?Math.pow(a,1/3):7.787037*a+4/29}function ea(a){return Math.round(255*(.00304>=a?12.92*a:1.055*Math.pow(a,1/2.4)-.055))}function fa(a){return ha(a>>16,a>>8&255,255&a)}function ga(a){return fa(a)+""}function ha(a,b,c){return new ia(a,b,c)}function ia(a,b,c){this.r=a,this.g=b,this.b=c}function ja(a){return 16>a?"0"+Math.max(0,a).toString(16):Math.min(255,a).toString(16)}function ka(a,b,c){var d,e,f,g=0,h=0,i=0;if(d=/([a-z]+)\((.*)\)/i.exec(a))switch(e=d[2].split(","),d[1]){case"hsl":return c(parseFloat(e[0]),parseFloat(e[1])/100,parseFloat(e[2])/100);case"rgb":return b(oa(e[0]),oa(e[1]),oa(e[2]))}return(f=Vg.get(a))?b(f.r,f.g,f.b):(null!=a&&"#"===a.charAt(0)&&(4===a.length?(g=a.charAt(1),g+=g,h=a.charAt(2),h+=h,i=a.charAt(3),i+=i):7===a.length&&(g=a.substring(1,3),h=a.substring(3,5),i=a.substring(5,7)),g=parseInt(g,16),h=parseInt(h,16),i=parseInt(i,16)),b(g,h,i))}function la(a,b,c){var d,e,f=Math.min(a/=255,b/=255,c/=255),g=Math.max(a,b,c),h=g-f,i=(g+f)/2;return h?(e=.5>i?h/(g+f):h/(2-g-f),d=a==g?(b-c)/h+(c>b?6:0):b==g?(c-a)/h+2:(a-b)/h+4,d*=60):(d=NaN,e=i>0&&1>i?0:d),U(d,e,i)}function ma(a,b,c){a=na(a),b=na(b),c=na(c);var d=da((.4124564*a+.3575761*b+.1804375*c)/Qg),e=da((.2126729*a+.7151522*b+.072175*c)/Rg),f=da((.0193339*a+.119192*b+.9503041*c)/Sg);return $(116*e-16,500*(d-e),200*(e-f))}function na(a){return(a/=255)<=.04045?a/12.92:Math.pow((a+.055)/1.055,2.4)}function oa(a){var b=parseFloat(a);return"%"===a.charAt(a.length-1)?Math.round(2.55*b):b}function pa(a){return"function"==typeof a?a:function(){return a}}function qa(a){return a}function ra(a){return function(b,c,d){return 2===arguments.length&&"function"==typeof c&&(d=c,c=null),sa(b,c,a,d)}}function sa(a,b,c,d){function e(){var a,b=i.status;if(!b&&i.responseText||b>=200&&300>b||304===b){try{a=c.call(f,i)}catch(d){return void g.error.call(f,d)}g.load.call(f,a)}else g.error.call(f,i)}var f={},g=Wf.dispatch("beforesend","progress","load","error"),h={},i=new XMLHttpRequest,j=null;return!_f.XDomainRequest||"withCredentials"in i||!/^(http(s)?:)?\/\//.test(a)||(i=new XDomainRequest),"onload"in i?i.onload=i.onerror=e:i.onreadystatechange=function(){i.readyState>3&&e()},i.onprogress=function(a){var b=Wf.event;Wf.event=a;try{g.progress.call(f,i)}finally{Wf.event=b}},f.header=function(a,b){return a=(a+"").toLowerCase(),arguments.length<2?h[a]:(null==b?delete h[a]:h[a]=b+"",f)},f.mimeType=function(a){return arguments.length?(b=null==a?null:a+"",f):b},f.responseType=function(a){return arguments.length?(j=a,f):j},f.response=function(a){return c=a,f},["get","post"].forEach(function(a){f[a]=function(){return f.send.apply(f,[a].concat(Yf(arguments)))}}),f.send=function(c,d,e){if(2===arguments.length&&"function"==typeof d&&(e=d,d=null),i.open(c,a,!0),null==b||"accept"in h||(h.accept=b+",*/*"),i.setRequestHeader)for(var k in h)i.setRequestHeader(k,h[k]);return null!=b&&i.overrideMimeType&&i.overrideMimeType(b),null!=j&&(i.responseType=j),null!=e&&f.on("error",e).on("load",function(a){e(null,a)}),g.beforesend.call(f,i),i.send(null==d?null:d),f},f.abort=function(){return i.abort(),f},Wf.rebind(f,g,"on"),null==d?f:f.get(ta(d))}function ta(a){return 1===a.length?function(b,c){a(null==b?c:null)}:a}function ua(){var a=va(),b=wa()-a;b>24?(isFinite(b)&&(clearTimeout(Zg),Zg=setTimeout(ua,b)),Yg=0):(Yg=1,_g(ua))}function va(){var a=Date.now();for($g=Wg;$g;)a>=$g.t&&($g.f=$g.c(a-$g.t)),$g=$g.n;return a}function wa(){for(var a,b=Wg,c=1/0;b;)b.f?b=a?a.n=b.n:Wg=b.n:(b.t<c&&(c=b.t),b=(a=b).n);return Xg=a,c}function xa(a,b){var c=Math.pow(10,3*ig(8-b));return{scale:b>8?function(a){return a/c}:function(a){return a*c},symbol:a}}function ya(a,b){return b-(a?Math.ceil(Math.log(a)/Math.LN10):1)}function za(a){return a+""}function Aa(){}function Ba(a,b,c){var d=c.s=a+b,e=d-a,f=d-e;c.t=a-f+(b-e)}function Ca(a,b){a&&lh.hasOwnProperty(a.type)&&lh[a.type](a,b)}function Da(a,b,c){var d,e=-1,f=a.length-c;for(b.lineStart();++e<f;)d=a[e],b.point(d[0],d[1],d[2]);b.lineEnd()}function Ea(a,b){var c=-1,d=a.length;for(b.polygonStart();++c<d;)Da(a[c],b,1);b.polygonEnd()}function Fa(){function a(a,b){a*=Fg,b=b*Fg/2+Ag/4;var c=a-d,g=Math.cos(b),h=Math.sin(b),i=f*h,j=e*g+i*Math.cos(c),k=i*Math.sin(c);nh.add(Math.atan2(k,j)),d=a,e=g,f=h}var b,c,d,e,f;oh.point=function(g,h){oh.point=a,d=(b=g)*Fg,e=Math.cos(h=(c=h)*Fg/2+Ag/4),f=Math.sin(h)},oh.lineEnd=function(){a(b,c)}}function Ga(a){var b=a[0],c=a[1],d=Math.cos(c);return[d*Math.cos(b),d*Math.sin(b),Math.sin(c)]}function Ha(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]}function Ia(a,b){return[a[1]*b[2]-a[2]*b[1],a[2]*b[0]-a[0]*b[2],a[0]*b[1]-a[1]*b[0]]}function Ja(a,b){a[0]+=b[0],a[1]+=b[1],a[2]+=b[2]}function Ka(a,b){return[a[0]*b,a[1]*b,a[2]*b]}function La(a){var b=Math.sqrt(a[0]*a[0]+a[1]*a[1]+a[2]*a[2]);a[0]/=b,a[1]/=b,a[2]/=b}function Ma(a){return[Math.atan2(a[1],a[0]),O(a[2])]}function Na(a,b){return ig(a[0]-b[0])<Dg&&ig(a[1]-b[1])<Dg}function Oa(a,b){a*=Fg;var c=Math.cos(b*=Fg);Pa(c*Math.cos(a),c*Math.sin(a),Math.sin(b))}function Pa(a,b,c){++ph,rh+=(a-rh)/ph,sh+=(b-sh)/ph,th+=(c-th)/ph}function Qa(){function a(a,e){a*=Fg;var f=Math.cos(e*=Fg),g=f*Math.cos(a),h=f*Math.sin(a),i=Math.sin(e),j=Math.atan2(Math.sqrt((j=c*i-d*h)*j+(j=d*g-b*i)*j+(j=b*h-c*g)*j),b*g+c*h+d*i);qh+=j,uh+=j*(b+(b=g)),vh+=j*(c+(c=h)),wh+=j*(d+(d=i)),Pa(b,c,d)}var b,c,d;Ah.point=function(e,f){e*=Fg;var g=Math.cos(f*=Fg);b=g*Math.cos(e),c=g*Math.sin(e),d=Math.sin(f),Ah.point=a,Pa(b,c,d)}}function Ra(){Ah.point=Oa}function Sa(){function a(a,b){a*=Fg;var c=Math.cos(b*=Fg),g=c*Math.cos(a),h=c*Math.sin(a),i=Math.sin(b),j=e*i-f*h,k=f*g-d*i,l=d*h-e*g,m=Math.sqrt(j*j+k*k+l*l),n=d*g+e*h+f*i,o=m&&-N(n)/m,p=Math.atan2(m,n);xh+=o*j,yh+=o*k,zh+=o*l,qh+=p,uh+=p*(d+(d=g)),vh+=p*(e+(e=h)),wh+=p*(f+(f=i)),Pa(d,e,f)}var b,c,d,e,f;Ah.point=function(g,h){b=g,c=h,Ah.point=a,g*=Fg;var i=Math.cos(h*=Fg);d=i*Math.cos(g),e=i*Math.sin(g),f=Math.sin(h),Pa(d,e,f)},Ah.lineEnd=function(){a(b,c),Ah.lineEnd=Ra,Ah.point=Oa}}function Ta(){return!0}function Ua(a,b,c,d,e){var f=[],g=[];if(a.forEach(function(a){if(!((b=a.length-1)<=0)){var b,c=a[0],d=a[b];if(Na(c,d)){e.lineStart();for(var h=0;b>h;++h)e.point((c=a[h])[0],c[1]);return void e.lineEnd()}var i=new Wa(c,a,null,!0),j=new Wa(c,null,i,!1);i.o=j,f.push(i),g.push(j),i=new Wa(d,a,null,!1),j=new Wa(d,null,i,!0),i.o=j,f.push(i),g.push(j)}}),g.sort(b),Va(f),Va(g),f.length){for(var h=0,i=c,j=g.length;j>h;++h)g[h].e=i=!i;for(var k,l,m=f[0];;){for(var n=m,o=!0;n.v;)if((n=n.n)===m)return;k=n.z,e.lineStart();do{if(n.v=n.o.v=!0,n.e){if(o)for(var h=0,j=k.length;j>h;++h)e.point((l=k[h])[0],l[1]);else d(n.x,n.n.x,1,e);n=n.n}else{if(o){k=n.p.z;for(var h=k.length-1;h>=0;--h)e.point((l=k[h])[0],l[1])}else d(n.x,n.p.x,-1,e);n=n.p}n=n.o,k=n.z,o=!o}while(!n.v);e.lineEnd()}}}function Va(a){if(b=a.length){for(var b,c,d=0,e=a[0];++d<b;)e.n=c=a[d],c.p=e,e=c;e.n=c=a[0],c.p=e}}function Wa(a,b,c,d){this.x=a,this.z=b,this.o=c,this.e=d,this.v=!1,this.n=this.p=null}function Xa(a,b,c,d){return function(e,f){function g(b,c){var d=e(b,c);a(b=d[0],c=d[1])&&f.point(b,c)}function h(a,b){var c=e(a,b);q.point(c[0],c[1])}function i(){s.point=h,q.lineStart()}function j(){s.point=g,q.lineEnd()}function k(a,b){p.push([a,b]);var c=e(a,b);u.point(c[0],c[1])}function l(){u.lineStart(),p=[]}function m(){k(p[0][0],p[0][1]),u.lineEnd();var a,b=u.clean(),c=t.buffer(),d=c.length;if(p.pop(),o.push(p),p=null,d){if(1&b){a=c[0];var e,d=a.length-1,g=-1;for(f.lineStart();++g<d;)f.point((e=a[g])[0],e[1]);return void f.lineEnd()}d>1&&2&b&&c.push(c.pop().concat(c.shift())),n.push(c.filter(Ya))}}var n,o,p,q=b(f),r=e.invert(d[0],d[1]),s={point:g,lineStart:i,lineEnd:j,polygonStart:function(){s.point=k,s.lineStart=l,s.lineEnd=m,n=[],o=[],f.polygonStart()},polygonEnd:function(){s.point=g,s.lineStart=i,s.lineEnd=j,n=Wf.merge(n);var a=_a(r,o);n.length?Ua(n,$a,a,c,f):a&&(f.lineStart(),c(null,null,1,f),f.lineEnd()),f.polygonEnd(),n=o=null},sphere:function(){f.polygonStart(),f.lineStart(),c(null,null,1,f),f.lineEnd(),f.polygonEnd()}},t=Za(),u=b(t);return s}}function Ya(a){return a.length>1}function Za(){var a,b=[];return{lineStart:function(){b.push(a=[])},point:function(b,c){a.push([b,c])},lineEnd:i,buffer:function(){var c=b;return b=[],a=null,c},rejoin:function(){b.length>1&&b.push(b.pop().concat(b.shift()))}}}function $a(a,b){return((a=a.x)[0]<0?a[1]-Cg-Dg:Cg-a[1])-((b=b.x)[0]<0?b[1]-Cg-Dg:Cg-b[1])}function _a(a,b){var c=a[0],d=a[1],e=[Math.sin(c),-Math.cos(c),0],f=0,g=0;nh.reset();for(var h=0,i=b.length;i>h;++h){var j=b[h],k=j.length;if(k)for(var l=j[0],m=l[0],n=l[1]/2+Ag/4,o=Math.sin(n),p=Math.cos(n),q=1;;){q===k&&(q=0),a=j[q];var r=a[0],s=a[1]/2+Ag/4,t=Math.sin(s),u=Math.cos(s),v=r-m,w=ig(v)>Ag,x=o*t;if(nh.add(Math.atan2(x*Math.sin(v),p*u+x*Math.cos(v))),f+=w?v+(v>=0?Bg:-Bg):v,w^m>=c^r>=c){var y=Ia(Ga(l),Ga(a));La(y);var z=Ia(e,y);La(z);var A=(w^v>=0?-1:1)*O(z[2]);(d>A||d===A&&(y[0]||y[1]))&&(g+=w^v>=0?1:-1)}if(!q++)break;m=r,o=t,p=u,l=a}}return(-Dg>f||Dg>f&&0>nh)^1&g}function ab(a){var b,c=NaN,d=NaN,e=NaN;return{lineStart:function(){a.lineStart(),b=1},point:function(f,g){var h=f>0?Ag:-Ag,i=ig(f-c);ig(i-Ag)<Dg?(a.point(c,d=(d+g)/2>0?Cg:-Cg),a.point(e,d),a.lineEnd(),a.lineStart(),a.point(h,d),a.point(f,d),b=0):e!==h&&i>=Ag&&(ig(c-e)<Dg&&(c-=e*Dg),ig(f-h)<Dg&&(f-=h*Dg),d=bb(c,d,f,g),a.point(e,d),a.lineEnd(),a.lineStart(),a.point(h,d),b=0),a.point(c=f,d=g),e=h},lineEnd:function(){a.lineEnd(),c=d=NaN},clean:function(){return 2-b}}}function bb(a,b,c,d){var e,f,g=Math.sin(a-c);return ig(g)>Dg?Math.atan((Math.sin(b)*(f=Math.cos(d))*Math.sin(c)-Math.sin(d)*(e=Math.cos(b))*Math.sin(a))/(e*f*g)):(b+d)/2}function cb(a,b,c,d){var e;if(null==a)e=c*Cg,d.point(-Ag,e),d.point(0,e),d.point(Ag,e),d.point(Ag,0),d.point(Ag,-e),d.point(0,-e),d.point(-Ag,-e),d.point(-Ag,0),d.point(-Ag,e);else if(ig(a[0]-b[0])>Dg){var f=a[0]<b[0]?Ag:-Ag;e=c*f/2,d.point(-f,e),d.point(0,e),d.point(f,e)}else d.point(b[0],b[1])}function db(a){function b(a,b){return Math.cos(a)*Math.cos(b)>f}function c(a){var c,f,i,j,k;return{lineStart:function(){j=i=!1,k=1},point:function(l,m){var n,o=[l,m],p=b(l,m),q=g?p?0:e(l,m):p?e(l+(0>l?Ag:-Ag),m):0;if(!c&&(j=i=p)&&a.lineStart(),p!==i&&(n=d(c,o),(Na(c,n)||Na(o,n))&&(o[0]+=Dg,o[1]+=Dg,p=b(o[0],o[1]))),p!==i)k=0,p?(a.lineStart(),n=d(o,c),a.point(n[0],n[1])):(n=d(c,o),a.point(n[0],n[1]),a.lineEnd()),c=n;else if(h&&c&&g^p){var r;q&f||!(r=d(o,c,!0))||(k=0,g?(a.lineStart(),a.point(r[0][0],r[0][1]),a.point(r[1][0],r[1][1]),a.lineEnd()):(a.point(r[1][0],r[1][1]),a.lineEnd(),a.lineStart(),a.point(r[0][0],r[0][1])))}!p||c&&Na(c,o)||a.point(o[0],o[1]),c=o,i=p,f=q},lineEnd:function(){i&&a.lineEnd(),c=null},clean:function(){return k|(j&&i)<<1}}}function d(a,b,c){var d=Ga(a),e=Ga(b),g=[1,0,0],h=Ia(d,e),i=Ha(h,h),j=h[0],k=i-j*j;if(!k)return!c&&a;var l=f*i/k,m=-f*j/k,n=Ia(g,h),o=Ka(g,l),p=Ka(h,m);Ja(o,p);var q=n,r=Ha(o,q),s=Ha(q,q),t=r*r-s*(Ha(o,o)-1);if(!(0>t)){var u=Math.sqrt(t),v=Ka(q,(-r-u)/s);if(Ja(v,o),v=Ma(v),!c)return v;var w,x=a[0],y=b[0],z=a[1],A=b[1];x>y&&(w=x,x=y,y=w);var B=y-x,C=ig(B-Ag)<Dg,D=C||Dg>B;if(!C&&z>A&&(w=z,z=A,A=w),D?C?z+A>0^v[1]<(ig(v[0]-x)<Dg?z:A):z<=v[1]&&v[1]<=A:B>Ag^(x<=v[0]&&v[0]<=y)){var E=Ka(q,(-r+u)/s);return Ja(E,o),[v,Ma(E)]}}}function e(b,c){var d=g?a:Ag-a,e=0;return-d>b?e|=1:b>d&&(e|=2),-d>c?e|=4:c>d&&(e|=8),e}var f=Math.cos(a),g=f>0,h=ig(f)>Dg,i=Fb(a,6*Fg);return Xa(b,c,i,g?[0,-a]:[-Ag,a-Ag])}function eb(a,b,c,d){return function(e){var f,g=e.a,h=e.b,i=g.x,j=g.y,k=h.x,l=h.y,m=0,n=1,o=k-i,p=l-j;if(f=a-i,o||!(f>0)){if(f/=o,0>o){if(m>f)return;n>f&&(n=f)}else if(o>0){if(f>n)return;f>m&&(m=f)}if(f=c-i,o||!(0>f)){if(f/=o,0>o){if(f>n)return;f>m&&(m=f)}else if(o>0){if(m>f)return;n>f&&(n=f)}if(f=b-j,p||!(f>0)){if(f/=p,0>p){if(m>f)return;n>f&&(n=f)}else if(p>0){if(f>n)return;f>m&&(m=f)}if(f=d-j,p||!(0>f)){if(f/=p,0>p){if(f>n)return;f>m&&(m=f)}else if(p>0){if(m>f)return;n>f&&(n=f)}return m>0&&(e.a={x:i+m*o,y:j+m*p}),1>n&&(e.b={x:i+n*o,y:j+n*p}),e}}}}}}function fb(a,b,c,d){function e(d,e){return ig(d[0]-a)<Dg?e>0?0:3:ig(d[0]-c)<Dg?e>0?2:1:ig(d[1]-b)<Dg?e>0?1:0:e>0?3:2}function f(a,b){return g(a.x,b.x)}function g(a,b){var c=e(a,1),d=e(b,1);return c!==d?c-d:0===c?b[1]-a[1]:1===c?a[0]-b[0]:2===c?a[1]-b[1]:b[0]-a[0]}return function(h){function i(a){for(var b=0,c=r.length,d=a[1],e=0;c>e;++e)for(var f,g=1,h=r[e],i=h.length,k=h[0];i>g;++g)f=h[g],k[1]<=d?f[1]>d&&j(k,f,a)>0&&++b:f[1]<=d&&j(k,f,a)<0&&--b,k=f;return 0!==b}function j(a,b,c){return(b[0]-a[0])*(c[1]-a[1])-(c[0]-a[0])*(b[1]-a[1])}function k(f,h,i,j){var k=0,l=0;if(null==f||(k=e(f,i))!==(l=e(h,i))||g(f,h)<0^i>0){do j.point(0===k||3===k?a:c,k>1?d:b);while((k=(k+i+4)%4)!==l)}else j.point(h[0],h[1])}function l(e,f){return e>=a&&c>=e&&f>=b&&d>=f}function m(a,b){l(a,b)&&h.point(a,b)}function n(){E.point=p,r&&r.push(s=[]),z=!0,y=!1,w=x=NaN}function o(){q&&(p(t,u),v&&y&&C.rejoin(),q.push(C.buffer())),E.point=m,y&&h.lineEnd()}function p(a,b){a=Math.max(-Ch,Math.min(Ch,a)),b=Math.max(-Ch,Math.min(Ch,b));var c=l(a,b);if(r&&s.push([a,b]),z)t=a,u=b,v=c,z=!1,c&&(h.lineStart(),h.point(a,b));else if(c&&y)h.point(a,b);else{var d={a:{x:w,y:x},b:{x:a,y:b}};D(d)?(y||(h.lineStart(),h.point(d.a.x,d.a.y)),h.point(d.b.x,d.b.y),c||h.lineEnd(),A=!1):c&&(h.lineStart(),h.point(a,b),A=!1)}w=a,x=b,y=c}var q,r,s,t,u,v,w,x,y,z,A,B=h,C=Za(),D=eb(a,b,c,d),E={point:m,lineStart:n,lineEnd:o,polygonStart:function(){h=C,q=[],r=[],A=!0},polygonEnd:function(){h=B,q=Wf.merge(q);var b=i([a,d]),c=A&&b,e=q.length;(c||e)&&(h.polygonStart(),c&&(h.lineStart(),k(null,null,1,h),h.lineEnd()),e&&Ua(q,f,b,k,h),h.polygonEnd()),q=r=s=null}};return E}}function gb(a,b){function c(c,d){return c=a(c,d),b(c[0],c[1])}return a.invert&&b.invert&&(c.invert=function(c,d){return c=b.invert(c,d),c&&a.invert(c[0],c[1])}),c}function hb(a){var b=0,c=Ag/3,d=xb(a),e=d(b,c);return e.parallels=function(a){return arguments.length?d(b=a[0]*Ag/180,c=a[1]*Ag/180):[b/Ag*180,c/Ag*180]},e}function ib(a,b){function c(a,b){var c=Math.sqrt(f-2*e*Math.sin(b))/e;return[c*Math.sin(a*=e),g-c*Math.cos(a)]}var d=Math.sin(a),e=(d+Math.sin(b))/2,f=1+d*(2*e-d),g=Math.sqrt(f)/e;return c.invert=function(a,b){var c=g-b;return[Math.atan2(a,c)/e,O((f-(a*a+c*c)*e*e)/(2*e))]},c}function jb(){function a(a,b){Eh+=e*a-d*b,d=a,e=b}var b,c,d,e;Jh.point=function(f,g){Jh.point=a,b=d=f,c=e=g},Jh.lineEnd=function(){a(b,c)}}function kb(a,b){Fh>a&&(Fh=a),a>Hh&&(Hh=a),Gh>b&&(Gh=b),b>Ih&&(Ih=b)}function lb(){function a(a,b){g.push("M",a,",",b,f)}function b(a,b){g.push("M",a,",",b),h.point=c}function c(a,b){g.push("L",a,",",b)}function d(){h.point=a}function e(){g.push("Z")}var f=mb(4.5),g=[],h={point:a,lineStart:function(){h.point=b},lineEnd:d,polygonStart:function(){h.lineEnd=e},polygonEnd:function(){h.lineEnd=d,h.point=a},pointRadius:function(a){return f=mb(a),h},result:function(){if(g.length){var a=g.join("");return g=[],a}}};return h}function mb(a){return"m0,"+a+"a"+a+","+a+" 0 1,1 0,"+-2*a+"a"+a+","+a+" 0 1,1 0,"+2*a+"z"}function nb(a,b){rh+=a,sh+=b,++th}function ob(){function a(a,d){var e=a-b,f=d-c,g=Math.sqrt(e*e+f*f);uh+=g*(b+a)/2,vh+=g*(c+d)/2,wh+=g,nb(b=a,c=d)}var b,c;Lh.point=function(d,e){Lh.point=a,nb(b=d,c=e)}}function pb(){Lh.point=nb}function qb(){function a(a,b){var c=a-d,f=b-e,g=Math.sqrt(c*c+f*f);uh+=g*(d+a)/2,vh+=g*(e+b)/2,wh+=g,g=e*a-d*b,xh+=g*(d+a),yh+=g*(e+b),zh+=3*g,nb(d=a,e=b)}var b,c,d,e;Lh.point=function(f,g){Lh.point=a,nb(b=d=f,c=e=g)},Lh.lineEnd=function(){a(b,c)}}function rb(a){function b(b,c){a.moveTo(b,c),a.arc(b,c,g,0,Bg)}function c(b,c){a.moveTo(b,c),h.point=d}function d(b,c){a.lineTo(b,c)}function e(){h.point=b}function f(){a.closePath()}var g=4.5,h={point:b,lineStart:function(){h.point=c},lineEnd:e,polygonStart:function(){h.lineEnd=f},polygonEnd:function(){h.lineEnd=e,h.point=b},pointRadius:function(a){return g=a,h},result:i};return h}function sb(a){function b(a){return(h?d:c)(a)}function c(b){return vb(b,function(c,d){c=a(c,d),b.point(c[0],c[1])})}function d(b){function c(c,d){c=a(c,d),b.point(c[0],c[1])}function d(){t=NaN,y.point=f,b.lineStart()}function f(c,d){var f=Ga([c,d]),g=a(c,d);e(t,u,s,v,w,x,t=g[0],u=g[1],s=c,v=f[0],w=f[1],x=f[2],h,b),b.point(t,u)}function g(){y.point=c,b.lineEnd()}function i(){d(),y.point=j,y.lineEnd=k}function j(a,b){f(l=a,m=b),n=t,o=u,p=v,q=w,r=x,y.point=f}function k(){e(t,u,s,v,w,x,n,o,l,p,q,r,h,b),y.lineEnd=g,g()}var l,m,n,o,p,q,r,s,t,u,v,w,x,y={point:c,lineStart:d,lineEnd:g,polygonStart:function(){b.polygonStart(),y.lineStart=i},polygonEnd:function(){b.polygonEnd(),y.lineStart=d}};return y}function e(b,c,d,h,i,j,k,l,m,n,o,p,q,r){var s=k-b,t=l-c,u=s*s+t*t;if(u>4*f&&q--){var v=h+n,w=i+o,x=j+p,y=Math.sqrt(v*v+w*w+x*x),z=Math.asin(x/=y),A=ig(ig(x)-1)<Dg||ig(d-m)<Dg?(d+m)/2:Math.atan2(w,v),B=a(A,z),C=B[0],D=B[1],E=C-b,F=D-c,G=t*E-s*F;(G*G/u>f||ig((s*E+t*F)/u-.5)>.3||g>h*n+i*o+j*p)&&(e(b,c,d,h,i,j,C,D,A,v/=y,w/=y,x,q,r),r.point(C,D),e(C,D,A,v,w,x,k,l,m,n,o,p,q,r))}}var f=.5,g=Math.cos(30*Fg),h=16;return b.precision=function(a){return arguments.length?(h=(f=a*a)>0&&16,b):Math.sqrt(f)},b}function tb(a){var b=sb(function(b,c){return a([b*Gg,c*Gg])});return function(a){return yb(b(a))}}function ub(a){this.stream=a}function vb(a,b){return{point:b,sphere:function(){a.sphere()},lineStart:function(){a.lineStart()},lineEnd:function(){a.lineEnd()},polygonStart:function(){a.polygonStart()},polygonEnd:function(){a.polygonEnd()}}}function wb(a){return xb(function(){return a})()}function xb(a){function b(a){return a=h(a[0]*Fg,a[1]*Fg),[a[0]*m+i,j-a[1]*m]}function c(a){return a=h.invert((a[0]-i)/m,(j-a[1])/m),a&&[a[0]*Gg,a[1]*Gg]}function d(){h=gb(g=Bb(r,s,t),f);var a=f(p,q);return i=n-a[0]*m,j=o+a[1]*m,e()}function e(){return k&&(k.valid=!1,k=null),b}var f,g,h,i,j,k,l=sb(function(a,b){return a=f(a,b),[a[0]*m+i,j-a[1]*m]}),m=150,n=480,o=250,p=0,q=0,r=0,s=0,t=0,u=Bh,v=qa,w=null,x=null;return b.stream=function(a){return k&&(k.valid=!1),k=yb(u(g,l(v(a)))),k.valid=!0,k},b.clipAngle=function(a){return arguments.length?(u=null==a?(w=a,Bh):db((w=+a)*Fg),e()):w},b.clipExtent=function(a){return arguments.length?(x=a,v=a?fb(a[0][0],a[0][1],a[1][0],a[1][1]):qa,e()):x},b.scale=function(a){return arguments.length?(m=+a,d()):m},b.translate=function(a){return arguments.length?(n=+a[0],o=+a[1],d()):[n,o]},b.center=function(a){return arguments.length?(p=a[0]%360*Fg,q=a[1]%360*Fg,d()):[p*Gg,q*Gg]},b.rotate=function(a){return arguments.length?(r=a[0]%360*Fg,s=a[1]%360*Fg,t=a.length>2?a[2]%360*Fg:0,d()):[r*Gg,s*Gg,t*Gg]},Wf.rebind(b,l,"precision"),function(){return f=a.apply(this,arguments),b.invert=f.invert&&c,d()}}function yb(a){return vb(a,function(b,c){a.point(b*Fg,c*Fg)})}function zb(a,b){return[a,b]}function Ab(a,b){return[a>Ag?a-Bg:-Ag>a?a+Bg:a,b]}function Bb(a,b,c){return a?b||c?gb(Db(a),Eb(b,c)):Db(a):b||c?Eb(b,c):Ab}function Cb(a){return function(b,c){return b+=a,[b>Ag?b-Bg:-Ag>b?b+Bg:b,c]}}function Db(a){var b=Cb(a);return b.invert=Cb(-a),b}function Eb(a,b){function c(a,b){var c=Math.cos(b),h=Math.cos(a)*c,i=Math.sin(a)*c,j=Math.sin(b),k=j*d+h*e;return[Math.atan2(i*f-k*g,h*d-j*e),O(k*f+i*g)]}var d=Math.cos(a),e=Math.sin(a),f=Math.cos(b),g=Math.sin(b);return c.invert=function(a,b){var c=Math.cos(b),h=Math.cos(a)*c,i=Math.sin(a)*c,j=Math.sin(b),k=j*f-i*g;return[Math.atan2(i*f+j*g,h*d+k*e),O(k*d-h*e)]},c}function Fb(a,b){var c=Math.cos(a),d=Math.sin(a);return function(e,f,g,h){var i=g*b;null!=e?(e=Gb(c,e),f=Gb(c,f),(g>0?f>e:e>f)&&(e+=g*Bg)):(e=a+g*Bg,f=a-.5*i);for(var j,k=e;g>0?k>f:f>k;k-=i)h.point((j=Ma([c,-d*Math.cos(k),-d*Math.sin(k)]))[0],j[1])}}function Gb(a,b){var c=Ga(b);c[0]-=a,La(c);var d=N(-c[1]);return((-c[2]<0?-d:d)+2*Math.PI-Dg)%(2*Math.PI)}function Hb(a,b,c){var d=Wf.range(a,b-Dg,c).concat(b);return function(a){return d.map(function(b){return[a,b]})}}function Ib(a,b,c){var d=Wf.range(a,b-Dg,c).concat(b);return function(a){return d.map(function(b){return[b,a]})}}function Jb(a){return a.source}function Kb(a){return a.target}function Lb(a,b,c,d){var e=Math.cos(b),f=Math.sin(b),g=Math.cos(d),h=Math.sin(d),i=e*Math.cos(a),j=e*Math.sin(a),k=g*Math.cos(c),l=g*Math.sin(c),m=2*Math.asin(Math.sqrt(S(d-b)+e*g*S(c-a))),n=1/Math.sin(m),o=m?function(a){var b=Math.sin(a*=m)*n,c=Math.sin(m-a)*n,d=c*i+b*k,e=c*j+b*l,g=c*f+b*h;return[Math.atan2(e,d)*Gg,Math.atan2(g,Math.sqrt(d*d+e*e))*Gg]}:function(){return[a*Gg,b*Gg]};return o.distance=m,o}function Mb(){function a(a,e){var f=Math.sin(e*=Fg),g=Math.cos(e),h=ig((a*=Fg)-b),i=Math.cos(h);Mh+=Math.atan2(Math.sqrt((h=g*Math.sin(h))*h+(h=d*f-c*g*i)*h),c*f+d*g*i),b=a,c=f,d=g}var b,c,d;Nh.point=function(e,f){b=e*Fg,c=Math.sin(f*=Fg),d=Math.cos(f),Nh.point=a},Nh.lineEnd=function(){Nh.point=Nh.lineEnd=i}}function Nb(a,b){function c(b,c){var d=Math.cos(b),e=Math.cos(c),f=a(d*e);return[f*e*Math.sin(b),f*Math.sin(c)]}return c.invert=function(a,c){var d=Math.sqrt(a*a+c*c),e=b(d),f=Math.sin(e),g=Math.cos(e);return[Math.atan2(a*f,d*g),Math.asin(d&&c*f/d)]},c}function Ob(a,b){function c(a,b){var c=ig(ig(b)-Cg)<Dg?0:g/Math.pow(e(b),f);return[c*Math.sin(f*a),g-c*Math.cos(f*a)]}var d=Math.cos(a),e=function(a){return Math.tan(Ag/4+a/2)},f=a===b?Math.sin(a):Math.log(d/Math.cos(b))/Math.log(e(b)/e(a)),g=d*Math.pow(e(a),f)/f;return f?(c.invert=function(a,b){var c=g-b,d=M(f)*Math.sqrt(a*a+c*c);return[Math.atan2(a,c)/f,2*Math.atan(Math.pow(g/d,1/f))-Cg]},c):Qb}function Pb(a,b){function c(a,b){var c=f-b;return[c*Math.sin(e*a),f-c*Math.cos(e*a)]}var d=Math.cos(a),e=a===b?Math.sin(a):(d-Math.cos(b))/(b-a),f=d/e+a;return ig(e)<Dg?zb:(c.invert=function(a,b){var c=f-b;return[Math.atan2(a,c)/e,f-M(e)*Math.sqrt(a*a+c*c)]},c)}function Qb(a,b){return[a,Math.log(Math.tan(Ag/4+b/2))]}function Rb(a){var b,c=wb(a),d=c.scale,e=c.translate,f=c.clipExtent;return c.scale=function(){var a=d.apply(c,arguments);return a===c?b?c.clipExtent(null):c:a},c.translate=function(){var a=e.apply(c,arguments);return a===c?b?c.clipExtent(null):c:a},c.clipExtent=function(a){var g=f.apply(c,arguments);if(g===c){if(b=null==a){var h=Ag*d(),i=e();f([[i[0]-h,i[1]-h],[i[0]+h,i[1]+h]])}}else b&&(g=null);return g},c.clipExtent(null)}function Sb(a,b){return[Math.log(Math.tan(Ag/4+b/2)),-a]}function Tb(a){return a[0]}function Ub(a){return a[1]}function Vb(a,b,c,d){var e,f,g,h,i,j,k;return e=d[a],f=e[0],g=e[1],e=d[b],h=e[0],i=e[1],e=d[c],j=e[0],k=e[1],(k-g)*(h-f)-(i-g)*(j-f)>0}function Wb(a,b,c){return(c[0]-b[0])*(a[1]-b[1])<(c[1]-b[1])*(a[0]-b[0])}function Xb(a,b,c,d){var e=a[0],f=c[0],g=b[0]-e,h=d[0]-f,i=a[1],j=c[1],k=b[1]-i,l=d[1]-j,m=(h*(i-j)-l*(e-f))/(l*g-h*k);return[e+m*g,i+m*k]}function Yb(a){var b=a[0],c=a[a.length-1];return!(b[0]-c[0]||b[1]-c[1])}function Zb(){sc(this),this.edge=this.site=this.circle=null}function $b(a){var b=Zh.pop()||new Zb;return b.site=a,b}function _b(a){jc(a),Wh.remove(a),Zh.push(a),sc(a)}function ac(a){var b=a.circle,c=b.x,d=b.cy,e={x:c,y:d},f=a.P,g=a.N,h=[a];_b(a);for(var i=f;i.circle&&ig(c-i.circle.x)<Dg&&ig(d-i.circle.cy)<Dg;)f=i.P,h.unshift(i),_b(i),i=f;h.unshift(i),jc(i);for(var j=g;j.circle&&ig(c-j.circle.x)<Dg&&ig(d-j.circle.cy)<Dg;)g=j.N,h.push(j),_b(j),j=g;h.push(j),jc(j);var k,l=h.length;for(k=1;l>k;++k)j=h[k],i=h[k-1],pc(j.edge,i.site,j.site,e);i=h[0],j=h[l-1],j.edge=nc(i.site,j.site,null,e),ic(i),ic(j)}function bc(a){for(var b,c,d,e,f=a.x,g=a.y,h=Wh._;h;)if(d=cc(h,g)-f,d>Dg)h=h.L;else{if(e=f-dc(h,g),!(e>Dg)){d>-Dg?(b=h.P,c=h):e>-Dg?(b=h,c=h.N):b=c=h;break}if(!h.R){b=h;break}h=h.R}var i=$b(a);if(Wh.insert(b,i),b||c){if(b===c)return jc(b),c=$b(b.site),Wh.insert(i,c),i.edge=c.edge=nc(b.site,i.site),ic(b),void ic(c);if(!c)return void(i.edge=nc(b.site,i.site));jc(b),jc(c);var j=b.site,k=j.x,l=j.y,m=a.x-k,n=a.y-l,o=c.site,p=o.x-k,q=o.y-l,r=2*(m*q-n*p),s=m*m+n*n,t=p*p+q*q,u={x:(q*s-n*t)/r+k,y:(m*t-p*s)/r+l};pc(c.edge,j,o,u),i.edge=nc(j,a,null,u),c.edge=nc(a,o,null,u),ic(b),ic(c)}}function cc(a,b){var c=a.site,d=c.x,e=c.y,f=e-b;if(!f)return d;var g=a.P;if(!g)return-(1/0);c=g.site;var h=c.x,i=c.y,j=i-b;if(!j)return h;var k=h-d,l=1/f-1/j,m=k/j;return l?(-m+Math.sqrt(m*m-2*l*(k*k/(-2*j)-i+j/2+e-f/2)))/l+d:(d+h)/2}function dc(a,b){var c=a.N;if(c)return cc(c,b);var d=a.site;return d.y===b?d.x:1/0}function ec(a){this.site=a,this.edges=[]}function fc(a){for(var b,c,d,e,f,g,h,i,j,k,l=a[0][0],m=a[1][0],n=a[0][1],o=a[1][1],p=Vh,q=p.length;q--;)if(f=p[q],f&&f.prepare())for(h=f.edges,i=h.length,g=0;i>g;)k=h[g].end(),d=k.x,e=k.y,j=h[++g%i].start(),b=j.x,c=j.y,(ig(d-b)>Dg||ig(e-c)>Dg)&&(h.splice(g,0,new qc(oc(f.site,k,ig(d-l)<Dg&&o-e>Dg?{x:l,y:ig(b-l)<Dg?c:o}:ig(e-o)<Dg&&m-d>Dg?{x:ig(c-o)<Dg?b:m,y:o}:ig(d-m)<Dg&&e-n>Dg?{x:m,y:ig(b-m)<Dg?c:n}:ig(e-n)<Dg&&d-l>Dg?{x:ig(c-n)<Dg?b:l,y:n}:null),f.site,null)),++i)}function gc(a,b){return b.angle-a.angle}function hc(){sc(this),this.x=this.y=this.arc=this.site=this.cy=null}function ic(a){var b=a.P,c=a.N;if(b&&c){var d=b.site,e=a.site,f=c.site;if(d!==f){var g=e.x,h=e.y,i=d.x-g,j=d.y-h,k=f.x-g,l=f.y-h,m=2*(i*l-j*k);if(!(m>=-Eg)){var n=i*i+j*j,o=k*k+l*l,p=(l*n-j*o)/m,q=(i*o-k*n)/m,l=q+h,r=$h.pop()||new hc;r.arc=a,r.site=e,r.x=p+g,r.y=l+Math.sqrt(p*p+q*q),r.cy=l,a.circle=r;for(var s=null,t=Yh._;t;)if(r.y<t.y||r.y===t.y&&r.x<=t.x){if(!t.L){s=t.P;break}t=t.L}else{if(!t.R){s=t;break}t=t.R}Yh.insert(s,r),s||(Xh=r)}}}}function jc(a){var b=a.circle;b&&(b.P||(Xh=b.N),Yh.remove(b),$h.push(b),sc(b),a.circle=null)}function kc(a){for(var b,c=Uh,d=eb(a[0][0],a[0][1],a[1][0],a[1][1]),e=c.length;e--;)b=c[e],(!lc(b,a)||!d(b)||ig(b.a.x-b.b.x)<Dg&&ig(b.a.y-b.b.y)<Dg)&&(b.a=b.b=null,c.splice(e,1))}function lc(a,b){var c=a.b;if(c)return!0;var d,e,f=a.a,g=b[0][0],h=b[1][0],i=b[0][1],j=b[1][1],k=a.l,l=a.r,m=k.x,n=k.y,o=l.x,p=l.y,q=(m+o)/2,r=(n+p)/2;
if(p===n){if(g>q||q>=h)return;if(m>o){if(f){if(f.y>=j)return}else f={x:q,y:i};c={x:q,y:j}}else{if(f){if(f.y<i)return}else f={x:q,y:j};c={x:q,y:i}}}else if(d=(m-o)/(p-n),e=r-d*q,-1>d||d>1)if(m>o){if(f){if(f.y>=j)return}else f={x:(i-e)/d,y:i};c={x:(j-e)/d,y:j}}else{if(f){if(f.y<i)return}else f={x:(j-e)/d,y:j};c={x:(i-e)/d,y:i}}else if(p>n){if(f){if(f.x>=h)return}else f={x:g,y:d*g+e};c={x:h,y:d*h+e}}else{if(f){if(f.x<g)return}else f={x:h,y:d*h+e};c={x:g,y:d*g+e}}return a.a=f,a.b=c,!0}function mc(a,b){this.l=a,this.r=b,this.a=this.b=null}function nc(a,b,c,d){var e=new mc(a,b);return Uh.push(e),c&&pc(e,a,b,c),d&&pc(e,b,a,d),Vh[a.i].edges.push(new qc(e,a,b)),Vh[b.i].edges.push(new qc(e,b,a)),e}function oc(a,b,c){var d=new mc(a,null);return d.a=b,d.b=c,Uh.push(d),d}function pc(a,b,c,d){a.a||a.b?a.l===c?a.b=d:a.a=d:(a.a=d,a.l=b,a.r=c)}function qc(a,b,c){var d=a.a,e=a.b;this.edge=a,this.site=b,this.angle=c?Math.atan2(c.y-b.y,c.x-b.x):a.l===b?Math.atan2(e.x-d.x,d.y-e.y):Math.atan2(d.x-e.x,e.y-d.y)}function rc(){this._=null}function sc(a){a.U=a.C=a.L=a.R=a.P=a.N=null}function tc(a,b){var c=b,d=b.R,e=c.U;e?e.L===c?e.L=d:e.R=d:a._=d,d.U=e,c.U=d,c.R=d.L,c.R&&(c.R.U=c),d.L=c}function uc(a,b){var c=b,d=b.L,e=c.U;e?e.L===c?e.L=d:e.R=d:a._=d,d.U=e,c.U=d,c.L=d.R,c.L&&(c.L.U=c),d.R=c}function vc(a){for(;a.L;)a=a.L;return a}function wc(a,b){var c,d,e,f=a.sort(xc).pop();for(Uh=[],Vh=new Array(a.length),Wh=new rc,Yh=new rc;;)if(e=Xh,f&&(!e||f.y<e.y||f.y===e.y&&f.x<e.x))(f.x!==c||f.y!==d)&&(Vh[f.i]=new ec(f),bc(f),c=f.x,d=f.y),f=a.pop();else{if(!e)break;ac(e.arc)}b&&(kc(b),fc(b));var g={cells:Vh,edges:Uh};return Wh=Yh=Uh=Vh=null,g}function xc(a,b){return b.y-a.y||b.x-a.x}function yc(a,b,c){return(a.x-c.x)*(b.y-a.y)-(a.x-b.x)*(c.y-a.y)}function zc(a){return a.x}function Ac(a){return a.y}function Bc(){return{leaf:!0,nodes:[],point:null,x:null,y:null}}function Cc(a,b,c,d,e,f){if(!a(b,c,d,e,f)){var g=.5*(c+e),h=.5*(d+f),i=b.nodes;i[0]&&Cc(a,i[0],c,d,g,h),i[1]&&Cc(a,i[1],g,d,e,h),i[2]&&Cc(a,i[2],c,h,g,f),i[3]&&Cc(a,i[3],g,h,e,f)}}function Dc(a,b){a=Wf.rgb(a),b=Wf.rgb(b);var c=a.r,d=a.g,e=a.b,f=b.r-c,g=b.g-d,h=b.b-e;return function(a){return"#"+ja(Math.round(c+f*a))+ja(Math.round(d+g*a))+ja(Math.round(e+h*a))}}function Ec(a,b){var c,d={},e={};for(c in a)c in b?d[c]=Hc(a[c],b[c]):e[c]=a[c];for(c in b)c in a||(e[c]=b[c]);return function(a){for(c in d)e[c]=d[c](a);return e}}function Fc(a,b){return b-=a=+a,function(c){return a+b*c}}function Gc(a,b){var c,d,e,f,g,h=0,i=0,j=[],k=[];for(a+="",b+="",ai.lastIndex=0,d=0;c=ai.exec(b);++d)c.index&&j.push(b.substring(h,i=c.index)),k.push({i:j.length,x:c[0]}),j.push(null),h=ai.lastIndex;for(h<b.length&&j.push(b.substring(h)),d=0,f=k.length;(c=ai.exec(a))&&f>d;++d)if(g=k[d],g.x==c[0]){if(g.i)if(null==j[g.i+1])for(j[g.i-1]+=g.x,j.splice(g.i,1),e=d+1;f>e;++e)k[e].i--;else for(j[g.i-1]+=g.x+j[g.i+1],j.splice(g.i,2),e=d+1;f>e;++e)k[e].i-=2;else if(null==j[g.i+1])j[g.i]=g.x;else for(j[g.i]=g.x+j[g.i+1],j.splice(g.i+1,1),e=d+1;f>e;++e)k[e].i--;k.splice(d,1),f--,d--}else g.x=Fc(parseFloat(c[0]),parseFloat(g.x));for(;f>d;)g=k.pop(),null==j[g.i+1]?j[g.i]=g.x:(j[g.i]=g.x+j[g.i+1],j.splice(g.i+1,1)),f--;return 1===j.length?null==j[0]?(g=k[0].x,function(a){return g(a)+""}):function(){return b}:function(a){for(d=0;f>d;++d)j[(g=k[d]).i]=g.x(a);return j.join("")}}function Hc(a,b){for(var c,d=Wf.interpolators.length;--d>=0&&!(c=Wf.interpolators[d](a,b)););return c}function Ic(a,b){var c,d=[],e=[],f=a.length,g=b.length,h=Math.min(a.length,b.length);for(c=0;h>c;++c)d.push(Hc(a[c],b[c]));for(;f>c;++c)e[c]=a[c];for(;g>c;++c)e[c]=b[c];return function(a){for(c=0;h>c;++c)e[c]=d[c](a);return e}}function Jc(a){return function(b){return 0>=b?0:b>=1?1:a(b)}}function Kc(a){return function(b){return 1-a(1-b)}}function Lc(a){return function(b){return.5*(.5>b?a(2*b):2-a(2-2*b))}}function Mc(a){return a*a}function Nc(a){return a*a*a}function Oc(a){if(0>=a)return 0;if(a>=1)return 1;var b=a*a,c=b*a;return 4*(.5>a?c:3*(a-b)+c-.75)}function Pc(a){return function(b){return Math.pow(b,a)}}function Qc(a){return 1-Math.cos(a*Cg)}function Rc(a){return Math.pow(2,10*(a-1))}function Sc(a){return 1-Math.sqrt(1-a*a)}function Tc(a,b){var c;return arguments.length<2&&(b=.45),arguments.length?c=b/Bg*Math.asin(1/a):(a=1,c=b/4),function(d){return 1+a*Math.pow(2,-10*d)*Math.sin((d-c)*Bg/b)}}function Uc(a){return a||(a=1.70158),function(b){return b*b*((a+1)*b-a)}}function Vc(a){return 1/2.75>a?7.5625*a*a:2/2.75>a?7.5625*(a-=1.5/2.75)*a+.75:2.5/2.75>a?7.5625*(a-=2.25/2.75)*a+.9375:7.5625*(a-=2.625/2.75)*a+.984375}function Wc(a,b){a=Wf.hcl(a),b=Wf.hcl(b);var c=a.h,d=a.c,e=a.l,f=b.h-c,g=b.c-d,h=b.l-e;return isNaN(g)&&(g=0,d=isNaN(d)?b.c:d),isNaN(f)?(f=0,c=isNaN(c)?b.h:c):f>180?f-=360:-180>f&&(f+=360),function(a){return Z(c+f*a,d+g*a,e+h*a)+""}}function Xc(a,b){a=Wf.hsl(a),b=Wf.hsl(b);var c=a.h,d=a.s,e=a.l,f=b.h-c,g=b.s-d,h=b.l-e;return isNaN(g)&&(g=0,d=isNaN(d)?b.s:d),isNaN(f)?(f=0,c=isNaN(c)?b.h:c):f>180?f-=360:-180>f&&(f+=360),function(a){return W(c+f*a,d+g*a,e+h*a)+""}}function Yc(a,b){a=Wf.lab(a),b=Wf.lab(b);var c=a.l,d=a.a,e=a.b,f=b.l-c,g=b.a-d,h=b.b-e;return function(a){return aa(c+f*a,d+g*a,e+h*a)+""}}function Zc(a,b){return b-=a,function(c){return Math.round(a+b*c)}}function $c(a){var b=[a.a,a.b],c=[a.c,a.d],d=ad(b),e=_c(b,c),f=ad(bd(c,b,-e))||0;b[0]*c[1]<c[0]*b[1]&&(b[0]*=-1,b[1]*=-1,d*=-1,e*=-1),this.rotate=(d?Math.atan2(b[1],b[0]):Math.atan2(-c[0],c[1]))*Gg,this.translate=[a.e,a.f],this.scale=[d,f],this.skew=f?Math.atan2(e,f)*Gg:0}function _c(a,b){return a[0]*b[0]+a[1]*b[1]}function ad(a){var b=Math.sqrt(_c(a,a));return b&&(a[0]/=b,a[1]/=b),b}function bd(a,b,c){return a[0]+=c*b[0],a[1]+=c*b[1],a}function cd(a,b){var c,d=[],e=[],f=Wf.transform(a),g=Wf.transform(b),h=f.translate,i=g.translate,j=f.rotate,k=g.rotate,l=f.skew,m=g.skew,n=f.scale,o=g.scale;return h[0]!=i[0]||h[1]!=i[1]?(d.push("translate(",null,",",null,")"),e.push({i:1,x:Fc(h[0],i[0])},{i:3,x:Fc(h[1],i[1])})):i[0]||i[1]?d.push("translate("+i+")"):d.push(""),j!=k?(j-k>180?k+=360:k-j>180&&(j+=360),e.push({i:d.push(d.pop()+"rotate(",null,")")-2,x:Fc(j,k)})):k&&d.push(d.pop()+"rotate("+k+")"),l!=m?e.push({i:d.push(d.pop()+"skewX(",null,")")-2,x:Fc(l,m)}):m&&d.push(d.pop()+"skewX("+m+")"),n[0]!=o[0]||n[1]!=o[1]?(c=d.push(d.pop()+"scale(",null,",",null,")"),e.push({i:c-4,x:Fc(n[0],o[0])},{i:c-2,x:Fc(n[1],o[1])})):(1!=o[0]||1!=o[1])&&d.push(d.pop()+"scale("+o+")"),c=e.length,function(a){for(var b,f=-1;++f<c;)d[(b=e[f]).i]=b.x(a);return d.join("")}}function dd(a,b){return b=b-(a=+a)?1/(b-a):0,function(c){return(c-a)*b}}function ed(a,b){return b=b-(a=+a)?1/(b-a):0,function(c){return Math.max(0,Math.min(1,(c-a)*b))}}function fd(a){for(var b=a.source,c=a.target,d=hd(b,c),e=[b];b!==d;)b=b.parent,e.push(b);for(var f=e.length;c!==d;)e.splice(f,0,c),c=c.parent;return e}function gd(a){for(var b=[],c=a.parent;null!=c;)b.push(a),a=c,c=c.parent;return b.push(a),b}function hd(a,b){if(a===b)return a;for(var c=gd(a),d=gd(b),e=c.pop(),f=d.pop(),g=null;e===f;)g=e,e=c.pop(),f=d.pop();return g}function id(a){a.fixed|=2}function jd(a){a.fixed&=-7}function kd(a){a.fixed|=4,a.px=a.x,a.py=a.y}function ld(a){a.fixed&=-5}function md(a,b,c){var d=0,e=0;if(a.charge=0,!a.leaf)for(var f,g=a.nodes,h=g.length,i=-1;++i<h;)f=g[i],null!=f&&(md(f,b,c),a.charge+=f.charge,d+=f.charge*f.cx,e+=f.charge*f.cy);if(a.point){a.leaf||(a.point.x+=Math.random()-.5,a.point.y+=Math.random()-.5);var j=b*c[a.point.index];a.charge+=a.pointCharge=j,d+=j*a.point.x,e+=j*a.point.y}a.cx=d/a.charge,a.cy=e/a.charge}function nd(a,b){return Wf.rebind(a,b,"sort","children","value"),a.nodes=a,a.links=rd,a}function od(a){return a.children}function pd(a){return a.value}function qd(a,b){return b.value-a.value}function rd(a){return Wf.merge(a.map(function(a){return(a.children||[]).map(function(b){return{source:a,target:b}})}))}function sd(a){return a.x}function td(a){return a.y}function ud(a,b,c){a.y0=b,a.y=c}function vd(a){return Wf.range(a.length)}function wd(a){for(var b=-1,c=a[0].length,d=[];++b<c;)d[b]=0;return d}function xd(a){for(var b,c=1,d=0,e=a[0][1],f=a.length;f>c;++c)(b=a[c][1])>e&&(d=c,e=b);return d}function yd(a){return a.reduce(zd,0)}function zd(a,b){return a+b[1]}function Ad(a,b){return Bd(a,Math.ceil(Math.log(b.length)/Math.LN2+1))}function Bd(a,b){for(var c=-1,d=+a[0],e=(a[1]-d)/b,f=[];++c<=b;)f[c]=e*c+d;return f}function Cd(a){return[Wf.min(a),Wf.max(a)]}function Dd(a,b){return a.parent==b.parent?1:2}function Ed(a){var b=a.children;return b&&b.length?b[0]:a._tree.thread}function Fd(a){var b,c=a.children;return c&&(b=c.length)?c[b-1]:a._tree.thread}function Gd(a,b){var c=a.children;if(c&&(e=c.length))for(var d,e,f=-1;++f<e;)b(d=Gd(c[f],b),a)>0&&(a=d);return a}function Hd(a,b){return a.x-b.x}function Id(a,b){return b.x-a.x}function Jd(a,b){return a.depth-b.depth}function Kd(a,b){function c(a,d){var e=a.children;if(e&&(g=e.length))for(var f,g,h=null,i=-1;++i<g;)f=e[i],c(f,h),h=f;b(a,d)}c(a,null)}function Ld(a){for(var b,c=0,d=0,e=a.children,f=e.length;--f>=0;)b=e[f]._tree,b.prelim+=c,b.mod+=c,c+=b.shift+(d+=b.change)}function Md(a,b,c){a=a._tree,b=b._tree;var d=c/(b.number-a.number);a.change+=d,b.change-=d,b.shift+=c,b.prelim+=c,b.mod+=c}function Nd(a,b,c){return a._tree.ancestor.parent==b.parent?a._tree.ancestor:c}function Od(a,b){return a.value-b.value}function Pd(a,b){var c=a._pack_next;a._pack_next=b,b._pack_prev=a,b._pack_next=c,c._pack_prev=b}function Qd(a,b){a._pack_next=b,b._pack_prev=a}function Rd(a,b){var c=b.x-a.x,d=b.y-a.y,e=a.r+b.r;return.999*e*e>c*c+d*d}function Sd(a){function b(a){k=Math.min(a.x-a.r,k),l=Math.max(a.x+a.r,l),m=Math.min(a.y-a.r,m),n=Math.max(a.y+a.r,n)}if((c=a.children)&&(j=c.length)){var c,d,e,f,g,h,i,j,k=1/0,l=-(1/0),m=1/0,n=-(1/0);if(c.forEach(Td),d=c[0],d.x=-d.r,d.y=0,b(d),j>1&&(e=c[1],e.x=e.r,e.y=0,b(e),j>2))for(f=c[2],Wd(d,e,f),b(f),Pd(d,f),d._pack_prev=f,Pd(f,e),e=d._pack_next,g=3;j>g;g++){Wd(d,e,f=c[g]);var o=0,p=1,q=1;for(h=e._pack_next;h!==e;h=h._pack_next,p++)if(Rd(h,f)){o=1;break}if(1==o)for(i=d._pack_prev;i!==h._pack_prev&&!Rd(i,f);i=i._pack_prev,q++);o?(q>p||p==q&&e.r<d.r?Qd(d,e=h):Qd(d=i,e),g--):(Pd(d,f),e=f,b(f))}var r=(k+l)/2,s=(m+n)/2,t=0;for(g=0;j>g;g++)f=c[g],f.x-=r,f.y-=s,t=Math.max(t,f.r+Math.sqrt(f.x*f.x+f.y*f.y));a.r=t,c.forEach(Ud)}}function Td(a){a._pack_next=a._pack_prev=a}function Ud(a){delete a._pack_next,delete a._pack_prev}function Vd(a,b,c,d){var e=a.children;if(a.x=b+=d*a.x,a.y=c+=d*a.y,a.r*=d,e)for(var f=-1,g=e.length;++f<g;)Vd(e[f],b,c,d)}function Wd(a,b,c){var d=a.r+c.r,e=b.x-a.x,f=b.y-a.y;if(d&&(e||f)){var g=b.r+c.r,h=e*e+f*f;g*=g,d*=d;var i=.5+(d-g)/(2*h),j=Math.sqrt(Math.max(0,2*g*(d+h)-(d-=h)*d-g*g))/(2*h);c.x=a.x+i*e+j*f,c.y=a.y+i*f-j*e}else c.x=a.x+d,c.y=a.y}function Xd(a){return 1+Wf.max(a,function(a){return a.y})}function Yd(a){return a.reduce(function(a,b){return a+b.x},0)/a.length}function Zd(a){var b=a.children;return b&&b.length?Zd(b[0]):a}function $d(a){var b,c=a.children;return c&&(b=c.length)?$d(c[b-1]):a}function _d(a){return{x:a.x,y:a.y,dx:a.dx,dy:a.dy}}function ae(a,b){var c=a.x+b[3],d=a.y+b[0],e=a.dx-b[1]-b[3],f=a.dy-b[0]-b[2];return 0>e&&(c+=e/2,e=0),0>f&&(d+=f/2,f=0),{x:c,y:d,dx:e,dy:f}}function be(a){var b=a[0],c=a[a.length-1];return c>b?[b,c]:[c,b]}function ce(a){return a.rangeExtent?a.rangeExtent():be(a.range())}function de(a,b,c,d){var e=c(a[0],a[1]),f=d(b[0],b[1]);return function(a){return f(e(a))}}function ee(a,b){var c,d=0,e=a.length-1,f=a[d],g=a[e];return f>g&&(c=d,d=e,e=c,c=f,f=g,g=c),a[d]=b.floor(f),a[e]=b.ceil(g),a}function fe(a){return a?{floor:function(b){return Math.floor(b/a)*a},ceil:function(b){return Math.ceil(b/a)*a}}:ki}function ge(a,b,c,d){var e=[],f=[],g=0,h=Math.min(a.length,b.length)-1;for(a[h]<a[0]&&(a=a.slice().reverse(),b=b.slice().reverse());++g<=h;)e.push(c(a[g-1],a[g])),f.push(d(b[g-1],b[g]));return function(b){var c=Wf.bisect(a,b,1,h)-1;return f[c](e[c](b))}}function he(a,b,c,d){function e(){var e=Math.min(a.length,b.length)>2?ge:de,i=d?ed:dd;return g=e(a,b,i,c),h=e(b,a,i,Hc),f}function f(a){return g(a)}var g,h;return f.invert=function(a){return h(a)},f.domain=function(b){return arguments.length?(a=b.map(Number),e()):a},f.range=function(a){return arguments.length?(b=a,e()):b},f.rangeRound=function(a){return f.range(a).interpolate(Zc)},f.clamp=function(a){return arguments.length?(d=a,e()):d},f.interpolate=function(a){return arguments.length?(c=a,e()):c},f.ticks=function(b){return le(a,b)},f.tickFormat=function(b,c){return me(a,b,c)},f.nice=function(b){return je(a,b),e()},f.copy=function(){return he(a,b,c,d)},e()}function ie(a,b){return Wf.rebind(a,b,"range","rangeRound","interpolate","clamp")}function je(a,b){return ee(a,fe(ke(a,b)[2]))}function ke(a,b){null==b&&(b=10);var c=be(a),d=c[1]-c[0],e=Math.pow(10,Math.floor(Math.log(d/b)/Math.LN10)),f=b/d*e;return.15>=f?e*=10:.35>=f?e*=5:.75>=f&&(e*=2),c[0]=Math.ceil(c[0]/e)*e,c[1]=Math.floor(c[1]/e)*e+.5*e,c[2]=e,c}function le(a,b){return Wf.range.apply(Wf,ke(a,b))}function me(a,b,c){var d=ke(a,b);return Wf.format(c?c.replace(fh,function(a,b,c,e,f,g,h,i,j,k){return[b,c,e,f,g,h,i,j||"."+oe(k,d),k].join("")}):",."+ne(d[2])+"f")}function ne(a){return-Math.floor(Math.log(a)/Math.LN10+.01)}function oe(a,b){var c=ne(b[2]);return a in li?Math.abs(c-ne(Math.max(Math.abs(b[0]),Math.abs(b[1]))))+ +("e"!==a):c-2*("%"===a)}function pe(a,b,c,d){function e(a){return(c?Math.log(0>a?0:a):-Math.log(a>0?0:-a))/Math.log(b)}function f(a){return c?Math.pow(b,a):-Math.pow(b,-a)}function g(b){return a(e(b))}return g.invert=function(b){return f(a.invert(b))},g.domain=function(b){return arguments.length?(c=b[0]>=0,a.domain((d=b.map(Number)).map(e)),g):d},g.base=function(c){return arguments.length?(b=+c,a.domain(d.map(e)),g):b},g.nice=function(){var b=ee(d.map(e),c?Math:ni);return a.domain(b),d=b.map(f),g},g.ticks=function(){var a=be(d),g=[],h=a[0],i=a[1],j=Math.floor(e(h)),k=Math.ceil(e(i)),l=b%1?2:b;if(isFinite(k-j)){if(c){for(;k>j;j++)for(var m=1;l>m;m++)g.push(f(j)*m);g.push(f(j))}else for(g.push(f(j));j++<k;)for(var m=l-1;m>0;m--)g.push(f(j)*m);for(j=0;g[j]<h;j++);for(k=g.length;g[k-1]>i;k--);g=g.slice(j,k)}return g},g.tickFormat=function(a,b){if(!arguments.length)return mi;arguments.length<2?b=mi:"function"!=typeof b&&(b=Wf.format(b));var d,h=Math.max(.1,a/g.ticks().length),i=c?(d=1e-12,Math.ceil):(d=-1e-12,Math.floor);return function(a){return a/f(i(e(a)+d))<=h?b(a):""}},g.copy=function(){return pe(a.copy(),b,c,d)},ie(g,a)}function qe(a,b,c){function d(b){return a(e(b))}var e=re(b),f=re(1/b);return d.invert=function(b){return f(a.invert(b))},d.domain=function(b){return arguments.length?(a.domain((c=b.map(Number)).map(e)),d):c},d.ticks=function(a){return le(c,a)},d.tickFormat=function(a,b){return me(c,a,b)},d.nice=function(a){return d.domain(je(c,a))},d.exponent=function(g){return arguments.length?(e=re(b=g),f=re(1/b),a.domain(c.map(e)),d):b},d.copy=function(){return qe(a.copy(),b,c)},ie(d,a)}function re(a){return function(b){return 0>b?-Math.pow(-b,a):Math.pow(b,a)}}function se(a,b){function c(c){return g[((f.get(c)||"range"===b.t&&f.set(c,a.push(c)))-1)%g.length]}function d(b,c){return Wf.range(a.length).map(function(a){return b+c*a})}var f,g,h;return c.domain=function(d){if(!arguments.length)return a;a=[],f=new e;for(var g,h=-1,i=d.length;++h<i;)f.has(g=d[h])||f.set(g,a.push(g));return c[b.t].apply(c,b.a)},c.range=function(a){return arguments.length?(g=a,h=0,b={t:"range",a:arguments},c):g},c.rangePoints=function(e,f){arguments.length<2&&(f=0);var i=e[0],j=e[1],k=(j-i)/(Math.max(1,a.length-1)+f);return g=d(a.length<2?(i+j)/2:i+k*f/2,k),h=0,b={t:"rangePoints",a:arguments},c},c.rangeBands=function(e,f,i){arguments.length<2&&(f=0),arguments.length<3&&(i=f);var j=e[1]<e[0],k=e[j-0],l=e[1-j],m=(l-k)/(a.length-f+2*i);return g=d(k+m*i,m),j&&g.reverse(),h=m*(1-f),b={t:"rangeBands",a:arguments},c},c.rangeRoundBands=function(e,f,i){arguments.length<2&&(f=0),arguments.length<3&&(i=f);var j=e[1]<e[0],k=e[j-0],l=e[1-j],m=Math.floor((l-k)/(a.length-f+2*i)),n=l-k-(a.length-f)*m;return g=d(k+Math.round(n/2),m),j&&g.reverse(),h=Math.round(m*(1-f)),b={t:"rangeRoundBands",a:arguments},c},c.rangeBand=function(){return h},c.rangeExtent=function(){return be(b.a[0])},c.copy=function(){return se(a,b)},c.domain(a)}function te(a,b){function c(){var c=0,f=b.length;for(e=[];++c<f;)e[c-1]=Wf.quantile(a,c/f);return d}function d(a){return isNaN(a=+a)?void 0:b[Wf.bisect(e,a)]}var e;return d.domain=function(b){return arguments.length?(a=b.filter(function(a){return!isNaN(a)}).sort(Wf.ascending),c()):a},d.range=function(a){return arguments.length?(b=a,c()):b},d.quantiles=function(){return e},d.invertExtent=function(c){return c=b.indexOf(c),0>c?[NaN,NaN]:[c>0?e[c-1]:a[0],c<e.length?e[c]:a[a.length-1]]},d.copy=function(){return te(a,b)},c()}function ue(a,b,c){function d(b){return c[Math.max(0,Math.min(g,Math.floor(f*(b-a))))]}function e(){return f=c.length/(b-a),g=c.length-1,d}var f,g;return d.domain=function(c){return arguments.length?(a=+c[0],b=+c[c.length-1],e()):[a,b]},d.range=function(a){return arguments.length?(c=a,e()):c},d.invertExtent=function(b){return b=c.indexOf(b),b=0>b?NaN:b/f+a,[b,b+1/f]},d.copy=function(){return ue(a,b,c)},e()}function ve(a,b){function c(c){return c>=c?b[Wf.bisect(a,c)]:void 0}return c.domain=function(b){return arguments.length?(a=b,c):a},c.range=function(a){return arguments.length?(b=a,c):b},c.invertExtent=function(c){return c=b.indexOf(c),[a[c-1],a[c]]},c.copy=function(){return ve(a,b)},c}function we(a){function b(a){return+a}return b.invert=b,b.domain=b.range=function(c){return arguments.length?(a=c.map(b),b):a},b.ticks=function(b){return le(a,b)},b.tickFormat=function(b,c){return me(a,b,c)},b.copy=function(){return we(a)},b}function xe(a){return a.innerRadius}function ye(a){return a.outerRadius}function ze(a){return a.startAngle}function Ae(a){return a.endAngle}function Be(a){function b(b){function g(){j.push("M",f(a(k),h))}for(var i,j=[],k=[],l=-1,m=b.length,n=pa(c),o=pa(d);++l<m;)e.call(this,i=b[l],l)?k.push([+n.call(this,i,l),+o.call(this,i,l)]):k.length&&(g(),k=[]);return k.length&&g(),j.length?j.join(""):null}var c=Tb,d=Ub,e=Ta,f=Ce,g=f.key,h=.7;return b.x=function(a){return arguments.length?(c=a,b):c},b.y=function(a){return arguments.length?(d=a,b):d},b.defined=function(a){return arguments.length?(e=a,b):e},b.interpolate=function(a){return arguments.length?(g="function"==typeof a?f=a:(f=ui.get(a)||Ce).key,b):g},b.tension=function(a){return arguments.length?(h=a,b):h},b}function Ce(a){return a.join("L")}function De(a){return Ce(a)+"Z"}function Ee(a){for(var b=0,c=a.length,d=a[0],e=[d[0],",",d[1]];++b<c;)e.push("H",(d[0]+(d=a[b])[0])/2,"V",d[1]);return c>1&&e.push("H",d[0]),e.join("")}function Fe(a){for(var b=0,c=a.length,d=a[0],e=[d[0],",",d[1]];++b<c;)e.push("V",(d=a[b])[1],"H",d[0]);return e.join("")}function Ge(a){for(var b=0,c=a.length,d=a[0],e=[d[0],",",d[1]];++b<c;)e.push("H",(d=a[b])[0],"V",d[1]);return e.join("")}function He(a,b){return a.length<4?Ce(a):a[1]+Ke(a.slice(1,a.length-1),Le(a,b))}function Ie(a,b){return a.length<3?Ce(a):a[0]+Ke((a.push(a[0]),a),Le([a[a.length-2]].concat(a,[a[1]]),b))}function Je(a,b){return a.length<3?Ce(a):a[0]+Ke(a,Le(a,b))}function Ke(a,b){if(b.length<1||a.length!=b.length&&a.length!=b.length+2)return Ce(a);var c=a.length!=b.length,d="",e=a[0],f=a[1],g=b[0],h=g,i=1;if(c&&(d+="Q"+(f[0]-2*g[0]/3)+","+(f[1]-2*g[1]/3)+","+f[0]+","+f[1],e=a[1],i=2),b.length>1){h=b[1],f=a[i],i++,d+="C"+(e[0]+g[0])+","+(e[1]+g[1])+","+(f[0]-h[0])+","+(f[1]-h[1])+","+f[0]+","+f[1];for(var j=2;j<b.length;j++,i++)f=a[i],h=b[j],d+="S"+(f[0]-h[0])+","+(f[1]-h[1])+","+f[0]+","+f[1]}if(c){var k=a[i];d+="Q"+(f[0]+2*h[0]/3)+","+(f[1]+2*h[1]/3)+","+k[0]+","+k[1]}return d}function Le(a,b){for(var c,d=[],e=(1-b)/2,f=a[0],g=a[1],h=1,i=a.length;++h<i;)c=f,f=g,g=a[h],d.push([e*(g[0]-c[0]),e*(g[1]-c[1])]);return d}function Me(a){if(a.length<3)return Ce(a);var b=1,c=a.length,d=a[0],e=d[0],f=d[1],g=[e,e,e,(d=a[1])[0]],h=[f,f,f,d[1]],i=[e,",",f,"L",Qe(xi,g),",",Qe(xi,h)];for(a.push(a[c-1]);++b<=c;)d=a[b],g.shift(),g.push(d[0]),h.shift(),h.push(d[1]),Re(i,g,h);return a.pop(),i.push("L",d),i.join("")}function Ne(a){if(a.length<4)return Ce(a);for(var b,c=[],d=-1,e=a.length,f=[0],g=[0];++d<3;)b=a[d],f.push(b[0]),g.push(b[1]);for(c.push(Qe(xi,f)+","+Qe(xi,g)),--d;++d<e;)b=a[d],f.shift(),f.push(b[0]),g.shift(),g.push(b[1]),Re(c,f,g);return c.join("")}function Oe(a){for(var b,c,d=-1,e=a.length,f=e+4,g=[],h=[];++d<4;)c=a[d%e],g.push(c[0]),h.push(c[1]);for(b=[Qe(xi,g),",",Qe(xi,h)],--d;++d<f;)c=a[d%e],g.shift(),g.push(c[0]),h.shift(),h.push(c[1]),Re(b,g,h);return b.join("")}function Pe(a,b){var c=a.length-1;if(c)for(var d,e,f=a[0][0],g=a[0][1],h=a[c][0]-f,i=a[c][1]-g,j=-1;++j<=c;)d=a[j],e=j/c,d[0]=b*d[0]+(1-b)*(f+e*h),d[1]=b*d[1]+(1-b)*(g+e*i);return Me(a)}function Qe(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3]}function Re(a,b,c){a.push("C",Qe(vi,b),",",Qe(vi,c),",",Qe(wi,b),",",Qe(wi,c),",",Qe(xi,b),",",Qe(xi,c))}function Se(a,b){return(b[1]-a[1])/(b[0]-a[0])}function Te(a){for(var b=0,c=a.length-1,d=[],e=a[0],f=a[1],g=d[0]=Se(e,f);++b<c;)d[b]=(g+(g=Se(e=f,f=a[b+1])))/2;return d[b]=g,d}function Ue(a){for(var b,c,d,e,f=[],g=Te(a),h=-1,i=a.length-1;++h<i;)b=Se(a[h],a[h+1]),ig(b)<Dg?g[h]=g[h+1]=0:(c=g[h]/b,d=g[h+1]/b,e=c*c+d*d,e>9&&(e=3*b/Math.sqrt(e),g[h]=e*c,g[h+1]=e*d));for(h=-1;++h<=i;)e=(a[Math.min(i,h+1)][0]-a[Math.max(0,h-1)][0])/(6*(1+g[h]*g[h])),f.push([e||0,g[h]*e||0]);return f}function Ve(a){return a.length<3?Ce(a):a[0]+Ke(a,Ue(a))}function We(a){for(var b,c,d,e=-1,f=a.length;++e<f;)b=a[e],c=b[0],d=b[1]+si,b[0]=c*Math.cos(d),b[1]=c*Math.sin(d);return a}function Xe(a){function b(b){function i(){p.push("M",h(a(r),l),k,j(a(q.reverse()),l),"Z")}for(var m,n,o,p=[],q=[],r=[],s=-1,t=b.length,u=pa(c),v=pa(e),w=c===d?function(){return n}:pa(d),x=e===f?function(){return o}:pa(f);++s<t;)g.call(this,m=b[s],s)?(q.push([n=+u.call(this,m,s),o=+v.call(this,m,s)]),r.push([+w.call(this,m,s),+x.call(this,m,s)])):q.length&&(i(),q=[],r=[]);return q.length&&i(),p.length?p.join(""):null}var c=Tb,d=Tb,e=0,f=Ub,g=Ta,h=Ce,i=h.key,j=h,k="L",l=.7;return b.x=function(a){return arguments.length?(c=d=a,b):d},b.x0=function(a){return arguments.length?(c=a,b):c},b.x1=function(a){return arguments.length?(d=a,b):d},b.y=function(a){return arguments.length?(e=f=a,b):f},b.y0=function(a){return arguments.length?(e=a,b):e},b.y1=function(a){return arguments.length?(f=a,b):f},b.defined=function(a){return arguments.length?(g=a,b):g},b.interpolate=function(a){return arguments.length?(i="function"==typeof a?h=a:(h=ui.get(a)||Ce).key,j=h.reverse||h,k=h.closed?"M":"L",b):i},b.tension=function(a){return arguments.length?(l=a,b):l},b}function Ye(a){return a.radius}function Ze(a){return[a.x,a.y]}function $e(a){return function(){var b=a.apply(this,arguments),c=b[0],d=b[1]+si;return[c*Math.cos(d),c*Math.sin(d)]}}function _e(){return 64}function af(){return"circle"}function bf(a){var b=Math.sqrt(a/Ag);return"M0,"+b+"A"+b+","+b+" 0 1,1 0,"+-b+"A"+b+","+b+" 0 1,1 0,"+b+"Z"}function cf(a,b){return ng(a,Di),a.id=b,a}function df(a,b,c,d){var e=a.id;return D(a,"function"==typeof c?function(a,f,g){a.__transition__[e].tween.set(b,d(c.call(a,a.__data__,f,g)))}:(c=d(c),function(a){a.__transition__[e].tween.set(b,c)}))}function ef(a){return null==a&&(a=""),function(){this.textContent=a}}function ff(a,b,c,d){var f=a.__transition__||(a.__transition__={active:0,count:0}),g=f[c];if(!g){var h=d.time;g=f[c]={tween:new e,time:h,ease:d.ease,delay:d.delay,duration:d.duration},++f.count,Wf.timer(function(d){function e(d){return f.active>c?j():(f.active=c,g.event&&g.event.start.call(a,k,b),g.tween.forEach(function(c,d){(d=d.call(a,k,b))&&p.push(d)}),void Wf.timer(function(){return o.c=i(d||1)?Ta:i,1},0,h))}function i(d){if(f.active!==c)return j();for(var e=d/n,h=l(e),i=p.length;i>0;)p[--i].call(a,h);return e>=1?(g.event&&g.event.end.call(a,k,b),j()):void 0}function j(){return--f.count?delete f[c]:delete a.__transition__,1}var k=a.__data__,l=g.ease,m=g.delay,n=g.duration,o=$g,p=[];return o.t=m+h,d>=m?e(d-m):void(o.c=e)},0,h)}}function gf(a,b){a.attr("transform",function(a){return"translate("+b(a)+",0)"})}function hf(a,b){a.attr("transform",function(a){return"translate(0,"+b(a)+")"})}function jf(){this._=new Date(arguments.length>1?Date.UTC.apply(this,arguments):arguments[0])}function kf(a,b,c){function d(b){var c=a(b),d=f(c,1);return d-b>b-c?c:d}function e(c){return b(c=a(new Ki(c-1)),1),c}function f(a,c){return b(a=new Ki(+a),c),a}function g(a,d,f){var g=e(a),h=[];if(f>1)for(;d>g;)c(g)%f||h.push(new Date(+g)),b(g,1);else for(;d>g;)h.push(new Date(+g)),b(g,1);return h}function h(a,b,c){try{Ki=jf;var d=new jf;return d._=a,g(d,b,c)}finally{Ki=Date}}a.floor=a,a.round=d,a.ceil=e,a.offset=f,a.range=g;var i=a.utc=lf(a);return i.floor=i,i.round=lf(d),i.ceil=lf(e),i.offset=lf(f),i.range=h,a}function lf(a){return function(b,c){try{Ki=jf;var d=new jf;return d._=b,a(d,c)._}finally{Ki=Date}}}function mf(a){function b(b){for(var d,e,f,g=[],h=-1,i=0;++h<c;)37===a.charCodeAt(h)&&(g.push(a.substring(i,h)),null!=(e=bj[d=a.charAt(++h)])&&(d=a.charAt(++h)),(f=cj[d])&&(d=f(b,null==e?"e"===d?" ":"0":e)),g.push(d),i=h+1);return g.push(a.substring(i,h)),g.join("")}var c=a.length;return b.parse=function(b){var c={y:1900,m:0,d:1,H:0,M:0,S:0,L:0,Z:null},d=nf(c,a,b,0);if(d!=b.length)return null;"p"in c&&(c.H=c.H%12+12*c.p);var e=null!=c.Z&&Ki!==jf,f=new(e?jf:Ki);return"j"in c?f.setFullYear(c.y,0,c.j):"w"in c&&("W"in c||"U"in c)?(f.setFullYear(c.y,0,1),f.setFullYear(c.y,0,"W"in c?(c.w+6)%7+7*c.W-(f.getDay()+5)%7:c.w+7*c.U-(f.getDay()+6)%7)):f.setFullYear(c.y,c.m,c.d),f.setHours(c.H+Math.floor(c.Z/100),c.M+c.Z%100,c.S,c.L),e?f._:f},b.toString=function(){return a},b}function nf(a,b,c,d){for(var e,f,g,h=0,i=b.length,j=c.length;i>h;){if(d>=j)return-1;if(e=b.charCodeAt(h++),37===e){if(g=b.charAt(h++),f=dj[g in bj?b.charAt(h++):g],!f||(d=f(a,c,d))<0)return-1}else if(e!=c.charCodeAt(d++))return-1}return d}function of(a){return new RegExp("^(?:"+a.map(Wf.requote).join("|")+")","i")}function pf(a){for(var b=new e,c=-1,d=a.length;++c<d;)b.set(a[c].toLowerCase(),c);return b}function qf(a,b,c){var d=0>a?"-":"",e=(d?-a:a)+"",f=e.length;return d+(c>f?new Array(c-f+1).join(b)+e:e)}function rf(a,b,c){Wi.lastIndex=0;var d=Wi.exec(b.substring(c));return d?(a.w=Xi.get(d[0].toLowerCase()),c+d[0].length):-1}function sf(a,b,c){Ui.lastIndex=0;var d=Ui.exec(b.substring(c));return d?(a.w=Vi.get(d[0].toLowerCase()),c+d[0].length):-1}function tf(a,b,c){ej.lastIndex=0;var d=ej.exec(b.substring(c,c+1));return d?(a.w=+d[0],c+d[0].length):-1}function uf(a,b,c){ej.lastIndex=0;var d=ej.exec(b.substring(c));return d?(a.U=+d[0],c+d[0].length):-1}function vf(a,b,c){ej.lastIndex=0;var d=ej.exec(b.substring(c));return d?(a.W=+d[0],c+d[0].length):-1}function wf(a,b,c){$i.lastIndex=0;var d=$i.exec(b.substring(c));return d?(a.m=_i.get(d[0].toLowerCase()),c+d[0].length):-1}function xf(a,b,c){Yi.lastIndex=0;var d=Yi.exec(b.substring(c));return d?(a.m=Zi.get(d[0].toLowerCase()),c+d[0].length):-1}function yf(a,b,c){return nf(a,cj.c.toString(),b,c)}function zf(a,b,c){return nf(a,cj.x.toString(),b,c)}function Af(a,b,c){return nf(a,cj.X.toString(),b,c)}function Bf(a,b,c){ej.lastIndex=0;var d=ej.exec(b.substring(c,c+4));return d?(a.y=+d[0],c+d[0].length):-1}function Cf(a,b,c){ej.lastIndex=0;var d=ej.exec(b.substring(c,c+2));return d?(a.y=Ef(+d[0]),c+d[0].length):-1}function Df(a,b,c){return/^[+-]\d{4}$/.test(b=b.substring(c,c+5))?(a.Z=+b,c+5):-1}function Ef(a){return a+(a>68?1900:2e3)}function Ff(a,b,c){ej.lastIndex=0;var d=ej.exec(b.substring(c,c+2));return d?(a.m=d[0]-1,c+d[0].length):-1}function Gf(a,b,c){ej.lastIndex=0;var d=ej.exec(b.substring(c,c+2));return d?(a.d=+d[0],c+d[0].length):-1}function Hf(a,b,c){ej.lastIndex=0;var d=ej.exec(b.substring(c,c+3));return d?(a.j=+d[0],c+d[0].length):-1}function If(a,b,c){ej.lastIndex=0;var d=ej.exec(b.substring(c,c+2));return d?(a.H=+d[0],c+d[0].length):-1}function Jf(a,b,c){ej.lastIndex=0;var d=ej.exec(b.substring(c,c+2));return d?(a.M=+d[0],c+d[0].length):-1}function Kf(a,b,c){ej.lastIndex=0;var d=ej.exec(b.substring(c,c+2));return d?(a.S=+d[0],c+d[0].length):-1}function Lf(a,b,c){ej.lastIndex=0;var d=ej.exec(b.substring(c,c+3));return d?(a.L=+d[0],c+d[0].length):-1}function Mf(a,b,c){var d=fj.get(b.substring(c,c+=2).toLowerCase());return null==d?-1:(a.p=d,c)}function Nf(a){var b=a.getTimezoneOffset(),c=b>0?"-":"+",d=~~(ig(b)/60),e=ig(b)%60;return c+qf(d,"0",2)+qf(e,"0",2)}function Of(a,b,c){aj.lastIndex=0;var d=aj.exec(b.substring(c,c+1));return d?c+d[0].length:-1}function Pf(a){function b(a){try{Ki=jf;var b=new Ki;return b._=a,c(b)}finally{Ki=Date}}var c=mf(a);return b.parse=function(a){try{Ki=jf;var b=c.parse(a);return b&&b._}finally{Ki=Date}},b.toString=c.toString,b}function Qf(a){return a.toISOString()}function Rf(a,b,c){function d(b){return a(b)}function e(a,c){var d=a[1]-a[0],e=d/c,f=Wf.bisect(hj,e);return f==hj.length?[b.year,ke(a.map(function(a){return a/31536e6}),c)[2]]:f?b[e/hj[f-1]<hj[f]/e?f-1:f]:[lj,ke(a,c)[2]]}return d.invert=function(b){return Sf(a.invert(b))},d.domain=function(b){return arguments.length?(a.domain(b),d):a.domain().map(Sf)},d.nice=function(a,b){function c(c){return!isNaN(c)&&!a.range(c,Sf(+c+1),b).length}var f=d.domain(),g=be(f),h=null==a?e(g,10):"number"==typeof a&&e(g,a);return h&&(a=h[0],b=h[1]),d.domain(ee(f,b>1?{floor:function(b){for(;c(b=a.floor(b));)b=Sf(b-1);return b},ceil:function(b){for(;c(b=a.ceil(b));)b=Sf(+b+1);return b}}:a))},d.ticks=function(a,b){var c=be(d.domain()),f=null==a?e(c,10):"number"==typeof a?e(c,a):!a.range&&[{range:a},b];return f&&(a=f[0],b=f[1]),a.range(c[0],Sf(+c[1]+1),1>b?1:b)},d.tickFormat=function(){return c},d.copy=function(){return Rf(a.copy(),b,c)},ie(d,a)}function Sf(a){return new Date(a)}function Tf(a){return function(b){for(var c=a.length-1,d=a[c];!d[1](b);)d=a[--c];return d[0](b)}}function Uf(a){return JSON.parse(a.responseText)}function Vf(a){var b=Zf.createRange();return b.selectNode(Zf.body),b.createContextualFragment(a.responseText)}var Wf={version:"3.3.13"};Date.now||(Date.now=function(){return+new Date});var Xf=[].slice,Yf=function(a){return Xf.call(a)},Zf=document,$f=Zf.documentElement,_f=window;try{Yf($f.childNodes)[0].nodeType}catch(ag){Yf=function(a){for(var b=a.length,c=new Array(b);b--;)c[b]=a[b];return c}}try{Zf.createElement("div").style.setProperty("opacity",0,"")}catch(bg){var cg=_f.Element.prototype,dg=cg.setAttribute,eg=cg.setAttributeNS,fg=_f.CSSStyleDeclaration.prototype,gg=fg.setProperty;cg.setAttribute=function(a,b){dg.call(this,a,b+"")},cg.setAttributeNS=function(a,b,c){eg.call(this,a,b,c+"")},fg.setProperty=function(a,b,c){gg.call(this,a,b+"",c)}}Wf.ascending=function(a,b){return b>a?-1:a>b?1:a>=b?0:NaN},Wf.descending=function(a,b){return a>b?-1:b>a?1:b>=a?0:NaN},Wf.min=function(a,b){var c,d,e=-1,f=a.length;if(1===arguments.length){for(;++e<f&&!(null!=(c=a[e])&&c>=c);)c=void 0;for(;++e<f;)null!=(d=a[e])&&c>d&&(c=d)}else{for(;++e<f&&!(null!=(c=b.call(a,a[e],e))&&c>=c);)c=void 0;for(;++e<f;)null!=(d=b.call(a,a[e],e))&&c>d&&(c=d)}return c},Wf.max=function(a,b){var c,d,e=-1,f=a.length;if(1===arguments.length){for(;++e<f&&!(null!=(c=a[e])&&c>=c);)c=void 0;for(;++e<f;)null!=(d=a[e])&&d>c&&(c=d)}else{for(;++e<f&&!(null!=(c=b.call(a,a[e],e))&&c>=c);)c=void 0;for(;++e<f;)null!=(d=b.call(a,a[e],e))&&d>c&&(c=d)}return c},Wf.extent=function(a,b){var c,d,e,f=-1,g=a.length;if(1===arguments.length){for(;++f<g&&!(null!=(c=e=a[f])&&c>=c);)c=e=void 0;for(;++f<g;)null!=(d=a[f])&&(c>d&&(c=d),d>e&&(e=d))}else{for(;++f<g&&!(null!=(c=e=b.call(a,a[f],f))&&c>=c);)c=void 0;for(;++f<g;)null!=(d=b.call(a,a[f],f))&&(c>d&&(c=d),d>e&&(e=d))}return[c,e]},Wf.sum=function(a,b){var c,d=0,e=a.length,f=-1;if(1===arguments.length)for(;++f<e;)isNaN(c=+a[f])||(d+=c);else for(;++f<e;)isNaN(c=+b.call(a,a[f],f))||(d+=c);return d},Wf.mean=function(b,c){var d,e=b.length,f=0,g=-1,h=0;if(1===arguments.length)for(;++g<e;)a(d=b[g])&&(f+=(d-f)/++h);else for(;++g<e;)a(d=c.call(b,b[g],g))&&(f+=(d-f)/++h);return h?f:void 0},
Wf.quantile=function(a,b){var c=(a.length-1)*b+1,d=Math.floor(c),e=+a[d-1],f=c-d;return f?e+f*(a[d]-e):e},Wf.median=function(b,c){return arguments.length>1&&(b=b.map(c)),b=b.filter(a),b.length?Wf.quantile(b.sort(Wf.ascending),.5):void 0},Wf.bisector=function(a){return{left:function(b,c,d,e){for(arguments.length<3&&(d=0),arguments.length<4&&(e=b.length);e>d;){var f=d+e>>>1;a.call(b,b[f],f)<c?d=f+1:e=f}return d},right:function(b,c,d,e){for(arguments.length<3&&(d=0),arguments.length<4&&(e=b.length);e>d;){var f=d+e>>>1;c<a.call(b,b[f],f)?e=f:d=f+1}return d}}};var hg=Wf.bisector(function(a){return a});Wf.bisectLeft=hg.left,Wf.bisect=Wf.bisectRight=hg.right,Wf.shuffle=function(a){for(var b,c,d=a.length;d;)c=Math.random()*d--|0,b=a[d],a[d]=a[c],a[c]=b;return a},Wf.permute=function(a,b){for(var c=b.length,d=new Array(c);c--;)d[c]=a[b[c]];return d},Wf.pairs=function(a){for(var b,c=0,d=a.length-1,e=a[0],f=new Array(0>d?0:d);d>c;)f[c]=[b=e,e=a[++c]];return f},Wf.zip=function(){if(!(e=arguments.length))return[];for(var a=-1,c=Wf.min(arguments,b),d=new Array(c);++a<c;)for(var e,f=-1,g=d[a]=new Array(e);++f<e;)g[f]=arguments[f][a];return d},Wf.transpose=function(a){return Wf.zip.apply(Wf,a)},Wf.keys=function(a){var b=[];for(var c in a)b.push(c);return b},Wf.values=function(a){var b=[];for(var c in a)b.push(a[c]);return b},Wf.entries=function(a){var b=[];for(var c in a)b.push({key:c,value:a[c]});return b},Wf.merge=function(a){for(var b,c,d,e=a.length,f=-1,g=0;++f<e;)g+=a[f].length;for(c=new Array(g);--e>=0;)for(d=a[e],b=d.length;--b>=0;)c[--g]=d[b];return c};var ig=Math.abs;Wf.range=function(a,b,d){if(arguments.length<3&&(d=1,arguments.length<2&&(b=a,a=0)),(b-a)/d===1/0)throw new Error("infinite range");var e,f=[],g=c(ig(d)),h=-1;if(a*=g,b*=g,d*=g,0>d)for(;(e=a+d*++h)>b;)f.push(e/g);else for(;(e=a+d*++h)<b;)f.push(e/g);return f},Wf.map=function(a){var b=new e;if(a instanceof e)a.forEach(function(a,c){b.set(a,c)});else for(var c in a)b.set(c,a[c]);return b},d(e,{has:function(a){return jg+a in this},get:function(a){return this[jg+a]},set:function(a,b){return this[jg+a]=b},remove:function(a){return a=jg+a,a in this&&delete this[a]},keys:function(){var a=[];return this.forEach(function(b){a.push(b)}),a},values:function(){var a=[];return this.forEach(function(b,c){a.push(c)}),a},entries:function(){var a=[];return this.forEach(function(b,c){a.push({key:b,value:c})}),a},forEach:function(a){for(var b in this)b.charCodeAt(0)===kg&&a.call(this,b.substring(1),this[b])}});var jg="\x00",kg=jg.charCodeAt(0);Wf.nest=function(){function a(b,h,i){if(i>=g.length)return d?d.call(f,h):c?h.sort(c):h;for(var j,k,l,m,n=-1,o=h.length,p=g[i++],q=new e;++n<o;)(m=q.get(j=p(k=h[n])))?m.push(k):q.set(j,[k]);return b?(k=b(),l=function(c,d){k.set(c,a(b,d,i))}):(k={},l=function(c,d){k[c]=a(b,d,i)}),q.forEach(l),k}function b(a,c){if(c>=g.length)return a;var d=[],e=h[c++];return a.forEach(function(a,e){d.push({key:a,values:b(e,c)})}),e?d.sort(function(a,b){return e(a.key,b.key)}):d}var c,d,f={},g=[],h=[];return f.map=function(b,c){return a(c,b,0)},f.entries=function(c){return b(a(Wf.map,c,0),0)},f.key=function(a){return g.push(a),f},f.sortKeys=function(a){return h[g.length-1]=a,f},f.sortValues=function(a){return c=a,f},f.rollup=function(a){return d=a,f},f},Wf.set=function(a){var b=new f;if(a)for(var c=0,d=a.length;d>c;++c)b.add(a[c]);return b},d(f,{has:function(a){return jg+a in this},add:function(a){return this[jg+a]=!0,a},remove:function(a){return a=jg+a,a in this&&delete this[a]},values:function(){var a=[];return this.forEach(function(b){a.push(b)}),a},forEach:function(a){for(var b in this)b.charCodeAt(0)===kg&&a.call(this,b.substring(1))}}),Wf.behavior={},Wf.rebind=function(a,b){for(var c,d=1,e=arguments.length;++d<e;)a[c=arguments[d]]=g(a,b,b[c]);return a};var lg=["webkit","ms","moz","Moz","o","O"];Wf.dispatch=function(){for(var a=new j,b=-1,c=arguments.length;++b<c;)a[arguments[b]]=k(a);return a},j.prototype.on=function(a,b){var c=a.indexOf("."),d="";if(c>=0&&(d=a.substring(c+1),a=a.substring(0,c)),a)return arguments.length<2?this[a].on(d):this[a].on(d,b);if(2===arguments.length){if(null==b)for(a in this)this.hasOwnProperty(a)&&this[a].on(d,null);return this}},Wf.event=null,Wf.requote=function(a){return a.replace(mg,"\\$&")};var mg=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g,ng={}.__proto__?function(a,b){a.__proto__=b}:function(a,b){for(var c in b)a[c]=b[c]},og=function(a,b){return b.querySelector(a)},pg=function(a,b){return b.querySelectorAll(a)},qg=$f[h($f,"matchesSelector")],rg=function(a,b){return qg.call(a,b)};"function"==typeof Sizzle&&(og=function(a,b){return Sizzle(a,b)[0]||null},pg=function(a,b){return Sizzle.uniqueSort(Sizzle(a,b))},rg=Sizzle.matchesSelector),Wf.selection=function(){return vg};var sg=Wf.selection.prototype=[];sg.select=function(a){var b,c,d,e,f=[];a=p(a);for(var g=-1,h=this.length;++g<h;){f.push(b=[]),b.parentNode=(d=this[g]).parentNode;for(var i=-1,j=d.length;++i<j;)(e=d[i])?(b.push(c=a.call(e,e.__data__,i,g)),c&&"__data__"in e&&(c.__data__=e.__data__)):b.push(null)}return o(f)},sg.selectAll=function(a){var b,c,d=[];a=q(a);for(var e=-1,f=this.length;++e<f;)for(var g=this[e],h=-1,i=g.length;++h<i;)(c=g[h])&&(d.push(b=Yf(a.call(c,c.__data__,h,e))),b.parentNode=c);return o(d)};var tg={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};Wf.ns={prefix:tg,qualify:function(a){var b=a.indexOf(":"),c=a;return b>=0&&(c=a.substring(0,b),a=a.substring(b+1)),tg.hasOwnProperty(c)?{space:tg[c],local:a}:a}},sg.attr=function(a,b){if(arguments.length<2){if("string"==typeof a){var c=this.node();return a=Wf.ns.qualify(a),a.local?c.getAttributeNS(a.space,a.local):c.getAttribute(a)}for(b in a)this.each(r(b,a[b]));return this}return this.each(r(a,b))},sg.classed=function(a,b){if(arguments.length<2){if("string"==typeof a){var c=this.node(),d=(a=u(a)).length,e=-1;if(b=c.classList){for(;++e<d;)if(!b.contains(a[e]))return!1}else for(b=c.getAttribute("class");++e<d;)if(!t(a[e]).test(b))return!1;return!0}for(b in a)this.each(v(b,a[b]));return this}return this.each(v(a,b))},sg.style=function(a,b,c){var d=arguments.length;if(3>d){if("string"!=typeof a){2>d&&(b="");for(c in a)this.each(x(c,a[c],b));return this}if(2>d)return _f.getComputedStyle(this.node(),null).getPropertyValue(a);c=""}return this.each(x(a,b,c))},sg.property=function(a,b){if(arguments.length<2){if("string"==typeof a)return this.node()[a];for(b in a)this.each(y(b,a[b]));return this}return this.each(y(a,b))},sg.text=function(a){return arguments.length?this.each("function"==typeof a?function(){var b=a.apply(this,arguments);this.textContent=null==b?"":b}:null==a?function(){this.textContent=""}:function(){this.textContent=a}):this.node().textContent},sg.html=function(a){return arguments.length?this.each("function"==typeof a?function(){var b=a.apply(this,arguments);this.innerHTML=null==b?"":b}:null==a?function(){this.innerHTML=""}:function(){this.innerHTML=a}):this.node().innerHTML},sg.append=function(a){return a=z(a),this.select(function(){return this.appendChild(a.apply(this,arguments))})},sg.insert=function(a,b){return a=z(a),b=p(b),this.select(function(){return this.insertBefore(a.apply(this,arguments),b.apply(this,arguments)||null)})},sg.remove=function(){return this.each(function(){var a=this.parentNode;a&&a.removeChild(this)})},sg.data=function(a,b){function c(a,c){var d,f,g,h=a.length,l=c.length,m=Math.min(h,l),n=new Array(l),o=new Array(l),p=new Array(h);if(b){var q,r=new e,s=new e,t=[];for(d=-1;++d<h;)q=b.call(f=a[d],f.__data__,d),r.has(q)?p[d]=f:r.set(q,f),t.push(q);for(d=-1;++d<l;)q=b.call(c,g=c[d],d),(f=r.get(q))?(n[d]=f,f.__data__=g):s.has(q)||(o[d]=A(g)),s.set(q,g),r.remove(q);for(d=-1;++d<h;)r.has(t[d])&&(p[d]=a[d])}else{for(d=-1;++d<m;)f=a[d],g=c[d],f?(f.__data__=g,n[d]=f):o[d]=A(g);for(;l>d;++d)o[d]=A(c[d]);for(;h>d;++d)p[d]=a[d]}o.update=n,o.parentNode=n.parentNode=p.parentNode=a.parentNode,i.push(o),j.push(n),k.push(p)}var d,f,g=-1,h=this.length;if(!arguments.length){for(a=new Array(h=(d=this[0]).length);++g<h;)(f=d[g])&&(a[g]=f.__data__);return a}var i=E([]),j=o([]),k=o([]);if("function"==typeof a)for(;++g<h;)c(d=this[g],a.call(d,d.parentNode.__data__,g));else for(;++g<h;)c(d=this[g],a);return j.enter=function(){return i},j.exit=function(){return k},j},sg.datum=function(a){return arguments.length?this.property("__data__",a):this.property("__data__")},sg.filter=function(a){var b,c,d,e=[];"function"!=typeof a&&(a=B(a));for(var f=0,g=this.length;g>f;f++){e.push(b=[]),b.parentNode=(c=this[f]).parentNode;for(var h=0,i=c.length;i>h;h++)(d=c[h])&&a.call(d,d.__data__,h,f)&&b.push(d)}return o(e)},sg.order=function(){for(var a=-1,b=this.length;++a<b;)for(var c,d=this[a],e=d.length-1,f=d[e];--e>=0;)(c=d[e])&&(f&&f!==c.nextSibling&&f.parentNode.insertBefore(c,f),f=c);return this},sg.sort=function(a){a=C.apply(this,arguments);for(var b=-1,c=this.length;++b<c;)this[b].sort(a);return this.order()},sg.each=function(a){return D(this,function(b,c,d){a.call(b,b.__data__,c,d)})},sg.call=function(a){var b=Yf(arguments);return a.apply(b[0]=this,b),this},sg.empty=function(){return!this.node()},sg.node=function(){for(var a=0,b=this.length;b>a;a++)for(var c=this[a],d=0,e=c.length;e>d;d++){var f=c[d];if(f)return f}return null},sg.size=function(){var a=0;return this.each(function(){++a}),a};var ug=[];Wf.selection.enter=E,Wf.selection.enter.prototype=ug,ug.append=sg.append,ug.empty=sg.empty,ug.node=sg.node,ug.call=sg.call,ug.size=sg.size,ug.select=function(a){for(var b,c,d,e,f,g=[],h=-1,i=this.length;++h<i;){d=(e=this[h]).update,g.push(b=[]),b.parentNode=e.parentNode;for(var j=-1,k=e.length;++j<k;)(f=e[j])?(b.push(d[j]=c=a.call(e.parentNode,f.__data__,j,h)),c.__data__=f.__data__):b.push(null)}return o(g)},ug.insert=function(a,b){return arguments.length<2&&(b=F(this)),sg.insert.call(this,a,b)},sg.transition=function(){for(var a,b,c=zi||++Ei,d=[],e=Ai||{time:Date.now(),ease:Oc,delay:0,duration:250},f=-1,g=this.length;++f<g;){d.push(a=[]);for(var h=this[f],i=-1,j=h.length;++i<j;)(b=h[i])&&ff(b,i,c,e),a.push(b)}return cf(d,c)},sg.interrupt=function(){return this.each(G)},Wf.select=function(a){var b=["string"==typeof a?og(a,Zf):a];return b.parentNode=$f,o([b])},Wf.selectAll=function(a){var b=Yf("string"==typeof a?pg(a,Zf):a);return b.parentNode=$f,o([b])};var vg=Wf.select($f);sg.on=function(a,b,c){var d=arguments.length;if(3>d){if("string"!=typeof a){2>d&&(b=!1);for(c in a)this.each(H(c,a[c],b));return this}if(2>d)return(d=this.node()["__on"+a])&&d._;c=!1}return this.each(H(a,b,c))};var wg=Wf.map({mouseenter:"mouseover",mouseleave:"mouseout"});wg.forEach(function(a){"on"+a in Zf&&wg.remove(a)});var xg="onselectstart"in Zf?null:h($f.style,"userSelect"),yg=0;Wf.mouse=function(a){return L(a,m())};var zg=/WebKit/.test(_f.navigator.userAgent)?-1:0;Wf.touches=function(a,b){return arguments.length<2&&(b=m().touches),b?Yf(b).map(function(b){var c=L(a,b);return c.identifier=b.identifier,c}):[]},Wf.behavior.drag=function(){function a(){this.on("mousedown.drag",g).on("touchstart.drag",h)}function b(){return Wf.event.changedTouches[0].identifier}function c(a,b){return Wf.touches(a).filter(function(a){return a.identifier===b})[0]}function d(a,b,c,d){return function(){function g(){var a=b(k,n),c=a[0]-p[0],d=a[1]-p[1];q|=c|d,p=a,l({type:"drag",x:a[0]+i[0],y:a[1]+i[1],dx:c,dy:d})}function h(){r.on(c+"."+o,null).on(d+"."+o,null),s(q&&Wf.event.target===m),l({type:"dragend"})}var i,j=this,k=j.parentNode,l=e.of(j,arguments),m=Wf.event.target,n=a(),o=null==n?"drag":"drag-"+n,p=b(k,n),q=0,r=Wf.select(_f).on(c+"."+o,g).on(d+"."+o,h),s=K();f?(i=f.apply(j,arguments),i=[i.x-p[0],i.y-p[1]]):i=[0,0],l({type:"dragstart"})}}var e=n(a,"drag","dragstart","dragend"),f=null,g=d(i,Wf.mouse,"mousemove","mouseup"),h=d(b,c,"touchmove","touchend");return a.origin=function(b){return arguments.length?(f=b,a):f},Wf.rebind(a,e,"on")};var Ag=Math.PI,Bg=2*Ag,Cg=Ag/2,Dg=1e-6,Eg=Dg*Dg,Fg=Ag/180,Gg=180/Ag,Hg=Math.SQRT2,Ig=2,Jg=4;Wf.interpolateZoom=function(a,b){function c(a){var b=a*s;if(r){var c=Q(p),g=f/(Ig*m)*(c*R(Hg*b+p)-P(p));return[d+g*j,e+g*k,f*c/Q(Hg*b+p)]}return[d+a*j,e+a*k,f*Math.exp(Hg*b)]}var d=a[0],e=a[1],f=a[2],g=b[0],h=b[1],i=b[2],j=g-d,k=h-e,l=j*j+k*k,m=Math.sqrt(l),n=(i*i-f*f+Jg*l)/(2*f*Ig*m),o=(i*i-f*f-Jg*l)/(2*i*Ig*m),p=Math.log(Math.sqrt(n*n+1)-n),q=Math.log(Math.sqrt(o*o+1)-o),r=q-p,s=(r||Math.log(i/f))/Hg;return c.duration=1e3*s,c},Wf.behavior.zoom=function(){function a(a){a.on(B,j).on(Mg+".zoom",m).on(C,o).on("dblclick.zoom",p).on(E,k)}function b(a){return[(a[0]-y.x)/y.k,(a[1]-y.y)/y.k]}function c(a){return[a[0]*y.k+y.x,a[1]*y.k+y.y]}function d(a){y.k=Math.max(A[0],Math.min(A[1],a))}function e(a,b){b=c(b),y.x+=a[0]-b[0],y.y+=a[1]-b[1]}function f(){v&&v.domain(u.range().map(function(a){return(a-y.x)/y.k}).map(u.invert)),x&&x.domain(w.range().map(function(a){return(a-y.y)/y.k}).map(w.invert))}function g(a){a({type:"zoomstart"})}function h(a){f(),a({type:"zoom",scale:y.k,translate:[y.x,y.y]})}function i(a){a({type:"zoomend"})}function j(){function a(){k=1,e(Wf.mouse(d),m),h(f)}function c(){l.on(C,_f===d?o:null).on(D,null),n(k&&Wf.event.target===j),i(f)}var d=this,f=F.of(d,arguments),j=Wf.event.target,k=0,l=Wf.select(_f).on(C,a).on(D,c),m=b(Wf.mouse(d)),n=K();G.call(d),g(f)}function k(){function a(){var a=Wf.touches(o);return n=y.k,a.forEach(function(a){a.identifier in q&&(q[a.identifier]=b(a))}),a}function c(){for(var b=Wf.event.changedTouches,c=0,f=b.length;f>c;++c)q[b[c].identifier]=null;var g=a(),i=Date.now();if(1===g.length){if(500>i-t){var j=g[0],k=q[j.identifier];d(2*y.k),e(j,k),l(),h(p)}t=i}else if(g.length>1){var j=g[0],m=g[1],n=j[0]-m[0],o=j[1]-m[1];r=n*n+o*o}}function f(){for(var a,b,c,f,g=Wf.touches(o),i=0,j=g.length;j>i;++i,f=null)if(c=g[i],f=q[c.identifier]){if(b)break;a=c,b=f}if(f){var k=(k=c[0]-a[0])*k+(k=c[1]-a[1])*k,l=r&&Math.sqrt(k/r);a=[(a[0]+c[0])/2,(a[1]+c[1])/2],b=[(b[0]+f[0])/2,(b[1]+f[1])/2],d(l*n)}t=null,e(a,b),h(p)}function m(){if(Wf.event.touches.length){for(var b=Wf.event.changedTouches,c=0,d=b.length;d>c;++c)delete q[b[c].identifier];for(var e in q)return void a()}w.on(u,null).on(v,null),x.on(B,j).on(E,k),z(),i(p)}var n,o=this,p=F.of(o,arguments),q={},r=0,s=Wf.event.changedTouches[0].identifier,u="touchmove.zoom-"+s,v="touchend.zoom-"+s,w=Wf.select(_f).on(u,f).on(v,m),x=Wf.select(o).on(B,null).on(E,c),z=K();G.call(o),c(),g(p)}function m(){var a=F.of(this,arguments);s?clearTimeout(s):(G.call(this),g(a)),s=setTimeout(function(){s=null,i(a)},50),l();var c=r||Wf.mouse(this);q||(q=b(c)),d(Math.pow(2,.002*Kg())*y.k),e(c,q),h(a)}function o(){q=null}function p(){var a=F.of(this,arguments),c=Wf.mouse(this),f=b(c),j=Math.log(y.k)/Math.LN2;g(a),d(Math.pow(2,Wf.event.shiftKey?Math.ceil(j)-1:Math.floor(j)+1)),e(c,f),h(a),i(a)}var q,r,s,t,u,v,w,x,y={x:0,y:0,k:1},z=[960,500],A=Lg,B="mousedown.zoom",C="mousemove.zoom",D="mouseup.zoom",E="touchstart.zoom",F=n(a,"zoomstart","zoom","zoomend");return a.event=function(a){a.each(function(){var a=F.of(this,arguments),b=y;zi?Wf.select(this).transition().each("start.zoom",function(){y=this.__chart__||{x:0,y:0,k:1},g(a)}).tween("zoom:zoom",function(){var c=z[0],d=z[1],e=c/2,f=d/2,g=Wf.interpolateZoom([(e-y.x)/y.k,(f-y.y)/y.k,c/y.k],[(e-b.x)/b.k,(f-b.y)/b.k,c/b.k]);return function(b){var d=g(b),i=c/d[2];this.__chart__=y={x:e-d[0]*i,y:f-d[1]*i,k:i},h(a)}}).each("end.zoom",function(){i(a)}):(this.__chart__=y,g(a),h(a),i(a))})},a.translate=function(b){return arguments.length?(y={x:+b[0],y:+b[1],k:y.k},f(),a):[y.x,y.y]},a.scale=function(b){return arguments.length?(y={x:y.x,y:y.y,k:+b},f(),a):y.k},a.scaleExtent=function(b){return arguments.length?(A=null==b?Lg:[+b[0],+b[1]],a):A},a.center=function(b){return arguments.length?(r=b&&[+b[0],+b[1]],a):r},a.size=function(b){return arguments.length?(z=b&&[+b[0],+b[1]],a):z},a.x=function(b){return arguments.length?(v=b,u=b.copy(),y={x:0,y:0,k:1},a):v},a.y=function(b){return arguments.length?(x=b,w=b.copy(),y={x:0,y:0,k:1},a):x},Wf.rebind(a,F,"on")};var Kg,Lg=[0,1/0],Mg="onwheel"in Zf?(Kg=function(){return-Wf.event.deltaY*(Wf.event.deltaMode?120:1)},"wheel"):"onmousewheel"in Zf?(Kg=function(){return Wf.event.wheelDelta},"mousewheel"):(Kg=function(){return-Wf.event.detail},"MozMousePixelScroll");T.prototype.toString=function(){return this.rgb()+""},Wf.hsl=function(a,b,c){return 1===arguments.length?a instanceof V?U(a.h,a.s,a.l):ka(""+a,la,U):U(+a,+b,+c)};var Ng=V.prototype=new T;Ng.brighter=function(a){return a=Math.pow(.7,arguments.length?a:1),U(this.h,this.s,this.l/a)},Ng.darker=function(a){return a=Math.pow(.7,arguments.length?a:1),U(this.h,this.s,a*this.l)},Ng.rgb=function(){return W(this.h,this.s,this.l)},Wf.hcl=function(a,b,c){return 1===arguments.length?a instanceof Y?X(a.h,a.c,a.l):a instanceof _?ba(a.l,a.a,a.b):ba((a=ma((a=Wf.rgb(a)).r,a.g,a.b)).l,a.a,a.b):X(+a,+b,+c)};var Og=Y.prototype=new T;Og.brighter=function(a){return X(this.h,this.c,Math.min(100,this.l+Pg*(arguments.length?a:1)))},Og.darker=function(a){return X(this.h,this.c,Math.max(0,this.l-Pg*(arguments.length?a:1)))},Og.rgb=function(){return Z(this.h,this.c,this.l).rgb()},Wf.lab=function(a,b,c){return 1===arguments.length?a instanceof _?$(a.l,a.a,a.b):a instanceof Y?Z(a.l,a.c,a.h):ma((a=Wf.rgb(a)).r,a.g,a.b):$(+a,+b,+c)};var Pg=18,Qg=.95047,Rg=1,Sg=1.08883,Tg=_.prototype=new T;Tg.brighter=function(a){return $(Math.min(100,this.l+Pg*(arguments.length?a:1)),this.a,this.b)},Tg.darker=function(a){return $(Math.max(0,this.l-Pg*(arguments.length?a:1)),this.a,this.b)},Tg.rgb=function(){return aa(this.l,this.a,this.b)},Wf.rgb=function(a,b,c){return 1===arguments.length?a instanceof ia?ha(a.r,a.g,a.b):ka(""+a,ha,W):ha(~~a,~~b,~~c)};var Ug=ia.prototype=new T;Ug.brighter=function(a){a=Math.pow(.7,arguments.length?a:1);var b=this.r,c=this.g,d=this.b,e=30;return b||c||d?(b&&e>b&&(b=e),c&&e>c&&(c=e),d&&e>d&&(d=e),ha(Math.min(255,~~(b/a)),Math.min(255,~~(c/a)),Math.min(255,~~(d/a)))):ha(e,e,e)},Ug.darker=function(a){return a=Math.pow(.7,arguments.length?a:1),ha(~~(a*this.r),~~(a*this.g),~~(a*this.b))},Ug.hsl=function(){return la(this.r,this.g,this.b)},Ug.toString=function(){return"#"+ja(this.r)+ja(this.g)+ja(this.b)};var Vg=Wf.map({aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074});Vg.forEach(function(a,b){Vg.set(a,fa(b))}),Wf.functor=pa,Wf.xhr=ra(qa),Wf.dsv=function(a,b){function c(a,c,f){arguments.length<3&&(f=c,c=null);var g=sa(a,b,null==c?d:e(c),f);return g.row=function(a){return arguments.length?g.response(null==(c=a)?d:e(a)):c},g}function d(a){return c.parse(a.responseText)}function e(a){return function(b){return c.parse(b.responseText,a)}}function g(b){return b.map(h).join(a)}function h(a){return i.test(a)?'"'+a.replace(/\"/g,'""')+'"':a}var i=new RegExp('["'+a+"\n]"),j=a.charCodeAt(0);return c.parse=function(a,b){var d;return c.parseRows(a,function(a,c){if(d)return d(a,c-1);var e=new Function("d","return {"+a.map(function(a,b){return JSON.stringify(a)+": d["+b+"]"}).join(",")+"}");d=b?function(a,c){return b(e(a),c)}:e})},c.parseRows=function(a,b){function c(){if(k>=i)return g;if(e)return e=!1,f;var b=k;if(34===a.charCodeAt(b)){for(var c=b;c++<i;)if(34===a.charCodeAt(c)){if(34!==a.charCodeAt(c+1))break;++c}k=c+2;var d=a.charCodeAt(c+1);return 13===d?(e=!0,10===a.charCodeAt(c+2)&&++k):10===d&&(e=!0),a.substring(b+1,c).replace(/""/g,'"')}for(;i>k;){var d=a.charCodeAt(k++),h=1;if(10===d)e=!0;else if(13===d)e=!0,10===a.charCodeAt(k)&&(++k,++h);else if(d!==j)continue;return a.substring(b,k-h)}return a.substring(b)}for(var d,e,f={},g={},h=[],i=a.length,k=0,l=0;(d=c())!==g;){for(var m=[];d!==f&&d!==g;)m.push(d),d=c();(!b||(m=b(m,l++)))&&h.push(m)}return h},c.format=function(b){if(Array.isArray(b[0]))return c.formatRows(b);var d=new f,e=[];return b.forEach(function(a){for(var b in a)d.has(b)||e.push(d.add(b))}),[e.map(h).join(a)].concat(b.map(function(b){return e.map(function(a){return h(b[a])}).join(a)})).join("\n")},c.formatRows=function(a){return a.map(g).join("\n")},c},Wf.csv=Wf.dsv(",","text/csv"),Wf.tsv=Wf.dsv("	","text/tab-separated-values");var Wg,Xg,Yg,Zg,$g,_g=_f[h(_f,"requestAnimationFrame")]||function(a){setTimeout(a,17)};Wf.timer=function(a,b,c){var d=arguments.length;2>d&&(b=0),3>d&&(c=Date.now());var e=c+b,f={c:a,t:e,f:!1,n:null};Xg?Xg.n=f:Wg=f,Xg=f,Yg||(Zg=clearTimeout(Zg),Yg=1,_g(ua))},Wf.timer.flush=function(){va(),wa()};var ah=".",bh=",",ch=[3,3],dh="$",eh=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"].map(xa);Wf.formatPrefix=function(a,b){var c=0;return a&&(0>a&&(a*=-1),b&&(a=Wf.round(a,ya(a,b))),c=1+Math.floor(1e-12+Math.log(a)/Math.LN10),c=Math.max(-24,Math.min(24,3*Math.floor((0>=c?c+1:c-1)/3)))),eh[8+c/3]},Wf.round=function(a,b){return b?Math.round(a*(b=Math.pow(10,b)))/b:Math.round(a)},Wf.format=function(a){var b=fh.exec(a),c=b[1]||" ",d=b[2]||">",e=b[3]||"",f=b[4]||"",g=b[5],h=+b[6],i=b[7],j=b[8],k=b[9],l=1,m="",n=!1;switch(j&&(j=+j.substring(1)),(g||"0"===c&&"="===d)&&(g=c="0",d="=",i&&(h-=Math.floor((h-1)/4))),k){case"n":i=!0,k="g";break;case"%":l=100,m="%",k="f";break;case"p":l=100,m="%",k="r";break;case"b":case"o":case"x":case"X":"#"===f&&(f="0"+k.toLowerCase());case"c":case"d":n=!0,j=0;break;case"s":l=-1,k="r"}"#"===f?f="":"$"===f&&(f=dh),"r"!=k||j||(k="g"),null!=j&&("g"==k?j=Math.max(1,Math.min(21,j)):("e"==k||"f"==k)&&(j=Math.max(0,Math.min(20,j)))),k=gh.get(k)||za;var o=g&&i;return function(a){if(n&&a%1)return"";var b=0>a||0===a&&0>1/a?(a=-a,"-"):e;if(0>l){var p=Wf.formatPrefix(a,j);a=p.scale(a),m=p.symbol}else a*=l;a=k(a,j);var q=a.lastIndexOf("."),r=0>q?a:a.substring(0,q),s=0>q?"":ah+a.substring(q+1);!g&&i&&(r=hh(r));var t=f.length+r.length+s.length+(o?0:b.length),u=h>t?new Array(t=h-t+1).join(c):"";return o&&(r=hh(u+r)),b+=f,a=r+s,("<"===d?b+a+u:">"===d?u+b+a:"^"===d?u.substring(0,t>>=1)+b+a+u.substring(t):b+(o?a:u+a))+m}};var fh=/(?:([^{])?([<>=^]))?([+\- ])?([$#])?(0)?(\d+)?(,)?(\.-?\d+)?([a-z%])?/i,gh=Wf.map({b:function(a){return a.toString(2)},c:function(a){return String.fromCharCode(a)},o:function(a){return a.toString(8)},x:function(a){return a.toString(16)},X:function(a){return a.toString(16).toUpperCase()},g:function(a,b){return a.toPrecision(b)},e:function(a,b){return a.toExponential(b)},f:function(a,b){return a.toFixed(b)},r:function(a,b){return(a=Wf.round(a,ya(a,b))).toFixed(Math.max(0,Math.min(20,ya(a*(1+1e-15),b))))}}),hh=qa;if(ch){var ih=ch.length;hh=function(a){for(var b=a.length,c=[],d=0,e=ch[0];b>0&&e>0;)c.push(a.substring(b-=e,b+e)),e=ch[d=(d+1)%ih];return c.reverse().join(bh)}}Wf.geo={},Aa.prototype={s:0,t:0,add:function(a){Ba(a,this.t,jh),Ba(jh.s,this.s,this),this.s?this.t+=jh.t:this.s=jh.t},reset:function(){this.s=this.t=0},valueOf:function(){return this.s}};var jh=new Aa;Wf.geo.stream=function(a,b){a&&kh.hasOwnProperty(a.type)?kh[a.type](a,b):Ca(a,b)};var kh={Feature:function(a,b){Ca(a.geometry,b)},FeatureCollection:function(a,b){for(var c=a.features,d=-1,e=c.length;++d<e;)Ca(c[d].geometry,b)}},lh={Sphere:function(a,b){b.sphere()},Point:function(a,b){a=a.coordinates,b.point(a[0],a[1],a[2])},MultiPoint:function(a,b){for(var c=a.coordinates,d=-1,e=c.length;++d<e;)a=c[d],b.point(a[0],a[1],a[2])},LineString:function(a,b){Da(a.coordinates,b,0)},MultiLineString:function(a,b){for(var c=a.coordinates,d=-1,e=c.length;++d<e;)Da(c[d],b,0)},Polygon:function(a,b){Ea(a.coordinates,b)},MultiPolygon:function(a,b){for(var c=a.coordinates,d=-1,e=c.length;++d<e;)Ea(c[d],b)},GeometryCollection:function(a,b){for(var c=a.geometries,d=-1,e=c.length;++d<e;)Ca(c[d],b)}};Wf.geo.area=function(a){return mh=0,Wf.geo.stream(a,oh),mh};var mh,nh=new Aa,oh={sphere:function(){mh+=4*Ag},point:i,lineStart:i,lineEnd:i,polygonStart:function(){nh.reset(),oh.lineStart=Fa},polygonEnd:function(){var a=2*nh;mh+=0>a?4*Ag+a:a,oh.lineStart=oh.lineEnd=oh.point=i}};Wf.geo.bounds=function(){function a(a,b){t.push(u=[k=a,m=a]),l>b&&(l=b),b>n&&(n=b)}function b(b,c){var d=Ga([b*Fg,c*Fg]);if(r){var e=Ia(r,d),f=[e[1],-e[0],0],g=Ia(f,e);La(g),g=Ma(g);var i=b-o,j=i>0?1:-1,p=g[0]*Gg*j,q=ig(i)>180;if(q^(p>j*o&&j*b>p)){var s=g[1]*Gg;s>n&&(n=s)}else if(p=(p+360)%360-180,q^(p>j*o&&j*b>p)){var s=-g[1]*Gg;l>s&&(l=s)}else l>c&&(l=c),c>n&&(n=c);q?o>b?h(k,b)>h(k,m)&&(m=b):h(b,m)>h(k,m)&&(k=b):m>=k?(k>b&&(k=b),b>m&&(m=b)):b>o?h(k,b)>h(k,m)&&(m=b):h(b,m)>h(k,m)&&(k=b)}else a(b,c);r=d,o=b}function c(){v.point=b}function d(){u[0]=k,u[1]=m,v.point=a,r=null}function e(a,c){if(r){var d=a-o;s+=ig(d)>180?d+(d>0?360:-360):d}else p=a,q=c;oh.point(a,c),b(a,c)}function f(){oh.lineStart()}function g(){e(p,q),oh.lineEnd(),ig(s)>Dg&&(k=-(m=180)),u[0]=k,u[1]=m,r=null}function h(a,b){return(b-=a)<0?b+360:b}function i(a,b){return a[0]-b[0]}function j(a,b){return b[0]<=b[1]?b[0]<=a&&a<=b[1]:a<b[0]||b[1]<a}var k,l,m,n,o,p,q,r,s,t,u,v={point:a,lineStart:c,lineEnd:d,polygonStart:function(){v.point=e,v.lineStart=f,v.lineEnd=g,s=0,oh.polygonStart()},polygonEnd:function(){oh.polygonEnd(),v.point=a,v.lineStart=c,v.lineEnd=d,0>nh?(k=-(m=180),l=-(n=90)):s>Dg?n=90:-Dg>s&&(l=-90),u[0]=k,u[1]=m}};return function(a){n=m=-(k=l=1/0),t=[],Wf.geo.stream(a,v);var b=t.length;if(b){t.sort(i);for(var c,d=1,e=t[0],f=[e];b>d;++d)c=t[d],j(c[0],e)||j(c[1],e)?(h(e[0],c[1])>h(e[0],e[1])&&(e[1]=c[1]),h(c[0],e[1])>h(e[0],e[1])&&(e[0]=c[0])):f.push(e=c);for(var g,c,o=-(1/0),b=f.length-1,d=0,e=f[b];b>=d;e=c,++d)c=f[d],(g=h(e[1],c[0]))>o&&(o=g,k=c[0],m=e[1])}return t=u=null,k===1/0||l===1/0?[[NaN,NaN],[NaN,NaN]]:[[k,l],[m,n]]}}(),Wf.geo.centroid=function(a){ph=qh=rh=sh=th=uh=vh=wh=xh=yh=zh=0,Wf.geo.stream(a,Ah);var b=xh,c=yh,d=zh,e=b*b+c*c+d*d;return Eg>e&&(b=uh,c=vh,d=wh,Dg>qh&&(b=rh,c=sh,d=th),e=b*b+c*c+d*d,Eg>e)?[NaN,NaN]:[Math.atan2(c,b)*Gg,O(d/Math.sqrt(e))*Gg]};var ph,qh,rh,sh,th,uh,vh,wh,xh,yh,zh,Ah={sphere:i,point:Oa,lineStart:Qa,lineEnd:Ra,polygonStart:function(){Ah.lineStart=Sa},polygonEnd:function(){Ah.lineStart=Qa}},Bh=Xa(Ta,ab,cb,[-Ag,-Ag/2]),Ch=1e9;Wf.geo.clipExtent=function(){var a,b,c,d,e,f,g={stream:function(a){return e&&(e.valid=!1),e=f(a),e.valid=!0,e},extent:function(h){return arguments.length?(f=fb(a=+h[0][0],b=+h[0][1],c=+h[1][0],d=+h[1][1]),e&&(e.valid=!1,e=null),g):[[a,b],[c,d]]}};return g.extent([[0,0],[960,500]])},(Wf.geo.conicEqualArea=function(){return hb(ib)}).raw=ib,Wf.geo.albers=function(){return Wf.geo.conicEqualArea().rotate([96,0]).center([-.6,38.7]).parallels([29.5,45.5]).scale(1070)},Wf.geo.albersUsa=function(){function a(a){var f=a[0],g=a[1];return b=null,c(f,g),b||(d(f,g),b)||e(f,g),b}var b,c,d,e,f=Wf.geo.albers(),g=Wf.geo.conicEqualArea().rotate([154,0]).center([-2,58.5]).parallels([55,65]),h=Wf.geo.conicEqualArea().rotate([157,0]).center([-3,19.9]).parallels([8,18]),i={point:function(a,c){b=[a,c]}};return a.invert=function(a){var b=f.scale(),c=f.translate(),d=(a[0]-c[0])/b,e=(a[1]-c[1])/b;return(e>=.12&&.234>e&&d>=-.425&&-.214>d?g:e>=.166&&.234>e&&d>=-.214&&-.115>d?h:f).invert(a)},a.stream=function(a){var b=f.stream(a),c=g.stream(a),d=h.stream(a);return{point:function(a,e){b.point(a,e),c.point(a,e),d.point(a,e)},sphere:function(){b.sphere(),c.sphere(),d.sphere()},lineStart:function(){b.lineStart(),c.lineStart(),d.lineStart()},lineEnd:function(){b.lineEnd(),c.lineEnd(),d.lineEnd()},polygonStart:function(){b.polygonStart(),c.polygonStart(),d.polygonStart()},polygonEnd:function(){b.polygonEnd(),c.polygonEnd(),d.polygonEnd()}}},a.precision=function(b){return arguments.length?(f.precision(b),g.precision(b),h.precision(b),a):f.precision()},a.scale=function(b){return arguments.length?(f.scale(b),g.scale(.35*b),h.scale(b),a.translate(f.translate())):f.scale()},a.translate=function(b){if(!arguments.length)return f.translate();var j=f.scale(),k=+b[0],l=+b[1];return c=f.translate(b).clipExtent([[k-.455*j,l-.238*j],[k+.455*j,l+.238*j]]).stream(i).point,d=g.translate([k-.307*j,l+.201*j]).clipExtent([[k-.425*j+Dg,l+.12*j+Dg],[k-.214*j-Dg,l+.234*j-Dg]]).stream(i).point,e=h.translate([k-.205*j,l+.212*j]).clipExtent([[k-.214*j+Dg,l+.166*j+Dg],[k-.115*j-Dg,l+.234*j-Dg]]).stream(i).point,a},a.scale(1070)};var Dh,Eh,Fh,Gh,Hh,Ih,Jh={point:i,lineStart:i,lineEnd:i,polygonStart:function(){Eh=0,Jh.lineStart=jb},polygonEnd:function(){Jh.lineStart=Jh.lineEnd=Jh.point=i,Dh+=ig(Eh/2)}},Kh={point:kb,lineStart:i,lineEnd:i,polygonStart:i,polygonEnd:i},Lh={point:nb,lineStart:ob,lineEnd:pb,polygonStart:function(){Lh.lineStart=qb},polygonEnd:function(){Lh.point=nb,Lh.lineStart=ob,Lh.lineEnd=pb}};Wf.geo.path=function(){function a(a){return a&&("function"==typeof h&&f.pointRadius(+h.apply(this,arguments)),g&&g.valid||(g=e(f)),Wf.geo.stream(a,g)),f.result()}function b(){return g=null,a}var c,d,e,f,g,h=4.5;return a.area=function(a){return Dh=0,Wf.geo.stream(a,e(Jh)),Dh},a.centroid=function(a){return rh=sh=th=uh=vh=wh=xh=yh=zh=0,Wf.geo.stream(a,e(Lh)),zh?[xh/zh,yh/zh]:wh?[uh/wh,vh/wh]:th?[rh/th,sh/th]:[NaN,NaN]},a.bounds=function(a){return Hh=Ih=-(Fh=Gh=1/0),Wf.geo.stream(a,e(Kh)),[[Fh,Gh],[Hh,Ih]]},a.projection=function(a){return arguments.length?(e=(c=a)?a.stream||tb(a):qa,b()):c},a.context=function(a){return arguments.length?(f=null==(d=a)?new lb:new rb(a),"function"!=typeof h&&f.pointRadius(h),b()):d},a.pointRadius=function(b){return arguments.length?(h="function"==typeof b?b:(f.pointRadius(+b),+b),a):h},a.projection(Wf.geo.albersUsa()).context(null)},Wf.geo.transform=function(a){return{stream:function(b){var c=new ub(b);for(var d in a)c[d]=a[d];return c}}},ub.prototype={point:function(a,b){this.stream.point(a,b);
},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}},Wf.geo.projection=wb,Wf.geo.projectionMutator=xb,(Wf.geo.equirectangular=function(){return wb(zb)}).raw=zb.invert=zb,Wf.geo.rotation=function(a){function b(b){return b=a(b[0]*Fg,b[1]*Fg),b[0]*=Gg,b[1]*=Gg,b}return a=Bb(a[0]%360*Fg,a[1]*Fg,a.length>2?a[2]*Fg:0),b.invert=function(b){return b=a.invert(b[0]*Fg,b[1]*Fg),b[0]*=Gg,b[1]*=Gg,b},b},Ab.invert=zb,Wf.geo.circle=function(){function a(){var a="function"==typeof d?d.apply(this,arguments):d,b=Bb(-a[0]*Fg,-a[1]*Fg,0).invert,e=[];return c(null,null,1,{point:function(a,c){e.push(a=b(a,c)),a[0]*=Gg,a[1]*=Gg}}),{type:"Polygon",coordinates:[e]}}var b,c,d=[0,0],e=6;return a.origin=function(b){return arguments.length?(d=b,a):d},a.angle=function(d){return arguments.length?(c=Fb((b=+d)*Fg,e*Fg),a):b},a.precision=function(d){return arguments.length?(c=Fb(b*Fg,(e=+d)*Fg),a):e},a.angle(90)},Wf.geo.distance=function(a,b){var c,d=(b[0]-a[0])*Fg,e=a[1]*Fg,f=b[1]*Fg,g=Math.sin(d),h=Math.cos(d),i=Math.sin(e),j=Math.cos(e),k=Math.sin(f),l=Math.cos(f);return Math.atan2(Math.sqrt((c=l*g)*c+(c=j*k-i*l*h)*c),i*k+j*l*h)},Wf.geo.graticule=function(){function a(){return{type:"MultiLineString",coordinates:b()}}function b(){return Wf.range(Math.ceil(f/q)*q,e,q).map(m).concat(Wf.range(Math.ceil(j/r)*r,i,r).map(n)).concat(Wf.range(Math.ceil(d/o)*o,c,o).filter(function(a){return ig(a%q)>Dg}).map(k)).concat(Wf.range(Math.ceil(h/p)*p,g,p).filter(function(a){return ig(a%r)>Dg}).map(l))}var c,d,e,f,g,h,i,j,k,l,m,n,o=10,p=o,q=90,r=360,s=2.5;return a.lines=function(){return b().map(function(a){return{type:"LineString",coordinates:a}})},a.outline=function(){return{type:"Polygon",coordinates:[m(f).concat(n(i).slice(1),m(e).reverse().slice(1),n(j).reverse().slice(1))]}},a.extent=function(b){return arguments.length?a.majorExtent(b).minorExtent(b):a.minorExtent()},a.majorExtent=function(b){return arguments.length?(f=+b[0][0],e=+b[1][0],j=+b[0][1],i=+b[1][1],f>e&&(b=f,f=e,e=b),j>i&&(b=j,j=i,i=b),a.precision(s)):[[f,j],[e,i]]},a.minorExtent=function(b){return arguments.length?(d=+b[0][0],c=+b[1][0],h=+b[0][1],g=+b[1][1],d>c&&(b=d,d=c,c=b),h>g&&(b=h,h=g,g=b),a.precision(s)):[[d,h],[c,g]]},a.step=function(b){return arguments.length?a.majorStep(b).minorStep(b):a.minorStep()},a.majorStep=function(b){return arguments.length?(q=+b[0],r=+b[1],a):[q,r]},a.minorStep=function(b){return arguments.length?(o=+b[0],p=+b[1],a):[o,p]},a.precision=function(b){return arguments.length?(s=+b,k=Hb(h,g,90),l=Ib(d,c,s),m=Hb(j,i,90),n=Ib(f,e,s),a):s},a.majorExtent([[-180,-90+Dg],[180,90-Dg]]).minorExtent([[-180,-80-Dg],[180,80+Dg]])},Wf.geo.greatArc=function(){function a(){return{type:"LineString",coordinates:[b||d.apply(this,arguments),c||e.apply(this,arguments)]}}var b,c,d=Jb,e=Kb;return a.distance=function(){return Wf.geo.distance(b||d.apply(this,arguments),c||e.apply(this,arguments))},a.source=function(c){return arguments.length?(d=c,b="function"==typeof c?null:c,a):d},a.target=function(b){return arguments.length?(e=b,c="function"==typeof b?null:b,a):e},a.precision=function(){return arguments.length?a:0},a},Wf.geo.interpolate=function(a,b){return Lb(a[0]*Fg,a[1]*Fg,b[0]*Fg,b[1]*Fg)},Wf.geo.length=function(a){return Mh=0,Wf.geo.stream(a,Nh),Mh};var Mh,Nh={sphere:i,point:i,lineStart:Mb,lineEnd:i,polygonStart:i,polygonEnd:i},Oh=Nb(function(a){return Math.sqrt(2/(1+a))},function(a){return 2*Math.asin(a/2)});(Wf.geo.azimuthalEqualArea=function(){return wb(Oh)}).raw=Oh;var Ph=Nb(function(a){var b=Math.acos(a);return b&&b/Math.sin(b)},qa);(Wf.geo.azimuthalEquidistant=function(){return wb(Ph)}).raw=Ph,(Wf.geo.conicConformal=function(){return hb(Ob)}).raw=Ob,(Wf.geo.conicEquidistant=function(){return hb(Pb)}).raw=Pb;var Qh=Nb(function(a){return 1/a},Math.atan);(Wf.geo.gnomonic=function(){return wb(Qh)}).raw=Qh,Qb.invert=function(a,b){return[a,2*Math.atan(Math.exp(b))-Cg]},(Wf.geo.mercator=function(){return Rb(Qb)}).raw=Qb;var Rh=Nb(function(){return 1},Math.asin);(Wf.geo.orthographic=function(){return wb(Rh)}).raw=Rh;var Sh=Nb(function(a){return 1/(1+a)},function(a){return 2*Math.atan(a)});(Wf.geo.stereographic=function(){return wb(Sh)}).raw=Sh,Sb.invert=function(a,b){return[-b,2*Math.atan(Math.exp(a))-Cg]},(Wf.geo.transverseMercator=function(){var a=Rb(Sb),b=a.center,c=a.rotate;return a.center=function(a){return a?b([-a[1],a[0]]):(a=b(),[-a[1],a[0]])},a.rotate=function(a){return a?c([a[0],a[1],a.length>2?a[2]+90:90]):(a=c(),[a[0],a[1],a[2]-90])},a.rotate([0,0])}).raw=Sb,Wf.geom={},Wf.geom.hull=function(a){function b(a){if(a.length<3)return[];var b,e,f,g,h,i,j,k,l,m,n,o,p=pa(c),q=pa(d),r=a.length,s=r-1,t=[],u=[],v=0;if(p===Tb&&d===Ub)b=a;else for(f=0,b=[];r>f;++f)b.push([+p.call(this,e=a[f],f),+q.call(this,e,f)]);for(f=1;r>f;++f)(b[f][1]<b[v][1]||b[f][1]==b[v][1]&&b[f][0]<b[v][0])&&(v=f);for(f=0;r>f;++f)f!==v&&(i=b[f][1]-b[v][1],h=b[f][0]-b[v][0],t.push({angle:Math.atan2(i,h),index:f}));for(t.sort(function(a,b){return a.angle-b.angle}),n=t[0].angle,m=t[0].index,l=0,f=1;s>f;++f){if(g=t[f].index,n==t[f].angle){if(h=b[m][0]-b[v][0],i=b[m][1]-b[v][1],j=b[g][0]-b[v][0],k=b[g][1]-b[v][1],h*h+i*i>=j*j+k*k){t[f].index=-1;continue}t[l].index=-1}n=t[f].angle,l=f,m=g}for(u.push(v),f=0,g=0;2>f;++g)t[g].index>-1&&(u.push(t[g].index),f++);for(o=u.length;s>g;++g)if(!(t[g].index<0)){for(;!Vb(u[o-2],u[o-1],t[g].index,b);)--o;u[o++]=t[g].index}var w=[];for(f=o-1;f>=0;--f)w.push(a[u[f]]);return w}var c=Tb,d=Ub;return arguments.length?b(a):(b.x=function(a){return arguments.length?(c=a,b):c},b.y=function(a){return arguments.length?(d=a,b):d},b)},Wf.geom.polygon=function(a){return ng(a,Th),a};var Th=Wf.geom.polygon.prototype=[];Th.area=function(){for(var a,b=-1,c=this.length,d=this[c-1],e=0;++b<c;)a=d,d=this[b],e+=a[1]*d[0]-a[0]*d[1];return.5*e},Th.centroid=function(a){var b,c,d=-1,e=this.length,f=0,g=0,h=this[e-1];for(arguments.length||(a=-1/(6*this.area()));++d<e;)b=h,h=this[d],c=b[0]*h[1]-h[0]*b[1],f+=(b[0]+h[0])*c,g+=(b[1]+h[1])*c;return[f*a,g*a]},Th.clip=function(a){for(var b,c,d,e,f,g,h=Yb(a),i=-1,j=this.length-Yb(this),k=this[j-1];++i<j;){for(b=a.slice(),a.length=0,e=this[i],f=b[(d=b.length-h)-1],c=-1;++c<d;)g=b[c],Wb(g,k,e)?(Wb(f,k,e)||a.push(Xb(f,g,k,e)),a.push(g)):Wb(f,k,e)&&a.push(Xb(f,g,k,e)),f=g;h&&a.push(a[0]),k=e}return a};var Uh,Vh,Wh,Xh,Yh,Zh=[],$h=[];ec.prototype.prepare=function(){for(var a,b=this.edges,c=b.length;c--;)a=b[c].edge,a.b&&a.a||b.splice(c,1);return b.sort(gc),b.length},qc.prototype={start:function(){return this.edge.l===this.site?this.edge.a:this.edge.b},end:function(){return this.edge.l===this.site?this.edge.b:this.edge.a}},rc.prototype={insert:function(a,b){var c,d,e;if(a){if(b.P=a,b.N=a.N,a.N&&(a.N.P=b),a.N=b,a.R){for(a=a.R;a.L;)a=a.L;a.L=b}else a.R=b;c=a}else this._?(a=vc(this._),b.P=null,b.N=a,a.P=a.L=b,c=a):(b.P=b.N=null,this._=b,c=null);for(b.L=b.R=null,b.U=c,b.C=!0,a=b;c&&c.C;)d=c.U,c===d.L?(e=d.R,e&&e.C?(c.C=e.C=!1,d.C=!0,a=d):(a===c.R&&(tc(this,c),a=c,c=a.U),c.C=!1,d.C=!0,uc(this,d))):(e=d.L,e&&e.C?(c.C=e.C=!1,d.C=!0,a=d):(a===c.L&&(uc(this,c),a=c,c=a.U),c.C=!1,d.C=!0,tc(this,d))),c=a.U;this._.C=!1},remove:function(a){a.N&&(a.N.P=a.P),a.P&&(a.P.N=a.N),a.N=a.P=null;var b,c,d,e=a.U,f=a.L,g=a.R;if(c=f?g?vc(g):f:g,e?e.L===a?e.L=c:e.R=c:this._=c,f&&g?(d=c.C,c.C=a.C,c.L=f,f.U=c,c!==g?(e=c.U,c.U=a.U,a=c.R,e.L=a,c.R=g,g.U=c):(c.U=e,e=c,a=c.R)):(d=a.C,a=c),a&&(a.U=e),!d){if(a&&a.C)return void(a.C=!1);do{if(a===this._)break;if(a===e.L){if(b=e.R,b.C&&(b.C=!1,e.C=!0,tc(this,e),b=e.R),b.L&&b.L.C||b.R&&b.R.C){b.R&&b.R.C||(b.L.C=!1,b.C=!0,uc(this,b),b=e.R),b.C=e.C,e.C=b.R.C=!1,tc(this,e),a=this._;break}}else if(b=e.L,b.C&&(b.C=!1,e.C=!0,uc(this,e),b=e.L),b.L&&b.L.C||b.R&&b.R.C){b.L&&b.L.C||(b.R.C=!1,b.C=!0,tc(this,b),b=e.L),b.C=e.C,e.C=b.L.C=!1,uc(this,e),a=this._;break}b.C=!0,a=e,e=e.U}while(!a.C);a&&(a.C=!1)}}},Wf.geom.voronoi=function(a){function b(a){var b=new Array(a.length),d=h[0][0],e=h[0][1],f=h[1][0],g=h[1][1];return wc(c(a),h).cells.forEach(function(c,h){var i=c.edges,j=c.site,k=b[h]=i.length?i.map(function(a){var b=a.start();return[b.x,b.y]}):j.x>=d&&j.x<=f&&j.y>=e&&j.y<=g?[[d,g],[f,g],[f,e],[d,e]]:[];k.point=a[h]}),b}function c(a){return a.map(function(a,b){return{x:Math.round(f(a,b)/Dg)*Dg,y:Math.round(g(a,b)/Dg)*Dg,i:b}})}var d=Tb,e=Ub,f=d,g=e,h=_h;return a?b(a):(b.links=function(a){return wc(c(a)).edges.filter(function(a){return a.l&&a.r}).map(function(b){return{source:a[b.l.i],target:a[b.r.i]}})},b.triangles=function(a){var b=[];return wc(c(a)).cells.forEach(function(c,d){for(var e,f,g=c.site,h=c.edges.sort(gc),i=-1,j=h.length,k=h[j-1].edge,l=k.l===g?k.r:k.l;++i<j;)e=k,f=l,k=h[i].edge,l=k.l===g?k.r:k.l,d<f.i&&d<l.i&&yc(g,f,l)<0&&b.push([a[d],a[f.i],a[l.i]])}),b},b.x=function(a){return arguments.length?(f=pa(d=a),b):d},b.y=function(a){return arguments.length?(g=pa(e=a),b):e},b.clipExtent=function(a){return arguments.length?(h=null==a?_h:a,b):h===_h?null:h},b.size=function(a){return arguments.length?b.clipExtent(a&&[[0,0],a]):h===_h?null:h&&h[1]},b)};var _h=[[-1e6,-1e6],[1e6,1e6]];Wf.geom.delaunay=function(a){return Wf.geom.voronoi().triangles(a)},Wf.geom.quadtree=function(a,b,c,d,e){function f(a){function f(a,b,c,d,e,f,g,h){if(!isNaN(c)&&!isNaN(d))if(a.leaf){var i=a.x,k=a.y;if(null!=i)if(ig(i-c)+ig(k-d)<.01)j(a,b,c,d,e,f,g,h);else{var l=a.point;a.x=a.y=a.point=null,j(a,l,i,k,e,f,g,h),j(a,b,c,d,e,f,g,h)}else a.x=c,a.y=d,a.point=b}else j(a,b,c,d,e,f,g,h)}function j(a,b,c,d,e,g,h,i){var j=.5*(e+h),k=.5*(g+i),l=c>=j,m=d>=k,n=(m<<1)+l;a.leaf=!1,a=a.nodes[n]||(a.nodes[n]=Bc()),l?e=j:h=j,m?g=k:i=k,f(a,b,c,d,e,g,h,i)}var k,l,m,n,o,p,q,r,s,t=pa(h),u=pa(i);if(null!=b)p=b,q=c,r=d,s=e;else if(r=s=-(p=q=1/0),l=[],m=[],o=a.length,g)for(n=0;o>n;++n)k=a[n],k.x<p&&(p=k.x),k.y<q&&(q=k.y),k.x>r&&(r=k.x),k.y>s&&(s=k.y),l.push(k.x),m.push(k.y);else for(n=0;o>n;++n){var v=+t(k=a[n],n),w=+u(k,n);p>v&&(p=v),q>w&&(q=w),v>r&&(r=v),w>s&&(s=w),l.push(v),m.push(w)}var x=r-p,y=s-q;x>y?s=q+x:r=p+y;var z=Bc();if(z.add=function(a){f(z,a,+t(a,++n),+u(a,n),p,q,r,s)},z.visit=function(a){Cc(a,z,p,q,r,s)},n=-1,null==b){for(;++n<o;)f(z,a[n],l[n],m[n],p,q,r,s);--n}else a.forEach(z.add);return l=m=a=k=null,z}var g,h=Tb,i=Ub;return(g=arguments.length)?(h=zc,i=Ac,3===g&&(e=c,d=b,c=b=0),f(a)):(f.x=function(a){return arguments.length?(h=a,f):h},f.y=function(a){return arguments.length?(i=a,f):i},f.extent=function(a){return arguments.length?(null==a?b=c=d=e=null:(b=+a[0][0],c=+a[0][1],d=+a[1][0],e=+a[1][1]),f):null==b?null:[[b,c],[d,e]]},f.size=function(a){return arguments.length?(null==a?b=c=d=e=null:(b=c=0,d=+a[0],e=+a[1]),f):null==b?null:[d-b,e-c]},f)},Wf.interpolateRgb=Dc,Wf.interpolateObject=Ec,Wf.interpolateNumber=Fc,Wf.interpolateString=Gc;var ai=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g;Wf.interpolate=Hc,Wf.interpolators=[function(a,b){var c=typeof b;return("string"===c?Vg.has(b)||/^(#|rgb\(|hsl\()/.test(b)?Dc:Gc:b instanceof T?Dc:"object"===c?Array.isArray(b)?Ic:Ec:Fc)(a,b)}],Wf.interpolateArray=Ic;var bi=function(){return qa},ci=Wf.map({linear:bi,poly:Pc,quad:function(){return Mc},cubic:function(){return Nc},sin:function(){return Qc},exp:function(){return Rc},circle:function(){return Sc},elastic:Tc,back:Uc,bounce:function(){return Vc}}),di=Wf.map({"in":qa,out:Kc,"in-out":Lc,"out-in":function(a){return Lc(Kc(a))}});Wf.ease=function(a){var b=a.indexOf("-"),c=b>=0?a.substring(0,b):a,d=b>=0?a.substring(b+1):"in";return c=ci.get(c)||bi,d=di.get(d)||qa,Jc(d(c.apply(null,Xf.call(arguments,1))))},Wf.interpolateHcl=Wc,Wf.interpolateHsl=Xc,Wf.interpolateLab=Yc,Wf.interpolateRound=Zc,Wf.transform=function(a){var b=Zf.createElementNS(Wf.ns.prefix.svg,"g");return(Wf.transform=function(a){if(null!=a){b.setAttribute("transform",a);var c=b.transform.baseVal.consolidate()}return new $c(c?c.matrix:ei)})(a)},$c.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};var ei={a:1,b:0,c:0,d:1,e:0,f:0};Wf.interpolateTransform=cd,Wf.layout={},Wf.layout.bundle=function(){return function(a){for(var b=[],c=-1,d=a.length;++c<d;)b.push(fd(a[c]));return b}},Wf.layout.chord=function(){function a(){var a,j,l,m,n,o={},p=[],q=Wf.range(f),r=[];for(c=[],d=[],a=0,m=-1;++m<f;){for(j=0,n=-1;++n<f;)j+=e[m][n];p.push(j),r.push(Wf.range(f)),a+=j}for(g&&q.sort(function(a,b){return g(p[a],p[b])}),h&&r.forEach(function(a,b){a.sort(function(a,c){return h(e[b][a],e[b][c])})}),a=(Bg-k*f)/a,j=0,m=-1;++m<f;){for(l=j,n=-1;++n<f;){var s=q[m],t=r[s][n],u=e[s][t],v=j,w=j+=u*a;o[s+"-"+t]={index:s,subindex:t,startAngle:v,endAngle:w,value:u}}d[s]={index:s,startAngle:l,endAngle:j,value:(j-l)/a},j+=k}for(m=-1;++m<f;)for(n=m-1;++n<f;){var x=o[m+"-"+n],y=o[n+"-"+m];(x.value||y.value)&&c.push(x.value<y.value?{source:y,target:x}:{source:x,target:y})}i&&b()}function b(){c.sort(function(a,b){return i((a.source.value+a.target.value)/2,(b.source.value+b.target.value)/2)})}var c,d,e,f,g,h,i,j={},k=0;return j.matrix=function(a){return arguments.length?(f=(e=a)&&e.length,c=d=null,j):e},j.padding=function(a){return arguments.length?(k=a,c=d=null,j):k},j.sortGroups=function(a){return arguments.length?(g=a,c=d=null,j):g},j.sortSubgroups=function(a){return arguments.length?(h=a,c=null,j):h},j.sortChords=function(a){return arguments.length?(i=a,c&&b(),j):i},j.chords=function(){return c||a(),c},j.groups=function(){return d||a(),d},j},Wf.layout.force=function(){function a(a){return function(b,c,d,e){if(b.point!==a){var f=b.cx-a.x,g=b.cy-a.y,h=1/Math.sqrt(f*f+g*g);if(p>(e-c)*h){var i=b.charge*h*h;return a.px-=f*i,a.py-=g*i,!0}if(b.point&&isFinite(h)){var i=b.pointCharge*h*h;a.px-=f*i,a.py-=g*i}}return!b.charge}}function b(a){a.px=Wf.event.x,a.py=Wf.event.y,h.resume()}var c,d,e,f,g,h={},i=Wf.dispatch("start","tick","end"),j=[1,1],k=.9,l=fi,m=gi,n=-30,o=.1,p=.8,q=[],r=[];return h.tick=function(){if((d*=.99)<.005)return i.end({type:"end",alpha:d=0}),!0;var b,c,h,l,m,p,s,t,u,v=q.length,w=r.length;for(c=0;w>c;++c)h=r[c],l=h.source,m=h.target,t=m.x-l.x,u=m.y-l.y,(p=t*t+u*u)&&(p=d*f[c]*((p=Math.sqrt(p))-e[c])/p,t*=p,u*=p,m.x-=t*(s=l.weight/(m.weight+l.weight)),m.y-=u*s,l.x+=t*(s=1-s),l.y+=u*s);if((s=d*o)&&(t=j[0]/2,u=j[1]/2,c=-1,s))for(;++c<v;)h=q[c],h.x+=(t-h.x)*s,h.y+=(u-h.y)*s;if(n)for(md(b=Wf.geom.quadtree(q),d,g),c=-1;++c<v;)(h=q[c]).fixed||b.visit(a(h));for(c=-1;++c<v;)h=q[c],h.fixed?(h.x=h.px,h.y=h.py):(h.x-=(h.px-(h.px=h.x))*k,h.y-=(h.py-(h.py=h.y))*k);i.tick({type:"tick",alpha:d})},h.nodes=function(a){return arguments.length?(q=a,h):q},h.links=function(a){return arguments.length?(r=a,h):r},h.size=function(a){return arguments.length?(j=a,h):j},h.linkDistance=function(a){return arguments.length?(l="function"==typeof a?a:+a,h):l},h.distance=h.linkDistance,h.linkStrength=function(a){return arguments.length?(m="function"==typeof a?a:+a,h):m},h.friction=function(a){return arguments.length?(k=+a,h):k},h.charge=function(a){return arguments.length?(n="function"==typeof a?a:+a,h):n},h.gravity=function(a){return arguments.length?(o=+a,h):o},h.theta=function(a){return arguments.length?(p=+a,h):p},h.alpha=function(a){return arguments.length?(a=+a,d?d=a>0?a:0:a>0&&(i.start({type:"start",alpha:d=a}),Wf.timer(h.tick)),h):d},h.start=function(){function a(a,d){if(!c){for(c=new Array(i),h=0;i>h;++h)c[h]=[];for(h=0;j>h;++h){var e=r[h];c[e.source.index].push(e.target),c[e.target.index].push(e.source)}}for(var f,g=c[b],h=-1,j=g.length;++h<j;)if(!isNaN(f=g[h][a]))return f;return Math.random()*d}var b,c,d,i=q.length,k=r.length,o=j[0],p=j[1];for(b=0;i>b;++b)(d=q[b]).index=b,d.weight=0;for(b=0;k>b;++b)d=r[b],"number"==typeof d.source&&(d.source=q[d.source]),"number"==typeof d.target&&(d.target=q[d.target]),++d.source.weight,++d.target.weight;for(b=0;i>b;++b)d=q[b],isNaN(d.x)&&(d.x=a("x",o)),isNaN(d.y)&&(d.y=a("y",p)),isNaN(d.px)&&(d.px=d.x),isNaN(d.py)&&(d.py=d.y);if(e=[],"function"==typeof l)for(b=0;k>b;++b)e[b]=+l.call(this,r[b],b);else for(b=0;k>b;++b)e[b]=l;if(f=[],"function"==typeof m)for(b=0;k>b;++b)f[b]=+m.call(this,r[b],b);else for(b=0;k>b;++b)f[b]=m;if(g=[],"function"==typeof n)for(b=0;i>b;++b)g[b]=+n.call(this,q[b],b);else for(b=0;i>b;++b)g[b]=n;return h.resume()},h.resume=function(){return h.alpha(.1)},h.stop=function(){return h.alpha(0)},h.drag=function(){return c||(c=Wf.behavior.drag().origin(qa).on("dragstart.force",id).on("drag.force",b).on("dragend.force",jd)),arguments.length?void this.on("mouseover.force",kd).on("mouseout.force",ld).call(c):c},Wf.rebind(h,i,"on")};var fi=20,gi=1;Wf.layout.hierarchy=function(){function a(b,g,h){var i=e.call(c,b,g);if(b.depth=g,h.push(b),i&&(j=i.length)){for(var j,k,l=-1,m=b.children=new Array(j),n=0,o=g+1;++l<j;)k=m[l]=a(i[l],o,h),k.parent=b,n+=k.value;d&&m.sort(d),f&&(b.value=n)}else delete b.children,f&&(b.value=+f.call(c,b,g)||0);return b}function b(a,d){var e=a.children,g=0;if(e&&(h=e.length))for(var h,i=-1,j=d+1;++i<h;)g+=b(e[i],j);else f&&(g=+f.call(c,a,d)||0);return f&&(a.value=g),g}function c(b){var c=[];return a(b,0,c),c}var d=qd,e=od,f=pd;return c.sort=function(a){return arguments.length?(d=a,c):d},c.children=function(a){return arguments.length?(e=a,c):e},c.value=function(a){return arguments.length?(f=a,c):f},c.revalue=function(a){return b(a,0),a},c},Wf.layout.partition=function(){function a(b,c,d,e){var f=b.children;if(b.x=c,b.y=b.depth*e,b.dx=d,b.dy=e,f&&(g=f.length)){var g,h,i,j=-1;for(d=b.value?d/b.value:0;++j<g;)a(h=f[j],c,i=h.value*d,e),c+=i}}function b(a){var c=a.children,d=0;if(c&&(e=c.length))for(var e,f=-1;++f<e;)d=Math.max(d,b(c[f]));return 1+d}function c(c,f){var g=d.call(this,c,f);return a(g[0],0,e[0],e[1]/b(g[0])),g}var d=Wf.layout.hierarchy(),e=[1,1];return c.size=function(a){return arguments.length?(e=a,c):e},nd(c,d)},Wf.layout.pie=function(){function a(f){var g=f.map(function(c,d){return+b.call(a,c,d)}),h=+("function"==typeof d?d.apply(this,arguments):d),i=(("function"==typeof e?e.apply(this,arguments):e)-h)/Wf.sum(g),j=Wf.range(f.length);null!=c&&j.sort(c===hi?function(a,b){return g[b]-g[a]}:function(a,b){return c(f[a],f[b])});var k=[];return j.forEach(function(a){var b;k[a]={data:f[a],value:b=g[a],startAngle:h,endAngle:h+=b*i}}),k}var b=Number,c=hi,d=0,e=Bg;return a.value=function(c){return arguments.length?(b=c,a):b},a.sort=function(b){return arguments.length?(c=b,a):c},a.startAngle=function(b){return arguments.length?(d=b,a):d},a.endAngle=function(b){return arguments.length?(e=b,a):e},a};var hi={};Wf.layout.stack=function(){function a(h,i){var j=h.map(function(c,d){return b.call(a,c,d)}),k=j.map(function(b){return b.map(function(b,c){return[f.call(a,b,c),g.call(a,b,c)]})}),l=c.call(a,k,i);j=Wf.permute(j,l),k=Wf.permute(k,l);var m,n,o,p=d.call(a,k,i),q=j.length,r=j[0].length;for(n=0;r>n;++n)for(e.call(a,j[0][n],o=p[n],k[0][n][1]),m=1;q>m;++m)e.call(a,j[m][n],o+=k[m-1][n][1],k[m][n][1]);return h}var b=qa,c=vd,d=wd,e=ud,f=sd,g=td;return a.values=function(c){return arguments.length?(b=c,a):b},a.order=function(b){return arguments.length?(c="function"==typeof b?b:ii.get(b)||vd,a):c},a.offset=function(b){return arguments.length?(d="function"==typeof b?b:ji.get(b)||wd,a):d},a.x=function(b){return arguments.length?(f=b,a):f},a.y=function(b){return arguments.length?(g=b,a):g},a.out=function(b){return arguments.length?(e=b,a):e},a};var ii=Wf.map({"inside-out":function(a){var b,c,d=a.length,e=a.map(xd),f=a.map(yd),g=Wf.range(d).sort(function(a,b){return e[a]-e[b]}),h=0,i=0,j=[],k=[];for(b=0;d>b;++b)c=g[b],i>h?(h+=f[c],j.push(c)):(i+=f[c],k.push(c));return k.reverse().concat(j)},reverse:function(a){return Wf.range(a.length).reverse()},"default":vd}),ji=Wf.map({silhouette:function(a){var b,c,d,e=a.length,f=a[0].length,g=[],h=0,i=[];for(c=0;f>c;++c){for(b=0,d=0;e>b;b++)d+=a[b][c][1];d>h&&(h=d),g.push(d)}for(c=0;f>c;++c)i[c]=(h-g[c])/2;return i},wiggle:function(a){var b,c,d,e,f,g,h,i,j,k=a.length,l=a[0],m=l.length,n=[];for(n[0]=i=j=0,c=1;m>c;++c){for(b=0,e=0;k>b;++b)e+=a[b][c][1];for(b=0,f=0,h=l[c][0]-l[c-1][0];k>b;++b){for(d=0,g=(a[b][c][1]-a[b][c-1][1])/(2*h);b>d;++d)g+=(a[d][c][1]-a[d][c-1][1])/h;f+=g*a[b][c][1]}n[c]=i-=e?f/e*h:0,j>i&&(j=i)}for(c=0;m>c;++c)n[c]-=j;return n},expand:function(a){var b,c,d,e=a.length,f=a[0].length,g=1/e,h=[];for(c=0;f>c;++c){for(b=0,d=0;e>b;b++)d+=a[b][c][1];if(d)for(b=0;e>b;b++)a[b][c][1]/=d;else for(b=0;e>b;b++)a[b][c][1]=g}for(c=0;f>c;++c)h[c]=0;return h},zero:wd});Wf.layout.histogram=function(){function a(a,f){for(var g,h,i=[],j=a.map(c,this),k=d.call(this,j,f),l=e.call(this,k,j,f),f=-1,m=j.length,n=l.length-1,o=b?1:1/m;++f<n;)g=i[f]=[],g.dx=l[f+1]-(g.x=l[f]),g.y=0;if(n>0)for(f=-1;++f<m;)h=j[f],h>=k[0]&&h<=k[1]&&(g=i[Wf.bisect(l,h,1,n)-1],g.y+=o,g.push(a[f]));return i}var b=!0,c=Number,d=Cd,e=Ad;return a.value=function(b){return arguments.length?(c=b,a):c},a.range=function(b){return arguments.length?(d=pa(b),a):d},a.bins=function(b){return arguments.length?(e="number"==typeof b?function(a){return Bd(a,b)}:pa(b),a):e},a.frequency=function(c){return arguments.length?(b=!!c,a):b},a},Wf.layout.tree=function(){function a(a,f){function g(a,b){var d=a.children,e=a._tree;if(d&&(f=d.length)){for(var f,h,j,k=d[0],l=k,m=-1;++m<f;)j=d[m],g(j,h),l=i(j,h,l),h=j;Ld(a);var n=.5*(k._tree.prelim+j._tree.prelim);b?(e.prelim=b._tree.prelim+c(a,b),e.mod=e.prelim-n):e.prelim=n}else b&&(e.prelim=b._tree.prelim+c(a,b))}function h(a,b){a.x=a._tree.prelim+b;var c=a.children;if(c&&(d=c.length)){var d,e=-1;for(b+=a._tree.mod;++e<d;)h(c[e],b)}}function i(a,b,d){if(b){for(var e,f=a,g=a,h=b,i=a.parent.children[0],j=f._tree.mod,k=g._tree.mod,l=h._tree.mod,m=i._tree.mod;h=Fd(h),f=Ed(f),h&&f;)i=Ed(i),g=Fd(g),g._tree.ancestor=a,e=h._tree.prelim+l-f._tree.prelim-j+c(h,f),e>0&&(Md(Nd(h,a,d),a,e),j+=e,k+=e),l+=h._tree.mod,j+=f._tree.mod,m+=i._tree.mod,k+=g._tree.mod;h&&!Fd(g)&&(g._tree.thread=h,g._tree.mod+=l-k),f&&!Ed(i)&&(i._tree.thread=f,i._tree.mod+=j-m,d=a)}return d}var j=b.call(this,a,f),k=j[0];Kd(k,function(a,b){a._tree={ancestor:a,prelim:0,mod:0,change:0,shift:0,number:b?b._tree.number+1:0}}),g(k),h(k,-k._tree.prelim);var l=Gd(k,Id),m=Gd(k,Hd),n=Gd(k,Jd),o=l.x-c(l,m)/2,p=m.x+c(m,l)/2,q=n.depth||1;return Kd(k,e?function(a){a.x*=d[0],a.y=a.depth*d[1],delete a._tree}:function(a){a.x=(a.x-o)/(p-o)*d[0],a.y=a.depth/q*d[1],delete a._tree}),j}var b=Wf.layout.hierarchy().sort(null).value(null),c=Dd,d=[1,1],e=!1;return a.separation=function(b){return arguments.length?(c=b,a):c},a.size=function(b){return arguments.length?(e=null==(d=b),a):e?null:d},a.nodeSize=function(b){return arguments.length?(e=null!=(d=b),a):e?d:null},nd(a,b)},Wf.layout.pack=function(){function a(a,f){var g=c.call(this,a,f),h=g[0],i=e[0],j=e[1],k=null==b?Math.sqrt:"function"==typeof b?b:function(){return b};if(h.x=h.y=0,Kd(h,function(a){a.r=+k(a.value)}),Kd(h,Sd),d){var l=d*(b?1:Math.max(2*h.r/i,2*h.r/j))/2;Kd(h,function(a){a.r+=l}),Kd(h,Sd),Kd(h,function(a){a.r-=l})}return Vd(h,i/2,j/2,b?1:1/Math.max(2*h.r/i,2*h.r/j)),g}var b,c=Wf.layout.hierarchy().sort(Od),d=0,e=[1,1];return a.size=function(b){return arguments.length?(e=b,a):e},a.radius=function(c){return arguments.length?(b=null==c||"function"==typeof c?c:+c,a):b},a.padding=function(b){return arguments.length?(d=+b,a):d},nd(a,c)},Wf.layout.cluster=function(){function a(a,f){var g,h=b.call(this,a,f),i=h[0],j=0;Kd(i,function(a){var b=a.children;b&&b.length?(a.x=Yd(b),a.y=Xd(b)):(a.x=g?j+=c(a,g):0,a.y=0,g=a)});var k=Zd(i),l=$d(i),m=k.x-c(k,l)/2,n=l.x+c(l,k)/2;return Kd(i,e?function(a){a.x=(a.x-i.x)*d[0],a.y=(i.y-a.y)*d[1]}:function(a){a.x=(a.x-m)/(n-m)*d[0],a.y=(1-(i.y?a.y/i.y:1))*d[1]}),h}var b=Wf.layout.hierarchy().sort(null).value(null),c=Dd,d=[1,1],e=!1;return a.separation=function(b){return arguments.length?(c=b,a):c},a.size=function(b){return arguments.length?(e=null==(d=b),a):e?null:d},a.nodeSize=function(b){return arguments.length?(e=null!=(d=b),a):e?d:null},nd(a,b)},Wf.layout.treemap=function(){function a(a,b){for(var c,d,e=-1,f=a.length;++e<f;)d=(c=a[e]).value*(0>b?0:b),c.area=isNaN(d)||0>=d?0:d}function b(c){var f=c.children;if(f&&f.length){var g,h,i,j=l(c),k=[],m=f.slice(),o=1/0,p="slice"===n?j.dx:"dice"===n?j.dy:"slice-dice"===n?1&c.depth?j.dy:j.dx:Math.min(j.dx,j.dy);for(a(m,j.dx*j.dy/c.value),k.area=0;(i=m.length)>0;)k.push(g=m[i-1]),k.area+=g.area,"squarify"!==n||(h=d(k,p))<=o?(m.pop(),o=h):(k.area-=k.pop().area,e(k,p,j,!1),p=Math.min(j.dx,j.dy),k.length=k.area=0,o=1/0);k.length&&(e(k,p,j,!0),k.length=k.area=0),f.forEach(b)}}function c(b){var d=b.children;if(d&&d.length){var f,g=l(b),h=d.slice(),i=[];for(a(h,g.dx*g.dy/b.value),i.area=0;f=h.pop();)i.push(f),i.area+=f.area,null!=f.z&&(e(i,f.z?g.dx:g.dy,g,!h.length),i.length=i.area=0);d.forEach(c)}}function d(a,b){for(var c,d=a.area,e=0,f=1/0,g=-1,h=a.length;++g<h;)(c=a[g].area)&&(f>c&&(f=c),c>e&&(e=c));return d*=d,b*=b,d?Math.max(b*e*o/d,d/(b*f*o)):1/0}function e(a,b,c,d){var e,f=-1,g=a.length,h=c.x,j=c.y,k=b?i(a.area/b):0;if(b==c.dx){for((d||k>c.dy)&&(k=c.dy);++f<g;)e=a[f],e.x=h,e.y=j,e.dy=k,h+=e.dx=Math.min(c.x+c.dx-h,k?i(e.area/k):0);e.z=!0,e.dx+=c.x+c.dx-h,c.y+=k,c.dy-=k}else{for((d||k>c.dx)&&(k=c.dx);++f<g;)e=a[f],e.x=h,e.y=j,e.dx=k,j+=e.dy=Math.min(c.y+c.dy-j,k?i(e.area/k):0);e.z=!1,e.dy+=c.y+c.dy-j,c.x+=k,c.dx-=k}}function f(d){var e=g||h(d),f=e[0];return f.x=0,f.y=0,f.dx=j[0],f.dy=j[1],g&&h.revalue(f),a([f],f.dx*f.dy/f.value),(g?c:b)(f),m&&(g=e),e}var g,h=Wf.layout.hierarchy(),i=Math.round,j=[1,1],k=null,l=_d,m=!1,n="squarify",o=.5*(1+Math.sqrt(5));return f.size=function(a){return arguments.length?(j=a,f):j},f.padding=function(a){function b(b){var c=a.call(f,b,b.depth);return null==c?_d(b):ae(b,"number"==typeof c?[c,c,c,c]:c)}function c(b){return ae(b,a)}if(!arguments.length)return k;var d;return l=null==(k=a)?_d:"function"==(d=typeof a)?b:"number"===d?(a=[a,a,a,a],c):c,f},f.round=function(a){return arguments.length?(i=a?Math.round:Number,f):i!=Number},f.sticky=function(a){return arguments.length?(m=a,g=null,f):m},f.ratio=function(a){return arguments.length?(o=a,f):o},f.mode=function(a){return arguments.length?(n=a+"",f):n},nd(f,h)},Wf.random={normal:function(a,b){var c=arguments.length;return 2>c&&(b=1),1>c&&(a=0),function(){var c,d,e;do c=2*Math.random()-1,d=2*Math.random()-1,e=c*c+d*d;while(!e||e>1);return a+b*c*Math.sqrt(-2*Math.log(e)/e)}},logNormal:function(){var a=Wf.random.normal.apply(Wf,arguments);return function(){return Math.exp(a())}},bates:function(a){var b=Wf.random.irwinHall(a);return function(){return b()/a}},irwinHall:function(a){return function(){for(var b=0,c=0;a>c;c++)b+=Math.random();return b}}},Wf.scale={};var ki={floor:qa,ceil:qa};Wf.scale.linear=function(){return he([0,1],[0,1],Hc,!1)};var li={s:1,g:1,p:1,r:1,e:1};Wf.scale.log=function(){return pe(Wf.scale.linear().domain([0,1]),10,!0,[1,10])};var mi=Wf.format(".0e"),ni={floor:function(a){return-Math.ceil(-a)},ceil:function(a){return-Math.floor(-a)}};Wf.scale.pow=function(){return qe(Wf.scale.linear(),1,[0,1])},Wf.scale.sqrt=function(){return Wf.scale.pow().exponent(.5)},Wf.scale.ordinal=function(){return se([],{t:"range",a:[[]]})},Wf.scale.category10=function(){return Wf.scale.ordinal().range(oi)},Wf.scale.category20=function(){return Wf.scale.ordinal().range(pi)},Wf.scale.category20b=function(){return Wf.scale.ordinal().range(qi)},Wf.scale.category20c=function(){return Wf.scale.ordinal().range(ri)};var oi=[2062260,16744206,2924588,14034728,9725885,9197131,14907330,8355711,12369186,1556175].map(ga),pi=[2062260,11454440,16744206,16759672,2924588,10018698,14034728,16750742,9725885,12955861,9197131,12885140,14907330,16234194,8355711,13092807,12369186,14408589,1556175,10410725].map(ga),qi=[3750777,5395619,7040719,10264286,6519097,9216594,11915115,13556636,9202993,12426809,15186514,15190932,8666169,11356490,14049643,15177372,8077683,10834324,13528509,14589654].map(ga),ri=[3244733,7057110,10406625,13032431,15095053,16616764,16625259,16634018,3253076,7652470,10607003,13101504,7695281,10394312,12369372,14342891,6513507,9868950,12434877,14277081].map(ga);Wf.scale.quantile=function(){return te([],[])},Wf.scale.quantize=function(){return ue(0,1,[0,1])},Wf.scale.threshold=function(){return ve([.5],[0,1])},Wf.scale.identity=function(){return we([0,1])},Wf.svg={},Wf.svg.arc=function(){function a(){var a=b.apply(this,arguments),f=c.apply(this,arguments),g=d.apply(this,arguments)+si,h=e.apply(this,arguments)+si,i=(g>h&&(i=g,g=h,h=i),h-g),j=Ag>i?"0":"1",k=Math.cos(g),l=Math.sin(g),m=Math.cos(h),n=Math.sin(h);return i>=ti?a?"M0,"+f+"A"+f+","+f+" 0 1,1 0,"+-f+"A"+f+","+f+" 0 1,1 0,"+f+"M0,"+a+"A"+a+","+a+" 0 1,0 0,"+-a+"A"+a+","+a+" 0 1,0 0,"+a+"Z":"M0,"+f+"A"+f+","+f+" 0 1,1 0,"+-f+"A"+f+","+f+" 0 1,1 0,"+f+"Z":a?"M"+f*k+","+f*l+"A"+f+","+f+" 0 "+j+",1 "+f*m+","+f*n+"L"+a*m+","+a*n+"A"+a+","+a+" 0 "+j+",0 "+a*k+","+a*l+"Z":"M"+f*k+","+f*l+"A"+f+","+f+" 0 "+j+",1 "+f*m+","+f*n+"L0,0Z"}var b=xe,c=ye,d=ze,e=Ae;return a.innerRadius=function(c){return arguments.length?(b=pa(c),a):b},a.outerRadius=function(b){return arguments.length?(c=pa(b),a):c},a.startAngle=function(b){return arguments.length?(d=pa(b),a):d},a.endAngle=function(b){return arguments.length?(e=pa(b),a):e},a.centroid=function(){var a=(b.apply(this,arguments)+c.apply(this,arguments))/2,f=(d.apply(this,arguments)+e.apply(this,arguments))/2+si;return[Math.cos(f)*a,Math.sin(f)*a]},a};var si=-Cg,ti=Bg-Dg;Wf.svg.line=function(){return Be(qa)};var ui=Wf.map({linear:Ce,"linear-closed":De,step:Ee,"step-before":Fe,"step-after":Ge,basis:Me,"basis-open":Ne,"basis-closed":Oe,bundle:Pe,cardinal:Je,"cardinal-open":He,"cardinal-closed":Ie,monotone:Ve});ui.forEach(function(a,b){b.key=a,b.closed=/-closed$/.test(a)});var vi=[0,2/3,1/3,0],wi=[0,1/3,2/3,0],xi=[0,1/6,2/3,1/6];Wf.svg.line.radial=function(){var a=Be(We);return a.radius=a.x,delete a.x,a.angle=a.y,delete a.y,a},Fe.reverse=Ge,Ge.reverse=Fe,Wf.svg.area=function(){return Xe(qa)},Wf.svg.area.radial=function(){var a=Xe(We);return a.radius=a.x,delete a.x,a.innerRadius=a.x0,delete a.x0,a.outerRadius=a.x1,delete a.x1,a.angle=a.y,delete a.y,a.startAngle=a.y0,delete a.y0,a.endAngle=a.y1,delete a.y1,a},Wf.svg.chord=function(){function a(a,h){var i=b(this,f,a,h),j=b(this,g,a,h);return"M"+i.p0+d(i.r,i.p1,i.a1-i.a0)+(c(i,j)?e(i.r,i.p1,i.r,i.p0):e(i.r,i.p1,j.r,j.p0)+d(j.r,j.p1,j.a1-j.a0)+e(j.r,j.p1,i.r,i.p0))+"Z"}function b(a,b,c,d){var e=b.call(a,c,d),f=h.call(a,e,d),g=i.call(a,e,d)+si,k=j.call(a,e,d)+si;return{r:f,a0:g,a1:k,p0:[f*Math.cos(g),f*Math.sin(g)],p1:[f*Math.cos(k),f*Math.sin(k)]}}function c(a,b){return a.a0==b.a0&&a.a1==b.a1}function d(a,b,c){return"A"+a+","+a+" 0 "+ +(c>Ag)+",1 "+b}function e(a,b,c,d){return"Q 0,0 "+d}var f=Jb,g=Kb,h=Ye,i=ze,j=Ae;return a.radius=function(b){return arguments.length?(h=pa(b),a):h},a.source=function(b){return arguments.length?(f=pa(b),a):f},a.target=function(b){return arguments.length?(g=pa(b),a):g},a.startAngle=function(b){return arguments.length?(i=pa(b),a):i},a.endAngle=function(b){return arguments.length?(j=pa(b),a):j},a},Wf.svg.diagonal=function(){function a(a,e){var f=b.call(this,a,e),g=c.call(this,a,e),h=(f.y+g.y)/2,i=[f,{x:f.x,y:h},{x:g.x,y:h},g];return i=i.map(d),"M"+i[0]+"C"+i[1]+" "+i[2]+" "+i[3]}var b=Jb,c=Kb,d=Ze;return a.source=function(c){return arguments.length?(b=pa(c),a):b},a.target=function(b){return arguments.length?(c=pa(b),a):c},a.projection=function(b){return arguments.length?(d=b,a):d},a},Wf.svg.diagonal.radial=function(){var a=Wf.svg.diagonal(),b=Ze,c=a.projection;return a.projection=function(a){return arguments.length?c($e(b=a)):b},a},Wf.svg.symbol=function(){function a(a,d){return(yi.get(b.call(this,a,d))||bf)(c.call(this,a,d))}var b=af,c=_e;return a.type=function(c){return arguments.length?(b=pa(c),a):b},a.size=function(b){return arguments.length?(c=pa(b),a):c},a};var yi=Wf.map({circle:bf,cross:function(a){var b=Math.sqrt(a/5)/2;return"M"+-3*b+","+-b+"H"+-b+"V"+-3*b+"H"+b+"V"+-b+"H"+3*b+"V"+b+"H"+b+"V"+3*b+"H"+-b+"V"+b+"H"+-3*b+"Z"},diamond:function(a){var b=Math.sqrt(a/(2*Ci)),c=b*Ci;return"M0,"+-b+"L"+c+",0 0,"+b+" "+-c+",0Z"},square:function(a){
var b=Math.sqrt(a)/2;return"M"+-b+","+-b+"L"+b+","+-b+" "+b+","+b+" "+-b+","+b+"Z"},"triangle-down":function(a){var b=Math.sqrt(a/Bi),c=b*Bi/2;return"M0,"+c+"L"+b+","+-c+" "+-b+","+-c+"Z"},"triangle-up":function(a){var b=Math.sqrt(a/Bi),c=b*Bi/2;return"M0,"+-c+"L"+b+","+c+" "+-b+","+c+"Z"}});Wf.svg.symbolTypes=yi.keys();var zi,Ai,Bi=Math.sqrt(3),Ci=Math.tan(30*Fg),Di=[],Ei=0;Di.call=sg.call,Di.empty=sg.empty,Di.node=sg.node,Di.size=sg.size,Wf.transition=function(a){return arguments.length?zi?a.transition():a:vg.transition()},Wf.transition.prototype=Di,Di.select=function(a){var b,c,d,e=this.id,f=[];a=p(a);for(var g=-1,h=this.length;++g<h;){f.push(b=[]);for(var i=this[g],j=-1,k=i.length;++j<k;)(d=i[j])&&(c=a.call(d,d.__data__,j,g))?("__data__"in d&&(c.__data__=d.__data__),ff(c,j,e,d.__transition__[e]),b.push(c)):b.push(null)}return cf(f,e)},Di.selectAll=function(a){var b,c,d,e,f,g=this.id,h=[];a=q(a);for(var i=-1,j=this.length;++i<j;)for(var k=this[i],l=-1,m=k.length;++l<m;)if(d=k[l]){f=d.__transition__[g],c=a.call(d,d.__data__,l,i),h.push(b=[]);for(var n=-1,o=c.length;++n<o;)(e=c[n])&&ff(e,n,g,f),b.push(e)}return cf(h,g)},Di.filter=function(a){var b,c,d,e=[];"function"!=typeof a&&(a=B(a));for(var f=0,g=this.length;g>f;f++){e.push(b=[]);for(var c=this[f],h=0,i=c.length;i>h;h++)(d=c[h])&&a.call(d,d.__data__,h,f)&&b.push(d)}return cf(e,this.id)},Di.tween=function(a,b){var c=this.id;return arguments.length<2?this.node().__transition__[c].tween.get(a):D(this,null==b?function(b){b.__transition__[c].tween.remove(a)}:function(d){d.__transition__[c].tween.set(a,b)})},Di.attr=function(a,b){function c(){this.removeAttribute(h)}function d(){this.removeAttributeNS(h.space,h.local)}function e(a){return null==a?c:(a+="",function(){var b,c=this.getAttribute(h);return c!==a&&(b=g(c,a),function(a){this.setAttribute(h,b(a))})})}function f(a){return null==a?d:(a+="",function(){var b,c=this.getAttributeNS(h.space,h.local);return c!==a&&(b=g(c,a),function(a){this.setAttributeNS(h.space,h.local,b(a))})})}if(arguments.length<2){for(b in a)this.attr(b,a[b]);return this}var g="transform"==a?cd:Hc,h=Wf.ns.qualify(a);return df(this,"attr."+a,b,h.local?f:e)},Di.attrTween=function(a,b){function c(a,c){var d=b.call(this,a,c,this.getAttribute(e));return d&&function(a){this.setAttribute(e,d(a))}}function d(a,c){var d=b.call(this,a,c,this.getAttributeNS(e.space,e.local));return d&&function(a){this.setAttributeNS(e.space,e.local,d(a))}}var e=Wf.ns.qualify(a);return this.tween("attr."+a,e.local?d:c)},Di.style=function(a,b,c){function d(){this.style.removeProperty(a)}function e(b){return null==b?d:(b+="",function(){var d,e=_f.getComputedStyle(this,null).getPropertyValue(a);return e!==b&&(d=Hc(e,b),function(b){this.style.setProperty(a,d(b),c)})})}var f=arguments.length;if(3>f){if("string"!=typeof a){2>f&&(b="");for(c in a)this.style(c,a[c],b);return this}c=""}return df(this,"style."+a,b,e)},Di.styleTween=function(a,b,c){function d(d,e){var f=b.call(this,d,e,_f.getComputedStyle(this,null).getPropertyValue(a));return f&&function(b){this.style.setProperty(a,f(b),c)}}return arguments.length<3&&(c=""),this.tween("style."+a,d)},Di.text=function(a){return df(this,"text",a,ef)},Di.remove=function(){return this.each("end.transition",function(){var a;this.__transition__.count<2&&(a=this.parentNode)&&a.removeChild(this)})},Di.ease=function(a){var b=this.id;return arguments.length<1?this.node().__transition__[b].ease:("function"!=typeof a&&(a=Wf.ease.apply(Wf,arguments)),D(this,function(c){c.__transition__[b].ease=a}))},Di.delay=function(a){var b=this.id;return D(this,"function"==typeof a?function(c,d,e){c.__transition__[b].delay=+a.call(c,c.__data__,d,e)}:(a=+a,function(c){c.__transition__[b].delay=a}))},Di.duration=function(a){var b=this.id;return D(this,"function"==typeof a?function(c,d,e){c.__transition__[b].duration=Math.max(1,a.call(c,c.__data__,d,e))}:(a=Math.max(1,a),function(c){c.__transition__[b].duration=a}))},Di.each=function(a,b){var c=this.id;if(arguments.length<2){var d=Ai,e=zi;zi=c,D(this,function(b,d,e){Ai=b.__transition__[c],a.call(b,b.__data__,d,e)}),Ai=d,zi=e}else D(this,function(d){var e=d.__transition__[c];(e.event||(e.event=Wf.dispatch("start","end"))).on(a,b)});return this},Di.transition=function(){for(var a,b,c,d,e=this.id,f=++Ei,g=[],h=0,i=this.length;i>h;h++){g.push(a=[]);for(var b=this[h],j=0,k=b.length;k>j;j++)(c=b[j])&&(d=Object.create(c.__transition__[e]),d.delay+=d.duration,ff(c,j,f,d)),a.push(c)}return cf(g,f)},Wf.svg.axis=function(){function a(a){a.each(function(){var a,j=Wf.select(this),k=this.__chart__||c,l=this.__chart__=c.copy(),m=null==i?l.ticks?l.ticks.apply(l,h):l.domain():i,n=null==b?l.tickFormat?l.tickFormat.apply(l,h):qa:b,o=j.selectAll(".tick").data(m,l),p=o.enter().insert("g",".domain").attr("class","tick").style("opacity",Dg),q=Wf.transition(o.exit()).style("opacity",Dg).remove(),r=Wf.transition(o).style("opacity",1),s=ce(l),t=j.selectAll(".domain").data([0]),u=(t.enter().append("path").attr("class","domain"),Wf.transition(t));p.append("line"),p.append("text");var v=p.select("line"),w=r.select("line"),x=o.select("text").text(n),y=p.select("text"),z=r.select("text");switch(d){case"bottom":a=gf,v.attr("y2",e),y.attr("y",Math.max(e,0)+g),w.attr("x2",0).attr("y2",e),z.attr("x",0).attr("y",Math.max(e,0)+g),x.attr("dy",".71em").style("text-anchor","middle"),u.attr("d","M"+s[0]+","+f+"V0H"+s[1]+"V"+f);break;case"top":a=gf,v.attr("y2",-e),y.attr("y",-(Math.max(e,0)+g)),w.attr("x2",0).attr("y2",-e),z.attr("x",0).attr("y",-(Math.max(e,0)+g)),x.attr("dy","0em").style("text-anchor","middle"),u.attr("d","M"+s[0]+","+-f+"V0H"+s[1]+"V"+-f);break;case"left":a=hf,v.attr("x2",-e),y.attr("x",-(Math.max(e,0)+g)),w.attr("x2",-e).attr("y2",0),z.attr("x",-(Math.max(e,0)+g)).attr("y",0),x.attr("dy",".32em").style("text-anchor","end"),u.attr("d","M"+-f+","+s[0]+"H0V"+s[1]+"H"+-f);break;case"right":a=hf,v.attr("x2",e),y.attr("x",Math.max(e,0)+g),w.attr("x2",e).attr("y2",0),z.attr("x",Math.max(e,0)+g).attr("y",0),x.attr("dy",".32em").style("text-anchor","start"),u.attr("d","M"+f+","+s[0]+"H0V"+s[1]+"H"+f)}if(l.rangeBand){var A=l,B=A.rangeBand()/2;k=l=function(a){return A(a)+B}}else k.rangeBand?k=l:q.call(a,l);p.call(a,k),r.call(a,l)})}var b,c=Wf.scale.linear(),d=Fi,e=6,f=6,g=3,h=[10],i=null;return a.scale=function(b){return arguments.length?(c=b,a):c},a.orient=function(b){return arguments.length?(d=b in Gi?b+"":Fi,a):d},a.ticks=function(){return arguments.length?(h=arguments,a):h},a.tickValues=function(b){return arguments.length?(i=b,a):i},a.tickFormat=function(c){return arguments.length?(b=c,a):b},a.tickSize=function(b){var c=arguments.length;return c?(e=+b,f=+arguments[c-1],a):e},a.innerTickSize=function(b){return arguments.length?(e=+b,a):e},a.outerTickSize=function(b){return arguments.length?(f=+b,a):f},a.tickPadding=function(b){return arguments.length?(g=+b,a):g},a.tickSubdivide=function(){return arguments.length&&a},a};var Fi="bottom",Gi={top:1,right:1,bottom:1,left:1};Wf.svg.brush=function(){function a(f){f.each(function(){var f=Wf.select(this).style("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush",e).on("touchstart.brush",e),g=f.selectAll(".background").data([0]);g.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair"),f.selectAll(".extent").data([0]).enter().append("rect").attr("class","extent").style("cursor","move");var h=f.selectAll(".resize").data(q,qa);h.exit().remove(),h.enter().append("g").attr("class",function(a){return"resize "+a}).style("cursor",function(a){return Hi[a]}).append("rect").attr("x",function(a){return/[ew]$/.test(a)?-3:null}).attr("y",function(a){return/^[ns]/.test(a)?-3:null}).attr("width",6).attr("height",6).style("visibility","hidden"),h.style("display",a.empty()?"none":null);var k,l=Wf.transition(f),m=Wf.transition(g);i&&(k=ce(i),m.attr("x",k[0]).attr("width",k[1]-k[0]),c(l)),j&&(k=ce(j),m.attr("y",k[0]).attr("height",k[1]-k[0]),d(l)),b(l)})}function b(a){a.selectAll(".resize").attr("transform",function(a){return"translate("+k[+/e$/.test(a)]+","+m[+/^s/.test(a)]+")"})}function c(a){a.select(".extent").attr("x",k[0]),a.selectAll(".extent,.n>rect,.s>rect").attr("width",k[1]-k[0])}function d(a){a.select(".extent").attr("y",m[0]),a.selectAll(".extent,.e>rect,.w>rect").attr("height",m[1]-m[0])}function e(){function e(){32==Wf.event.keyCode&&(C||(t=null,E[0]-=k[1],E[1]-=m[1],C=2),l())}function n(){32==Wf.event.keyCode&&2==C&&(E[0]+=k[1],E[1]+=m[1],C=0,l())}function q(){var a=Wf.mouse(v),e=!1;u&&(a[0]+=u[0],a[1]+=u[1]),C||(Wf.event.altKey?(t||(t=[(k[0]+k[1])/2,(m[0]+m[1])/2]),E[0]=k[+(a[0]<t[0])],E[1]=m[+(a[1]<t[1])]):t=null),A&&r(a,i,0)&&(c(y),e=!0),B&&r(a,j,1)&&(d(y),e=!0),e&&(b(y),x({type:"brush",mode:C?"move":"resize"}))}function r(a,b,c){var d,e,h=ce(b),i=h[0],j=h[1],l=E[c],n=c?m:k,q=n[1]-n[0];return C&&(i-=l,j-=q+l),d=(c?p:o)?Math.max(i,Math.min(j,a[c])):a[c],C?e=(d+=l)+q:(t&&(l=Math.max(i,Math.min(j,2*t[c]-d))),d>l?(e=d,d=l):e=l),n[0]!=d||n[1]!=e?(c?g=null:f=null,n[0]=d,n[1]=e,!0):void 0}function s(){q(),y.style("pointer-events","all").selectAll(".resize").style("display",a.empty()?"none":null),Wf.select("body").style("cursor",null),F.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null),D(),x({type:"brushend"})}var t,u,v=this,w=Wf.select(Wf.event.target),x=h.of(v,arguments),y=Wf.select(v),z=w.datum(),A=!/^(n|s)$/.test(z)&&i,B=!/^(e|w)$/.test(z)&&j,C=w.classed("extent"),D=K(),E=Wf.mouse(v),F=Wf.select(_f).on("keydown.brush",e).on("keyup.brush",n);if(Wf.event.changedTouches?F.on("touchmove.brush",q).on("touchend.brush",s):F.on("mousemove.brush",q).on("mouseup.brush",s),y.interrupt().selectAll("*").interrupt(),C)E[0]=k[0]-E[0],E[1]=m[0]-E[1];else if(z){var G=+/w$/.test(z),H=+/^n/.test(z);u=[k[1-G]-E[0],m[1-H]-E[1]],E[0]=k[G],E[1]=m[H]}else Wf.event.altKey&&(t=E.slice());y.style("pointer-events","none").selectAll(".resize").style("display",null),Wf.select("body").style("cursor",w.style("cursor")),x({type:"brushstart"}),q()}var f,g,h=n(a,"brushstart","brush","brushend"),i=null,j=null,k=[0,0],m=[0,0],o=!0,p=!0,q=Ii[0];return a.event=function(a){a.each(function(){var a=h.of(this,arguments),b={x:k,y:m,i:f,j:g},c=this.__chart__||b;this.__chart__=b,zi?Wf.select(this).transition().each("start.brush",function(){f=c.i,g=c.j,k=c.x,m=c.y,a({type:"brushstart"})}).tween("brush:brush",function(){var c=Ic(k,b.x),d=Ic(m,b.y);return f=g=null,function(e){k=b.x=c(e),m=b.y=d(e),a({type:"brush",mode:"resize"})}}).each("end.brush",function(){f=b.i,g=b.j,a({type:"brush",mode:"resize"}),a({type:"brushend"})}):(a({type:"brushstart"}),a({type:"brush",mode:"resize"}),a({type:"brushend"}))})},a.x=function(b){return arguments.length?(i=b,q=Ii[!i<<1|!j],a):i},a.y=function(b){return arguments.length?(j=b,q=Ii[!i<<1|!j],a):j},a.clamp=function(b){return arguments.length?(i&&j?(o=!!b[0],p=!!b[1]):i?o=!!b:j&&(p=!!b),a):i&&j?[o,p]:i?o:j?p:null},a.extent=function(b){var c,d,e,h,l;return arguments.length?(i&&(c=b[0],d=b[1],j&&(c=c[0],d=d[0]),f=[c,d],i.invert&&(c=i(c),d=i(d)),c>d&&(l=c,c=d,d=l),(c!=k[0]||d!=k[1])&&(k=[c,d])),j&&(e=b[0],h=b[1],i&&(e=e[1],h=h[1]),g=[e,h],j.invert&&(e=j(e),h=j(h)),e>h&&(l=e,e=h,h=l),(e!=m[0]||h!=m[1])&&(m=[e,h])),a):(i&&(f?(c=f[0],d=f[1]):(c=k[0],d=k[1],i.invert&&(c=i.invert(c),d=i.invert(d)),c>d&&(l=c,c=d,d=l))),j&&(g?(e=g[0],h=g[1]):(e=m[0],h=m[1],j.invert&&(e=j.invert(e),h=j.invert(h)),e>h&&(l=e,e=h,h=l))),i&&j?[[c,e],[d,h]]:i?[c,d]:j&&[e,h])},a.clear=function(){return a.empty()||(k=[0,0],m=[0,0],f=g=null),a},a.empty=function(){return!!i&&k[0]==k[1]||!!j&&m[0]==m[1]},Wf.rebind(a,h,"on")};var Hi={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},Ii=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]],Ji=Wf.time={},Ki=Date,Li=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];jf.prototype={getDate:function(){return this._.getUTCDate()},getDay:function(){return this._.getUTCDay()},getFullYear:function(){return this._.getUTCFullYear()},getHours:function(){return this._.getUTCHours()},getMilliseconds:function(){return this._.getUTCMilliseconds()},getMinutes:function(){return this._.getUTCMinutes()},getMonth:function(){return this._.getUTCMonth()},getSeconds:function(){return this._.getUTCSeconds()},getTime:function(){return this._.getTime()},getTimezoneOffset:function(){return 0},valueOf:function(){return this._.valueOf()},setDate:function(){Mi.setUTCDate.apply(this._,arguments)},setDay:function(){Mi.setUTCDay.apply(this._,arguments)},setFullYear:function(){Mi.setUTCFullYear.apply(this._,arguments)},setHours:function(){Mi.setUTCHours.apply(this._,arguments)},setMilliseconds:function(){Mi.setUTCMilliseconds.apply(this._,arguments)},setMinutes:function(){Mi.setUTCMinutes.apply(this._,arguments)},setMonth:function(){Mi.setUTCMonth.apply(this._,arguments)},setSeconds:function(){Mi.setUTCSeconds.apply(this._,arguments)},setTime:function(){Mi.setTime.apply(this._,arguments)}};var Mi=Date.prototype,Ni="%a %b %e %X %Y",Oi="%m/%d/%Y",Pi="%H:%M:%S",Qi=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],Ri=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],Si=["January","February","March","April","May","June","July","August","September","October","November","December"],Ti=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];Ji.year=kf(function(a){return a=Ji.day(a),a.setMonth(0,1),a},function(a,b){a.setFullYear(a.getFullYear()+b)},function(a){return a.getFullYear()}),Ji.years=Ji.year.range,Ji.years.utc=Ji.year.utc.range,Ji.day=kf(function(a){var b=new Ki(2e3,0);return b.setFullYear(a.getFullYear(),a.getMonth(),a.getDate()),b},function(a,b){a.setDate(a.getDate()+b)},function(a){return a.getDate()-1}),Ji.days=Ji.day.range,Ji.days.utc=Ji.day.utc.range,Ji.dayOfYear=function(a){var b=Ji.year(a);return Math.floor((a-b-6e4*(a.getTimezoneOffset()-b.getTimezoneOffset()))/864e5)},Li.forEach(function(a,b){a=a.toLowerCase(),b=7-b;var c=Ji[a]=kf(function(a){return(a=Ji.day(a)).setDate(a.getDate()-(a.getDay()+b)%7),a},function(a,b){a.setDate(a.getDate()+7*Math.floor(b))},function(a){var c=Ji.year(a).getDay();return Math.floor((Ji.dayOfYear(a)+(c+b)%7)/7)-(c!==b)});Ji[a+"s"]=c.range,Ji[a+"s"].utc=c.utc.range,Ji[a+"OfYear"]=function(a){var c=Ji.year(a).getDay();return Math.floor((Ji.dayOfYear(a)+(c+b)%7)/7)}}),Ji.week=Ji.sunday,Ji.weeks=Ji.sunday.range,Ji.weeks.utc=Ji.sunday.utc.range,Ji.weekOfYear=Ji.sundayOfYear,Ji.format=mf;var Ui=of(Qi),Vi=pf(Qi),Wi=of(Ri),Xi=pf(Ri),Yi=of(Si),Zi=pf(Si),$i=of(Ti),_i=pf(Ti),aj=/^%/,bj={"-":"",_:" ",0:"0"},cj={a:function(a){return Ri[a.getDay()]},A:function(a){return Qi[a.getDay()]},b:function(a){return Ti[a.getMonth()]},B:function(a){return Si[a.getMonth()]},c:mf(Ni),d:function(a,b){return qf(a.getDate(),b,2)},e:function(a,b){return qf(a.getDate(),b,2)},H:function(a,b){return qf(a.getHours(),b,2)},I:function(a,b){return qf(a.getHours()%12||12,b,2)},j:function(a,b){return qf(1+Ji.dayOfYear(a),b,3)},L:function(a,b){return qf(a.getMilliseconds(),b,3)},m:function(a,b){return qf(a.getMonth()+1,b,2)},M:function(a,b){return qf(a.getMinutes(),b,2)},p:function(a){return a.getHours()>=12?"PM":"AM"},S:function(a,b){return qf(a.getSeconds(),b,2)},U:function(a,b){return qf(Ji.sundayOfYear(a),b,2)},w:function(a){return a.getDay()},W:function(a,b){return qf(Ji.mondayOfYear(a),b,2)},x:mf(Oi),X:mf(Pi),y:function(a,b){return qf(a.getFullYear()%100,b,2)},Y:function(a,b){return qf(a.getFullYear()%1e4,b,4)},Z:Nf,"%":function(){return"%"}},dj={a:rf,A:sf,b:wf,B:xf,c:yf,d:Gf,e:Gf,H:If,I:If,j:Hf,L:Lf,m:Ff,M:Jf,p:Mf,S:Kf,U:uf,w:tf,W:vf,x:zf,X:Af,y:Cf,Y:Bf,Z:Df,"%":Of},ej=/^\s*\d+/,fj=Wf.map({am:0,pm:1});mf.utc=Pf;var gj=Pf("%Y-%m-%dT%H:%M:%S.%LZ");mf.iso=Date.prototype.toISOString&&+new Date("2000-01-01T00:00:00.000Z")?Qf:gj,Qf.parse=function(a){var b=new Date(a);return isNaN(b)?null:b},Qf.toString=gj.toString,Ji.second=kf(function(a){return new Ki(1e3*Math.floor(a/1e3))},function(a,b){a.setTime(a.getTime()+1e3*Math.floor(b))},function(a){return a.getSeconds()}),Ji.seconds=Ji.second.range,Ji.seconds.utc=Ji.second.utc.range,Ji.minute=kf(function(a){return new Ki(6e4*Math.floor(a/6e4))},function(a,b){a.setTime(a.getTime()+6e4*Math.floor(b))},function(a){return a.getMinutes()}),Ji.minutes=Ji.minute.range,Ji.minutes.utc=Ji.minute.utc.range,Ji.hour=kf(function(a){var b=a.getTimezoneOffset()/60;return new Ki(36e5*(Math.floor(a/36e5-b)+b))},function(a,b){a.setTime(a.getTime()+36e5*Math.floor(b))},function(a){return a.getHours()}),Ji.hours=Ji.hour.range,Ji.hours.utc=Ji.hour.utc.range,Ji.month=kf(function(a){return a=Ji.day(a),a.setDate(1),a},function(a,b){a.setMonth(a.getMonth()+b)},function(a){return a.getMonth()}),Ji.months=Ji.month.range,Ji.months.utc=Ji.month.utc.range;var hj=[1e3,5e3,15e3,3e4,6e4,3e5,9e5,18e5,36e5,108e5,216e5,432e5,864e5,1728e5,6048e5,2592e6,7776e6,31536e6],ij=[[Ji.second,1],[Ji.second,5],[Ji.second,15],[Ji.second,30],[Ji.minute,1],[Ji.minute,5],[Ji.minute,15],[Ji.minute,30],[Ji.hour,1],[Ji.hour,3],[Ji.hour,6],[Ji.hour,12],[Ji.day,1],[Ji.day,2],[Ji.week,1],[Ji.month,1],[Ji.month,3],[Ji.year,1]],jj=[[mf("%Y"),Ta],[mf("%B"),function(a){return a.getMonth()}],[mf("%b %d"),function(a){return 1!=a.getDate()}],[mf("%a %d"),function(a){return a.getDay()&&1!=a.getDate()}],[mf("%I %p"),function(a){return a.getHours()}],[mf("%I:%M"),function(a){return a.getMinutes()}],[mf(":%S"),function(a){return a.getSeconds()}],[mf(".%L"),function(a){return a.getMilliseconds()}]],kj=Tf(jj);ij.year=Ji.year,Ji.scale=function(){return Rf(Wf.scale.linear(),ij,kj)};var lj={range:function(a,b,c){return Wf.range(+a,+b,c).map(Sf)},floor:qa,ceil:qa},mj=ij.map(function(a){return[a[0].utc,a[1]]}),nj=[[Pf("%Y"),Ta],[Pf("%B"),function(a){return a.getUTCMonth()}],[Pf("%b %d"),function(a){return 1!=a.getUTCDate()}],[Pf("%a %d"),function(a){return a.getUTCDay()&&1!=a.getUTCDate()}],[Pf("%I %p"),function(a){return a.getUTCHours()}],[Pf("%I:%M"),function(a){return a.getUTCMinutes()}],[Pf(":%S"),function(a){return a.getUTCSeconds()}],[Pf(".%L"),function(a){return a.getUTCMilliseconds()}]],oj=Tf(nj);return mj.year=Ji.year.utc,Ji.scale.utc=function(){return Rf(Wf.scale.linear(),mj,oj)},Wf.text=ra(function(a){return a.responseText}),Wf.json=function(a,b){return sa(a,"application/json",Uf,b)},Wf.html=function(a,b){return sa(a,"text/html",Vf,b)},Wf.xml=ra(function(a){return a.responseXML}),Wf}(),function(){function a(a){return function(){if("touchstart"===d3.event.type){M=b(d3.event),Q=O=M.pageX,R=P=M.pageY,N=!0;var c=d3.event;setTimeout(function(){Q!==O||N||R!==P||(d3.event=c,a.apply(this,arguments))},200)}"touchend"===d3.event.type&&N&&(N=!1),"touchmove"===d3.event.type&&N&&(M=b(d3.event),O=M.pageX,P=M.pageY)}}function b(a){return a.touches?a.touches[0]:a}function c(a){return a[0]}function d(a){return a[1]}function e(a){return a[2]}function f(){return!0}function g(){return 0}function h(a){return a[0]}function i(a){return a[1]}function j(a){return a[2]}function k(a){return a[3]}function l(){return!0}function m(a,b,c,d){return"M"+a+","+c+"L"+b+","+c+"L"+b+","+d+"L"+a+","+d+"Z"}function n(){return 64}function o(){return"circle"}function p(a){return a[0]}function q(a){return a[1]}function r(a){return!0}function s(a){return a[0]}function t(a){return a[1]}function u(a){return a[2]}function v(a){return a[3]}function w(){return!1}function z(){return!0}function A(a,b,c,d,e){var f;return e?(f=c+(d-c)/2,"M"+a+","+c+"L"+a+","+d+"M"+a+","+f+"L"+b+","+f+"M"+b+","+c+"L"+b+","+d):(f=a+(b-a)/2,"M"+a+","+c+"L"+b+","+c+"M"+f+","+c+"L"+f+","+d+"M"+a+","+d+"L"+b+","+d)}function B(a){return!0}function C(a){return a[0]}function D(a){return a[1]}function E(a,b){for(var c=d3.max([a.length,b.length]),d="M",e=0;c>e;e++)e>0&&(d+="L"),d+=e<a.length?a[e]:"0",d+=",",d+=e<b.length?b[e]:"0";return d+="Z"}function F(){}function G(a){function b(){for(var b,d=c,e=-1,f=d.length;++e<f;)(b=d[e].on)&&b.apply(this,arguments);return a}var c=[],d=new d3.map;return b.on=function(b,e){var f,g=d.get(b);return arguments.length<2?g&&g.on:(g&&(g.on=null,c=c.slice(0,f=c.indexOf(g)).concat(c.slice(f+1)),d.remove(b)),e&&c.push(d.set(b,{on:e})),a)},b}function H(a){for(var b=new F,c=0,d=arguments.length;++c<d;)b[arguments[c]]=G(b);return b.of=function(c,d){return function(e){var f;try{f=e.sourceEvent=d3.event,e.target=a,d3.event=e,b[e.type].apply(c,d)}finally{d3.event=f}}},b}function I(){d3.event.stopPropagation(),d3.event.preventDefault()}var J=d3.selection.prototype,K=J.on,L={tap:[["touchstart","touchend","touchmove"],a]},M=null,N=!1,O=0,P=0,Q=0,R=0;J.on=function(a,b,c){var d=a.split("."),e=d.shift(),f=L[e];if(f){var g=f[0],h=this;return b=f[1].call(null,b),g.forEach(function(a,e){var f=[a,d].join(".");K.call(h,f,b,c)}),K}return K.apply(this,arguments)},dv=function(){},dv.version="3.2.0",dv.ANIMATION=!0;var S=!1,T=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/;dv.extend=function(a){function b(){if(!S){S=!0;var a=new arguments.callee;return S=!1,a.init.apply(a,arguments),a}}var c=this.prototype;S=!0;var d=new this;a=a(),a.init=a,S=!1;for(var e in a)d[e]="function"==typeof a[e]&&"function"==typeof c[e]&&T.test(a[e])?function(a,b){return function(){var d=this._super;this._super=c[a];var e=b.apply(this,arguments);return this._super=d,e}}(e,a[e]):a[e];return b.prototype=d,b.mixin=function(a,b){dv.util.isObject(a)?dv.util.each(a,function(a,c){d[c]=b}):d[a]=b},b.extend=arguments.callee,b},dv.DEFAULT_COLORS=["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf"],dv.DEFAULT_CATEGORICAL_AES=["color","fill","stroke","shape","size","linetype"],dv.absoluteCoordinates=function(a,b,c){if(a.coord()instanceof dv.coord.polar){var d=a.coord().flip()?c.yOuterScale():c.xOuterScale(),e=a.coord().flip()?c.xOuterScale():c.yOuterScale(),f=dv.util.scaleRangeNoReverse(d),g=dv.util.scaleRangeNoReverse(e);b[0]+=(f[0]+f[1])/2,b[1]+=(g[0]+g[1])/2}return b},dv.showTooltip=function(a,b,c,d,e,f){var g=f.selectAll(".dv-tooltip").data([a]);a.cx=a.cx||a.x+a.width/2,a.cy=a.cy||a.y+a.height/2,a.dx=a.dx||a.x+a.width,a.dy=a.dy||a.y+a.height,b.dx=b.dy||b.x+b.width,b.dy=b.dy||b.y+b.height;var h=g.enter().append("div").classed("dv-tooltip",!0).style("top",0).style("left",0);h.append("div").classed("content",!0),h.append("b").classed("notch",!0),g.select(".content").html(c);var i=g.select(".notch"),j=g.node(),k=j.offsetWidth,l=j.offsetHeight,m=0,n=0,o=function(a,b,c){return Math.min(Math.max(b,a),c)};switch(d){case"left":n=a.x-k-e,m=a.cy-l/2,n<b.x&&(n=a.dx+e,d="right"),m<b.y&&(m=b.y),m+l>b.dy&&(m=b.dy-l),i.style("top",o(a.cy-m-5,3,l-13)+"px");break;case"right":n=a.x+a.width+e,m=a.cy-l/2,n+k>b.dx&&(n=a.x-k-e,d="left"),m<b.y&&(m=b.y),m+l>b.dy&&(m=b.dy-l),i.style("top",o(a.cy-m-5,3,l-13)+"px");break;case"top":n=a.cx-k/2,m=a.y-l-e,m<b.y&&(m=a.dy+e,d="bottom"),n<b.x&&(n=b.x),n+k>b.dx&&(n=b.dx-k),i.style("left",o(a.cx-n-5,3,k-13)+"px");break;case"bottom":n=a.cx-k/2,m=a.dy+e,m+l>b.dy&&(m=a.y-l-e,d="top"),n<b.x&&(n=b.x),n+k>b.dx&&(n=b.dx-k),i.style("left",o(a.cx-n-5,3,k-13)+"px");break;default:d=null}m=Math.round(m),n=Math.round(n),g.classed("top right left bottom hide",!1).classed(d,!0),h.style("top",m+"px").style("left",n+"px"),g.style("top",m+"px").style("left",n+"px")},dv.removeTooltip=function(a){a.selectAll(".dv-tooltip").classed("hide",!0)},dv.cancelEvent=function(a){a.stopPropagation(),a.preventDefault()},dv.windowDimensions=function(){var a={width:640,height:480};return document.body&&document.body.offsetWidth&&(a.width=document.body.offsetWidth,a.height=document.body.offsetHeight),"CSS1Compat"==document.compatMode&&document.documentElement&&document.documentElement.offsetWidth&&(a.width=document.documentElement.offsetWidth,a.height=document.documentElement.offsetHeight),window.innerWidth&&window.innerHeight&&(a.width=window.innerWidth,a.height=window.innerHeight),a},dv.addWindowResizeHandler=function(a){window.addEventListener("resize",a)},dv.removeWindowResizeHandler=function(a){window.removeEventListener("resize",a)},dv.scale=dv.extend(function(){function a(a){this._d3Scale=a,this._reverse=!1,this._parse=dv.util.identity,this._includeInDomain=function(){return!0}}return a._mapToD3Scale=function(a){return this._d3Scale(a)},a.trainingProperties=function(a){return arguments.length?(dv.util.isValidValue(a,["isUndefined","isArray"])||dv.log.error({msg:"The supplied properties is not an array",data:{range:a}}),this._trainingProperties=a,this):this._trainingProperties?this._trainingProperties:this._property?[this._property]:void 0},a.trainDomain=function(a,b){var c=this.calculateDomain(a,b);return this.domain(c),c},a.parse=function(a){return arguments.length?(this._parse=a,this):this._parse},a.applyRangePadding=function(){},a.validateDomain=function(){},a.mapToProp=function(a){var b=a[this.property()],c=this;return dv.util.isArray(b)?dv.util.map(b,function(a){return c._mapToD3Scale.call(c,a)}):this._mapToD3Scale.call(this,b)},a.mapPropToPercent=function(a){return this.mapValueToPercent(this.mapToProp(a))},a.mapValueToPercent=function(a){var b=dv.util.scaleRange(this),c=b[1]-b[0];return dv.util.isArray(a)?dv.util.map(a,function(a){return c?(a-b[0])/c:0}):c?(a-b[0])/c:0},a.mapValue=function(a){if(dv.util.isArray(a)){var b=this;return dv.util.map(a,function(a){return b._mapToD3Scale.call(b,a)})}return this._mapToD3Scale.call(this,a)},a.invertValue=function(a){return this._d3Scale.invert(a)},a.rangeBand=function(a){return 0},a.reverse=function(a){return arguments.length?(this._reverse=a,this):this._reverse},a.property=function(a){return arguments.length?(this._property=a,this):this._property},a.mapping=function(a){return arguments.length?(this._mapping=a,this):this._mapping},a.domain=function(a){return arguments.length?this._d3Scale?(this._d3Scale.domain(a),this):this:this._d3Scale.domain()},a.hasSameDomain=function(a){var b=!0,c=this.domain();if(c.length!=a.length)b=!1;else for(var d=0;d<a.length;d++)if(a[d]!=c[d]){b=!1;break}return b},a.range=function(a){return arguments.length?this._d3Scale?(dv.util.isValidValue(a,["isArray"])||dv.log.error({msg:"The supplied range is not an array",data:{range:a}}),this._d3Scale.range(a),this):this:this._d3Scale.range()},a.expand=function(a){return arguments.length?(this._expand=a,this):this._expand},a.limits=function(a){return arguments.length?(this._limits=a,this):this._limits},a.breaks=function(a){return arguments.length?(this._breaks=a,this):this._breaks},a.orientation=function(a){return arguments.length?(this._orientation=a,this):this._orientation},a.includeInDomain=function(a){return arguments.length?(this._includeInDomain=a,this):this._includeInDomain},a.scaleIndex=function(a){return arguments.length?(this._scaleIndex=a,this):this._scaleIndex},a._copy=function(){dv.log.error({msg:"A copy function was not specified for the scale subclass."})},a.copy=a._copy,a.isDefault=function(a){return arguments.length?(this._isDefault=a,this):this._isDefault},a}),dv.scale.constant=dv.scale.extend(function(){function a(){this._super(null)}return a.trainDomain=function(a){},a.map=function(a){return this._value},a.mapToProp=function(a){return this._value},a.value=function(a){return arguments.length?(this._value=a,this):this._value},a._copy=function(a){var b=this.trainingProperties();return dv.util.isUndefined(b)||(b=b.slice(0)),dv.scale.constant().isDefault(this.isDefault()).value(this.value()).property(this.property()).trainingProperties(b).scaleIndex(this._scaleIndex)},a.copy=a._copy,a}),dv.scale.continuous=dv.scale.extend(function(){function a(a){this._super(a?a:d3.scale.linear()),this.to=this.range,this._parse=function(a){return null==a?void 0:parseFloat(a)}}return a.calculateDomain=function(a,b){var c,d,e=[],f=this;this.trainingProperties()||this.trainingProperties([this.property()]);var g=this.trainingProperties();b||(b={}),a||(a=[]);for(var h=0;h<g.length;h++)for(var i=g[h],j=0;j<a.length;j++)if(!b.filter||!b.filter.call(this,a[j].key))for(var k=a[j].values,l=0;l<k.length;l++){var m=k[l];if(this._includeInDomain(m,l)){0!==this.scaleIndex()&&(m[this.property()+"-index"]=this.scaleIndex());var n=b.stack?m.y0:m[i];dv.util.isArray(n)||(n=this._parse.call(this,n));var o=dv.util.isArray(n)?d3.min(n):n;if(c=dv.util.isUndefined(c)||isNaN(c)||c>o?o:c,b.stack){var p=m[i];n+=dv.util.isArray(p)?d3.max(p):f._parse.call(this,p)}var q=dv.util.isArray(n)?d3.max(n):n;d=dv.util.isUndefined(d)||isNaN(d)||q>d?q:d}}return isNaN(c)&&isNaN(d)?(e=[],this._naturalDomain=[]):(e=[c,d],this._naturalDomain=[c,d]),b.fill&&(e=[0,100]),dv.util.isUndefined(this._upperLimit)||dv.util.isFunction(this._upperLimit)||dv.util.isUndefined(this._lowerLimit)||dv.util.isFunction(this._lowerLimit)?this._reconcileLimits(e):e=this.limits(),e},a.unionDomain=function(a,b){a&&a instanceof dv.scale.continuous||dv.log.error({msg:"The supplied scale is not continuous.",data:{scale:a,isReversed:b}});var c=a.domain(),d=a.naturalDomain(),e=this.domain()?d3.extent(this.domain().concat(c)):d3.extent(c),f=this._naturalDomain?d3.extent(this._naturalDomain.concat(d)):d3.extent(d);return isNaN(e[0])&&isNaN(e[1])&&(e=[]),isNaN(f[0]&&isNaN(f[1]))&&(f=[]),this.reverse(b||this._reverse),this.domain(e),this._naturalDomain=f,this},a.validateDomain=function(){var a=this.domain();a&&a.length||this.domain([0,1])},a.unionRange=function(a){return dv.util.isValidValue(a,["isArray"])||dv.log.error({msg:"The supplied range is not an array",data:{range:a}}),this.range(this.range()?d3.extent(this.range().concat(a)):a),this},a.applyRangePadding=function(){var a=this.domain(),b=this.range();if(this._lowerRangePadding){var c=b[0]-b[1],d=Math.min(Math.abs(c)-1,this._lowerRangePadding);a[0]=this.invertValue(c/(Math.abs(c)-d)*d+b[0])}if(this._upperRangePadding){var e=b[1]-b[0],f=Math.min(Math.abs(e)-1,this._upperRangePadding);a[1]=this.invertValue(e/(Math.abs(e)-f)*f+b[1])}return this.domain(a),this},a.upperLimit=function(a){return arguments.length?(dv.util.isValidValue(a,["isUndefined","isFinite","isDate","isFunction"])?this._upperLimit=a:dv.log.error({msg:"Invalid value, cannot set upperLimit with: "+a}),this):this._upperLimit},a.lowerLimit=function(a){return arguments.length?(dv.util.isValidValue(a,["isUndefined","isFinite","isDate","isFunction"])?this._lowerLimit=a:dv.log.error({msg:"Invalid value, cannot set lowerLimit with: "+a}),this):this._lowerLimit},a.limits=function(a){return arguments.length?(a&&2==a.length||dv.log.error({msg:"Incorrect number of arguments, the limits function must supply an array containing both a lower and upper limit"}),this.lowerLimit(a[0]),this.upperLimit(a[1]),this):[this._lowerLimit,this._upperLimit]},a.naturalDomain=function(){return this._naturalDomain},a.upperRangePadding=function(a){return arguments.length?(dv.util.isValidValue(a,["isUndefined","isFinite","isDate","isFunction"])?this._upperRangePadding=a:dv.log.error({msg:"Invalid value, cannot set upperRangePadding with: "+a}),this):this._upperRangePadding},a.lowerRangePadding=function(a){return arguments.length?(dv.util.isValidValue(a,["isUndefined","isFinite","isDate","isFunction"])?this._lowerRangePadding=a:dv.log.error({msg:"Invalid value, cannot set lowerRangePadding with: "+a}),this):this._lowerRangePadding},a.rangePadding=function(a){return arguments.length?(a&&2==a.length||dv.log.error({msg:"Incorrect number of arguments, the limits function must supply an array containing both a lower and upper limit"}),this.lowerRangePadding(a[0]),this.upperRangePadding(a[1]),this):[this._lowerRangePadding,this._upperRangePadding]},a.softLowerLimit=function(a){return arguments.length?(this._softLowerLimit=a,this):this._softLowerLimit},a._reconcileLimits=function(a){a.length&&(dv.util.isUndefined(this._softLowerLimit)||(a[0]=Math.min(a[0],this._softLowerLimit),a[1]=Math.max(a[1],this._softLowerLimit)),dv.util.isUndefined(this._lowerLimit)||(a[0]=dv.util.isFunction(this._lowerLimit)?this._lowerLimit(a[0],a[1]):this._lowerLimit),
dv.util.isUndefined(this._upperLimit)||(a[1]=dv.util.isFunction(this._upperLimit)?this._upperLimit(a[0],a[1]):this._upperLimit))},a.labels=function(a){return arguments.length?(this._labels=a,this):this._labels},a._copy=function(){var a=this.domain().slice(0),b=this.trainingProperties();dv.util.isUndefined(b)||(b=b.slice(0));var c=dv.scale.continuous().isDefault(this.isDefault()).property(this.property()).mapping(this.mapping()).reverse(this.reverse()).domain(a).includeInDomain(this.includeInDomain()).upperLimit(this.upperLimit()).lowerLimit(this.lowerLimit()).upperRangePadding(this.upperRangePadding()).lowerRangePadding(this.lowerRangePadding()).softLowerLimit(this.softLowerLimit()).range(this.range().slice(0)).trainingProperties(b).scaleIndex(this._scaleIndex);return c._naturalDomain=this._naturalDomain,c},a.invert=function(a){return this._d3Scale.invert(a[this.mapping()])},a.invertFromProp=function(a){return this._d3Scale.invert(a[this.property()])},a.copy=a._copy,a}),dv.scale.linear=dv.scale.continuous.extend(function(){function a(){this._super(d3.scale.linear())}return a._copy=function(){var a=this.domain().slice(0),b=this.trainingProperties();dv.util.isUndefined(b)||(b=b.slice(0));var c=dv.scale.linear().isDefault(this.isDefault()).property(this.property()).mapping(this.mapping()).domain(a).includeInDomain(this.includeInDomain()).upperLimit(this.upperLimit()).lowerLimit(this.lowerLimit()).upperRangePadding(this.upperRangePadding()).lowerRangePadding(this.lowerRangePadding()).softLowerLimit(this.softLowerLimit()).range(this.range().slice(0)).reverse(this.reverse()).trainingProperties(b).scaleIndex(this._scaleIndex);return c._naturalDomain=this._naturalDomain,c},a.copy=a._copy,a}),dv.scale.gradient=dv.scale.continuous.extend(function(){function a(){this._super(d3.scale.linear()),this._innerScale=d3.scale.linear().range([0,1]),this.colors=this.range,this._controlPoints=["0%","50%","100%"],this.colors(["#FA5A50","#E1E1E1","#5FAF69"])}return a._adjustOuterDomain=function(){var a=this;this._d3Scale.domain(dv.util.map(this._controlPoints,function(b,c){return dv.util.isPercentString(b)?a._innerScale.invert(parseInt(b,10)/100):b}))},a.controlPoints=function(a){return arguments.length?(this._controlPoints=a,this._adjustOuterDomain(),this):this._controlPoints},a.domain=function(a){return arguments.length?this._innerScale?(this._innerScale.domain(a),this._adjustOuterDomain(),this):this:this._innerScale.domain()},a._copy=function(){var a=this.domain().slice(0),b=this.trainingProperties();dv.util.isUndefined(b)||(b=b.slice(0));var c=dv.scale.gradient().property(this.property()).mapping(this.mapping()).domain(a).upperLimit(this.upperLimit()).lowerLimit(this.lowerLimit()).includeInDomain(this.includeInDomain()).upperRangePadding(this.upperRangePadding()).lowerRangePadding(this.lowerRangePadding()).softLowerLimit(this.softLowerLimit()).range(this.range().slice(0)).controlPoints(this.controlPoints()).reverse(this.reverse()).trainingProperties(b).scaleIndex(this._scaleIndex);return c._naturalDomain=this._naturalDomain,c},a.copy=a._copy,a}),dv.scale.time=dv.scale.continuous.extend(function(){function a(){this._super(d3.time.scale()),this._parse=function(a){return a instanceof Date?a:new Date(Date.parse(a))}}return a._copy=function(){var a=this.domain().slice(0),b=this.trainingProperties();dv.util.isUndefined(b)||(b=b.slice(0));var c=dv.scale.time().isDefault(this.isDefault()).property(this.property()).mapping(this.mapping()).domain(a).includeInDomain(this.includeInDomain()).upperLimit(this.upperLimit()).lowerLimit(this.lowerLimit()).upperRangePadding(this.upperRangePadding()).lowerRangePadding(this.lowerRangePadding()).softLowerLimit(this.softLowerLimit()).range(this.range().slice(0)).reverse(this.reverse()).trainingProperties(b).scaleIndex(this._scaleIndex);return c._naturalDomain=this._naturalDomain,c},a.copy=a._copy,a._reconcileLimits=function(a,b,c){dv.util.isUndefined(this._softLowerLimit)||(a[0]=Math.min(a[0],this._softLowerLimit),a[1]=Math.max(a[1],this._softLowerLimit)),dv.util.isUndefined(this._lowerLimit)||(a[0]=dv.util.isFunction(this._lowerLimit)?this._parse(this._lowerLimit(new Date(b),new Date(c))):this._lowerLimit),dv.util.isUndefined(this._upperLimit)||(a[1]=dv.util.isFunction(this._upperLimit)?this._parse(this._upperLimit(new Date(b),new Date(c))):this._upperLimit)},a}),dv.scale.time.utc=dv.scale.continuous.extend(function(){function a(){this._super(d3.time.scale.utc()),this._parse=function(a){return a instanceof Date?a:new Date(Date.parse(a))}}return a._copy=function(){var a=this.domain().slice(0),b=this.trainingProperties();dv.util.isUndefined(b)||(b=b.slice(0));var c=dv.scale.time.utc().isDefault(this.isDefault()).property(this.property()).mapping(this.mapping()).domain(a).includeInDomain(this.includeInDomain()).upperLimit(this.upperLimit()).lowerLimit(this.lowerLimit()).upperRangePadding(this.upperRangePadding()).lowerRangePadding(this.lowerRangePadding()).softLowerLimit(this.softLowerLimit()).range(this.range().slice(0)).reverse(this.reverse()).trainingProperties(b).scaleIndex(this._scaleIndex);return c._naturalDomain=this._naturalDomain,c},a.copy=a._copy,a._reconcileLimits=function(a,b,c){dv.util.isUndefined(this._softLowerLimit)||(a[0]=Math.min(a[0],this._softLowerLimit),a[1]=Math.max(a[1],this._softLowerLimit)),dv.util.isUndefined(this._lowerLimit)||(a[0]=dv.util.isFunction(this._lowerLimit)?this._parse(this._lowerLimit(new Date(b),new Date(c))):this._lowerLimit),dv.util.isUndefined(this._upperLimit)||(a[1]=dv.util.isFunction(this._upperLimit)?this._parse(this._upperLimit(new Date(b),new Date(c))):this._upperLimit)},a}),dv.scale.ordinal=dv.scale.extend(function(){function a(){this._super(d3.scale.ordinal()),this._defaultPadding=.1,this._defaultOuterPadding=0,this._rangeExtent=[],this._rangeBandsSet=!1}return a._mapToD3Scale=function(a){for(var b=this.domain(),c=-1,d=b.length,e=-1;++c<d;){var f=b[c];if(f===a||dv.util.isDate(f)&&f.getTime()===a.getTime()){e=c;break}}return 0>e?void 0:this._d3Scale(a)},a.calculateDomain=function(a,b){var c={},d=[],e=this.trainingProperties();b=b||{};for(var f=0;f<e.length;f++)for(var g=e[f],h=0;h<a.length;h++){var i=a[h].values;if(!b.filter||!b.filter.call(this,a[h].key))for(var j=0;j<i.length;j++){var k=i[j];if(this._includeInDomain(k,j)){0!==this.scaleIndex()&&(k[this.property()+"-index"]=this.scaleIndex());var l=this._parse.call(this,k[g]);dv.util.isUndefined(l)||c.hasOwnProperty(l)||(c[l]=l,d.push(l))}}}return d.length?d:[]},a.unionDomain=function(a,b){a&&a instanceof dv.scale.ordinal||dv.log.error({msg:"The supplied scale is not ordinal.",data:{scale:a,isReversed:b}});var c=a.domain();if(c&&!dv.util.isArray(c))throw new Error("The supplied domain is not an array");return c&&(this.reverse(b||this._reverse),this.domain(this.domain()?dv.util.union(this.domain(),c):c)),this},a.unionRange=function(a){if(a&&!dv.util.isArray(a))throw new Error("The supplied range is not an array");return a&&this.range(this.range()?dv.util.union(this.range(),a):a),this},a.invertValue=function(a){var b=this.range().indexOf(a),c=this.domain();if(0>b)throw new Error("The supplied value does not exist in the specified range.");return c[b%c.length]},a.padding=function(a){return arguments.length?(this._padding=a,this._rangeBandsSet&&this._d3Scale.rangeBands(this.rangeExtent(),this._padding,this.outerPadding()),this):dv.util.isUndefined(this._padding)?this._defaultPadding:this._padding},a.outerPadding=function(a){return arguments.length?(this._outerPadding=a,this._rangeBandsSet&&this._d3Scale.rangeBands(this.rangeExtent(),this.padding(),this._outerPadding),this):dv.util.isUndefined(this._outerPadding)?dv.util.isUndefined(this._padding)?this._defaultOuterPadding:this.padding():this._outerPadding},a.rangeBands=function(a){return arguments.length?(this._rangeBandsSet=!0,this._d3Scale.rangeBands(a,this.padding(),this.outerPadding()),this.rangeExtent(a),this):this._d3Scale.range()},a.rangeBand=function(){return this._d3Scale.rangeBand()},a.range=function(a){return arguments.length?this._d3Scale?(dv.util.isValidValue(a,["isArray"])||dv.log.error({msg:"The supplied range is not an array",data:{range:a}}),this._d3Scale.range(a),this.rangeExtent([a[0],a[a.length-1]]),this):this:this._d3Scale.range()},a.rangeExtent=function(a){return arguments.length?(dv.util.isValidValue(a,["isArray"])||dv.log.error({msg:"The supplied range extent is not an array",data:{range:a}}),this._rangeExtent=a,this):this._rangeExtent},a.values=function(a){return arguments.length?(dv.util.isValidValue(a,["isArray"])||dv.log.error({msg:"The supplied values is not an array",data:{range:a}}),this.range(a)):this._d3Scale.range()},a.drop=function(a){return arguments.length?(this._drop=a,this):this._drop},a._copy=function(){var a=this.domain().slice(0),b=this.trainingProperties();dv.util.isUndefined(b)||(b=b.slice(0));var c=dv.scale.ordinal().isDefault(this.isDefault()).property(this.property()).mapping(this.mapping()).domain(a).includeInDomain(this.includeInDomain()).range(this.range().slice(0)).rangeExtent(this.rangeExtent().slice(0)).reverse(this.reverse()).padding(this._padding).outerPadding(this._outerPadding).trainingProperties(b).scaleIndex(this._scaleIndex);return this._rangeBandsSet&&c.rangeBands(this.rangeExtent().slice(0)),c},a.copy=a._copy,a}),dv.scale.color=dv.scale.ordinal.extend(function(){function a(){this._super(),this.range(b)}var b=["#8CC350","#5A6EAA","#D755A5","#1EBED7","#F0A01E","#9B8CE6","#3CB5A0","#3287D2","#F0557D","#C3D250","#EB782D","#78B4F5","#5FAF69","#AA5FA5","#FA5A50","#F5C841"];return a._copy=function(){var a=this.domain().slice(0),b=this.trainingProperties();dv.util.isUndefined(b)||(b=b.slice(0));var c=dv.scale.ordinal().isDefault(this.isDefault()).property(this.property()).mapping(this.mapping()).domain(a).range(this.range()).rangeExtent(this.rangeExtent()).includeInDomain(this.includeInDomain()).reverse(this.reverse()).padding(this._padding).outerPadding(this._outerPadding).trainingProperties(b).scaleIndex(this._scaleIndex);return this._rangeBandsSet&&c.rangeBands(this.rangeExtent().slice(0)).padding(this._padding).outerPadding(this._outerPadding),c},a.copy=a._copy,a}),dv.scale.shape=dv.scale.ordinal.extend(function(){function a(){this._super(),this.range(b)}var b=["circle","cross","diamond","square","triangle-down","triangle-up"];return a._copy=function(){var a=this.domain().slice(0),b=this.trainingProperties();dv.util.isUndefined(b)||(b=b.slice(0));var c=dv.scale.ordinal().isDefault(this.isDefault()).property(this.property()).mapping(this.mapping()).domain(a).includeInDomain(this.includeInDomain()).range(this.range().slice(0)).rangeExtent(this.rangeExtent().slice(0)).reverse(this.reverse()).padding(this._padding).outerPadding(this._outerPadding).trainingProperties(b).scaleIndex(this._scaleIndex);return this._rangeBandsSet&&c.rangeBands(this.rangeExtent().slice(0)).padding(this._padding).outerPadding(this._outerPadding),c},a.copy=a._copy,a}),dv.scale.linetype=dv.scale.ordinal.extend(function(){function a(){this._super(),this.range(b)}var b=["solid","dashed","dotted","dotdash","longdash","twodash"];return a._copy=function(){var a=this.domain().slice(0),b=this.trainingProperties();dv.util.isUndefined(b)||(b=b.slice(0));var c=dv.scale.ordinal().isDefault(this.isDefault()).property(this.property()).mapping(this.mapping()).domain(a).includeInDomain(this.includeInDomain()).range(this.range().slice(0)).rangeExtent(this.rangeExtent().slice(0)).reverse(this.reverse()).padding(this._padding).outerPadding(this._outerPadding).trainingProperties(b).scaleIndex(this._scaleIndex);return this._rangeBandsSet&&c.rangeBands(this.rangeExtent().slice(0)).padding(this._padding).outerPadding(this._outerPadding),c},a.copy=a._copy,a}),dv.scale.size=dv.scale.continuous.extend(function(){function a(){this._super(),this.to([2,10])}return a._copy=function(){var a=this.domain().slice(0),b=this.trainingProperties();dv.util.isUndefined(b)||(b=b.slice(0));var c=dv.scale.size().isDefault(this.isDefault()).property(this.property()).mapping(this.mapping()).domain(a).includeInDomain(this.includeInDomain()).upperLimit(this.upperLimit()).lowerLimit(this.lowerLimit()).upperRangePadding(this.upperRangePadding()).lowerRangePadding(this.lowerRangePadding()).softLowerLimit(this.softLowerLimit()).range(this.range().slice(0)).reverse(this.reverse()).trainingProperties(b).scaleIndex(this._scaleIndex);return c._naturalDomain=this._naturalDomain,c},a.copy=a._copy,a}),dv.scale.identity=dv.scale.ordinal.extend(function(){function a(a){this._super(d3.scale.ordinal())}return a.mapToProp=function(a){return a[this.property()]},a.domain=function(a){return arguments.length?this._d3Scale?(this._d3Scale.domain(a),this._d3Scale.range(a),this):this:this._d3Scale.domain()},a.range=function(){return arguments.length?this:this._d3Scale.range()},a.labels=function(a){return arguments.length?(this._labels=a,this):this._labels},a._copy=function(){var a=this.domain().slice(0),b=this.trainingProperties();return dv.util.isUndefined(b)||(b=b.slice(0)),dv.scale.identity().isDefault(this.isDefault()).property(this.property()).mapping(this.mapping()).domain(a).includeInDomain(this.includeInDomain()).range(this.range().slice(0)).reverse(this.reverse()).trainingProperties(b).scaleIndex(this._scaleIndex)},a.copy=a._copy,a}),dv.scale.log=dv.scale.continuous.extend(function(){function a(){this._super(d3.scale.log())}return a._copy=function(){var a=this.domain().slice(0),b=this.trainingProperties();dv.util.isUndefined(b)||(b=b.slice(0));var c=dv.scale.log().isDefault(this.isDefault()).property(this.property()).mapping(this.mapping()).domain(a).includeInDomain(this.includeInDomain()).upperLimit(this.upperLimit()).lowerLimit(this.lowerLimit()).upperRangePadding(this.upperRangePadding()).lowerRangePadding(this.lowerRangePadding()).softLowerLimit(this.softLowerLimit()).range(this.range().slice(0)).reverse(this.reverse()).trainingProperties(b).scaleIndex(this._scaleIndex);return c._naturalDomain=this._naturalDomain,c},a.domain=function(a){if(a){var b=d3.extent(a);if(b[0]<=0&&b[1]>=0)throw new Error('Data mapped to the logarithmic "'+this.property()+'" property must be entirely positive or entirely negative. The data values cannot cross zero.')}return this._super.apply(this,arguments)},a.copy=a._copy,a}),dv.svg=dv.svg||{},dv.svg.text=function(){function a(a){return a.select(function(a,b){return j.call(this,a,b)?this:null}).attr("x",function(a,c){return b.call(this,a,c)}).attr("y",function(a,b){return h.call(this,a,b)}).text(function(a,b){return i.call(this,a,b)})}var b=c,h=d,i=e,j=f,k=g;return a.x=function(c){return arguments.length?(b=c,a):b},a.y=function(b){return arguments.length?(h=b,a):h},a.label=function(b){return arguments.length?(i=b,a):i},a.defined=function(b){return arguments.length?(j=b,a):j},a.duration=function(b){return arguments.length?(k=b,a):k},a},dv.svg.text.radial=function(){function a(a){var c=function(a,c){return b.call(this,a,c)+X},d=function(a,b){return h.call(this,a,b)};return a.select(function(a,b){return j.call(this,a,b)?this:null}).attr("x",function(a,b){return d(a,b)*Math.cos(c(a,b))}).attr("y",function(a,b){return d(a,b)*Math.sin(c(a,b))}).text(function(a,b){return i.call(this,a,b)})}var b=c,h=d,i=e,j=f,k=g;return a.angle=function(c){return arguments.length?(b=c,a):b},a.radius=function(b){return arguments.length?(h=b,a):h},a.label=function(b){return arguments.length?(i=b,a):i},a.defined=function(b){return arguments.length?(j=b,a):j},a.duration=function(b){return arguments.length?(k=b,a):k},a},dv.svg.rect=function(){function a(a,g){return f.call(this,a,g)?m(b.call(this,a,g),c.call(this,a,g),d.call(this,a,g),e.call(this,a,g)):null}var b=h,c=i,d=j,e=k,f=l;return a.x0=function(c){return arguments.length?(b=c,a):b},a.x1=function(b){return arguments.length?(c=b,a):c},a.y0=function(b){return arguments.length?(d=b,a):d},a.y1=function(b){return arguments.length?(e=b,a):e},a.defined=function(b){return arguments.length?(f=b,a):f},a},dv.svg.symbol=function(){function a(a,g){return f.call(this,a,g)?(U[b.call(this,a,g)]||U.circle)(c.call(this,a,g),d.call(this,a,g),e.call(this,a,g)):null}var b=o,c=n,d=p,e=q,f=r;return a.x=function(b){return arguments.length?(d=b,a):d},a.y=function(b){return arguments.length?(e=b,a):e},a.type=function(c){return arguments.length?(b=d3.functor(c),a):b},a.size=function(b){return arguments.length?(c=d3.functor(b),a):c},a.defined=function(b){return arguments.length?(f=b,a):f},a},dv.svg.symbol.radial=function(){function a(a,g){if(f.call(this,a,g)){var h=d.call(this,a,g)+X,i=e.call(this,a,g),j=i*Math.cos(h),k=i*Math.sin(h);return(U[b.call(this,a,g)]||U.circle)(c.call(this,a,g),j,k)}return null}var b=o,c=n,d=p,e=q,f=r;return a.angle=function(b){return arguments.length?(d=b,a):d},a.radius=function(b){return arguments.length?(e=b,a):e},a.type=function(c){return arguments.length?(b=d3.functor(c),a):b},a.size=function(b){return arguments.length?(c=d3.functor(b),a):c},a.defined=function(b){return arguments.length?(f=b,a):f},a},d3.svg.symbolTypes=d3.keys(U);var U={circle:function(a,b,c){var d=Math.sqrt(a/Math.PI);return"M"+b+","+(c+d)+"A"+d+","+d+" 0 1,1 "+b+","+(c-d)+"A"+d+","+d+" 0 1,1 "+b+","+(c+d)+"Z"},cross:function(a,b,c){var d=Math.sqrt(a/5)/2;return"M"+(b+-3*d)+","+(c-d)+"H"+(b-d)+"V"+(c+-3*d)+"H"+(b+d)+"V"+(c-d)+"H"+(b+3*d)+"V"+(c+d)+"H"+(b+d)+"V"+(c+3*d)+"H"+(b-d)+"V"+(c+d)+"H"+(b-3*d)+"Z"},diamond:function(a,b,c){var d=Math.sqrt(a/(2*W)),e=d*W;return"M"+b+","+(c-d)+"L"+(b+e)+","+c+" "+b+","+(c+d)+" "+(b-e)+","+c+"Z"},square:function(a,b,c){var d=Math.sqrt(a)/2;return"M"+(b-d)+","+(c-d)+"L"+(b+d)+","+(c-d)+" "+(b+d)+","+(c+d)+" "+(b-d)+","+(c+d)+"Z"},"triangle-down":function(a,b,c){var d=Math.sqrt(a/V),e=d*V/2;return"M"+b+","+(c+e)+"L"+(b+d)+","+(c-e)+" "+(b-d)+","+(c-e)+"Z"},"triangle-up":function(a,b,c){var d=Math.sqrt(a/V),e=d*V/2;return"M"+b+","+(c-e)+"L"+(b+d)+","+(c+e)+" "+(b-d)+","+(c+e)+"Z"}};dv.svg.errorBar=function(){function a(a,h){return g.call(this,a,h)?A(b.call(this,a,h),c.call(this,a,h),d.call(this,a,h),e.call(this,a,h),f.call(this,a,h)):null}var b=s,c=t,d=u,e=v,f=w,g=z;return a.x0=function(c){return arguments.length?(b=c,a):b},a.x1=function(b){return arguments.length?(c=b,a):c},a.y0=function(b){return arguments.length?(d=b,a):d},a.y1=function(b){return arguments.length?(e=b,a):e},a.flip=function(b){return arguments.length?(f=b,a):f},a.defined=function(b){return arguments.length?(g=b,a):g},a};var V=Math.sqrt(3),W=Math.tan(30*Math.PI/180),X=-Math.PI/2;dv.svg.poly=function(){function a(a,e){return b.call(this,a,e)?E(c.call(this,a,e),d.call(this,a,e)):null}var b=B,c=C,d=D;return a.xs=function(b){return arguments.length?(c=b,a):c},a.ys=function(b){return arguments.length?(d=b,a):d},a.defined=function(a){return arguments.length?b=a:b},a},dv.svg.poly.radial=function(){function a(a,e){if(b.call(this,a,e)){for(var f=c.call(this,a,e),g=d.call(this,a,e),h=d3.max([f.length,g.length]),i="M",j=0;h>j;j++){j>0&&(i+="L");var k=f[j]+X,l=g[j],m=l*Math.cos(k),n=l*Math.sin(k);i+=j<f.length?m:"0",i+=",",i+=j<g.length?n:"0"}return i+="Z"}return null}var b=B,c=C,d=D;return a.angles=function(b){return arguments.length?(c=b,a):c},a.radii=function(b){return arguments.length?(d=b,a):d},a.defined=function(a){return arguments.length?b=a:b},a},dv.util={},dv.util.filterAndZip=function(a,b,c){var d=[],e=[];if(b)d=a[b];else for(var f in a){d=a[f];break}for(var g=-1,h=d.length;++g<h;){var i=d[g];if(!c||i==c){var j={};for(var k in a)if("data"===k){j[k]={};for(var l in a[k])j[k][l]=a[k][l][g]}else j[k]=a[k][g];e.push(j)}}return e},dv.util.binaryCompare=function(a,b,c,d,e){var f=d;for(arguments.length<4&&(f=0),arguments.length<5&&(e=a.length);e>f;){var g=f+e>>1;b<c(a[g])?e=g:f=g+1}return f==d||Math.abs(c(a[f])-b)<Math.abs(c(a[f-1])-b)?f:f-1},dv.util.uniqueValues=function(a,b){var c=[];return dv.util.each(a,function(d,e){for(var f=-1,g=c.length,h=!1;++f<g;){var i=c[f];if(b(d,i)){h=!0;break}}h||c.push(a[f])}),c},dv.util.scaleRange=function(a,b){return 1===arguments.length?a.rangeExtent?a.rangeExtent():a.range():(a.rangeExtent?a.rangeBands(b):a.range(b),a)},dv.util.minRangeDistance=function(a,b){var c,d,e=Number.MAX_VALUE;return dv.util.each(b,function(b){dv.util.each(b.values,function(b){c=b.panel.xScale(b).mapValue(b[a]),dv.util.isUndefined(d)||(e=Math.min(e,Math.abs(c-d))),d=c})}),e},dv.util.scaleRangeNoReverse=function(a){return a.rangeExtent?a.rangeExtent():dv.util.scaleExtent(a.range())},dv.util.scaleExtent=function(a){var b=a[0],c=a[a.length-1];return c>b?[b,c]:[c,b]},dv.util.merge=function(a,b){var c,d={};for(c in a)d[c]=a[c];for(c in b)d[c]=b[c];return d},dv.util.getPercentValue=function(a,b){return dv.util.isPercentString(a)?b*parseInt(a,10)/100:a},dv.util.isPercentString=function(a){return"string"==typeof a&&/^(-?[0-9]+)%$/.test(a)},dv.util.isValidValue=function(a,b){for(var c=0;c<b.length;c++)if(dv.util[b[c]](a))return!0;return!1},dv.util.identity=function(a){return a},dv.util.clamp=function(a,b,c){return Math.min(Math.max(a,b),c)},dv.util.clone=function(a){return dv.util.isObject(a)?dv.util.isArray(a)?a.slice():dv.util.extend({},a):a},dv.util.isArray=function(a){return Array.isArray?Array.isArray(a):"[object Array]"==Object.prototype.toString.call(a)},dv.util.isObject=function(a){return a===Object(a)},dv.util.isFunction=function(a){return"[object Function]"==Object.prototype.toString.call(a)},dv.util.isUndefined=function(a){return void 0===a},dv.util.isFinite=function(a){return isFinite(a)&&!isNaN(parseFloat(a))},dv.util.isDate=function(a){return a instanceof Date},dv.util.isEmpty=function(a){return 0===Object.keys(a).length},dv.util.extend=function(a){return dv.util.each(Array.prototype.slice.call(arguments,1),function(b){for(var c in b)a[c]=b[c]}),a},dv.util.each=function(a,b,c){if(null!=a)if(Array.prototype.forEach&&a.forEach===Array.prototype.forEach)a.forEach(b,c);else if(a.length===+a.length){for(var d=0,e=a.length;e>d;d++)if(b.call(c,a[d],d,a)==={})return}else for(var f in a)if(dv.util.has(a,f)&&b.call(c,a[f],f,a)==={})return},dv.util.has=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},dv.util.uniq=function(a,b,c,d){dv.util.isFunction(b)&&(d=c,c=b,b=!1);var e=c?dv.util.map(a,c,d):a,f=[],g=[];return dv.util.each(e,function(c,d){(b?d&&g[g.length-1]===c:dv.util.contains(g,c))||(g.push(c),f.push(a[d]))}),f},dv.util.union=function(){return dv.util.uniq(Array.prototype.concat.apply(Array.prototype,arguments))},dv.util.contains=function(a,b){return null==a?!1:Array.prototype.indexOf&&a.indexOf===Array.prototype.indexOf?-1!=a.indexOf(b):dv.util.any(a,function(a){return a===b})},dv.util.any=function(a,b,c){b||(b=dv.util.identity);var d=!1;return null==a?d:Array.prototype.some&&a.some===Array.prototype.some?a.some(b,c):void dv.util.each(a,function(a,e,f){return d||(d=b.call(c,a,e,f))?{}:void 0})},dv.util.sortBy=function(a,b,c){var d=function(a){return dv.util.isFunction(a)?a:function(b){return b[a]}},e=d(b);return dv.util.pluck(dv.util.map(a,function(a,b,d){return{value:a,index:b,criteria:e.call(c,a,b,d)}}).sort(function(a,b){var c=a.criteria,d=b.criteria;if(c!==d){if(c>d||void 0===c)return 1;if(d>c||void 0===d)return-1}return a.index<b.index?-1:1}),"value")},dv.util.pluck=function(a,b){return dv.util.map(a,function(a){return a[b]})},dv.util.map=function(a,b,c){var d=[];return null===a?d:Array.prototype.map&&a.map===Array.prototype.map?a.map(b,c):(dv.util.each(a,function(a,e,f){d[d.length]=b.call(c,a,e,f)}),d)},dv.util.reduce=function(a,b,c,d){var e=arguments.length>2;if(null===a&&(a=[]),Array.prototype.reduce&&a.reduce===Array.prototype.reduce)return d&&(b=dv.util.bind(b,d)),e?a.reduce(b,c):a.reduce(b);if(dv.util.each(a,function(a,f,g){e?c=b.call(d,c,a,f,g):(c=a,e=!0)}),!e)throw new TypeError("Reduce of empty array with no initial value");return c},dv.util.bind=function(a,b){if(a.bind===Function.prototype.bind&&Function.prototype.bind)return Function.prototype.bind.apply(a,Array.prototype.slice.call(arguments,1));var c=Array.prototype.slice.call(arguments,2);return function(){return a.apply(b,c.concat(Array.prototype.slice.call(arguments)))}},dv.util.noop=function(){},dv.util.each(["Arguments","String","Number","RegExp"],function(a){dv.util["is"+a]=function(b){return toString.call(b)=="[object "+a+"]"}}),dv.util.validateParam=function(a,b,c,d){if("isString"===b)return dv.util.isString(a)&&dv.util.isArray(c)&&-1!==c.indexOf(a.toLowerCase())?a.toLowerCase():d;if("isNumber"===b)return dv.util.isNumber(a)&&dv.util.isArray(c)&&a<=c[1]&&a>=c[0]?a:d;if("isFunction"===b)return dv.util.isFunction(a)?a:d;if("isDimension"===b)return"x"===a||"X"===a?"x":"y"===a||"Y"===a?"y":a===["x","y"]||a===["X","y"]||a===["x","Y"]||a===["X","Y"]?["x","y"]:d;if("isRange"===b){var e=c[0],f=c[1];return dv.util.isArray(a)&&2===a.length?(dv.util.isNumber(a[0])&&dv.util.isNumber(a[1])&&(e=Math.max(Math.min(a[0],a[1]),c[0]),f=Math.min(Math.max(a[0],a[1]),c[1])),[e,f]):d}},dv.util=dv.util||{},dv.util.svg={},dv.util.svg.getDasharray=function(a){if(-1!=a.indexOf(",")||-1!=a.indexOf(" "))return a;if(Y.hasOwnProperty(a))return Y[a];throw new Error("The dashed line format is invalid")};var Y={solid:"",dashed:"7,4",dotted:"2,3",dotdash:"2,3,7,4",longdash:"11,4",twodash:"5,2,11,2"};dv.container=dv.extend(function(){function a(){this._aes={}}var b={x:dv.scale.linear,y:dv.scale.linear,yMin:dv.scale.linear,yMax:dv.scale.linear,xMin:dv.scale.linear,xMax:dv.scale.linear,color:dv.scale.color,fill:dv.scale.color,stroke:dv.scale.color,alpha:dv.scale.linear,shape:dv.scale.shape,size:dv.scale.size,radius:dv.scale.linear,group:dv.scale.ordinal,linetype:dv.scale.linetype,label:dv.scale.identity};return a.render=function(){throw new Error("render() must be implemented in a subclass")},a._calculateStats=function(){throw new Error("_calculateStats() must be implemented in a subclass")},a._handlePositions=function(){throw new Error("_handlePositions() must be implemented in a subclass")},a.getTrainedScale=function(a){throw new Error("getTrainedScale() must be implemented in a subclass")},a.getExplicitScalesMap=function(){return this._aes},a._normalizeData=function(a){if(a.hasOwnProperty("data")&&!dv.util.isArray(a.data))return a;var b,c={},d=this.getExplicitScalesMap();return dv.util.each(d,function(d,e){for(var f in d)if(b=d[f],!(b instanceof dv.scale.constant)){var g=a[b.mapping()];if(dv.util.isArray(g)){var h=g.map(function(a){return dv.util.isArray(a)?a.map(function(a){return b._parse(a)}):b._parse(a)});c[b.property()]=h}}}),c.data=a,c},a.map=function(a,c,d,e){if(d||(d=b[a]().copy().isDefault(!0)),!d)throw new Error("There is no default scale associated with this property. Either the property isn't valid or the scale default doesn't exist.");return arguments.length<4&&(e=0),this._aes[a]||(this._aes[a]={}),this._aes[a][e]=d.property(a).mapping(c).scaleIndex(e),this},a.set=function(a,b){this._aes[a]||(this._aes[a]={});var c=this._aes[a][0]=dv.scale.constant();return dv.util.isFunction(b)?c.map=c.mapToProp=b:c.value(b),this},a.on=function(a,b,c){arguments.length<3&&(c=!1);var d=b&&dv.util.isFunction(b);return d?(this.eventMap=this.eventMap||{},this.eventMap[a]={callback:b,capture:c}):(this.eventMap&&delete this.eventMap[a],this.unregisterEventMap=this.unregisterEventMap||{},this.unregisterEventMap[a]=c),this._removeRegisteredEvents(),this._addRegisteredEvents(),this},a.position=function(a){return arguments.length?(this._position=a,this):this._chart&&!this._position?this._chart.position():this._position},a.delay=function(a){return arguments.length?(this._delay=d3.functor(a),this):this._chart&&dv.util.isUndefined(this._delay)?this._chart.delay():this._delay},a.duration=function(a){return arguments.length?(this._duration=d3.functor(a),this):this._chart&&dv.util.isUndefined(this._duration)?this._chart.duration():this._duration},a.ease=function(a){return arguments.length?(this._ease=a,this):this._chart&&dv.util.isUndefined(this._ease)?this._chart.ease():this._ease},a}),dv.coord=dv.extend(function(){function a(){this._flip=!1}return a.flip=function(a){return arguments.length?(this._flip=a,this):this._flip},a.startX=function(a){return arguments.length?(dv.util.isValidValue(a,["isFinite","isPercentString"])||dv.log.error({msg:"Invalid value type, startX/startAngle must be a number or percent string",data:{val:a}}),this._startX=a,this):this._startX},a.endX=function(a){return arguments.length?(dv.util.isValidValue(a,["isFinite","isPercentString"])||dv.log.error({msg:"Invalid value type, endX/endAngle must be a number or percent string",data:{val:a}}),this._endX=a,this):this._endX},a.startY=function(a){return arguments.length?(dv.util.isValidValue(a,["isFinite","isPercentString"])||dv.log.error({msg:"Invalid value type, startY/innerRadius must be a number or percent string",data:{val:a}}),this._startY=a,this):this._startY},a.endY=function(a){return arguments.length?(dv.util.isValidValue(a,["isFinite","isPercentString"])||dv.log.error({msg:"Invalid value type, endY/outerRadius must be a number or percent string",data:{val:a}}),this._endY=a,this):this._endY},a}),dv.coord.cartesian=dv.coord.extend(function(){function a(){this._super(),this.startX(0),this.endX(0),this.startY(0),this.endY(0),this._type="cartesian"}return a._translatePercentToX=function(a,b){var c=dv.util.scaleRange(a),d=this._translatePercent(b,c,this.startX(),this.endX()),e=3*Math.abs(c[1]-c[0]);return dv.util.clamp(d,c[0]-e,c[1]+e)},a._translatePercentToY=function(a,b){var c=dv.util.scaleRange(a),d=this._translatePercent(b,c,this.startY(),this.endY()),e=3*Math.abs(c[1]-c[0]);return dv.util.clamp(d,c[1]-e,c[0]+e)},a._translatePercent=function(a,b,c,d){return(b[1]-b[0]-d-c)*a+c+b[0]},a._translatePercentArrToY=function(a,b){var c=this;return dv.util.map(b,function(b){return c._translatePercentToY(a,b)})},a._translatePercentArrToX=function(a,b){var c=this;return dv.util.map(b,function(b){return c._translatePercentToX(a,b)})},a._text=function(){function a(){var c=dv.svg.text();return b._flip?c.x(function(c,d){return b._translatePercentToY(c.panel.yOuterScale(),a.y()(c,d))}).y(function(c,d){return b._translatePercentToX(c.panel.xOuterScale(),a.x()(c,d))}):c.x(function(c,d){return b._translatePercentToX(c.panel.xOuterScale(),a.x()(c,d))}).y(function(c,d){return b._translatePercentToY(c.panel.yOuterScale(),a.y()(c,d))})}var b=this;return a.x=function(a){return arguments.length?(this._x=a,this):this._x},a.y=function(a){return arguments.length?(this._y=a,this):this._y},a},a._point=function(){var a=this,b={};return b.renderer=dv.svg.symbol().x(function(a,b){return a.bounds.x}).y(function(a,b){return a.bounds.y}),b.getBounds=function(c,d){return c.hasOwnProperty("y")||(c.y=0),c.hasOwnProperty("x")||(c.x=0),b._defined(c,d)?(a._flip?c.bounds={x:a._translatePercentToY(c.panel.yOuterScale(),b.y()(c,d)),y:a._translatePercentToX(c.panel.xOuterScale(),b.x()(c,d))}:c.bounds={x:a._translatePercentToX(c.panel.xOuterScale(),b.x()(c,d)),y:a._translatePercentToY(c.panel.yOuterScale(),b.y()(c,d))},c):null},b.getPath=function(a){return null===a||void 0===a.bounds?null:b.renderer(a)},b.x=function(a){return arguments.length?(this._x=a,b):this._x},b.y=function(a){return arguments.length?(this._y=a,b):this._y},b.defined=function(a){return arguments.length?(this._defined=a,this):this._defined},b},a._line=function(){var a=this,b={};return b.renderer=d3.svg.line().x(function(a,b){return a.bounds.x}).y(function(a,b){return a.bounds.y}),b.getBounds=function(c,d){var e=[];return dv.util.each(c,function(d,f){d.hasOwnProperty("y")||(d.y=0),d.hasOwnProperty("x")||(d.x=0),b._defined(d,f)&&(a._flip?d.bounds={x:a._translatePercentToY(d.panel.yOuterScale(),b.y()(d,f)),y:a._translatePercentToX(d.panel.xOuterScale(),b.x()(d,f))}:d.bounds={x:a._translatePercentToX(d.panel.xOuterScale(),b.x()(d,f)),y:a._translatePercentToY(d.panel.yOuterScale(),b.y()(d,f))},e.push(c[f]))}),e},b.getPath=function(a){return null===a?null:b.renderer(a)},b.x=function(a){return arguments.length?(dv.util.isValidValue(a,["isFunction"])||dv.log.error({msg:"Invalid value, line.x must be a function",
data:{val:a}}),this._x=a,this):this._x},b.y=function(a){return arguments.length?(dv.util.isValidValue(a,["isFunction"])||dv.log.error({msg:"Invalid value, line.y must be a function",data:{val:a}}),this._y=a,this):this._y},b.defined=function(a){return arguments.length?(dv.util.isValidValue(a,["isFunction"])||dv.log.error({msg:"Invalid value, line.defined must be a function",data:{val:a}}),this._defined=a,this):this._defined},b},a._area=function(){var a=this,b={};return b.renderer=d3.svg.area(),b.getBounds=function(c,d){var e=[];return b.setupRenderer(),dv.util.each(c,function(c,d){if(c.hasOwnProperty("y")||(c.y=0),c.hasOwnProperty("x")||(c.x=0),b._defined(c,d)){var f=dv.util.clone(c);f.bounds={x:a._translatePercentToX(c.panel.xOuterScale(),b.x()(c,d)),y0:a._translatePercentToY(c.panel.yOuterScale(),b.y0()(c,d)),y1:a._translatePercentToY(c.panel.yOuterScale(),b.y1()(c,d))},e.push(f)}}),e},b.getPath=function(a){return b.setupRenderer(),null===a?null:b.renderer(a)},b.setupRenderer=function(){a._flip?b.renderer.x(null).y0(null).y1(null).y(function(a,b){return a.bounds.x}).x0(function(a,b){return a.bounds.y0}).x1(function(a,b){return a.bounds.y1}):b.renderer.y(null).x0(null).x1(null).x(function(a,b){return a.bounds.x}).y0(function(a,b){return a.bounds.y0}).y1(function(a,b){return a.bounds.y1})},b.x=function(a){return arguments.length?(dv.util.isValidValue(a,["isFunction"])||dv.log.error({msg:"Invalid value, area.x must be a function",data:{val:a}}),this._x=a,this):this._x},b.y0=function(a){return arguments.length?(dv.util.isValidValue(a,["isFunction"])||dv.log.error({msg:"Invalid value, area.y0 must be a function",data:{val:a}}),this._y0=a,this):this._y0},b.y1=function(a){return arguments.length?(dv.util.isValidValue(a,["isFunction"])||dv.log.error({msg:"Invalid value, area.y1 must be a function",data:{val:a}}),this._y1=a,this):this._y1},b.defined=function(a){return arguments.length?(dv.util.isValidValue(a,["isFunction"])||dv.log.error({msg:"Invalid value, area.defined must be a function",data:{val:a}}),this._defined=a,this):this._defined},b},a._rect=function(){var a=this,b={};return b.renderer=dv.svg.rect().x0(function(a,b){return a.bounds.x0}).x1(function(a,b){return a.bounds.x1}).y0(function(a,b){return a.bounds.y0}).y1(function(a,b){return a.bounds.y1}),b.getBounds=function(c,d){var e=dv.util.clone(c),f=e[c.panel.xScale(c).property()];dv.util.isArray(f)&&(e.x0=f[0],e.x1=f[1]);var g=e[c.panel.yScale(c).property()];return dv.util.isArray(g)&&(e.y0=g[0],e.y1=g[1]),b._defined(e,d)?(a._flip?e.bounds={x0:a._translatePercentToY(c.panel.yOuterScale(),b.y0()(e,d)),x1:a._translatePercentToY(c.panel.yOuterScale(),b.y1()(e,d)),y0:a._translatePercentToX(c.panel.xOuterScale(),b.x0()(e,d)),y1:a._translatePercentToX(c.panel.xOuterScale(),b.x1()(e,d))}:e.bounds={x0:a._translatePercentToX(c.panel.xOuterScale(),b.x0()(e,d)),x1:a._translatePercentToX(c.panel.xOuterScale(),b.x1()(e,d)),y0:a._translatePercentToY(c.panel.yOuterScale(),b.y0()(e,d)),y1:a._translatePercentToY(c.panel.yOuterScale(),b.y1()(e,d))},e):null},b.getPath=function(a){return null===a?null:b.renderer(a)},b.x0=function(a){return arguments.length?(dv.util.isValidValue(a,["isFunction"])||dv.log.error({msg:"Invalid value, line.x0 must be a function",data:{val:a}}),this._x0=a,this):this._x0},b.x1=function(a){return arguments.length?(dv.util.isValidValue(a,["isFunction"])||dv.log.error({msg:"Invalid value, line.x1 must be a function",data:{val:a}}),this._x1=a,this):this._x1},b.y0=function(a){return arguments.length?(dv.util.isValidValue(a,["isFunction"])||dv.log.error({msg:"Invalid value, line.y0 must be a function",data:{val:a}}),this._y0=a,this):this._y0},b.y1=function(a){return arguments.length?(dv.util.isValidValue(a,["isFunction"])||dv.log.error({msg:"Invalid value, line.y1 must be a function",data:{val:a}}),this._y1=a,this):this._y1},b.defined=function(a){return arguments.length?(dv.util.isValidValue(a,["isFunction"])||dv.log.error({msg:"Invalid value, line.defined must be a function",data:{val:a}}),this._defined=a,this):this._defined},b},a._errorBar=function(){var a=this,b={};return b.renderer=dv.svg.errorBar().x0(function(a,b){return a.bounds.x0}).x1(function(a,b){return a.bounds.x1}).y0(function(a,b){return a.bounds.y0}).y1(function(a,b){return a.bounds.y1}).flip(function(){return a._flip}),b.getBounds=function(c,d){var e=dv.util.clone(c);return b._defined(e,d)?(a._flip?e.bounds={x0:a._translatePercentToY(c.panel.yOuterScale(),b.y0()(e,d)),x1:a._translatePercentToY(c.panel.yOuterScale(),b.y1()(e,d)),y0:a._translatePercentToX(c.panel.xOuterScale(),b.x0()(e,d)),y1:a._translatePercentToX(c.panel.xOuterScale(),b.x1()(e,d))}:e.bounds={x0:a._translatePercentToX(c.panel.xOuterScale(),b.x0()(e,d)),x1:a._translatePercentToX(c.panel.xOuterScale(),b.x1()(e,d)),y0:a._translatePercentToY(c.panel.yOuterScale(),b.y0()(e,d)),y1:a._translatePercentToY(c.panel.yOuterScale(),b.y1()(e,d))},e):null},b.getPath=function(a){return null===a?null:b.renderer(a)},b.x0=function(a){return arguments.length?(this._x0=a,this):this._x0},b.x1=function(a){return arguments.length?(this._x1=a,this):this._x1},b.y0=function(a){return arguments.length?(this._y0=a,this):this._y0},b.y1=function(a){return arguments.length?(this._y1=a,this):this._y1},b.defined=function(a){return arguments.length?(this._defined=a,this):this._defined},b},a._poly=function(){var a=this,b={};return b.renderer=dv.svg.poly().xs(function(a,b){return a.bounds.x}).ys(function(a,b){return a.bounds.y}),b.getBounds=function(c,d){var e=dv.util.clone(c);return b._defined(c,d)&&(a._flip?e.bounds={x:a._translatePercentArrToY(c.panel.yOuterScale(),b.ys()(c,d)),y:a._translatePercentArrToX(c.panel.xOuterScale(),b.xs()(c,d))}:e.bounds={x:a._translatePercentArrToX(c.panel.xOuterScale(),b.xs()(c,d)),y:a._translatePercentArrToY(c.panel.yOuterScale(),b.ys()(c,d))}),e},b.getPath=function(a){return null===a?null:b.renderer(a)},b.xs=function(a){return arguments.length?(this._xs=a,this):this._xs},b.ys=function(a){return arguments.length?(this._ys=a,this):this._ys},b.defined=function(a){return arguments.length?(this._defined=a,this):this._defined},b},a}),dv.coord.polar=dv.coord.extend(function(){function a(){this._super(),this.innerRadius=this.startY,this.outerRadius=this.endY,this.startAngle=this.startX,this.endAngle=this.endX,this.innerRadius(0),this.outerRadius(0),this.startAngle(0),this.endAngle(360),this._type="polar"}return a._transformAngleRadiusToXY=function(a,b){return a+=-1.570796327,[b*Math.cos(a),b*Math.sin(a)]},a._translatePercentToRadius=function(a,b){var c=Math.abs(a[1]-a[0])/2,d=dv.util.getPercentValue(this.innerRadius(),c),e=dv.util.getPercentValue(this.outerRadius(),c);return(c-e-d)*b+d},a._translatePercentToTheta=function(a,b){var c=360,d=dv.util.getPercentValue(this.startAngle(),c),e=dv.util.getPercentValue(this.endAngle(),c),f=(e-d)*b+d;return.017453293*f},a._translatePercentArrToRadius=function(a,b){var c=this;return dv.util.map(b,function(b){return c._translatePercentToRadius(a,b)})},a._translatePercentArrToTheta=function(a,b){var c=this;return dv.util.map(b,function(b){return c._translatePercentToTheta(a,b)})},a._getRadiusRange=function(a,b){var c=dv.util.scaleRange(a),d=dv.util.scaleRange(b);return[0,Math.min(Math.abs(c[1]-c[0]),Math.abs(d[1]-d[0]))]},a._text=function(){function a(){var c=dv.svg.text.radial();return b._flip?c.angle(function(c,d){return b._translatePercentToTheta(c.panel.yOuterScale(),a.y()(c,d))}).radius(function(c,d){return b._translatePercentToRadius(b._getRadiusRange(c.panel.xOuterScale(),c.panel.yOuterScale()),a.x()(c,d))}):c.angle(function(c,d){return b._translatePercentToTheta(c.panel.xOuterScale(),a.x()(c,d))}).radius(function(c,d){return b._translatePercentToRadius(b._getRadiusRange(c.panel.xOuterScale(),c.panel.yOuterScale()),a.y()(c,d))})}var b=this;return a.x=function(a){return arguments.length?(this._x=a,this):this._x},a.y=function(a){return arguments.length?(this._y=a,this):this._y},a},a._point=function(){var a=this,b={};return b.renderer=dv.svg.symbol.radial().angle(function(a,b){return a.bounds.x}).radius(function(a,b){return a.bounds.y}),b.getBounds=function(c,d){if(c.hasOwnProperty("y")||(c.y=0),c.hasOwnProperty("x")||(c.x=0),b._defined(c,d)){var e=a._getRadiusRange(c.panel.xOuterScale(),c.panel.yOuterScale());a._flip?c.bounds={x:a._translatePercentToTheta(c.panel.xOuterScale(),b.y()(c,d)),y:a._translatePercentToRadius(e,b.x()(c,d))}:c.bounds={x:a._translatePercentToTheta(c.panel.xOuterScale(),b.x()(c,d)),y:a._translatePercentToRadius(e,b.y()(c,d))}}return c},b.getPath=function(a){return null===a||dv.util.isUndefined(a.bounds)?null:b.renderer(a)},b.x=function(a){return arguments.length?(this._x=a,this):this._x},b.y=function(a){return arguments.length?(this._y=a,this):this._y},b.defined=function(a){return arguments.length?(this._defined=a,this):this._defined},b},a._line=function(){var a=this,b={};return b.renderer=d3.svg.line.radial().angle(function(a,b){return a.bounds.x}).radius(function(a,b){return a.bounds.y}),b.getBounds=function(c,d){var e=[];return dv.util.each(c,function(d,f){var g=a._getRadiusRange(d.panel.xOuterScale(),d.panel.yOuterScale());d.hasOwnProperty("y")||(d.y=0),d.hasOwnProperty("x")||(d.x=0),b._defined(d,f)&&(a._flip?d.bounds={x:a._translatePercentToTheta(d.panel.xOuterScale(),b.y()(d,f)),y:a._translatePercentToRadius(g,b.x()(d,f))}:d.bounds={x:a._translatePercentToTheta(d.panel.xOuterScale(),b.x()(d,f)),y:a._translatePercentToRadius(g,b.y()(d,f))},e.push(c[f]))}),e},b.getPath=function(a){return null===a?null:b.renderer(a)},b.x=function(a){return arguments.length?(this._x=a,this):this._x},b.y=function(a){return arguments.length?(this._y=a,this):this._y},b.defined=function(a){return arguments.length?(this._defined=a,this):this._defined},b},a._area=function(){var a=this,b={};return b.renderer=d3.svg.area.radial(),b.getBounds=function(c,d){var e=[];return b.setupRenderer(),dv.util.each(c,function(c,d){var f=a._getRadiusRange(c.panel.xOuterScale(),c.panel.yOuterScale());if(c.hasOwnProperty("y")||(c.y=0),c.hasOwnProperty("x")||(c.x=0),b._defined(c,d)){var g=dv.util.clone(c);a._flip?g.bounds={x:a._translatePercentToRadius(f,b.x()(c,d)),y0:a._translatePercentToTheta(c.panel.xOuterScale(),b.y0()(c,d)),y1:a._translatePercentToTheta(c.panel.xOuterScale(),b.y1()(c,d))}:g.bounds={x:a._translatePercentToTheta(c.panel.xOuterScale(),b.x()(c,d)),y0:a._translatePercentToRadius(f,b.y0()(c,d)),y1:a._translatePercentToRadius(f,b.y1()(c,d))},e.push(g)}}),e},b.getPath=function(a){return b.setupRenderer(),null===a?null:b.renderer(a)},b.setupRenderer=function(){a._flip?b.renderer.angle(null).innerRadius(null).outerRadius(null).radius(function(a,b){return a.bounds.x}).startAngle(function(a,b){return a.bounds.y0}).endAngle(function(a,b){return a.bounds.y1}):b.renderer.radius(null).startAngle(null).endAngle(null).angle(function(a,b){return a.bounds.x}).innerRadius(function(a,b){return a.bounds.y0}).outerRadius(function(a,b){return a.bounds.y1})},b.x=function(a){return arguments.length?(this._x=a,this):this._x},b.y0=function(a){return arguments.length?(this._y0=a,this):this._y0},b.y1=function(a){return arguments.length?(this._y1=a,this):this._y1},b.defined=function(a){return arguments.length?(this._defined=a,this):this._defined},b},a._rect=function(){var a=this,b={};return b.renderer=d3.svg.arc().startAngle(function(a,b){return a.bounds.x0}).endAngle(function(a,b){return a.bounds.x1}).innerRadius(function(a,b){return a.bounds.y0}).outerRadius(function(a,b){return a.bounds.y1}),b.getBounds=function(c,d){var e=dv.util.clone(c);if(!b._defined(e,d))return null;var f=a._getRadiusRange(c.panel.xOuterScale(),c.panel.yOuterScale());return a._flip?e.bounds={x0:a._translatePercentToTheta(c.panel.yOuterScale(),b.y0()(e,d)),x1:a._translatePercentToTheta(c.panel.yOuterScale(),b.y1()(e,d)),y0:a._translatePercentToRadius(f,b.x0()(e,d)),y1:a._translatePercentToRadius(f,b.x1()(e,d))}:e.bounds={x0:a._translatePercentToTheta(c.panel.xOuterScale(),b.x0()(e,d)),x1:a._translatePercentToTheta(c.panel.xOuterScale(),b.x1()(e,d)),y0:a._translatePercentToRadius(f,b.y0()(e,d)),y1:a._translatePercentToRadius(f,b.y1()(e,d))},e},b.getPath=function(a){return null===a?null:b.renderer(a)},b.x0=function(a){return arguments.length?(this._x0=a,this):this._x0},b.x1=function(a){return arguments.length?(this._x1=a,this):this._x1},b.y0=function(a){return arguments.length?(this._y0=a,this):this._y0},b.y1=function(a){return arguments.length?(this._y1=a,this):this._y1},b.defined=function(a){return arguments.length?(this._defined=a,this):this._defined},b},a._poly=function(){var a=this,b={};return b.renderer=dv.svg.poly.radial().angles(function(a,b){return a.bounds.x}).radii(function(a,b){return a.bounds.y}),b.getBounds=function(c,d){var e=dv.util.clone(c);if(b._defined(c,d)){var f=a._getRadiusRange(c.panel.xOuterScale(),c.panel.yOuterScale());a._flip?e.bounds={x:a._translatePercentArrToTheta(c.panel.xOuterScale(),b.ys()(c,d)),y:a._translatePercentArrToRadius(f,b.xs()(c,d))}:e.bounds={x:a._translatePercentArrToTheta(c.panel.xOuterScale(),b.xs()(c,d)),y:a._translatePercentArrToRadius(f,b.ys()(c,d))}}return e},b.getPath=function(a){return null===a?null:b.renderer(a)},b.xs=function(a){return arguments.length?(this._xs=a,this):this._xs},b.ys=function(a){return arguments.length?(this._ys=a,this):this._ys},b.defined=function(a){return arguments.length?(this._defined=a,this):this._defined},b},a}),dv.guide=dv.extend(function(){function a(){this._renderer=null}return a._render=function(){dv.log.warn({msg:"dv.guide._render should not be called directly, try using dv.guide.legend.render or dv.guide.axis.render"})},a._scale=function(a){return arguments.length?(this.__scale=a,this):this.__scale},a.orientation=function(a){return arguments.length?(this._orientation=a,this):this._orientation},a._parent=function(a){return arguments.length?(this.__parent=a,this):this.__parent},a.scaleIndex=function(a){return arguments.length?(this._scaleIndex=a,this):this._scaleIndex},a.title=function(a){return arguments.length?(this._title=a,this):this._title},a}),dv.guide.axes=dv.extend(function(){function a(){this._axes={},this._emptyTickFormat=function(){return""}}return a._initializeAxisRenderers=function(){this._eachAxis(function(a,b,c){if(c.hasOwnProperty("_orientation")||"x"!==a||(c._orientation="bottom"),c.hasOwnProperty("_orientation")||"y"!==a||(c._orientation="left"),this._chart._coord.flip())switch(c._orientation){case"top":c._orientation="right";break;case"right":c._orientation="top";break;case"bottom":c._orientation="left";break;case"left":c._orientation="bottom"}})},a._measure=function(a){var b=this._chart._g.select(".panels"),c=this._chart._axisLabelContainer;return this._eachAxis(function(d,e,f){var g=this._changeScaleRangeToLocal(a.getOuterScale(d));this._chart._coord instanceof dv.coord.polar||"none"===f||(f._chart(this._chart)._scale(g[e])._parent(b)._labelParent(c),a.margins(f._measure(a.margins(),a.bounds(),a)))}),this},a._getAllOrientations=function(){var a={};return this._eachAxis(function(b,c,d){a[d._orientation]=b}),a},a._render=function(a,b,c){return this._eachAxis(function(d,e,f){var g=this._changeScaleRangeToLocal(c.getOuterScale(d));this._chart._coord instanceof dv.coord.polar||"none"===f?(a.selectAll(".axis-"+d+".axis-index-"+e).transition().duration(this._chart._duration).style("opacity",0).remove(),this._chart._chartContainer.select(".axes-labels .axis-"+d+".axis-index-"+e).transition().duration(this._chart._duration).style("opacity",0).remove()):f._chart(this._chart)._parent(a)._scale(g[e])._labelParent(b)._render(a,c,c.bounds())}),this},a._measureTitles=function(a){var b=this._chart._axisLabelContainer;return this._eachAxis(function(c,d,e){if("none"!==e){var f=e._chart(this._chart)._measureAxisTitle(b,c,d,a);a.left+=f.left,a.top+=f.top,a.right-=f.right,a.bottom-=f.bottom}}),a},a._renderTitles=function(a,b){var c=this._chart._axisLabelContainer;this._eachAxis(function(d,e,f){"none"!==f&&f.title()?f._chart(this._chart)._renderAxisTitle(c,b,d,e,a):c.selectAll(".axis-title-"+d+".axis-title-index-"+e).transition().duration(this._chart._duration).style("opacity",0).remove()})},a._changeScaleRangeToLocal=function(a){var b=a.range(),c=a.innerScaleGroup();for(var d in c)dv.util.scaleRange(c[d],[b[0],b[1]]);return c},a._eachAxis=function(a){for(var b in this._axes){var c=this._axes[b];for(var d in c)a.call(this,b,+d,c[d])}},a._add=function(a,b,c){c=void 0===c?0:c;var d=this._axes[a];return d||(this._axes[a]=d={}),d[c]=b,this},a._axes=function(a){return arguments.length?(this._axes=a,this):this._axes},a._get=function(a){return this._axes[a]},a._empty=function(){for(var a in this._axes)delete this._axes[a];return this._axes={},this},a._chart=function(a){return arguments.length?(this._chart=a,this):this._chart},a}),dv.guide.axis=dv.guide.extend(function(){function a(){this._ticks=d3.functor(5),this._tickInterval=void 0,this._labelGroup=null,this._htmlLabels=!1}function b(a,b){return a+"%"}return a._measure=function(a,b,c){var d,e=this._getAxisOffset(b),f=dv.util.scaleRange(this._scale()),g=this._ticks.call(this,Math.abs(f[1]-f[0])),h=this,i=this._parent().append("g").classed("temp-axis",!0);this._shouldDrawAxisLabels(c)&&(d=this._constructLabelGroup(this.__labelParent,e,!0));var j=this._constructD3Axis(d,b,g,c),k=this._measureAxis(i,e,j),l={left:k.x+e[0],top:k.y+e[1],right:k.x+k.width+e[0],bottom:k.y+k.height+e[1]};d&&d.selectAll("span").each(function(){var a=this,b=d3.select(this),c=h._htmlLabels?b.html():b.text();if(c){var d="right"===h._orientation?a.offsetWidth/2:0,e="bottom"===h._orientation?a.offsetHeight/2:0,f=[a.parentNode.parentNode.offsetLeft+a.parentNode.offsetLeft+d,a.parentNode.parentNode.offsetTop+a.parentNode.offsetTop+e];l.left=Math.min(f[0],l.left),l.top=Math.min(f[1],l.top),l.right=Math.max(f[0]+d,l.right),l.bottom=Math.max(f[1]+e,l.bottom)}}),i.remove(),d&&d.remove();var m={};return m.left=Math.abs(Math.min(l.left-b.left,0)),m.top=Math.abs(Math.min(l.top-b.top,0)),m.right=Math.max(l.right-b.right,0),m.bottom=Math.max(l.bottom-b.bottom,0),this._unionAxisPadding(m,a)},a._render=function(a,b,c){if(!this._scale())throw new Error("The axis does not have a scale associated with it.");var d,e=dv.util.scaleRange(this._scale()),f=this._ticks.call(this,Math.abs(e[1]-e[0])),g=this._getAxisOffset(c);this._shouldDrawAxisLabels(b)?d=this._constructLabelGroup(this.__labelParent,g):this.__labelParent.selectAll(".axis-"+this._scale().property()+".axis-index-"+this._scale().scaleIndex()).remove();var h=this._constructD3Axis(d,c,f,b);return this._renderAxis(this._parent(),b.bounds(),g,h,d),this},a._shouldDrawAxisLabels=function(a){var b=a.facet(),c=this._scale().property(),d=this.orientation();return b._isFree(c)&&b._showAllPanelLabelsIfFree()||a.visibleAxisLabelOrientations()[d]},a._unionAxisPadding=function(a,b){return b.left=Math.max(b.left,a.left),b.top=Math.max(b.top,a.top),b.right=Math.max(b.right,a.right),b.bottom=Math.max(b.bottom,a.bottom),b},a._constructLabelGroup=function(a,b,c){var d=".axis-"+this._scale().property()+".axis-index-"+this._scale().scaleIndex()+(c?" .temp-axis":""),e=a.selectAll(d).data([0]);return e.enter().append("div").classed("axis-"+this._scale().property()+" axis-index-"+this._scale().scaleIndex(),!0).classed("temp-axis",c).style("left",b[0]+"px").style("top",b[1]+"px"),dv.ANIMATION?e.transition().delay(this._chart().delay()).duration(this._chart().duration()).ease(this._chart().ease()).style("left",b[0]+"px").style("top",b[1]+"px"):e.style("left",b[0]+"px").style("top",b[1]+"px"),e},a._getAxisOffset=function(a){switch(this._orientation){case"bottom":return[0,a.bottom];case"left":return[a.left,0];case"top":return[0,a.top];case"right":return[a.right,0]}},a._constructD3Axis=function(a,c,d,e){var f,g=this._getDefaultTickSize(c),h=dv.util.isUndefined(this._tickSize)?g:this._tickSize,i=dv.util.isUndefined(this._minorTickSize)?g:this._minorTickSize;if("left"===this._orientation&&(f="right"),"right"===this._orientation&&(f="left"),"top"===this._orientation&&(f="bottom"),"bottom"===this._orientation&&(f="top"),"x"===this._scale().property()){var j=dv.util.scaleRange(this._scale());j[0]+=this._chart().coord().startX(),j[1]-=this._chart().coord().endX(),this._scale()instanceof dv.scale.ordinal?this._scale().rangeBands(j):this._scale().range(j)}return dv.svg.axis()._orient(f)._labelParent(a)._panel(e)._ticks(dv.util.isUndefined(d)?5:d,this._tickInterval)._tickSize(h,i,h)._defaultTickSize(g())._tickDx(dv.util.isUndefined(this._tickDx)?this._getDefaultTickDx():this._tickDx)._tickDy(dv.util.isUndefined(this._tickDy)?this._getDefaultTickDy():this._tickDy)._tickAnchor(dv.util.isUndefined(this._tickAnchor)?this._getDefaultTickAnchor():this._tickAnchor)._tickFormat(dv.util.isUndefined(this._tickFormat)&&"fill"===this._chart().position()&&"y"===this._scale().property()?b:this._tickFormat)._tickValues(this._tickValues)._htmlLabels(this._htmlLabels)._tickSubdivide(this._tickSubdivide)._scale(this._scale()._d3Scale)},a._renderAxis=function(a,b,c,d,e){var f=a.selectAll(".axis-"+this._scale().property()+".axis-index-"+this._scale().scaleIndex()).data([0]);d._labelParent(e),f.enter().append("g").classed("axis axis-"+this._scale().property()+" axis-index-"+this._scale().scaleIndex(),!0).attr("transform","translate("+c[0]+","+c[1]+")"),dv.ANIMATION&&(f=f.transition().delay(this._chart().delay()).duration(this._chart().duration()).ease(this._chart().ease())),f.attr("transform","translate("+c[0]+","+c[1]+")").call(d)},a._measureAxis=function(a,b,c){return a.attr("transform","translate("+b[0]+","+b[1]+")").call(c),a.node().getBBox()},a._measureAxisTitle=function(a,b,c,d){var e={left:0,top:0,right:0,bottom:0};if(this._title){var f=a.append("div").classed("temp-axis-title",!0),g=this._titleOrientation||this._orientation,h="top"===g||"bottom"===g?d.right-d.left:d.bottom-d.top,i=this._createAndSizeAxisTitle(f,g,b,c,h),j=i.node().getBoundingClientRect();"top"===g||"bottom"===g?e[g]+=j.height:e[g]+=j.width,f.remove()}return e},a._renderAxisTitle=function(a,b,c,d,e){var f,g=this._titleOrientation||this._orientation;if(this._title){var h=a.selectAll(".axis-title-"+c+".axis-title-index-"+d).empty(),i="left"===g||"right"===g,j=i?b[g][1]-e.top:b[g][0]-e.left,k=2*j,l=this._createAndSizeAxisTitle(a,g,c,d,k);dv.ANIMATION&&(f=l.transition().duration(this._chart().duration()).delay(this._chart().delay()).ease(this._chart().ease())),this._positionAxisTitle(h||!dv.ANIMATION?l:f,b[g],g),f?f.style("opacity",1):l.style("opacity",1)}},a._createAndSizeAxisTitle=function(b,c,d,e,f){var g=b.selectAll(".axis-title-"+d+".axis-title-index-"+e).data([a]);return g.enter().append("div").classed("axis-title axis-title-"+d+" axis-title-index-"+e,!0).style("opacity",dv.ANIMATION?0:1),g.text(this._title).style("width",f-10+"px").classed({top:"top"===c,bottom:"bottom"===c,left:"left"===c,right:"right"===c})},a._positionAxisTitle=function(a,b,c){a.style("left",function(){var a=0;return b[0]+a+"px"}).style("top",function(){var a=0;return"top"===c&&(a=-this.offsetHeight),b[1]+a+"px"})},a._getDefaultTickSize=function(a){return"bottom"===this._orientation?d3.functor(a.bottom-a.top):"left"===this._orientation?d3.functor(a.right-a.left):"top"===this._orientation?d3.functor(a.bottom-a.top):d3.functor(a.right-a.left)},a._getDefaultTickDx=function(){return"bottom"===this._orientation||"top"===this._orientation?d3.functor(0):d3.functor(-12)},a._getDefaultTickDy=function(){return"bottom"===this._orientation||"top"===this._orientation?d3.functor(-12):d3.functor(0)},a._getDefaultTickAnchor=function(){return"left"===this._orientation?d3.functor("end"):"right"===this._orientation?d3.functor("start"):d3.functor("middle")},a._labelParent=function(a){return arguments.length?(this.__labelParent=a,this):this.__labelParent},a.ticks=function(a,b){return arguments.length?(arguments.length>1?(this._ticks=function(){return a},this._tickInterval=b):(this._ticks=d3.functor(a),this._tickInterval=void 0),this):dv.util.isFinite(this._tickInterval)?[this._ticks,this._tickInterval]:this._ticks},a.tickSubdivide=function(a){return arguments.length?(this._tickSubdivide=a,this):this._tickSubdivide},a.tickSize=function(a){return arguments.length?(this._tickSize=d3.functor(a),this):this._tickSize},a.minorTickSize=function(a){return arguments.length?(this._minorTickSize=d3.functor(a),this):this._minorTickSize},a.tickDx=function(a){return arguments.length?(this._tickDx=d3.functor(a),this):this._tickDx},a.htmlLabels=function(a){return arguments.length?(this._htmlLabels=a,this):this._htmlLabels},a.tickDy=function(a){return arguments.length?(this._tickDy=d3.functor(a),this):this._tickDy},a.tickAnchor=function(a){return arguments.length?(this._tickAnchor=d3.functor(a),this):this._tickAnchor},a.tickFormat=function(a){if(!arguments.length){var b=this._scale()._d3Scale;return this._tickFormat?this._tickFormat:b.tickFormat?b.tickFormat(b):function(a){return a}}return this._tickFormat=a,this},a.tickValues=function(a){return arguments.length?(this._tickValues=a,this):this._tickValues},a.titleOrientation=function(a){return arguments.length?(this._titleOrientation=a,this):this._titleOrientation},a._chart=function(a){return arguments.length?(this.__chart=a,this):this.__chart},a}),dv.svg.axis=function(){function a(a,b){a.attr("transform",function(a){var c=b(a);return dv.util.isFinite(c)?"translate("+c+",0)":null})}function b(a,b){a.attr("transform",function(a){var c=b(a);return dv.util.isFinite(c)?"translate(0,"+c+")":null})}function c(a,b,c){var d=d3.select(a).select("span").node().offsetWidth,e="end"===c?-d:"middle"===c?-d/2:0;return b+e}function d(a,b,c){var d=d3.select(a).select("span").node().offsetHeight,e="top"===c?0:"middle"===c?-d/2:-d;return b+e}function e(a,b,c){var d=[];if(c&&b.length>1){for(var e,f,g=dv.util.scaleExtent(a.domain()),h=-1,i=b.length,j=(b[1]-b[0])/++c;++h<i;)for(e=c;--e>0;)(f=+b[h]-e*j)>=g[0]&&d.push(f);for(--h,e=0;++e<c&&(f=+b[h]+e*j)<g[1];)d.push(f)}return d}function f(f){var v=function(a,b,e,f,g){var h={};switch(g){case"top":h.top=d(a,-p.call(a,b,e),"top"),h.left=f(b)+c(a,o.call(a,b,e),q.call(a,b,e));break;case"bottom":h.top=d(a,p.call(a,b,e),"bottom"),h.left=f(b)+c(a,o.call(a,b,e),q.call(a,b,e));break;case"right":h.top=f(b)+d(a,p.call(a,b,e),"middle"),h.left=c(a,o.call(a,b,e),q.call(a,b,e));break;case"left":h.top=f(b)+d(a,p.call(a,b,e),"middle"),h.left=c(a,-o.call(a,b,e),q.call(a,b,e))}h.top=(isNaN(h.top)?0:h.top)+"px",h.left=(isNaN(h.left)?0:h.left)+"px";var i=q.call(a,b,e);return d3.select(a).classed({start:"start"===i,middle:"middle"===i,end:"end"===i}),h},w=function(a,b){["top","left"].forEach(function(c){a.style(c,function(a,d){return b[d][c]})})},x=function(a,b,c){if(h){var d,e,f,k,l=null==g?i.tickFormat?i.tickFormat.apply(i,r):String:g;h.style("position","absolute"),d=h.selectAll(".axis-label").data(a,String),e=d.enter().append("div").classed("axis-label",!0).style("opacity",1e-6).style("position","absolute"),f=d3.transition(d.exit()).style("opacity",1e-6).remove(),k=d3.transition(d).style("opacity",1),e.append("span");var m=d.selectAll("span"),n=function(a,b,c){return l.call(this,a,c,panel)};t?m.html(n):m.text(n);var o,p=[],q=[],s=[],u=[];if(!i.ticks){var x=i.rangeBand()/2;o=function(a){return c(a)+x}}e.each(function(a,c){p[c]=v(this,a,c,o||b,j)}),k.each(function(a,d){q[d]=v(this,a,d,o||b,j),s[d]=v(this,a,d,o||c,j)}),i.ticks&&f.each(function(a,b){u[b]=v(this,a,b,c,j)}),w(e,p),w(d,q),w(k,s),i.ticks&&w(f,u)}};f.each(function(){var c,d=d3.select(this),f=null==s?i.ticks?i.ticks.apply(i,r):i.domain():s,g=e(i,f,u),h=d.selectAll(".minor").data(g,String),o=h.enter().insert("line","g").attr("class","tick minor").style("opacity",1e-6),p=d3.transition(h.exit()).style("opacity",1e-6).remove(),q=d3.transition(h).style("opacity",1),t=d.selectAll(".axis-tick").data(f,String),v=t.enter().insert("g","path").classed("axis-tick",!0).style("opacity",1e-6),w=d3.transition(t.exit()).style("opacity",1e-6).remove(),y=d3.transition(t).style("opacity",1),z=dv.util.scaleRangeNoReverse(i);path=d.selectAll(".domain").data([0]),pathEnter=path.enter().append("path").attr("class","domain"),pathUpdate=d3.transition(path);var A=i.copy(),B=this.__chart__||A;this.__chart__=A,v.append("line").attr("class","tick");var C=v.select("line"),D=y.select("line"),E=function(a,b,c,d){var e=a.call(this,b,c,d);return null==e||isNaN(e)?n:e};switch(j){case"bottom":c=a,o.attr("y2",function(a,b){return E.call(this,l,a,b,panel)}),q.attr("x2",0).attr("y2",function(a,b){return E.call(this,l,a,b,panel)}),C.attr("y2",function(a,b){return E.call(this,k,a,b,panel)}),D.attr("x2",0).attr("y2",function(a,b){return E.call(this,k,a,b,panel)}),pathUpdate.attr("d",function(a,b){return"M"+z[0]+","+E.call(this,m,a,b,panel)+"V0H"+z[1]+"V"+E.call(this,m,a,b,panel)});break;case"top":c=a,o.attr("y2",function(a,b){return-E.call(this,l,a,b,panel)}),q.attr("x2",0).attr("y2",function(a,b){return-E.call(this,l,a,b,panel)}),C.attr("y2",function(a,b){return-E.call(this,k,a,b,panel)}),D.attr("x2",0).attr("y2",function(a,b){return-E.call(this,k,a,b,panel)}),pathUpdate.attr("d",function(a,b){return"M"+z[0]+","+-E.call(this,m,a,b,panel)+"V0H"+z[1]+"V"+-E.call(this,m,a,b,panel)});break;case"left":c=b,o.attr("x2",function(a,b){return-E.call(this,l,a,b,panel)}),q.attr("x2",function(a,b){return-E.call(this,l,a,b,panel)}).attr("y2",0),C.attr("x2",function(a,b){return-E.call(this,k,a,b,panel)}),D.attr("x2",function(a,b){return-E.call(this,k,a,b,panel)}).attr("y2",0),pathUpdate.attr("d",function(a,b){return"M"+-E.call(this,m,a,b,panel)+","+z[0]+"H0V"+z[1]+"H"+-E.call(this,m,a,b,panel)});break;case"right":c=b,o.attr("x2",function(a,b){return E.call(this,l,a,b,panel)}),q.attr("x2",function(a,b){return E.call(this,l,a,b,panel)}).attr("y2",0),C.attr("x2",function(a,b){return E.call(this,k,a,b,panel)}),D.attr("x2",function(a,b){return E.call(this,k,a,b,panel)}).attr("y2",0),pathUpdate.attr("d",function(a,b){return"M"+E.call(this,m,a,b,panel)+","+z[0]+"H0V"+z[1]+"H"+E.call(this,m,a,b,panel)})}if(i.ticks)B.ticks&&(v.call(c,B),o.call(c,B)),y.call(c,A),w.call(c,A),q.call(c,A),p.call(c,A);else{var F=A.rangeBand()/2,G=function(a){return A(a)+F};v.call(c,G),y.call(c,G)}x(f,B,A)})}var g,h,i=d3.scale.linear(),j="bottom",k=d3.functor(6),l=d3.functor(6),m=d3.functor(6),n=0,o=d3.functor(0),p=d3.functor(0),q=d3.functor("start"),r=[10],s=null,t=!1,u=0;return f._scale=function(a){return arguments.length?(i=a,f):i},f._orient=function(a){return arguments.length?(j=a,f):j},f._ticks=function(){return arguments.length?(r=arguments,f):r},f._tickValues=function(a){return arguments.length?(s=a,f):s},f._tickFormat=function(a){return arguments.length?(g=a,f):g},f._htmlLabels=function(a){return arguments.length?(t=a,f):t},f._tickSize=function(a,b,c){if(!arguments.length)return k;var d=arguments.length-1;return k=d3.functor(a),l=d>1?d3.functor(b):k,m=d>0?d3.functor(arguments[d]):k,f},f._defaultTickSize=function(a){return arguments.length?(n=a,f):n},f._tickDx=function(a){return arguments.length?(o=a,f):o},f._tickDy=function(a){return arguments.length?(p=a,f):p},f._tickAnchor=function(a){return arguments.length?(q=a,f):q},f._tickSubdivide=function(a){return arguments.length?(u=+a,f):u},f._panel=function(a){return arguments.length?(panel=a,f):panel},f._labelParent=function(a){return arguments.length?(h=a,f):h},f},dv.guide.legends=dv.extend(function(){function a(){this._legArr=[],this.__hide=!1,this._ad={left:0,right:0,width:0,height:0}}return a._render=function(a){if(this._w=0,this._h=0,!this.__hide){var b=a.el.select(".legends"),c=this,d=b.selectAll(".legend").data(this._legArr);d.exit().transition().duration(a.duration).style("opacity",0).remove();var e=d.enter().append("g").classed("legend",!0);dv.ANIMATION&&e.style("opacity",0),d.each(function(b,d){for(var e={},f=(b.props[0],c._getScale(a,b.props[0])),g=f.domain(),h=0;h<b.props.length;h++){var i=b.props[h],j=c._getScale(a,b.props[h]);if(!j.hasSameDomain(g))throw new Error("Can't render single legend from multiple domains");e[i]=a.scales[i]}b.guide._render(d3.select(this),e,{
dims:c._ad,renderOpts:a}),c._w+=b.guide._getUsedWidth(),c._h+=b.guide._getUsedHeight(),c._ad=b.guide._getAdjustedDimensions(c._ad)})}return this},a._getScale=function(a,b){var c=a.scales[b];if(void 0===b||void 0===c||void 0===c[0])throw new Error("A '"+b+"'' legend has been called for, but '"+b+" hasn't been mapped to data.");return c[0]},a._add=function(a){return this._legArr.push(a),this},a._remove=function(a){for(var b in a)for(var c=a[b],d=0;d<this._legArr.length;d++){for(var e=this._legArr[d].props,f=!0,g=0;g<e.length;g++)e[g]===c&&(e.splice(g,1),g--),0===e.length&&(f=!1);f||(this._legArr.splice(d,1),d--)}},a._legends=function(a){return arguments.length?(this._legArr=a,this):this._legArr},a._allowedDimensions=function(a){return arguments.length?(this._ad=a,this):this._ad},a._getWidth=function(){return this._w},a._getHeight=function(){return this._h},a._hide=function(a){return arguments.length?(this.__hide=a,this):this.__hide},a._empty=function(){for(var a=0;a<this._legArr.length;a++)delete this._legArr[a];return this._legArr=[],this},a}),dv.guide.legend=dv.guide.extend(function(){function a(){this._overlay=!1,this._orientation="top",this._vGap=5,this._hGap=15,this._defaultPadding=this._padding={top:10,left:10,right:10,bottom:10},this._swatchWidth=15,this._swatchHeight=10,this._innerPadding=5,this._spanPercent=.75,this._lineHeight=0,this._entriesWidth=[]}function b(a){var b=this;return a.each(function(a,c){b._entryWidths[c]=Math.min(b._entryWidths[c],b._width),b._lineHeight=Math.max(b._lineHeight,this.getBBox().height)}),b._entryWidths}function c(a){for(var b,e=0,f=0,g=0,h=!1,i=0,j=0,k=[],l=0;l<this._legendWidths.length;l++)if(e+=(0===f?0:this._hGap)+this._legendWidths[l],f<a.data.length&&e<=this._width){if(this._legendWidths[l]<=a.data[f]+g)j+=0===f?0:this._hGap,k.push({x:j,y:i}),j+=a.data[f]+g,g=0;else{if((b=this._legendWidths[l]-a.data[f])<=a.padding)return a.padding-=b,a.data[f]=this._legendWidths[l],c.call(this,a);if(!(f+1<a.data.length&&this._legendWidths[l]>=a.data[f]+a.data[f+1]*this._spanPercent+g))return a=d.call(this,a.data.length-1),c.call(this,a);f+1<=a.data.length?(g+=(0===f?0:this._hGap)+a.data[f],e-=(0===f?0:this._hGap)+this._legendWidths[l],l--):(e=e-this._legendWidths[l]+g+a.data[f],g=0,j+=0===f?0:this._hGap,k.push({x:j,y:i}),j+=a.data[f]+g,f++)}f++}else{if(f+1===a.data.length&&a.data.length>1)return a=d.call(this,a.data.length-1),c.call(this,a);f===a.data.length&&(h=!0),i+=this._lineHeight+this._vGap,e=j=0,f=0,g=0,l--}return f===a.data.length&&(h=!0),h?{offsets:k,cols:a}:(a=d.call(this,a.data.length-1),c.call(this,a))}function d(a){var b={data:[],padding:this._width},c=0,e=0;for(this._isVAligned()&&(a=Math.ceil(this._legendWidths.length/Math.floor(this._height/(this._lineHeight+this._vGap)))),e=0;a>e;e++)c+=this._legendWidths[e]+this._hGap;return c-=this._hGap,c>this._width&&a>1?d.call(this,a-1):(b.data=this._legendWidths.slice(0,a),b.padding-=c,b.padding<0&&(b.padding=0),b)}function e(a,b,c,d){return"M"+a+","+b+"L"+(a+c)+","+b+"L"+(a+c)+","+(b+d)+"L"+a+","+(b+d)+"Z"}function f(a,b,c,d){var e=b+d>>1;return"M"+a+","+e+"L"+c+","+e}function g(a,b){return this._scales.hasOwnProperty("fill")?e.call(this,0,0,this._swatchWidth,this._swatchHeight):f.call(this,0,0,this._swatchWidth,this._swatchHeight)}return a._render=function(a,e,f){var g=a,h=f.dims,i=this;this._renderingOptions=f.renderOpts,this._scales=e,this._transformData=[],this._width=h.width-this._padding.left-this._padding.right,this._height=h.height-this._padding.top-this._padding.bottom;var j=this._drawEntries(a);this._legendWidths=b.call(this,j);var k=d.call(this,Math.min(this._legendWidths.length,Math.floor(this._width/this._swatchWidth))),l=c.call(this,k),m=l.offsets;k=l.cols,this._width=this._width-k.padding+this._hGap*(k.data.length-1),this._height=this._lineHeight+m[m.length-1].y,j.each(function(a,b){var c=d3.select(this);dv.ANIMATION&&(c=c.transition().duration(i._renderingOptions.duration).delay(i._renderingOptions.delay).ease(i._renderingOptions.ease)),c.attr("transform","translate("+m[b].x+", "+m[b].y+")")}),this._renderingOptions.firstRender||(g=a.transition().duration(this._renderingOptions.duration).style("opacity",1));var n="right"===this._orientation?h.left+h.width-this._width-this._padding.right:h.left+this._padding.left,o="bottom"===this._orientation?h.top+h.height-this._height-this._padding.bottom:h.top+this._padding.top;g.attr("transform","translate("+n+","+o+")"),this._renderingOptions.firstRender&&g.transition().duration(this._renderingOptions.duration).style("opacity",1)},a._drawEntries=function(a){var b=this,c=[];this._entryWidths=[];for(var d in this._scales){c=this._scales[d][0].domain();break}var e=a.selectAll(".legend-entry").data(c);e.exit().transition().duration(this._renderingOptions.duration).style("opacity",0).remove();var f=e.enter().append("g").classed("legend-entry",!0);return f.append("path"),f.append("text").classed("legend-entry-label",!0),f.append("text").classed("legend-entry-value",!0),e.select("path").attr("d",function(a,c){return g.call(b,a,c)}).call(function(a){a.attr("style",""),b._scales.hasOwnProperty("fill")&&a.style("fill",function(a,c){return b._scales.fill[0].mapValue(a)}),b._scales.hasOwnProperty("stroke")&&a.style("stroke",function(a,c){return b._scales.stroke[0].mapValue(a)}).style("stroke-width",2),b._scales.hasOwnProperty("linetype")&&(a.style("stroke-dasharray",function(a,c){return dv.util.svg.getDasharray(b._scales.linetype[0].mapValue(a))}),b._scales.hasOwnProperty("stroke")||a.style("stroke","#000"),a.style("stroke-width",2)),b._scales.hasOwnProperty("size")&&a.style("stroke-width",function(a,c){return b._scales.size[0].mapValue(a)})}).each(function(a,c){b._entryWidths[c]=this.getBBox().width}),e.select("text.legend-entry-label").attr("x",this._swatchWidth+this._innerPadding).attr("y",10).text(function(a,c){return dv.util.isUndefined(b._labels)?a:b._labels[c%b._labels.length]}).each(function(a,c){b._entryWidths[c]+=b._innerPadding+this.getBBox().width}),e.select("text.legend-entry-value").attr("y",10).attr("x",function(a,c){return b._entryWidths[c]+b._innerPadding}).text(function(a,c){return dv.util.isUndefined(b._values)?"":b._values[c]}).style("fill",function(a,c){return dv.util.isUndefined(b._scales.stroke)?dv.util.isUndefined(b._scales.fill)?void 0:b._scales.fill[0].mapValue(a):b._scales.stroke[0].mapValue(a)}).each(function(a,c){var d=this.getBBox().width;b._entryWidths[c]+=d+(d>0?b._innerPadding:0)}),e},a._getAdjustedDimensions=function(a){if(this._overlay)return a;var b=this._padding.left+this._width+this._padding.right,c=this._padding.top+this._height+this._padding.bottom;return"left"===this._orientation?(a.left+=b,a.width-=b):"top"===this._orientation?(a.top+=c,a.height-=c):"right"===this._orientation?a.width-=b:"bottom"===this._orientation&&(a.height-=c),a},a._getUsedWidth=function(){return this._overlay?0:this._isVAligned()?this._width+this._padding.left+this._padding.right:0},a._getUsedHeight=function(){return this._overlay?0:this._isVAligned()?0:this._height+this._padding.top+this._padding.bottom},a._isVAligned=function(){return"left"===this._orientation||"right"===this._orientation},a.vGap=function(a){return arguments.length?(this._vGap=a,this):this._vGap},a.hGap=function(a){return arguments.length?(this._hGap=a,this):this._hGap},a.padding=function(a){return arguments.length?(this._padding=dv.util.merge(this._defaultPadding,a),this):this._padding},a.align=function(a){return arguments.length?(this._align=a,this):this._align},a.labels=function(a){return arguments.length?(this._labels=a,this):this._labels},a.values=function(a){return arguments.length?(this._values=a,this):this._values},a.overlay=function(a){return arguments.length?(this._overlay=a,this):this._overlay},a}),dv.guide.custom=dv.guide.extend(function(){function a(a){this._render=function(){return dv.log.warn({msg:"empty render function on custom guide"}),this},this._getAdjustedDimensions=function(a){return a},this._getUsedWidth=function(){return 0},this._getUsedHeight=function(){return 0}}return a.setFunc=function(a,b){return this[a]=b,this},a}),dv.geom=dv.container.extend(function(){function a(){this._super(),this._defaultAes={},this._behaviorsLayer=null,this._dodgePadding=0,this._initializeDefaultAes()}return a._initializeDefaultAes=function(){this._defaultAes.x=1,this._defaultAes.y=1,this._defaultAes.shape="circle",this._defaultAes.linetype="solid"},a._prerender=function(a){this._trainedScales={},this._chart=a,this.normalizedData(this._normalizeData(this.data())),this._calculateStats(),this._inheritChartAesthetics(a)},a._inheritChartAesthetics=function(a){for(var b in a._aes){var c=a._aes[b];this._aes[b]||(this._aes[b]={});for(var d in c)this._aes[b][d]||(this._aes[b][d]=c[d])}},a._trainScales=function(){},a._createDefaultScales=function(){for(var a in this._defaultAes)this._aes.hasOwnProperty(a)||(this._aes[a]={},this._aes[a][0]=dv.scale.constant().value(this._defaultAes[a]).property(a)),delete this._defaultAes[a]},a._render=function(a){var b=this;this._geomGroup=d3.select(a);var c=this._geomGroup.selectAll(".series").data(this._nestData);c.exit().call(b.exitSeriesGroup,b),c.enter().append("g").classed("series",!0),c.call(b.updateGroups,b.enterPen,b.pen,b.enterPen,b).call(b.updateDataPoints,b.enterPen,b.pen,b.enterPen,b),b._renderBehaviors(b._geomGroup),b.unregisterEventMap=null},a._renderBehaviors=function(a){var b=this;this._behaviors&&this._behaviors.length&&(this._behaviorsLayer=a.select(".behavior-layer"),this._behaviorsLayer.empty()?this._behaviorsLayer=a.append("g").classed("behavior-layer",!0):this._behaviorsLayer.node().parentNode.appendChild(this._behaviorsLayer.node()),dv.util.each(this._behaviors,function(a){a._geom(b)._render(b._behaviorsLayer)}))},a.updateGroups=function(a,b,c,d,e){a.each(function(a,b){var c=0,d=0,f=d3.select(this),g=f.attr("transform");if(e._chart._coord instanceof dv.coord.polar){var h=a.values[0],i=dv.util.scaleRange(h.panel.xOuterScale()),j=dv.util.scaleRange(h.panel.yOuterScale()),k=(i[0]+i[1])/2,l=(j[0]+j[1])/2,m=e._chart._coord.flip();c=m?l:k,d=m?k:l}g&&dv.ANIMATION&&(f=f.transition().duration(function(a,b){return e.duration().call(this,a,b)})),f.attr("transform","translate("+c+","+d+")")})},a.updateDataPoints=function(a,b,c,d,e){var f=b.call(e),g=c.call(e),h=d.call(e),i=a.selectAll("."+e._dataPointStyleClass).data(function(a){return e.getValues(a)});i.exit().transition().delay(function(a,b,c){return e.delay().call(this,a,b,c)}).duration(function(a,b,c){return e.duration().call(this,a,b,c)}).ease(e.ease()).each(function(){this.__exiting__=!0}).attrTween("d",h.pathTween).remove(),i.enter().append("path").each(function(a,b,c){e.setPreviousState.call(this,f,h,a,b,c)}).attr("class",function(a,b,c){return"datum-"+b+" series-"+c}).call(e.attributes,e).attr("d",f.path);var j=i.call(e.attributes,e).call(e._removeRegisteredEvents,e).call(e._addRegisteredEvents,e).each(function(){this.__exiting__=!1});dv.ANIMATION?j=j.transition().delay(function(a,b,c){return e.delay().call(this,a,b,c)}).duration(function(a,b,c){return e.duration().call(this,a,b,c)}).ease(e.ease()).attrTween("d",g.pathTween):j.each(function(a,b,c){var d=g.bounds(a,b,c);d&&(a.bounds=d.bounds)}).attr("d",g.path),j.call(e.addEachFunction,e)},a.addEachFunction=function(a,b){b._each&&(dv.util.isUndefined(b._each.start)||(dv.ANIMATION?a.each("start",function(a,c,d){b._each.start.call(this,a,c,d)}):a.each(function(a,c,d){b._each.start.call(this,a,c,d)})),dv.util.isUndefined(b._each.end)||(dv.ANIMATION?a.each("end",function(a,c,d){b._each.end.call(this,a,c,d)}):a.each(function(a,c,d){b._each.end.call(this,a,c,d)})))},a.exitSeriesGroup=function(a,b){b.exitSeries(a,b.enterPen,b)},a.setPreviousState=function(a,b,c,d){var e=a.bounds(c,d);this.__previousBounds__=e,this.__exitTransition__=b},a.pathTween=function(a,b,c,d,e){var f,g=d3.select(b);return b.__exiting__?(f=b.__exitTransition__.path(c,d),b.__exiting__=!1):f=a.getPath(a.getBounds(c,d)),null===f?(g.remove(),null):d3.interpolate(g.attr("d"),f)},a._calculateStats=function(){},a._handlePositions=function(){if("stack"===this.position()||"fill"===this.position()||"dodge"===this.position()){var a=this.position(),b=this._addGroupLayerToNestedData(),c=(this._chart.coord().flip(),function(a){var b=d.getExplicitScales(a)[a],c=!1;return function(d,e){for(var f in b)if(c=b[f]._includeInDomain(d,e))break;return c?d[a]:0}}),d=this;dv.util.each(b,function(b){var d=c("x"),e=c("y");if("stack"===a)d3.layout.stack().x(d).y(e).values(function(a){return a.values})(b.values);else if("fill"===a)d3.layout.stack().x(d).y(e).offset(function(a){var b,c,d,e=a.length,f=a[0].length,g=[];for(c=0;f>c;++c){for(b=0,d=0;e>b;b++)d+=a[b][c][1];if(d)for(b=0;e>b;b++)a[b][c][1]/=d;else for(b=0;e>b;b++)a[b][c][1]=0}for(c=0;f>c;++c)g[c]=0;return g}).values(function(a){return a.values})(b.values);else if("dodge"===a){var f=b.values.length;dv.util.each(b.values,function(a,b){dv.util.each(a.values,function(a){a.dodge={groupIndex:b,numGroups:f}})})}})}},a._addGroupLayerToNestedData=function(){var a=[],b={},c={};return dv.util.each(this._nestData,function(d,e){var f,g,h=/(.*) ~ .*/g.exec(d.key)[1],i=/.* ~ (.*)/g.exec(d.key)[1];b.hasOwnProperty(h)||(a.push({key:h,values:[]}),b[h]=a.length-1),f=a[b[h]],c.hasOwnProperty(d.key)||(f.values.push({key:i,values:[]}),c[d.key]=f.values.length-1),g=f.values[c[d.key]],g.values=g.values.concat(d.values)}),a},a.exit=function(a){d3.select(a).selectAll(".series").call(this.exitSeriesGroup,this)},a.exitSeries=function(a,b,c){a.selectAll("."+c._dataPointStyleClass).transition().delay(function(a,b,d){return c.delay().call(this,a,b,d)}).duration(function(a,b,d){return c.duration().call(this,a,b,d)}).ease(c.ease()).each(function(){this.__exiting__=!0}).attrTween("d",b.call(c).pathTween).remove().each("end",function(a,b){var c=this.parentNode;if(c&&c.childNodes&&!c.childNodes.length){var d=c.parentNode;d&&d.childNodes&&d.childNodes.length<=1?d3.select(d).remove():d3.select(c).remove()}})},a.coord=function(){return this.chart().coord()},a._addRegisteredEvents=function(a,b){b||(b=this),b._geomGroup&&(a=a?a:b._geomGroup.selectAll(".series").selectAll("."+this._dataPointStyleClass),b=b||this,dv.util.each(b.eventMap,function(c,d){a.on(d,function(a,c,e){b.eventMap[d].callback.call(this,a,c,e,d3.event)},c.capture)}),dv.util.each(b._chart.eventMap,function(c,d){a.on(d+".dvchart",function(a,c){var e=d3.event,f=b._chart._interactionGroup.select(".interaction-canvas").node();b._shouldDispatchChartEvent(e,f)&&b._chart.eventMap[d].callback.call(f,e)},c.capture)}),dv.util.each(b._behaviors,function(a){a._addRegisteredEvents&&a._addRegisteredEvents()}))},a._removeRegisteredEvents=function(a,b){b||(b=this),b._geomGroup&&(a=a||b._geomGroup.selectAll("."+this._dataPointStyleClass),b=b||this,dv.util.each(b.unregisterEventMap,function(b,c){a.on(c,null,b)}),dv.util.each(b._chart.unregisterEventMap,function(b,c){a.on(c+".dvchart",null,b)}),dv.util.each(b._behaviors,function(a){a._removeRegisteredEvents&&a._removeRegisteredEvents()}))},a._shouldDispatchChartEvent=function(a,b){var c=!0;if("mouseout"===a.type||"mouseover"===a.type){var d=a.relatedTarget;d||(d="mouseout"===a.type?a.toElement:a.fromElement);var e=d3.select(d);if(e&&!e.empty()){var f=e.attr("class");c=!(e.node()===b||f&&f.indexOf("-geom")>=0)}}return c},a.getExplicitScalesMap=function(){var a=dv.util.clone(this._chart.getExplicitScalesMap());for(var b in this._aes){var c=this._aes[b],d=a[b]||{},e=dv.util.extend({},d,c);a[b]=e}return a},a.getExplicitScale=function(a,b){if("group"===a)return this._getGroup();var c=this._aes[a],d=this.chart()._aes[a];return void 0!==b&&c&&c[b]?c[b]:void 0!==b&&d&&d[b]?d[b]:c&&void 0!==c[0]?c[0]:d&&void 0!==d[0]?d[0]:null},a.getExplicitScales=function(a){dv.util.isArray(a)||(a=[a]);for(var b={},c=-1,d=a.length;++c<d;){var e=a[c],f=this._aes[e],g=this.chart()._aes[e]||{};b[e]=dv.util.extend({},g,f)}return b},a.getTrainedScale=function(a,b){return this.chart().getTrainedScale(a,b)},a.getScale=function(a,b){return this.getExplicitScale(a,b)},a.getScales=function(a){return this.getExplicitScales(a)},a.hasScale=function(a,b){return this.getExplicitScale(a,b)?!0:!1},a._dodgeAdjust=function(a){var b=a.dodge.groupIndex,c=a.dodge.numGroups,d=a.panel.xScale(a).rangeBand(),e=c>1?d/(c-1)*this._dodgePadding:0,f=(d-e*(c-1))/c;return(f+e)*b+f/2},a.applyAttributeValue=function(a,b,c,d){var e=b.getScale(d,0);a.style(c,function(a,b,c){return e?e.mapToProp(dv.util.isArray(a)?a[0]:a,b,c):null})},a._getGroup=function(){if(this._aes.hasOwnProperty("group"))return this._aes.group[0];var a=this.chart()._getGroup();if(a&&"group"===a.property())return a;for(var b=-1,c=dv.DEFAULT_CATEGORICAL_AES.length-1;b++<c;){var d=this._aes[dv.DEFAULT_CATEGORICAL_AES[b]];if(d&&d[0]&&d[0]instanceof dv.scale.ordinal&&!dv.util.isUndefined(d[0].mapping()))return d[0]}return a},a.each=function(a,b){var c,d;return arguments.length?(this._each=this._each||{},arguments.length<2?(d=a,c="end"):(d=b,c=a),this._each[c]=d,this):this._each},a.dodgePadding=function(a){return arguments?(this._dodgePadding=a,this):this._dodgePadding},a.behaviors=function(a){return arguments.length?(this._behaviors=a,this):this._behaviors},a.stat=function(a){return arguments.length?(this._stat=a,this):this._stat},a.chart=function(a){return arguments.length?(this._chart=a,this):this._chart},a.normalizedData=function(a){return arguments.length?(this._normalizedData=a,this):this._normalizedData},a.data=function(a){return arguments.length?(this._data=a,this):this._data?this._data:this.chart().data()},a}),dv.geom.point=dv.geom.extend(function(){function a(){this._super(),this._rendererClass=dv.geom.point}return a._dataPointStyleClass="point-geom",a._initializeDefaultAes=function(){this._super(),this._defaultAes.shape="circle",this._defaultAes.size=7},a.getValues=function(a){return a.values},a.exitSeriesGroup=function(a,b){b.exitSeries(a,b.enterPen,b)},a.attributes=function(a,b){a.attr("style","").classed(b._dataPointStyleClass,!0).call(b.applyAttributeValue,b,"opacity","alpha").call(b.applyAttributeValue,b,"stroke","stroke").call(b.applyAttributeValue,b,"fill","fill")},a.getHighlightColor=function(a,b){var c=this.getScale("fill"),d=this.getScale("stroke");return!d||d instanceof dv.scale.constant?!c||c instanceof dv.scale.constant?d?d.mapToProp(a,b):"#8CC350":c.mapToProp(a,b):d.mapToProp(a,b)},a.enterPen=function(){var a,b=this,c=function(a,b){return a.panel.yScale(a).reverse()?1:0};return a="dodge"===this.position()?function(a,c){var d=a.panel.xScale(a);return d.mapValueToPercent(d.mapToProp(a,c)+b._dodgeAdjust(a),c)}:function(a,b){var c=a.panel.xScale(a);return c.mapValueToPercent(c.mapToProp(a,b)+c.rangeBand()/2,b)},this._decoratePen(a,c)},a.pen=function(){var a,b=this,c=function(a,b){var c=a.panel.xScale(a);return c.mapValueToPercent(c.mapToProp(a,b)+c.rangeBand()/2,b)};switch(this.position()){case"identity":a=function(a,b){var c=a.panel.yScale(a);return c.mapValueToPercent(c.mapToProp(a,b)+c.rangeBand()/2,b)};break;case"stack":a=function(a,b){var c=a.panel.yScale(a);return c.mapValueToPercent(c.mapValue(a.y0+a.y),b)};break;case"dodge":c=function(a,c){var d=a.panel.xScale(a);return d.mapValueToPercent(d.mapToProp(a,c)+b._dodgeAdjust(a),c)},a=function(a,b){var c=a.panel.yScale(a);return c.mapValueToPercent(c.mapToProp(a,b)+c.rangeBand()/2,b)};break;case"fill":a=function(a,b){return a.y+a.y0}}return this._decoratePen(c,a)},a._defined=function(a,b){return dv.util.isFinite(a.panel.xScale(a).mapToProp(a,b))&&dv.util.isFinite(a.panel.yScale(a).mapToProp(a,b))},a._decoratePen=function(a,b){var c=this.getScale("shape"),d=this.getScale("size"),e=this,f=this.coord()._point().x(a).y(b).defined(this._defined);return f.renderer.type(function(a,b){return c.mapToProp(a,b)}).size(function(a,b){return Math.pow(d.mapToProp(a,b),2)}),{bounds:function(a,b){return f.getBounds(a,b)},pathTween:function(a,b){return e.pathTween(f,this,a,b)},path:function(a,b){return f.getPath(f.getBounds(a,b))}}},a}),dv.geom.text=dv.geom.extend(function(){function a(){this._super(),this._rendererClass=dv.geom.text,this._dx=d3.functor(0),this._dy=d3.functor(0),this._textFormat=function(a){return a},this._textAnchor="start"}return a._dataPointStyleClass="text-geom",a.dx=function(a){return arguments.length?(this._dx=d3.functor(a),this):this._dx},a.dy=function(a){return arguments.length?(this._dy=d3.functor(a),this):this._dy},a.textAnchor=function(a){return arguments.length?(this._textAnchor=a,this):this._textAnchor},a.textFormat=function(a){return arguments.length?(this._textFormat=d3.functor(a),this):this._textFormat},a.getValues=function(a){return a.values},a.updateDataPoints=function(a,b,c,d,e){var f=(e.getScale("alpha"),b.call(e)),g=c.call(e),h=d.call(e),i=a.selectAll("."+e._dataPointStyleClass).data(function(a){return e.getValues(a)});i.exit().transition().delay(function(a,b,c){return e.delay().call(this,a,b,c)}).duration(function(a,b,c){return e.duration().call(this,a,b,c)}).ease(e.ease()).call(h).each("end.transition",function(a,b){var c=this.parentNode;c&&c.removeChild(this)}),i.enter().append("text").attr("class",function(a,b,c){return"datum-"+b+" series-"+c}).call(e.attributes,e).call(f);var j=i.call(e.attributes,e).call(e._removeRegisteredEvents,e).call(e._addRegisteredEvents,e);dv.ANIMATION&&(j=j.transition().delay(function(a,b,c){return e.delay().call(this,a,b,c)}).duration(function(a,b,c){return e.duration().call(this,a,b,c)}).ease(e.ease())),j.call(g).call(e.addEachFunction,e)},a.exitSeriesGroup=function(a,b){b.exitSeries(a,b.enterPen,b)},a.exitSeries=function(a,b,c){a.selectAll("."+c._dataPointStyleClass).transition().delay(function(a,b,d){return c.delay().call(this,a,b,d)}).duration(function(a,b,d){return c.duration().call(this,a,b,d)}).ease(c.ease()).call(b.call(c)).remove().each("end.transition",function(a,b){var c=this.parentNode;c.parentNode&&c.removeChild(this),c&&c.childNodes&&!c.childNodes.length&&d3.select(c).remove()})},a.attributes=function(a,b){a.attr("style","").classed(b._dataPointStyleClass,!0).call(b.applyAttributeValue,b,"stroke","stroke").call(b.applyAttributeValue,b,"fill","fill").call(b.applyAttributeValue,b,"opacity","alpha").call(b.applyAttributeValue,b,"font-size","size").attr("text-anchor",b._textAnchor)},a.enterPen=function(){var a,b=this,c=this._dx,d=function(a,b){return a.panel.yScale(a).reverse()?1:0};return a="dodge"===this.position()?function(a,d,e){var f=a.panel.xScale(a);return f.mapValueToPercent(f.mapToProp(a,d)+b._dodgeAdjust(a)+c(a,d,e),d)}:function(a,b,d){var e=a.panel.xScale(a);return e.mapValueToPercent(e.mapToProp(a,b)+e.rangeBand()/2+c(a,b,d),b)},this._decoratePen(a,d)},a.pen=function(){var a,b=this,c=this._dx,d=this._dy,e=function(a,b,d){var e=a.panel.xScale(a);return e.mapValueToPercent(e.mapToProp(a,b)+e.rangeBand()/2+c(a,b,d),b)};switch(this.position()){case"identity":a=function(a,b,c){var e=a.panel.yScale(a);return e.mapValueToPercent(e.mapToProp(a,b)+d(a,b,c)+e.rangeBand()/2,b)};break;case"stack":a=function(a,b,c){var e=a.panel.yScale(a);return e.mapValueToPercent(e.mapValue(a.y0+a.y,b)+d(a,b,c),b)};break;case"dodge":e=function(a,d,e){var f=a.panel.xScale(a);return f.mapValueToPercent(f.mapToProp(a,d)+b._dodgeAdjust(a)+c(a,d,e),d)},a=function(a,b,c){var e=a.panel.yScale(a);return e.mapValueToPercent(e.mapToProp(a,b)+d(a,b,c)+e.rangeBand()/2,b)};break;case"fill":a=function(a,b,c){var e=a.panel.yScale(a);return a.y+a.y0+e.mapValueToPercent(d(a,b,c)+dv.util.scaleRange(e)[0],b)}}return this._decoratePen(e,a)},a._defined=function(a,b){return dv.util.isFinite(a.panel.xScale(a).mapToProp(a,b))&&dv.util.isFinite(a.panel.yScale(a).mapToProp(a,b))},a._decoratePen=function(a,b){var c=this.getScale("label"),d=this,e=this.coord()._text().x(a).y(b);return e().label(function(a,b,e){return d._textFormat.call(this,c.mapToProp(a,b),b,e)}).defined(this._defined)},a}),dv.geom.line=dv.geom.extend(function(){function a(){this._super(),this._tension=.7,this._interpolate="linear",this._rendererClass=dv.geom.line}return a._dataPointStyleClass="line-geom",a.tension=function(a){return arguments.length?(this._tension=a,this):this._tension},a.interpolate=function(a){return arguments.length?(this._interpolate=a,this):this._interpolate},a._render=function(a){this._super(a);var b=this.getScale("size");b&&b.to&&!b.to()&&b.to([2,8])},a.getValues=function(a){return[a.values]},a.exitSeriesGroup=function(a,b){b.exitSeries(a,b.enterPen,b)},a.attributes=function(a,b){var c=b.getScale("linetype",0);a.attr("style","").classed(b._dataPointStyleClass,!0).call(b.applyAttributeValue,b,"stroke","stroke").call(b.applyAttributeValue,b,"opacity","alpha").call(b.applyAttributeValue,b,"stroke-width","size").style("stroke-dasharray",function(a,b,d){return c?dv.util.svg.getDasharray(c.mapToProp(a[0],b,d)):null}).style("fill","none")},a.getHighlightColor=function(a,b){var c=this.getScale("stroke",0);return c?c.mapToProp(a,b):"#8CC350"},a.enterPen=function(){var a,b=this,c=function(a,b){return a.panel.yScale(a).reverse()?1:0};return a="dodge"===this.position()?function(a,c){var d=a.panel.xScale(a);return d.mapValueToPercent(d.mapToProp(a,c)+b._dodgeAdjust(a),c)}:function(a,b){var c=a.panel.xScale(a);return c.mapValueToPercent(c.mapToProp(a,b)+c.rangeBand()/2,b)},this._decoratePen(a,c)},a.pen=function(){var a,b=this,c=function(a,b){var c=a.panel.xScale(a);return c.mapValueToPercent(c.mapToProp(a,b)+c.rangeBand()/2,b)};switch(this.position()){case"identity":a=function(a,b){var c=a.panel.yScale(a);return c.mapValueToPercent(c.mapToProp(a,b)+c.rangeBand()/2,b)};break;case"stack":a=function(a,b){var c=a.panel.yScale(a);return c.mapValueToPercent(c.mapValue(a.y0+a.y),b)};break;case"dodge":c=function(a,c){var d=a.panel.xScale(a);return d.mapValueToPercent(d.mapToProp(a,c)+b._dodgeAdjust(a),c)},a=function(a,b){var c=a.panel.yScale(a);return c.mapValueToPercent(c.mapToProp(a,b)+c.rangeBand()/2,b)};break;case"fill":a=function(a,b){return a.y+a.y0}}return this._decoratePen(c,a)},a._defined=function(a,b){return dv.util.isFinite(a.panel.xScale(a).mapToProp(a,b))&&dv.util.isFinite(a.panel.yScale(a).mapToProp(a,b))},a._decoratePen=function(a,b){var c=this,d=this.coord()._line().x(a).y(b).defined(this._defined);return d.renderer.tension(this.tension()).interpolate(this.interpolate()),{bounds:function(a,b){return d.getBounds(a,b)},pathTween:function(a,b){return c.pathTween(d,this,a,b)},path:function(a,b){return d.getPath(d.getBounds(a,b))}}},a}),dv.geom.area=dv.geom.extend(function(){function a(){this._super(),this._tension=.7,this._interpolate="linear",this._rendererClass=dv.geom.area,this._baseline=0}return a._dataPointStyleClass="area-geom",a._initializeDefaultAes=function(){this._super()},a._trainScales=function(){if(void 0!==this._baseline){var a=this.getExplicitScales("y").y;for(var b in a){var c=a[b];c instanceof dv.scale.continuous&&c.softLowerLimit(this._baseline)}}this._super()},a.tension=function(a){return arguments.length?(this._tension=a,this):this._tension},a.interpolate=function(a){return arguments.length?(this._interpolate=a,this):this._interpolate},a.getValues=function(a){return[a.values]},a.pathTween=function(a,b,c,d,e){var f,g,h,i,j=b.__previousBounds__,k=[],l=this.enterPen.call(this,e),m=this.getScale("x").domain(),n=-1;for(f=a.getBounds(c,d),f.coord=this.coord(),(j&&j.coord&&f.coord._type!==j.coord._type||f.coord.flip()!=j.coord.flip())&&(j=this.enterPen.call(this,e).bounds(c,d)),g=Math.max(f.length,j.length);++n<g;)h=n<f.length?f[n]:null,i=n<j.length?j[n]:null,i?h||(h=l.bounds([i],d)[0]):(h.x=m[m.length-1],i=l.bounds([h],d)[0]),k.push(d3.interpolateObject(i.bounds,h.bounds));return b.__previousBounds__=f,function(b){1===b&&(k=k.splice(0,f.length));var c=[];return dv.util.each(k,function(a,d){var e={};e.bounds=a(b),c.push(e)}),a.getPath(c)}},a.exitSeriesGroup=function(a,b){b.exitSeries(a,b.enterPen,b)},a.attributes=function(a,b){a.attr("style","").classed(b._dataPointStyleClass,!0).call(b.applyAttributeValue,b,"opacity","alpha").call(b.applyAttributeValue,b,"fill","fill")},a.getHighlightColor=function(a,b){var c=this.getScale("fill");return c?c.mapToProp(a,b):"#8CC350"},a.getBaseline=function(a){var b=d3.min(a.domain());return void 0!==self._baseline?self._baseline:0>b?0:b},a.enterPen=function(){var a,b=this,c=function(a,c){var d=a.panel.yScale(a);return d.mapValueToPercent(d.mapValue(b.getBaseline(d)),c)};return a="dodge"===this.position()?function(a,c){var d=a.panel.xScale(a);return d.mapValueToPercent(d.mapToProp(a,c)+b._dodgeAdjust(a),c)}:function(a,b){var c=a.panel.xScale(a);return c.mapValueToPercent(c.mapToProp(a,b)+c.rangeBand()/2,b)},this._decoratePen(a,c,c)},a.pen=function(){var a,b,c=function(a,b){var c=a.panel.xScale(a);return c.mapValueToPercent(c.mapToProp(a,b)+c.rangeBand()/2,b)},d=this;switch(this.position()){case"identity":a=function(a,b){var c=a.panel.yScale(a);return c.mapValueToPercent(c.mapValue(d.getBaseline(c)),b)},b=function(a,b){var c=a.panel.yScale(a);return c.mapPropToPercent(a,b)};break;case"stack":a=function(a,b){var c=a.panel.yScale(a);return c.mapValueToPercent(c.mapValue(a.y0),b)},b=function(a,b){var c=a.panel.yScale(a);return c.mapValueToPercent(c.mapValue(a.y0+a.y),b)};break;case"dodge":c=function(a,b){var c=a.panel.xScale(a);return c.mapValueToPercent(c.mapToProp(a,b)+d._dodgeAdjust(a),b)},a=function(a,b){var c=a.panel.yScale(a);return c.mapValueToPercent(c.mapValue(d.getBaseline(c)),b)},b=function(a,b){var c=a.panel.yScale(a);return c.mapPropToPercent(a,b)};break;case"fill":a=function(a,b){return a.y0},b=function(a,b){return a.y+a.y0}}return this._decoratePen(c,a,b)},a._defined=function(a,b){return dv.util.isFinite(a.panel.xScale(a).mapToProp(a,b))&&dv.util.isFinite(a.panel.yScale(a).mapToProp(a))},a._decoratePen=function(a,b,c){var d=this,e=this.coord()._area().x(a).y0(b).y1(c).defined(this._defined);return e.renderer.tension(this.tension()).interpolate(this.interpolate()),{bounds:function(a,b){var c=e.getBounds(a,b);return c&&(c.coord=d.coord()),c},pathTween:function(a,b){return d.pathTween(e,this,a,b)},path:function(a,b){return e.getPath(e.getBounds(a,b))}}},a.baseline=function(a){return arguments.length?(this._baseline=a,this):this._baseline},a}),dv.geom.rect=dv.geom.extend(function(){function a(){this._super(),this._rendererClass=dv.geom.rect}return a._dataPointStyleClass="bar-geom",a._initializeDefaultAes=function(){this._super(),this._defaultAes.yMin=1,this._defaultAes.yMax=1,this._defaultAes.xMin=1,this._defaultAes.xMax=1,delete this._defaultAes.x,delete this._defaultAes.y},a._trainScales=function(){var a,b=this.getExplicitScales(["yMin","xMin"]),c=b.yMin,d=b.xMin;for(a in c){var e=this._aes.y;e||(this._aes.y=e={}),e[a]||(e[a]=c[a].copy().property("y").mapping("y")),e[a].trainingProperties(["yMin","yMax"])}for(a in d){var f=this._aes.x;f||(this._aes.x=f={}),f[a]||(f[a]=d[a].copy().property("x").mapping("x")),f[a].trainingProperties(["xMin","xMax"])}},a.getValues=function(a){return a.values},a._render=function(a){var b,c=this.getExplicitScales(["yMin","yMax","y","xMin","xMax","x"]);for(b in c.yMin){var d=c.yMin[b],e=c.yMax[b],f=c.y[b];f&&(e.range(f.range()).domain(f.domain()),d.range(f.range()).domain(f.domain()))}for(b in c.xMin){var g=c.xMin[b],h=c.xMax[b],i=c.x[b];i&&(h.range(i.range()).domain(i.domain()),g.range(i.range()).domain(i.domain()))}this._super(a)},a.pathTween=function(a,b,c,d,e){var f,g=c,h=b.__previousBounds__,i=this.coord()._type;if(f=b.__exiting__?b.__exitTransition__.bounds(c,d):a.getBounds(c,d),h&&h.coord&&i!==h.coord&&(h=b.__exitTransition__.bounds(c,d)),!f||!h)return null;f.coord=i;var j=d3.interpolateObject(h.bounds,f.bounds);return b.__previousBounds__=f,function(b){return g.bounds=j(b),a.getPath(g)}},a.attributes=function(a,b){a.attr("style","").classed(b._dataPointStyleClass,!0).call(b.applyAttributeValue,b,"fill","fill").call(b.applyAttributeValue,b,"stroke","stroke").call(b.applyAttributeValue,b,"opacity","alpha")},a.enterPen=function(){var a=function(a,b){return a.panel.yScale(a).reverse()?1:0},b=function(a,b){var c=a.panel.xScale(a);
return c.mapValueToPercent(c.mapValue(dv.util.isArray(a.x)?a.x[0]:a.xMin,b))},c=function(a,b){var c=a.panel.xScale(a);return c.mapValueToPercent(c.mapValue(dv.util.isArray(a.x)?a.x[1]:a.xMax,b))};return this._decoratePen(b,c,a,a)},a.pen=function(){var a=function(a,b){var c=a.panel.xScale(a);return c.mapValueToPercent(c.mapValue(dv.util.isArray(a.x)?a.x[0]:a.xMin,b))},b=function(a,b){var c=a.panel.xScale(a);return c.mapValueToPercent(c.mapValue(dv.util.isArray(a.x)?a.x[1]:a.xMax,b))},c=function(a,b){var c=a.panel.yScale(a);return c.mapValueToPercent(c.mapValue(dv.util.isArray(a.y)?a.y[0]:a.yMin,b))},d=function(a,b){var c=a.panel.yScale(a);return c.mapValueToPercent(c.mapValue(dv.util.isArray(a.y)?a.y[1]:a.yMax,b))};return this._decoratePen(a,b,c,d)},a._defined=function(a,b){var c=a.panel.xScale(a),d=a.panel.yScale(a);return dv.util.isFinite(c.mapValue(dv.util.isArray(a.x)?a.x[0]:a.xMin,b))&&dv.util.isFinite(c.mapValue(dv.util.isArray(a.x)?a.x[1]:a.xMax,b))&&dv.util.isFinite(d.mapValue(dv.util.isArray(a.y)?a.y[0]:a.yMin,b))&&dv.util.isFinite(d.mapValue(dv.util.isArray(a.y)?a.y[1]:a.yMax,b))},a._decoratePen=function(a,b,c,d){var e=this,f=this.coord()._rect().x0(a).x1(b).y0(c).y1(d).defined(this._defined);return{bounds:function(a,b){var c=f.getBounds(a,b);return c&&(c.bounds.coord=e.coord()._type),c},pathTween:function(a,b,c){return e.pathTween(f,this,a,b,c)},path:function(a,b){return f.getPath(f.getBounds(a,b))}}},a}),dv.geom.tile=dv.geom.rect.extend(function(){function a(){this._super(),this._rendererClass=dv.geom.tile}return a._dataPointStyleClass="tile-geom",a._initializeDefaultAes=function(){this._super(),this._defaultAes.y=1,this._defaultAes.x=1},a.getValues=function(a){return a.values},a.enterPen=function(){var a=function(a,b){return a.panel.yScale(a).reverse()?1:0},b=function(a,b){return a.panel.xScale(a).mapPropToPercent(a,b)},c=function(a,b){var c=a.panel.xScale(a);return c.mapValueToPercent(c.mapToProp(a,b)+c.rangeBand(),b)};return this._decoratePen(b,c,a,a)},a.pen=function(){var a=function(a,b){return a.panel.xScale(a).mapPropToPercent(a,b)},b=function(a,b){var c=a.panel.xScale(a);return c.mapValueToPercent(c.mapToProp(a,b)+c.rangeBand(),b)},c=function(a,b){var c=a.panel.yScale(a);return c.mapPropToPercent(a,b)},d=function(a,b){var c=a.panel.yScale(a);return c.mapValueToPercent(c.mapToProp(a,b)+c.rangeBand(),b)};return this._decoratePen(a,b,c,d)},a._defined=function(a,b){return dv.util.isFinite(a.panel.xScale(a).mapToProp(a,b))&&dv.util.isFinite(a.panel.yScale(a).mapToProp(a,b))},a._decoratePen=function(a,b,c,d){var e=this,f=this.coord()._rect().x0(a).x1(b).y0(c).y1(d).defined(this._defined);return{bounds:function(a,b){var c=f.getBounds(a,b);return c&&(c.bounds.coord=e.coord()._type),c},pathTween:function(a,b,c){return e.pathTween(f,this,a,b,c)},path:function(a,b){return f.getPath(f.getBounds(a,b))}}},a}),dv.geom.bar=dv.geom.rect.extend(function(){function a(){this._super(),this._rendererClass=dv.geom.bar,this._baseline=0,this._width=1}return a._dataPointStyleClass="bar-geom",a._initializeDefaultAes=function(){this._super(),this._defaultAes.y=1,this._defaultAes.x=1},a._trainScales=function(){if(void 0!==this._baseline){var a=this.getExplicitScales("y").y;for(var b in a){var c=a[b];c instanceof dv.scale.continuous&&c.softLowerLimit(this._baseline)}}},a.getValues=function(a){return a.values},a.getBaseline=function(a){var b=d3.min(a.domain());return void 0!==self._baseline?self._baseline:0>b?0:b},a.width=function(a){return arguments.length?(this._width=a,this):this.width},a._enforceMinSize=function(a,b,c){var d=this.getBaseline(a),e=b[a.property()]-d,f=a.mapValueToPercent(a.mapValue(d)),g=a.mapPropToPercent(b,c)-f,h=dv.util.scaleExtent(a.range()),i=1/(h[1]-h[0]);return a.reverse()?f+(0>e?Math.max(i,g):Math.min(-i,g)):f+(0>e?Math.min(-i,g):Math.max(i,g))},a.enterPen=function(){var a,b,c=this,d=function(a,b){var d=a.panel.yScale(a);return d.mapValueToPercent(d.mapValue(c.getBaseline(d)),b)};return"dodge"===this.position()?(a=function(a,b){var d=a.panel.xScale(a);return d.mapValueToPercent(d.mapToProp(a,b)+c._dodgeAdjust(a),b)},b=function(a,b){var d=a.panel.xScale(a);return d.mapValueToPercent(d.mapToProp(a,b)+c._dodgeAdjust(a,!0),b)}):(a=function(a,b){var d=a.panel.xScale(a);return d.mapValueToPercent(d.mapToProp(a,b)+c._offsetX(a),b)},b=function(a,b){var d=a.panel.xScale(a);return d.mapValueToPercent(d.mapToProp(a,b)+c._offsetX(a,!0),b)}),this._decoratePen(a,b,d,d)},a.pen=function(){var a,b,c,d,e=this;switch(this.position()){case"identity":a=function(a,b){var c=a.panel.xScale(a);return c.mapValueToPercent(c.mapToProp(a,b)+e._offsetX(a),b)},b=function(a,b){var c=a.panel.xScale(a);return c.mapValueToPercent(c.mapToProp(a,b)+e._offsetX(a,!0),b)},c=function(a,b){var c=a.panel.yScale(a);return c.mapValueToPercent(c.mapValue(e.getBaseline(c)),b)},d=function(a,b){return e._enforceMinSize(a.panel.yScale(a),a,b)};break;case"stack":a=function(a,b){var c=a.panel.xScale(a);return c.mapValueToPercent(c.mapToProp(a,b)+e._offsetX(a),b)},b=function(a,b){var c=a.panel.xScale(a);return c.mapValueToPercent(c.mapToProp(a,b)+e._offsetX(a,!0),b)},c=function(a,b){var c=a.panel.yScale(a);return c.mapValueToPercent(c.mapValue(a.y0),b)},d=function(a,b){var c=a.panel.yScale(a);return c.mapValueToPercent(c.mapValue(a.y0+a.y),b)};break;case"dodge":a=function(a,b){var c=a.panel.xScale(a);return c.mapValueToPercent(c.mapToProp(a,b)+e._dodgeAdjust(a),b)},b=function(a,b){var c=a.panel.xScale(a);return c.mapValueToPercent(c.mapToProp(a,b)+e._dodgeAdjust(a,!0),b)},c=function(a,b){var c=a.panel.yScale(a);return c.mapValueToPercent(c.mapValue(e.getBaseline(c)),b)},d=function(a,b){return e._enforceMinSize(a.panel.yScale(a),a,b)};break;case"fill":a=function(a,b){var c=a.panel.xScale(a);return c.mapValueToPercent(c.mapToProp(a,b)+e._offsetX(a),b)},b=function(a,b){var c=a.panel.xScale(a);return c.mapValueToPercent(c.mapToProp(a,b)+e._offsetX(a,!0),b)},c=function(a,b){return a.y0},d=function(a,b){return a.y+a.y0}}return this._decoratePen(a,b,c,d)},a._offsetX=function(a,b){var c=a.panel.xScale(a),d=c.rangeBand();return d/2+d/2*(b?this._width:-this._width)},a._defined=function(a,b){return dv.util.isFinite(a.panel.xScale(a).mapToProp(a,b))&&dv.util.isFinite(a.panel.yScale(a).mapToProp(a,b))},a._decoratePen=function(a,b,c,d){var e=this,f=this.coord()._rect().x0(a).x1(b).y0(c).y1(d).defined(this._defined);return{bounds:function(a,b){var c=f.getBounds(a,b);return c&&(c.bounds.coord=e.coord()._type),c},pathTween:function(a,b,c){return e.pathTween(f,this,a,b,c)},path:function(a,b){return f.getPath(f.getBounds(a,b))}}},a._dodgeAdjust=function(a,b){var c=a.dodge.groupIndex,d=a.dodge.numGroups,e=a.panel.xScale(a).rangeBand(),f=d>1?e/(d-1)*this._dodgePadding:0,g=(e-f*(d-1))/d;return(g+f)*c+(b?g:0)},a.baseline=function(a){return arguments.length?(this._baseline=a,this):this._baseline},a}),dv.geom.barrange=dv.geom.bar.extend(function(){function a(){this._super(),this._rendererClass=dv.geom.barrange}return a._initializeDefaultAes=function(){this._super(),this._defaultAes.yMin=1,this._defaultAes.yMax=1,delete this._defaultAes.y},a._trainScales=function(){var a,b,c=this.getExplicitScales("yMin").yMin;for(var d in c)this._aes.y||(this._aes.y={}),a=this._aes.y,b=a[d],b||(a[d]=b=c[d].copy().property("y").mapping("y")),b.trainingProperties(["yMin","yMax"])},a._render=function(a){var b=this.getExplicitScales(["yMin","yMax","y"]),c=b.yMin;for(var d in c){var e=c[d],f=b.yMax[d],g=b.y[d];f.range(g.range()).domain(g.domain()),e.range(g.range()).domain(g.domain())}this._super(a)},a.enterPen=function(){var a=this,b=function(a,b){return a.panel.yScale(a).reverse()?1:0},c=function(b,c){var d=b.panel.xScale(b);return d.mapValueToPercent(d.mapToProp(b,c)+a._offsetX(b),c)},d=function(b,c){var d=b.panel.xScale(b);return d.mapValueToPercent(d.mapToProp(b,c)+a._offsetX(b,!0),c)};return this._decoratePen(c,d,b,b)},a.pen=function(){var a=this,b=function(b,c){var d=b.panel.xScale(b);return d.mapValueToPercent(d.mapToProp(b,c)+a._offsetX(b),c)},c=function(b,c){var d=b.panel.xScale(b);return d.mapValueToPercent(d.mapToProp(b,c)+a._offsetX(b,!0),c)},d=function(a,b){var c=a.panel.yScale(a);return c.mapValueToPercent(c.mapValue(a.yMin,b),b)},e=function(a,b){var c=a.panel.yScale(a);return c.mapValueToPercent(c.mapValue(a.yMax,b),b)};return this._decoratePen(b,c,d,e)},a._defined=function(a,b){var c=a.panel.xScale(a),d=a.panel.yScale(a);return dv.util.isFinite(c.mapToProp(a,b))&&dv.util.isFinite(d.mapValue(a.yMin,b))&&dv.util.isFinite(d.mapValue(a.yMax,b))},a._decoratePen=function(a,b,c,d){var e=this,f=this.coord()._rect().x0(a).x1(b).y0(c).y1(d).defined(this._defined);return{bounds:function(a,b){var c=f.getBounds(a,b);return c&&(c.bounds.coord=e.coord()._type),c},pathTween:function(a,b,c){return e.pathTween(f,this,a,b,c)},path:function(a,b){return f.getPath(f.getBounds(a,b))}}},a}),dv.geom.segment=dv.geom.line.extend(function(){function a(){this._super(),this._rendererClass=dv.geom.segment}return a.getValues=function(a){return a.values},a.enterPen=function(){var a=function(a,b){var c=a.panel.xScale(a);return c.mapValueToPercent(c.mapToProp(a,b)+c.rangeBand()/2,b)},b=function(a,b){return a.panel.yScale(a).reverse()?1:0};return this._decoratePen(a,b)},a.pen=function(){var a=function(a,b){var c=a.panel.xScale(a);return c.mapValueToPercent(c.mapToProp(a,b)+c.rangeBand()/2,b)},b=function(a,b){return a.panel.yScale(a).mapPropToPercent(a,b)};return this._decoratePen(a,b)},a}),dv.geom.vline=dv.geom.segment.extend(function(){function a(){this._super(),this._rendererClass=dv.geom.vline}return a._dataPointStyleClass="vline-geom",a._render=function(a){var b=this;dv.util.each(this._nestData,function(a,c){var d=[];dv.util.each(a.values,function(a,b){var c=a.panel.xScale(a),e=a.panel.yScale(a),f=(e.domain(),a[c.property()]);if(dv.util.isArray(a))a[0].x=f,a[1].x=f;else{var g=[];a.x=f,g.push(a),g.push(dv.util.clone(a)),d.push(g)}}),b._nestData[c].values=d}),this._super(a)},a.enterPen=function(){var a=function(a,b){var c=a.panel.xScale(a);return c.mapValueToPercent(c.mapToProp(a,b)+c.rangeBand()/2,b)},b=function(a,b){return 0};return this._decoratePen(a,b)},a.pen=function(){var a=function(a,b){var c=a.panel.xScale(a);return c.mapValueToPercent(c.mapToProp(a,b)+c.rangeBand()/2,b)},b=function(a,b){return 0===b?0:1};return this._decoratePen(a,b)},a._defined=function(a,b){return dv.util.isFinite(a.panel.xScale(a).mapToProp(a,b))},a}),dv.geom.hline=dv.geom.segment.extend(function(){function a(){this._super(),this._rendererClass=dv.geom.hline}return a._dataPointStyleClass="hline-geom",a._render=function(a){var b=this;dv.util.each(this._nestData,function(a,c){var d=[];dv.util.each(a.values,function(a,b){var c=a.panel.xScale(a),e=a.panel.yScale(a),f=(c.domain(),a[e.property()]);if(dv.util.isArray(a))a[0].y=f,a[1].y=f;else{var g=[];a.y=f,g.push(a),g.push(dv.util.clone(a)),d.push(g)}}),b._nestData[c].values=d}),this._super(a)},a.enterPen=function(){var a=function(a,b){return 0===b?0:1},b=function(a,b){return a.panel.yScale(a).reverse()?1:0};return this._decoratePen(a,b)},a.pen=function(){var a=function(a,b){return 0===b?0:1},b=function(a,b){return a.panel.yScale(a).mapPropToPercent(a,b)};return this._decoratePen(a,b)},a._defined=function(a,b){return dv.util.isFinite(a.panel.yScale(a).mapToProp(a,b))},a}),dv.geom.ribbon=dv.geom.area.extend(function(){function a(){this._super(),this._rendererClass=dv.geom.ribbon}return a._initializeDefaultAes=function(){this._super(),this._defaultAes.yMin=1,this._defaultAes.yMax=1,delete this._defaultAes.y},a._trainScales=function(){var a,b,c=this.getExplicitScales("yMin").yMin;for(var d in c)this._aes.y||(this._aes.y={}),a=this._aes.y,b=a[d],b||(a[d]=b=c[d].copy().property("y").mapping("y")),b.trainingProperties(["yMin","yMax"])},a._render=function(a){var b=this.getExplicitScales(["yMin","yMax","y"]),c=b.yMin;for(var d in c){var e=c[d],f=b.yMax[d],g=b.y[d];f.range(g.range()).domain(g.domain()),e.range(g.range()).domain(g.domain())}this._super(a)},a.enterPen=function(){var a=function(a,b){var c=a.panel.xScale(a);return c.mapValueToPercent(c.mapToProp(a,b)+c.rangeBand()/2,b)},b=function(a,b){return a.panel.yScale(a).reverse()?1:0};return this._decoratePen(a,b,b)},a.pen=function(){var a=function(a,b){var c=a.panel.xScale(a);return c.mapValueToPercent(c.mapToProp(a,b)+c.rangeBand()/2,b)},b=function(a,b){var c=a.panel.yScale(a);return c.mapValueToPercent(c.mapValue(a.yMin,b))},c=function(a,b){var c=a.panel.yScale(a);return c.mapValueToPercent(c.mapValue(a.yMax,b))};return this._decoratePen(a,b,c)},a._defined=function(a,b){var c=a.panel.xScale(a),d=a.panel.yScale(a);return dv.util.isFinite(c.mapToProp(a,b))&&dv.util.isFinite(d.mapValue(a.yMin,b))&&dv.util.isFinite(d.mapValue(a.yMax,b))},a._decoratePen=function(a,b,c){var d=this,e=this.coord()._area().x(a).y0(b).y1(c).defined(this._defined);return e.renderer.tension(this.tension()).interpolate(this.interpolate()),{bounds:function(a,b){var c=e.getBounds(a,b);return c&&(c.coord=d.coord()),c},pathTween:function(a,b){return d.pathTween(e,this,a,b)},path:function(a,b){return e.getPath(e.getBounds(a,b))}}},a}),dv.geom.errorbar=dv.geom.extend(function(){function a(){this._super(),this._rendererClass=dv.geom.errorbar,this._width=1}return a._dataPointStyleClass="errorbar-geom",a._initializeDefaultAes=function(){this._super(),this._defaultAes.yMin=1,this._defaultAes.yMax=1,delete this._defaultAes.y},a._trainScales=function(){var a,b=this.getExplicitScales("yMin").yMin;for(var c in b)this._aes.y||(this._aes.y={}),yScales=this._aes.y,a=yScales[c],a||(yScales[c]=a=b[c].copy().property("y").mapping("y")),a.trainingProperties(["yMin","yMax"])},a.getValues=function(a){return a.values},a.width=function(a){return arguments.length?(this._width=a,this):this._width},a.attributes=function(a,b){var c=b.getScale("linetype");a.attr("style","").classed(b._dataPointStyleClass,!0).call(b.applyAttributeValue,b,"stroke","stroke").call(b.applyAttributeValue,b,"opacity","alpha").call(b.applyAttributeValue,b,"stroke-width","size").style("stroke-dasharray",function(a,b,d){return c?dv.util.svg.getDasharray(c.mapToProp(a[0],b,d)):null}).style("fill","none")},a._render=function(a){var b=this.getScale("x");if(!(b instanceof dv.scale.ordinal)){var c,d,e=Number.MAX_VALUE;dv.util.each(this._nestData,function(a){dv.util.each(a.values,function(a){c=a.panel.xScale(a).mapValue(a.x),dv.util.isUndefined(d)||(e=Math.min(e,Math.abs(c-d))),d=c})}),this._maxWidthPixels=e}var f=this.getExplicitScales(["yMin","yMax","y"]),g=f.yMin;for(var h in g){var i=g[h],j=f.yMax[h];yScale=f.y[h],j.range(yScale.range()).domain(yScale.domain()),i.range(yScale.range()).domain(yScale.domain())}this._super(a)},a.enterPen=function(){var a=this,b=function(b,c){var d=b.panel.xScale(b);return d.mapValueToPercent(d.mapToProp(b,c)+a._offsetX(b),c)},c=function(b,c){var d=b.panel.xScale(b);return d.mapValueToPercent(d.mapToProp(b,c)+a._offsetX(b,!0),c)},d=function(a,b){return a.panel.yScale(a).reverse()?1:0};return this._decoratePen(b,c,d,d)},a.pen=function(){var a=this,b=function(b,c){var d=b.panel.xScale(b);return d.mapValueToPercent(d.mapToProp(b,c)+a._offsetX(b),c)},c=function(b,c){var d=b.panel.xScale(b);return d.mapValueToPercent(d.mapToProp(b,c)+a._offsetX(b,!0),c)},d=function(a,b){var c=a.panel.yScale(a);return c.mapValueToPercent(c.mapValue(a.yMin,b))},e=function(a,b){var c=a.panel.yScale(a);return c.mapValueToPercent(c.mapValue(a.yMax,b))};return this._decoratePen(b,c,d,e)},a._isOrdinal=function(a){return a.panel.xScale(a)instanceof dv.scale.ordinal},a._offsetX=function(a,b){var c,d=a.panel.xScale(a);return c=d instanceof dv.scale.ordinal?d.rangeBand()/2+d.rangeBand()/2*(b?this._width:-this._width):this._maxWidthPixels*(b?this._width/2:-this._width/2)},a._defined=function(a,b){var c=a.panel.xScale(a),d=a.panel.yScale(a);return dv.util.isFinite(c.mapToProp(a,b))&&dv.util.isFinite(d.mapValue(a.yMin,b))&&dv.util.isFinite(d.mapValue(a.yMax,b))},a._decoratePen=function(a,b,c,d){var e=this,f=this.coord()._errorBar().x0(a).x1(b).y0(c).y1(d).defined(this._defined);return{bounds:function(a,b){return f.getBounds(a,b)},pathTween:function(a,b){return e.pathTween(f,this,a,b)},path:function(a,b){return f.getPath(f.getBounds(a,b))}}},a}),dv.geom.poly=dv.geom.extend(function(){function a(){this._super(),this._rendererClass=dv.geom.poly}return a._dataPointStyleClass="poly-geom",a._initializeDefaultAes=function(){this._super(),this._defaultAes.size=1,delete this._defaultAes.shape,delete this._defaultAes.x,delete this._defaultAes.y},a._trainScales=function(){var a,b=this.getExplicitScales(["yMin","xMin"]);for(a in b.yMin){var c=this._aes.y;c||(this._aes.y=c={}),c[a]||(c[a]=yMinScale.copy().property("y").mapping("y")),c[a].trainingProperties(["yMin","yMax"])}for(a in b.xMin){var d=this._aes.x;d||(this._aes.x=d={}),d[a]||(d[a]=xMinScale.copy().property("x").mapping("x")),d[a].trainingProperties(["xMin","xMax"])}},a.getValues=function(a){return a.values},a.attributes=function(a,b){b.getScale("fill"),b.getScale("stroke"),b.getScale("alpha");a.attr("style","").classed(b._dataPointStyleClass,!0).call(b.applyAttributeValue,b,"stroke","stroke").call(b.applyAttributeValue,b,"fill","fill").call(b.applyAttributeValue,b,"opacity","alpha")},a.exitSeriesGroup=function(a,b){b.exitSeries(a,b.enterPen,b)},a.getHighlightColor=function(a,b){var c=this.getScale("fill"),d=this.getScale("stroke");return d instanceof dv.scale.constant?c instanceof dv.scale.constant?d.mapToProp(a,b):c.mapToProp(a,b):d.mapToProp(a,b)},a.enterPen=function(){var a=function(a,b){return a.panel.xScale(a).mapPropToPercent(a,b)},b=function(a,b){var c=a.panel.yScale(a);return dv.util.map(a[c.property()],function(){return c.reverse()?1:0})};return this._decoratePen(a,b)},a.pen=function(){var a=function(a,b){return a.panel.xScale(a).mapPropToPercent(a,b)},b=function(a,b){return a.panel.yScale(a).mapPropToPercent(a,b)};return this._decoratePen(a,b)},a._defined=function(a,b){for(var c=a.panel.xScale(a).mapToProp(a,b),d=a.panel.yScale(a).mapToProp(a,b),e=d3.max([c.length,d.length]),f=!0,g=0;e>g&&f;g++)f=dv.util.isFinite(c[g])&&dv.util.isFinite(d[g]);return f},a._decoratePen=function(a,b){var c=this,d=this.coord()._poly().xs(a).ys(b).defined(this._defined);return{bounds:function(a,b){return d.getBounds(a,b)},pathTween:function(a,b,e){return c.pathTween(d,this,a,b,e)},path:function(a,b){return d.getPath(d.getBounds(a,b))}}},a}),dv.behavior=dv.extend(function(){function a(){}var b;return a._testAndroidChromeBug141840=function(){if(void 0===b){var a=navigator.userAgent;b=null!==/Android .* Chrome\/18+/.exec(a)||null!==/Silk\/2./.exec(a)}return b},a}),dv.behavior.inspector=dv.behavior.extend(function(){function a(){this._size=void 0,this._lastX=NaN,this._visible=!1,this._inspector=null,this._thickness=3,this._orientation="bottom",this._currentValue=null,this._gutterPadding=-7,this._calloutPadding={left:8,top:7,right:8,bottom:7},this._label=this._defaultLabel(),this._underGeoms=!1,this._dragInspect=!0,this._pressTimer=null}function b(){var a=[],b=this._chart.getTrainedScale("x"),c=!1,d=function(a,d){return a=b._parse(a),d=b._parse(d),c&&a&&d?a.getTime()===d.getTime():a===d},e=function(a){return b.mapValue(a)},f=this._chart.data(),g=-1,h=this._chart._layers.length;for(f.length&&a.concat(f[b.property()]);++g<h;){var i=this._chart._layers[g],j=i.getTrainedScale("x"),k=i.data()[j.property()];k&&k!==f&&(a=a.concat(k)),c=c||j instanceof dv.scale.time||j instanceof dv.scale.time.utc}return a.length?dv.util.sortBy(dv.util.uniqueValues(a,d),e):a}function c(){this._chart.on("mousemove.inspector",dv.util.bind(g,this)),this._chart.on("mouseout.inspector",dv.util.bind(h,this)),this._chart.on("touchstart.inspector",dv.util.bind(e,this)),this._chart.on("touchmove.inspector",dv.util.bind(g,this)),this._chart.on("touchend.inspector",dv.util.bind(f,this))}function d(a,b,c){var d=0,e=0;if(this._lastX!==c){this._inspector.attr("opacity",1),this._inspector.select(".inspector-tip-label").text(b).each(function(){var a=this.getBBox();d=Math.max(a.width,d),e=Math.max(a.height,e)});var f,g=this._chart.facet().getPanel(0).bounds();d+=this._calloutPadding.left+this._calloutPadding.right,e+=this._calloutPadding.top+this._calloutPadding.bottom,f=c-d/2,f<g.left+this._gutterPadding&&(f=g.left+this._gutterPadding),f+d>g.right-this._gutterPadding&&(f=g.right-this._gutterPadding-d),this._inspector.select(".inspector-marker").attr("transform","translate("+f+",0)"),this._inspector.select(".inspector-tip-background").attr("width",d).attr("height",e);var h=c-f;this._inspector.select(".inspector-line-container").attr("transform","translate("+h+",0)")}}function e(a){if(a){var b=this;return this._dragInspect=!1,clearTimeout(this._pressTimer),this._pressTimer=setTimeout(function(){b._dragInspect=!0,g.call(b,a)},500),!1}}function f(a){clearTimeout(this._pressTimer),this._dragInspect&&(this._dragInspect=!1),h.call(this,a)}function g(a){if(a){if(!this._dragInspect)return void clearTimeout(this._pressTimer);var b=a.touches?a.touches[0]:a,c=this._chart.getTrainedScale("x"),e=this._testAndroidChromeBug141840()?b.screenX:b.clientX,f=e-b.target.getBoundingClientRect().left+b.target.getBBox().x,g=dv.util.binaryCompare(this._domain,f,function(a){return c.mapValue(a)}),h=Math.min(Math.max(g||0,0),this._domain.length-1),i=this._domain[h],j=this._label.call(this,i,h),k=c.mapValue(i);this._currentValue!=i&&(this._inspectorMove&&this._inspectorMove.call(this,j,h,k,i),d.call(this,i,j,k)),this._currentValue=i,dv.cancelEvent(a)}}function h(a){this._inspector.attr("opacity",1e-6),this._inspectorOut&&this._inspectorOut.call(this),this._currentValue=null,dv.cancelEvent(a)}return a._render=function(a){this._domain=b.call(this);var c=this._chart.facet().getPanel(0)._bounds;void 0===this._size&&(this._size=c.bottom-c.top),this._xGuide=dv.util.clone(this._chart._axes._get("x")[0]),this._selection=a,this._inspector=a.selectAll(".inspector").data([0]),this._inspector.call(this._createInspector,this._orientation,c,this._calloutPadding,this._thickness)},a._createInspector=function(a,b,c,d,e){var f=a,g=a.enter();g=g.append("g").classed("inspector",!0),f.style("pointer-events","none").attr("opacity",1e-6).attr("transform","translate(0,"+c.top+")");var h=g.append("g").classed("inspector-marker",!0),i=h.append("g").classed("inspector-line-container",!0);i.append("path").classed("inspector-callout",!0),f.select(".inspector-callout").attr("d",function(){var a=-3,d=a+5;return"bottom"===b&&(a=c.bottom-c.top+2,d=a-5),"M-5,"+a+"L5,"+a+"L0,"+d+"Z"}),i.append("line").classed("inspector-line",!0),f.select(".inspector-line").attr("y1","bottom"===b?0:4).attr("y2","bottom"===b?c.bottom-c.top-6:c.bottom-c.top).style("stroke-width",e);var j=h.append("g").classed("inspector-tip",!0);f.select(".inspector-tip").attr("transform","translate(0,"+("bottom"===b?c.bottom-c.top+2:-30)+")"),j.append("rect").classed("inspector-tip-background",!0),j.append("text").classed("inspector-tip-label",!0),f.select(".inspector-tip-label").attr("x",d.left).attr("y","1em").attr("dy",d.top)},a.moveToIndex=function(a){var b=this._chart.getTrainedScale("x"),c=this._domain[a],e=this._label.call(this,c,a),f=b.mapValue(c);d.call(this,c,e,f)},a.hide=function(){return this._inspector.attr("opacity",1e-6),this._visible=!1,this},a.show=function(){return this._inspector.attr("opacity",1),this._visible=!0,this},a._removeEvents=function(){this._chart.on("mousemove.inspector",null),this._chart.on("mouseout.inspector",null),this._chart.on("touchstart.inspector",null),this._chart.on("touchmove.inspector",null),this._chart.on("touchend.inspector",null)},a.inspectorMove=function(a){return arguments.length?(this._inspectorMove=a,this):this._inspectorMove},a.inspectorOut=function(a){return arguments.length?(this._inspectorOut=a,this):this._inspectorOut},a.label=function(a){return arguments.length?(this._label=d3.functor(a),this):this._label},a.thickness=function(a){return arguments.length?(this._thickness=a,this):this._thickness},a.size=function(a){return arguments.length?(this._size=a,this):this._size},a.chart=function(a){return arguments.length?(this._chart&&this._removeEvents(),this._chart=a,this._chart&&c.call(this),this):this._chart},a.orientation=function(a){return arguments.length?(this._orientation=a,this):this._orientation},a._defaultLabel=function(){var a=this;return function(b){var c=a._xGuide.tickFormat?a._xGuide.tickFormat():function(a){return a};return c(b)}},a.label=function(a){return arguments.length?(this._label=d3.functor(a),this):this._label},a.underGeoms=function(a){return arguments.length?(this._underGeoms=a,this):this._underGeoms},a.gutterPadding=function(a){return arguments.length?(this._gutterPadding=a,this):this._gutterPadding},a}),dv.behavior.brush=dv.behavior.extend(function(){function a(a){arguments.length&&!dv.util.isArray(a)&&(this._dimensions=[this._dimensions]),this._fluidDimensions=a||["x","y"],this._snap=!1,this._resizing=!1}return a.initializeBrush=function(a){var b=this;this._brush=dv.brush(a).on("brushstart.brush",function(){b._onBrushStart.call(b),b._brushStart&&b._brushStart.call(this,"start",b._brush.extent(),b)}).on("brush.brush",function(a){b._onBrushMove.call(b),b._brushMove&&b._brushMove.call(this,"move",b._brush.extent(),b)}).on("brushend.brush",function(){b._onBrushEnd.call(b),b._brushEnd&&b._brushEnd.call(this,"end",b._brush.extent(),b)})},a._removeEvents=function(){this._brush.on("brushstart.brush",null).on("brush.brush",null).on("brushend.brush",null)},a._onBrushStart=function(){!this.snap()||this._fluidDimensions.length>1||(this._startPos=d3.mouse(this._brushContainer.node()),this._moving=d3.select(d3.event.sourceEvent.target).classed("extent"))},a._onBrushMove=function(){if(this.snap()&&!(this._fluidDimensions.length>1)){var a=d3.mouse(this._brushContainer.node());(this._startPos[0]!==a[0]||this._startPos[1]!==a[1])&&this._snapToDataPoints()}},a._onBrushEnd=function(){if(this.snap()&&!(this._fluidDimensions.length>1)){var a=d3.mouse(this._brushContainer.node());this._moving||this._startPos[0]!==a[0]||this._startPos[1]!==a[1]?this._brushContainer.selectAll(".resize").style("display",null):this.clear()}},a._snapToDataPoints=function(){var a=this._brush.extent(),b=[],c=this._chart.getTrainedScale(this._fluidDimensions[0]),d=[this._snapToNearestPoint(c,a[0],0),this._snapToNearestPoint(c,a[1],1)];this._brush.extent([d[0].value,d[1].value]);var e=this._chart.plotBounds();"x"===this._fluidDimensions?(b[0]=[d[0].rangeValue,0],b[1]=[d[1].rangeValue,e.bottom-e.top]):(b[0]=[0,d[0].rangeValue],b[1]=[e.right-e.left,d[1].rangeValue]),this._adjustBounds(this._brushContainer,b)},a._snapToNearestPoint=function(a,b,c){var d,e={};if(a instanceof dv.scale.ordinal||a instanceof dv.scale.identity){var f=dv.util.scaleRangeNoReverse(a),g=f[1]-f[0];domain=a.domain(),d=Math.round(a.invertValue(b)/g-1)}else domain=dv.util.uniq(this._chart.data()[a.mapping()]),index=dv.util.binaryCompare(domain,b,function(a){return a}),d=Math.min(Math.max(index||0,0),domain.length-1);var h=domain[d];if(e.value=h,0===c)if(0===d)e.rangeValue=a.mapValue(h);else{var i=domain[d-1],j=a.mapValue(i);valueRange=a.mapValue(h),e.rangeValue=valueRange-(valueRange-j)/2}else if(d===domain.length-1)e.rangeValue=a.mapValue(h);else{var k=domain[d+1],l=a.mapValue(k);valueRange=a.mapValue(h),e.rangeValue=valueRange+(l-valueRange)/2}return e},a._adjustBounds=function(a,b){"x"===this._fluidDimensions&&this._adjustBoundsX(a,b),"y"===this._fluidDimensions&&this._adjustBoundsY(a,b),a.selectAll(".resize").attr("transform",function(a){return"translate("+b[+/e$/.test(a)][0]+","+b[+/^s/.test(a)][1]+")"})},a._adjustBoundsX=function(a,b){a.select(".extent").attr("x",b[0][0]),a.selectAll(".extent,.n>rect,.s>rect").attr("width",b[1][0]-b[0][0])},a._adjustBoundsY=function(a,b){a.select(".extent").attr("y",b[0][1]),a.selectAll(".extent,.e>rect,.w>rect").attr("height",b[1][1]-b[0][1])},a._setScales=function(){if(this._fluidDimensions.indexOf("x")>=0){var a=this._chart.getTrainedScale("x");this._brush.x(a._d3Scale)}if(this._fluidDimensions.indexOf("y")>=0){var b=this._chart.getTrainedScale("y");this._brush.y(b._d3Scale)}},a._render=function(){this._brushContainer=this._chart._parent.select(".interaction-group"),this._brush.empty()&&this._brushContainer.classed("brush",!0).call(this._brush);var a=this._chart.plotBounds();if(!this._brush.y()){var b=a.bottom-a.top;this._brushContainer.selectAll(".extent").attr("height",b).attr("y",0),this._brushContainer.selectAll(".resize rect").attr("height",b).attr("y",0)}if(!this._brush.x()){var c=a.right-a.left;this._brushContainer.selectAll(".extent").attr("width",c).attr("x",0),this._brushContainer.selectAll(".resize rect").attr("width",c).attr("x",0)}},a.empty=function(){return this._brush.empty()},a.clear=function(){this._brushContainer.call(this._brush.clear())},a.extent=function(a){return arguments.length?(this._brushContainer.call(this._brush.extent(a)),this):this._brush?this._brush.extent():null},a.snap=function(a){return arguments.length?(this._snap=this._fluidDimensions.length>1?!1:a,this):this._snap},a.brushStart=function(a){return arguments.length?(this._brushStart=a,this):this._brushStart},a.brushMove=function(a){return arguments.length?(this._brushMove=a,this):this._brushMove},a.brushEnd=function(a){return arguments.length?(this._brushEnd=a,this):this._brushEnd},a.chart=function(a){return arguments.length?(this._chart=a,this.initializeBrush(this._chart),this._chart&&this._setScales(),this):this._chart},a}),dv.brush=function(a){function b(g){g.each(function(){var g,h=d3.select(this),l=h.selectAll(".background").data([0]),m=h.selectAll(".extent").data([0]),n=h.selectAll(".resize").data(k,String);a.on("mousedown.brush",f).on("touchstart.brush",f)._g.style("cursor","crosshair"),h.style("pointer-events","all"),m.enter().append("rect").attr("class","extent").style("cursor","move"),n.enter().append("g").attr("class",function(a){return"resize "+a}).style("cursor",function(a){return Z[a]}).append("rect").attr("x",function(a){return/[e]$/.test(a)?-10:/[w]$/.test(a)?2:null}).attr("y",function(a){return/^[ns]/.test(a)?-3:null}).attr("width",10).attr("height",6).style("visibility","hidden"),n.style("display",b.empty()?"none":null),n.exit().remove(),i&&(g=dv.util.scaleRangeNoReverse(i),l.attr("x",g[0]).attr("width",g[1]-g[0]),d(h)),j&&(g=dv.util.scaleRangeNoReverse(j),l.attr("y",g[0]).attr("height",g[1]-g[0]),e(h)),c(h)})}function c(a){a.selectAll(".resize").attr("transform",function(a){return"translate("+l[+/e$/.test(a)][0]+","+l[+/^s/.test(a)][1]+")"})}function d(a){a.select(".extent").attr("x",l[0][0]),a.selectAll(".extent,.n>rect,.s>rect").attr("width",l[1][0]-l[0][0])}function e(a){a.select(".extent").attr("y",l[0][1]),a.selectAll(".extent,.e>rect,.w>rect").attr("height",l[1][1]-l[0][1])}function f(){function a(){var a=d3.event.changedTouches;return a?d3.touches(r,a)[0]:d3.mouse(r)}function f(){32==d3.event.keyCode&&(y||(p=null,z[0]-=l[1][0],z[1]-=l[1][1],y=2),I())}function k(){32==d3.event.keyCode&&2==y&&(z[0]+=l[1][0],z[1]+=l[1][1],y=0,I())}function m(){var b=a(),f=!1;q&&(b[0]+=q[0],b[1]+=q[1]),y||(d3.event.altKey?(p||(p=[(l[0][0]+l[1][0])/2,(l[0][1]+l[1][1])/2]),z[0]=l[+(b[0]<p[0])][0],z[1]=l[+(b[1]<p[1])][1]):p=null),w&&n(b,i,0)&&(d(u),f=!0),x&&n(b,j,1)&&(e(u),f=!0),f&&(c(u),t({type:"brush",mode:y?"move":"resize"}))}function n(a,b,c){var d,e,f=dv.util.scaleRangeNoReverse(b),h=f[0],i=f[1],j=z[c],k=l[1][c]-l[0][c];return y&&(h-=j,i-=k+j),d=Math.max(h,Math.min(i,a[c])),y?e=(d+=j)+k:(p&&(j=Math.max(h,Math.min(i,2*p[c]-d))),d>j?(e=d,d=j):e=j),l[0][c]!==d||l[1][c]!==e?(g=null,l[0][c]=d,l[1][c]=e,!0):void 0}function o(){m(),u.style("pointer-events","all").selectAll(".resize").style("display",b.empty()?"none":null),d3.select("body").style("cursor",null),A.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null),t({type:"brushend"}),I()}var p,q,r=this,s=d3.select(d3.event.target),t=h.of(r,arguments),u=d3.select(r),v=s.datum(),w=!/^(n|s)$/.test(v)&&i,x=!/^(e|w)$/.test(v)&&j,y=s.classed("extent"),z=a(),A=d3.select(window).on("mousemove.brush",m).on("mouseup.brush",o).on("touchmove.brush",m).on("touchend.brush",o).on("keydown.brush",f).on("keyup.brush",k);
if(y)z[0]=l[0][0]-z[0],z[1]=l[0][1]-z[1];else if(!v||"e"!==v&&"w"!==v&&"s"!==v&&"n"!==v&&"nw"!==v&&"ne"!==v&&"sw"!==v&&"se"!==v)d3.event.altKey&&(p=z.slice());else{var B=+/w$/.test(v),C=+/^n/.test(v);q=[l[1-B][0]-z[0],l[1-C][1]-z[1]],z[0]=l[B][0],z[1]=l[C][1]}u.style("pointer-events","none").selectAll(".resize").style("display",null),d3.select("body").style("cursor",s.style("cursor")),t({type:"brushstart"}),m(),I()}var g,h=H(b,"brushstart","brush","brushend"),i=null,j=null,k=$[0],l=[[0,0],[0,0]];return b.x=function(a){return arguments.length?(i=a,k=$[!i<<1|!j],b):i},b.y=function(a){return arguments.length?(j=a,k=$[!i<<1|!j],b):j},b.extent=function(a){var c,d,e,f,h;return arguments.length?(g=[[0,0],[0,0]],i&&(c=a[0],d=a[1],j&&(c=c[0],d=d[0]),g[0][0]=c,g[1][0]=d,i.invert&&(c=i(c),d=i(d)),c>d&&(h=c,c=d,d=h),l[0][0]=0|c,l[1][0]=0|d),j&&(e=a[0],f=a[1],i&&(e=e[1],f=f[1]),g[0][1]=e,g[1][1]=f,j.invert&&(e=j(e),f=j(f)),e>f&&(h=e,e=f,f=h),l[0][1]=0|e,l[1][1]=0|f),b):(a=g||l,i&&(c=a[0][0],d=a[1][0],g||(c=l[0][0],d=l[1][0],i.invert&&(c=i.invert(c),d=i.invert(d)),c>d&&(h=c,c=d,d=h))),j&&(e=a[0][1],f=a[1][1],g||(e=l[0][1],f=l[1][1],j.invert&&(e=j.invert(e),f=j.invert(f)),e>f&&(h=e,e=f,f=h))),i&&j?[[c,e],[d,f]]:i?[c,d]:j&&[e,f])},b.clear=function(){return g=null,l[0][0]=l[0][1]=l[1][0]=l[1][1]=0,b},b.empty=function(){return i&&l[0][0]===l[1][0]||j&&l[0][1]===l[1][1]},d3.rebind(b,h,"on")};var Z={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},$=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]];F.prototype.on=function(a,b){var c=a.indexOf("."),d="";return c>0&&(d=a.substring(c+1),a=a.substring(0,c)),arguments.length<2?this[a].on(d):this[a].on(d,b)},dv.behavior.zoom=dv.behavior.extend(function(){function a(a){arguments.length&&!dv.util.isArray(a)&&(this._dimensions=[this._dimensions]),this._fluidDimensions=a||["x","y"],this._zoom=d3.behavior.zoom(),this.scaleExtent([0,1/0]),this._underGeoms=!1}return a.initializeZoom=function(a){var b=this;this._cacheAxes(),this._zoom.on("zoomstart.zoom",function(){b._zoomStart&&b._zoomStart.call(this,"start",d3.event.scale,d3.event.translate,b)}).on("zoom.zoom",function(){b._zoomMove&&b._zoomMove.call(this,"move",d3.event.scale,d3.event.translate,b),b._refresh(d3.event.scale,d3.event.translate)}).on("zoomend.zoom",function(){b._zoomEnd&&b._zoomEnd.call(this,"end",d3.event.scale,d3.event.translate,b)})},a.underGeoms=function(a){return arguments.length?(this._underGeoms=a,this):this._underGeoms},a._cacheAxes=function(){this._axisCache={};for(var a in this._chart._axes._axes)this._axisCache[a]=this._chart._axes._axes[a]},a._removeEvents=function(){this._zoom.on("zoomstart.zoom",null).on("zoom.zoom",null).on("zoomend.zoom",null)},a._refresh=function(a,b){var c=this,d=[0,this._bounds.width-this._bounds.width*a],e=[0,this._bounds.height-this._bounds.height*a];a>=1?(b[0]=Math.min(d[0],Math.max(b[0],d[1])),b[1]=Math.min(e[0],Math.max(b[1],e[1]))):(b[0]=b[0]<d[0]?d[0]:b[0]>d[1]?d[1]:b[0],b[1]=b[1]<e[0]?e[0]:b[1]>e[1]?e[1]:b[1]),this._zoom.translate(b),setTimeout(function(){c._chart._axes._axes=c._axisCache,c._chart.duration(0),c._chart._finalizePlotBounds(),c._chart._facet._render()},0)},a._setScales=function(){if(this._fluidDimensions.indexOf("x")>=0){var a=this._chart.getTrainedScale("x");this._zoom.x(a._d3Scale)}if(this._fluidDimensions.indexOf("y")>=0){var b=this._chart.getTrainedScale("y");this._zoom.y(b._d3Scale)}},a._render=function(a){this._zoomContainer=a.selectAll(".zoom-container").data([0]),this._zoomContainer.enter().append("g").classed("zoom-container");var b=this._zoomContainer.selectAll(".zoom-pane").data([0]);b.enter().append("rect").classed("zoom-pane",!0);var c=this._chart.facet().getPanel(0),d=c.bounds();b.attr("x",d.left).attr("y",d.top).attr("width",d.width).attr("height",d.height).call(this._zoom),this._bounds=d},a.scale=function(a){return arguments.length?(this._zoom.scale(a),this._refresh(a,this._zoom.translate()),this):this._zoom.scale()},a.scaleExtent=function(a){return arguments.length?(this._zoom.scaleExtent(a),this):this._zoom.scaleExtent()},a.translate=function(a){return arguments.length?(this._zoom.translate(a),this._refresh(this._zoom.scale(),a),this):this._zoom.translate()},a.zoomStart=function(a){return arguments.length?(this._zoomStart=a,this):this._zoomStart},a.zoomMove=function(a){return arguments.length?(this._zoomMove=a,this):this._zoomMove},a.zoomEnd=function(a){return arguments.length?(this._zoomEnd=a,this):this._zoomEnd},a.chart=function(a){return arguments.length?(this._chart=a,this.initializeZoom(this._chart),this._chart&&(this._setScales(),this._chart.clipPlot(!0)),this):this._chart},a}),dv.behavior.rollover=dv.behavior.extend(function(){function a(){this._selection=null,this._showTooltip=this._defaultShowTooltip,this._hideTooltip=this._defaultHideTooltip,this._orientation="right",this._tooltipPadding=10,this._content=this._defaultContent,this._lastSelectedTarget=null,this._timer=null,this._pressTimer=null,this._dragInspect=!0}return a._render=function(a){this._xGuides=this.__geom._chart._axes._get("x"),this._yGuides=this.__geom._chart._axes._get("y"),this._isPolar=this.__geom.coord()instanceof dv.coord.polar,this._selection=a,this._addEvents()},a._addEvents=function(){var a=this;this.__geom.on("mouseover.rollover",function(b,c,d){return a._onMouseOver.call(this,b,c,d,a)}).on("mouseout.rollover",function(b,c,d){return a._onMouseOut.call(this,b,c,d,a)}),this.__geom._chart.on("tap.rollover",function(){return a._onTap.call(a,d3.event)}).on("touchstart.rollover",function(){return a._onTouchStart.call(a,d3.event)}).on("touchmove.rollover",function(){return a._onTouchMove.call(a,d3.event)}).on("touchend.rollover",function(){return a._onTouchEnd.call(a,d3.event)})},a._removeEvents=function(){this.__geom.on("mouseover.rollover",null).on("mouseout.rollover",null),this.__geom._chart.on("tap.rollover",null).on("touchstart.rollover",null).on("touchmove.rollover",null).on("touchend.rollover",null)},a._getElementMetadata=function(a,b){var c={d:b.datum(),i:0,j:0};return a._geomGroup.selectAll(".series ."+a._dataPointStyleClass).each(function(a,b,d){c.d===a&&(c.i=b,c.j=d)}),c},a._defaultShowTooltip=function(a,b,c,d,e){e._darkenGeom.call(this,a,e),e._showTip.call(this,a,b,c,e)},a._defaultHideTooltip=function(a,b,c,d,e){e._brightenGeom.call(this,a,e),e._removeTip.call(this,a,b,c,e)},a._darkenGeom=function(a,b){var c=d3.select(this),d=function(a,c,d){if(c.hasOwnProperty(a)){var e=b.__geom.getScale(a).mapValue(c[a]);d.style(a,d3.rgb(e).darker(1).toString())}};d("fill",a,c),d("stroke",a,c)},a._brightenGeom=function(a,b){var c=d3.select(this),d=function(a,c,d){if(c.hasOwnProperty(a)){var e=b.__geom.getScale(a).mapValue(c[a]);d.style(a,e)}};d("fill",a,c),d("stroke",a,c)},a._showTip=function(a,b,c,d){var e=d.__geom.chart()._chartContainer,f=this.getBBox(),g=dv.absoluteCoordinates(d.__geom.chart(),[f.x,f.y],a.panel),h={height:f.height,width:f.width,x:g[0],y:g[1]};dv.showTooltip(h,e.select(".plot").node().getBBox(),d.content().call(d,a,b,c),d._orientation,d._tooltipPadding,e)},a._removeTip=function(a,b,c,d){dv.removeTooltip(d.__geom.chart()._chartContainer)},a._defaultContent=function(a,b,c){var d=this.__geom.getExplicitScale("group"),e=a[0]?a[0]:a,f=e.panel.xScale(e),g=e.panel.yScale(e),h=this._xGuides[f.scaleIndex()],i=this._yGuides[g.scaleIndex()],j=h.__scale&&h.tickFormat()?h.tickFormat():String,k=i.__scale&&i.tickFormat()?i.tickFormat():String,l='<span class="metric-value">'+k(e.data[g.mapping()])+'</span><span class="metric-name">'+g.mapping()+'</span><span class="metric-value">'+j(e.data[f.mapping()])+'</span><span class="metric-name">'+f.mapping()+"</span>";return d&&d.mapping()&&(l='<span class="series-name">'+e.data[d.mapping()]+"</span>"+l),l},a._onMouseOver=function(a,b,c,d){d._showTooltip.call(this,a,b,c,d3.event,d),this._mouseOver&&this._mouseOver.call(this,a,b,c,d3.event)},a._onMouseOut=function(a,b,c,d){d._hideTooltip.call(this,a,b,c,d3.event,d),d._mouseOut&&d._mouseOut.call(this,a,b,c,d3.event)},a._onTap=function(a){this._dragInspect=!0,this._onTouchMove.call(this,a),this._onTouchEnd.call(this,a)},a._onTouchStart=function(a){var b=this;return this._lastSelectedTarget&&(clearTimeout(b._timer),this._onTouchEnd.call(this,a,0)),this._dragInspect=!1,clearTimeout(this._pressTimer),this._pressTimer=setTimeout(function(){b._dragInspect=!0,b._onTouchMove.call(b,a)},500),!1},a._onTouchMove=function(a){if(!this._dragInspect)return void clearTimeout(this._pressTimer);var b=a.touches?a.touches[0]:a,c=d3.select(this._elementFromPoint(b)),d=this._lastSelectedTarget&&this._lastSelectedTarget.node()===c.node();if(!c.empty()&&c.classed(this.__geom._dataPointStyleClass)){if(this._lastSelectedTarget&&!d){var e=this._lastSelectedTarget.datum();this._brightenGeom.call(this._lastSelectedTarget.node(),e,this)}if(!d){var f=this._getElementMetadata(this.__geom,c);this._showTooltip.call(c.node(),f.d,f.i,f.j,a,this),this._mouseOver&&this._mouseOver.call(c.node(),f.d,f.i,f.j,a),this._lastSelectedTarget=c}}dv.cancelEvent(a)},a._onTouchEnd=function(a,b){var c=this;clearTimeout(this._pressTimer),this._dragInspect=!1;a.touches?a.touches[0]:a;if(arguments.length<2&&(b=500),this._lastSelectedTarget){var d=function(){if(c._lastSelectedTarget){var b=c._getElementMetadata(c.__geom,c._lastSelectedTarget);c._hideTooltip.call(c._lastSelectedTarget.node(),b.d,b.i,b.j,a,c),c._mouseOut&&c._mouseOut.call(c._lastSelectedTarget.node(),b.d,b.i,b.j,a),c._lastSelectedTarget=null}};b?timer=setTimeout(d,b):d.call(this)}dv.cancelEvent(a)},a._elementFromPoint=function(a){var b=[a.clientX,a.clientY];return this._testAndroidChromeBug141840()&&(b=[a.screenX,a.screenY]),document.elementFromPoint(b[0],b[1])},a.content=function(a){return arguments.length?(this._content=d3.functor(a),this):this._content},a.tooltipPadding=function(a){return arguments.length?(this._tooltipPadding=a,this):this._tooltipPadding},a.orientation=function(a){return arguments.length?(this._orientation=a,this):this._orientation},a.mouseOver=function(a){return arguments.length?(this._mouseOver=a,this):this._mouseOver},a.mouseOut=function(a){return arguments.length?(this._mouseOut=a,this):this._mouseOut},a.showTooltip=function(a){return arguments.length?(this._showTooltip=a,this):this._showTooltip},a.hideTooltip=function(a){return arguments.length?(this._hideTooltip=a,this):this._hideTooltip},a._geom=function(a){return arguments.length?(this.__geom&&this.__geom!==a&&this._removeEvents(),this.__geom=a,this):this.__geom},a}),dv.behavior.voronoiRollover=dv.behavior.rollover.extend(function(){function a(){this._super(),this._voronoiContainer=null,this._points=null,this._pointDetectionRadius=20,this._numHitAreaVertices=12,this._isPolar=!1}return a._render=function(a){this._xGuides=this.__geom._chart._axes._get("x"),this._yGuides=this.__geom._chart._axes._get("y"),this._isPolar=this.__geom.coord()instanceof dv.coord.polar,this._selection=a,this._createTooltipContainer(),this._renderPolygons(this._getPolygonData(),a),this._addEvents()},a._addEvents=function(){var a=this;this.__geom._chart.on("tap.rollover",function(){return a._onTap.call(a,d3.event)}).on("touchstart.rollover",function(){return a._onTouchStart.call(a,d3.event)}).on("touchmove.rollover",function(){return a._onTouchMove.call(a,d3.event)}).on("touchend.rollover",function(){return a._onTouchEnd.call(a,d3.event)})},a._removeEvents=function(){this.__geom._chart.on("tap.rollover",null).on("touchstart.rollover",null).on("touchmove.rollover",null).on("touchend.rollover",null)},a._createTooltipContainer=function(){this._voronoiContainer=this._selection.selectAll(".voronoiSelection-container").data([this]),this._voronoiContainer.enter().append("g").classed("voronoiSelection-container",!0)},a._getPolygonData=function(){var a=[],b=(this.__geom._nestData,this);this._points=[];var c=b.__geom.coord()._point().x(function(a,b){return a.x}).y(function(a,b){return a.y}).defined(function(a,b){return!0});return dv.util.each(this.__geom._nestData,function(d,e){dv.util.each(d.values,function(d,f){var g={},h=d[0]?d[0]:d,i=h.panel.xScale(h),j=h.panel.yScale(h);g.x=i.mapValueToPercent(i.mapToProp(h,f)+i.rangeBand()/2,f)||0,g.y=j.mapValueToPercent(j.mapValue(h.hasOwnProperty("y0")?h.y+h.y0:h.y),f)||0,g.panel=h.panel;var k=c.getBounds(g,f);if(b._isPolar){var l=b.__geom.coord()._transformAngleRadiusToXY(k.bounds.x,k.bounds.y);range.bounds.x=l[0],range.bounds.y=l[1]}b._points.push({data:k,rawData:h,seriesIndex:e,index:f}),a.push([k.bounds.x,k.bounds.y])})}),d3.geom.voronoi(a)},a._renderPolygons=function(a,b){var c=this,d=(this.__geom._nestData.length,this.__geom._nestData[0].values.length,d3.select(b.node().parentNode),0),e=0;if(this._isPolar){var f=this.__geom._nestData[0].values[0].panel,g=dv.util.scaleRangeNoReverse(f.xOuterScale()),h=dv.util.scaleRangeNoReverse(f.yOuterScale());d=(g[0]+g[1])/2,e=(h[0]+h[1])/2}this._voronoiContainer.attr("transform","translate("+d+","+e+")");var i=this._voronoiContainer.selectAll("path").data(a);i.exit().remove(),i.enter().append("path").attr("id",function(a,b){return"path-"+b}).classed("voronoi-overlay",!0),i.attr("d",function(a,b){return c._getPolygonPath(a,b,c)}).on("mouseover.rollover",function(a,b,d){return c._onMouseOver.call(this,a.data,b,d,c)}).on("mouseout.rollover",function(a,b,d){return c._onMouseOut.call(this,a.data,b,d,c)}).call(this._removeRegisteredEvents,this).call(this._addRegisteredEvents,this),i.exit().on("mouseover.rollover",null).on("mouseout.rollover",null).remove()},a._addRegisteredEvents=function(a,b){b||(b=this),b.__geom&&(a=a||b._voronoiContainer.selectAll(".voronoi-overlay"),dv.util.each(b.__geom.eventMap,function(c,d){a.on(d,function(a,c){b.__geom.eventMap[d].callback.call(this,a,c,d3.event)},c.capture)}),dv.util.each(b.__geom._chart.eventMap,function(c,d){a.on(d+".dvchart",function(a,c){var e=d3.event,f=b.__geom._chart._interactionGroup.node();b._shouldDispatchChartEvent(e,f)&&b.__geom._chart.eventMap[d].callback.call(f,e)},c.capture)}))},a._removeRegisteredEvents=function(a,b){b||(b=this),b.__geom&&(a=a||b._voronoiContainer.selectAll(".voronoi-overlay"),dv.util.each(b.unregisterEventMap,function(b,c){a.on(c,null,b)}),dv.util.each(b.__geom._chart.unregisterEventMap,function(b,c){a.on(c+".dvchart",null,b)}))},a._shouldDispatchChartEvent=function(a,b){var c=!0;if("mouseout"===a.type||"mouseover"===a.type){var d=a.relatedTarget;d||(d="mouseout"===a.type?a.toElement:a.fromElement);var e=d3.select(d);if(e&&!e.empty()){e.attr("class");c=!(e.node()===b||e.classed("voronoi-overlay"))}}return c},a._getPolygonPath=function(a,b,c){if(!a)return null;a.data=c._points[b];var d=(dv.util.clone(a),c._points[b]),e=d3.geom.polygon(c._getPolygonPoints(d.data.bounds.x,d.data.bounds.y)),f=e.clip(a);return f.length?"M"+f.join("L")+"Z":null},a._getPolygonPoints=function(a,b){for(var c=[],d=360;d>0;d-=360/this._numHitAreaVertices){var e=d*Math.PI/180,f=Math.cos(e)*this._pointDetectionRadius+a,g=Math.sin(e)*this._pointDetectionRadius+b;c.push([f,g])}return c},a._defaultShowTooltip=function(a,b,c,d,e){e._showPoint.call(this,a,b,c,e),e._showTip.call(this,a,b,c,e)},a._defaultHideTooltip=function(a,b,c,d,e){e._removePoint.call(this,a,b,c,e),e._removeTip.call(this,a,b,c,e)},a._showPoint=function(a,b,c,d){var e=10,f=a.rawData,g=d.getGeomFromVoronoiIndex.call(d,f,b,c);if(!g.empty()){var h=g.node().getBoundingClientRect(),i={height:h.height,width:h.width,x:h.x,y:h.y};e=Math.max(i.height,i.width)/2+2.5}d._voronoiContainer.append("circle").classed("hover-point",!0).attr("id","point-"+c+"-"+b).attr("cx",a.data.bounds.x).attr("cy",a.data.bounds.y).attr("r",0).style("stroke",function(){return d.__geom.getHighlightColor(a.rawData,b)}).style("pointer-events","none").transition().duration(350).attr("r",e)},a._removePoint=function(a,b,c,d){d._voronoiContainer.selectAll("#point-"+c+"-"+b).transition().duration(350).attr("r",0).remove()},a._showTip=function(a,b,c,d){var e,f=d.__geom.chart()._chartContainer,g=a.data,h=a.rawData,i=d.getGeomFromVoronoiIndex.call(d,h,b,c);if(i.empty()){var j=dv.absoluteCoordinates(d.__geom.chart(),[g.bounds.x,g.bounds.y],h.panel),k=10,l=10;e={height:k,width:l,y:j[1]-k/2,x:j[0]-l/2}}else{var m=i.node().getBBox();e={height:m.height,width:m.width,x:m.x,y:m.y}}dv.showTooltip(e,f.select(".panels").node().getBBox(),d.content().call(d,h,b,c),d._orientation,d._tooltipPadding,f)},a.getGeomFromVoronoiIndex=function(a,b,c){return this.__geom.chart()._g.selectAll(".datum-"+b+".series-"+c).filter(function(b){return a===b})},a._onMouseOver=function(a,b,c,d){d._showTooltip.call(this,a,a.index,a.seriesIndex,d3.event,d),d._mouseOver&&d._mouseOver.call(this,a.rawData,a.index,a.seriesIndex,d3.event)},a._onMouseOut=function(a,b,c,d){d._hideTooltip.call(this,a,a.index,a.seriesIndex,d3.event,d),d._mouseOut&&d._mouseOut.call(this,a.rawData,a.index,a.seriesIndex,d3.event)},a._onTouchMove=function(a){if(!this._dragInspect)return void clearTimeout(this._pressTimer);var b=a.touches?a.touches[0]:a,c=d3.select(this._elementFromPoint(b)),d=this._lastSelectedTarget&&this._lastSelectedTarget.node()===c.node();if(!c.empty()&&c.classed("voronoi-overlay")){if(this._lastSelectedTarget&&!d){var e=this._lastSelectedTarget.datum().data;this._removePoint.call(c.node(),e.rawData,e.index,e.seriesIndex,this)}if(!d){var f=c.datum().data;this._showTooltip.call(c.node(),f,f.index,f.seriesIndex,a,this),this._mouseOver&&this._mouseOver.call(c.node(),f.rawData,f.index,f.seriesIndex,a),this._lastSelectedTarget=c}}dv.cancelEvent(a)},a._onTouchEnd=function(a,b){var c=this;if(clearTimeout(this._pressTimer),this._dragInspect&&(this._dragInspect=!1),arguments.length<2&&(b=500),this._lastSelectedTarget){var d=function(){if(c._lastSelectedTarget){var b=c._lastSelectedTarget.datum().data;c._hideTooltip.call(c._lastSelectedTarget.node(),b,b.index,b.seriesIndex,a,c),c._mouseOut&&c._mouseOut.call(c._lastSelectedTarget.node(),b.rawData,b.index,b.seriesIndex,a),c._lastSelectedTarget=null}};b?timer=setTimeout(d,b):d.call(this)}dv.cancelEvent(a)},a.pointDetectionRadius=function(a){return arguments.length?(this._pointDetectionRadius=a,this):this._pointDetectionRadius},a.numHitAreaVertices=function(a){return arguments.length?(this._numHitAreaVertices=a,this):this._numHitAreaVertices},a}),dv.log=dv.log||{},dv.log.NOCONSOLE=!1,dv.log.LVL_ERROR=0,dv.log.ERROR="error",dv.log.LVL_WARN=1,dv.log.WARN="warn",dv.log.LVL_DEBUG=2,dv.log.DEBUG="debug",dv.log.LOGLEVEL=dv.log.LVL_DEBUG,dv.log.error=function(a){return dv.log._message(dv.log.ERROR,a)},dv.log.warn=function(a){return dv.log._message(dv.log.WARN,a)},dv.log.debug=function(a){return dv.log._message(dv.log.DEBUG,a)},dv.log.noConsole=function(a){dv.log.NOCONSOLE=a||!1,dv.log.console=window.console||dv.util.noop,(!dv.log.console.log||dv.log.NOCONSOLE)&&(dv.log.console.log=dv.util.noop),(!dv.log.console.error||dv.log.NOCONSOLE)&&(dv.log.console.error=dv.log.console.log),(!dv.log.console.warn||dv.log.NOCONSOLE)&&(dv.log.console.warn=dv.log.console.log),(!dv.log.console.debug||dv.log.NOCONSOLE)&&(dv.log.console.debug=dv.log.console.log)},dv.log._message=function(a,b){if(dv.log._isValidType(a)){if(dv.log.LOGLEVEL>=dv.log["LVL_"+a.toUpperCase()]&&dv.log.console[a](b.msg,b.data),a===dv.log.ERROR)throw b.msg+" Context Data: "+JSON.stringify(b.data)}else dv.log.console.log("Logging message with invalid type: "+a)},dv.log._isValidType=function(a){return a===dv.log.ERROR||a===dv.log.WARN||a===dv.log.DEBUG},dv.log.noConsole(!1),dv.panel=dv.extend(function(){function a(){this._margins={left:0,top:0,right:0,bottom:0},this._trainedScales={}}return a.getTrainedScale=function(a){return"x"===a?this.xScale():"y"===a?this.yScale():this._trainedScales[a]},a.getOuterScale=function(a){return"x"===a?this._xScale:"y"===a?this._yScale:null},a._updateRanges=function(a){var b=[a.left,a.right],c=[a.bottom,a.top];this._facet._chart.coord().flip()?(this._xScale.range(c),this._yScale.range(b)):(this._xScale.range(b),this._yScale.range(c))},a.bounds=function(a){return arguments.length?(this._bounds=a,this._updateRanges(this._bounds),this):this._bounds},a.margins=function(a){return arguments.length?(this._margins=a,this):this._margins},a.visibleAxisLabelOrientations=function(a){return arguments.length?(this._visibleAxisLabelOrientations=a,this):this._visibleAxisLabelOrientations},a.columnIndex=function(a){return arguments.length?(this._columnIndex=a,this):this._columnIndex},a.rowIndex=function(a){return arguments.length?(this._rowIndex=a,this):this._rowIndex},a.facetIndex=function(a){return arguments.length?(this._facetIndex=a,this):this._facetIndex},a.facetKey=function(a){return arguments.length?(this._facetKey=a,this):this._facetKey},a.xFacetTitle=function(a){return arguments.length?(this._xFacetTitle=a,this):this._xFacetTitle},a.yFacetTitle=function(a){return arguments.length?(this._yFacetTitle=a,this):this._yFacetTitle},a.xOuterScale=function(a){return arguments.length?(this._xScale=a,this):this._xScale},a.yOuterScale=function(a){return arguments.length?(this._yScale=a,this):this._yScale},a.xScale=function(a){var b=0;return a&&a.hasOwnProperty("x-index")&&(b=a["x-index"]),this._xScale.innerScaleGroup()[b]},a.yScale=function(a){var b=0;return a&&a.hasOwnProperty("y-index")&&(b=a["y-index"]),this._yScale.innerScaleGroup()[b]},a.facet=function(a){return arguments.length?(this._facet=a,this._trainedScales={},this):this._facet},a}),dv.facet=dv.extend(function(){function a(){this._numColumns=0,this._numRows=0,this._hGap=10,this._vGap=10}return a._prerender=function(){var a=this;this._trainedScales={},this._panels=[],this._rows=[],this._columns=[],this._panelsWithAxisLabels=[],dv.util.each(a._chart._layers,function(b){b._prerender(a._chart),a._trainFacetGroups(b)}),this._configureFacets(),dv.util.each(a._chart._layers,function(b){b._nestData=a._nestFacet(b),b._handlePositions(),b._trainScales(),b._createDefaultScales()}),this._trainScales()},a._trainScales=function(){var a,b=this,c=function(a){return function(c){return b._getFacetFromFacetKey(c)!==a.facetKey()}},d=function(a){return function(a,b,c){return arguments.length<2&&(b=0),arguments.length<3?void 0===this._globalScales[a]?null:this._globalScales[a][b]:(this._globalScales[a]||(this._globalScales[a]={}),this._globalScales[a][b]=c,c)}};this._globalScales={},this._positionScales={},dv.util.each(this._panels,function(e,f){dv.util.each(b._chart._layers,function(f){for(var g in f._aes){var h=f._aes[g];for(var i in h){var j=f.getScale(g,i);j instanceof dv.scale.constant||(a=b._isFree.call(b,g)?b._trainFreeScale(f,e,g,i,c(e)):b._trainScale(f,d(f),g,i),e._trainedScales[g]||(e._trainedScales[g]={}),e._trainedScales[g][i]=a,h[i].domain(a.domain()),h[i].range(a.range()))}}})}),dv.util.each(this._globalScales,function(a,b){dv.util.each(a,function(a,b){a.validateDomain(),a.reverse()&&a.domain(a.domain().reverse())})})},a._isFree=function(a){var b="x"===a||"xMin"===a||"xMax"===a,c="y"===a||"yMin"===a||"yMax"===a;return b&&("free"===this._scales||"free_x"===this._scales)||c&&("free"===this._scales||"free_y"===this._scales)},a._trainScale=function(a,b,c,d,e){var f,g=b.call(this,c,d),h={stack:"stack"===a.position()&&"y"===c,fill:"fill"===a.position()&&"y"===c,filter:e};return g?(f=a._aes[c][d],f.domain(f.calculateDomain(a._nestData,h)),g.unionDomain(f,g.reverse()),g.unionRange(f.range())):(a._aes[c][d].trainDomain(a._nestData,h),g=a._aes[c][d].copy(),b.call(this,c,d,g)),g},a._render=function(){this._axes=this._chart._axes;var a=this._ensureColumnsAndRows();this._adjustPlotBounds(a[0],a[1]),this._configurePanels(a[0],a[1]),this._axes._initializeAxisRenderers(),this._axes._measureTitles(this._chart._plotBounds);var b=this._measureMargins(a[0],a[1]);this._layoutPanels(a[0],a[1],b),this._renderAxisTitles(),this._renderPanels()},a._setVisibleAxisLabelOrientations=function(a,b,c,d){var e=a.rowIndex(),f=a.columnIndex(),g={left:0===f,top:0===e,right:f===c||a.facetIndex()===d-1,bottom:e===b||f>c&&e===b-1};a.visibleAxisLabelOrientations(g)},a._changeScaleRangeToLocal=function(a){var b=a.range(),c=a.innerScaleGroup();for(var d in c)dv.util.scaleRange(c[d],[b[0],b[1]]).applyRangePadding();return c},a._measureMargins=function(a,b){var c=this._panels.length,d=~~((c-1)/a),e=(c-1)%a,f=this._axes._getAllOrientations(),g={rows:[],cols:[]},h=this._isFree("x"),i=this._isFree("y"),j=this._panels[0];j&&(this._changeScaleRangeToLocal(j.getOuterScale("x")),this._changeScaleRangeToLocal(j.getOuterScale("y")));for(var k=-1;++k<c;){var l=this._panels[k],m=l.columnIndex(),n=l.rowIndex();this._setVisibleAxisLabelOrientations(l,d,e,c),l.margins({left:0,top:0,right:0,bottom:0}),n>=g.rows.length&&(g.rows[n]={left:0,top:0,right:0,bottom:0}),m>=g.cols.length&&(g.cols[m]={left:0,top:0,right:0,bottom:0}),this._panelsWithAxisLabels.push(l),this._axes._measure(l);var o=l.margins();void 0!==f.right&&!i&&k===c-1&&a-1>m&&(o.right=0),void 0!==f.bottom&&!h&&m>=e&&n===d-1&&(o.bottom=0);for(var p in g){var q="rows"===p?n:m,r=g[p][q];r.left=Math.max(o.left,r.left),r.top=Math.max(o.top,r.top),r.right=Math.max(o.right,r.right),r.bottom=Math.max(o.bottom,r.bottom)}}return g},a._layoutPanels=function(a,b,c){var d,e,f,g,h=this._chart._plotBounds,i=h.right-h.left-(a-1)*this._hGap,j=h.bottom-h.top-(b-1)*this._vGap,k={x:0,y:0},l=this;for(f=-1,g=c.cols.length;++f<g;)i-=c.cols[f].left+c.cols[f].right;for(f=-1,g=c.rows.length;++f<g;)j-=c.rows[f].bottom+c.rows[f].top;d=Math.max(i/a,0),e=Math.max(j/b,0);var m=this._chart._chartContainer.select(".axes-labels"),n=m.selectAll(".panel-labels").data(this._panelsWithAxisLabels);n.enter().append("div"),n.exit().remove(),n.attr("class",function(a,b){return"panel-labels panel-"+a.facetIndex()});var o=this._chart._panelContainer.selectAll(".panel").data(this._panels);o.enter().append("g").classed("panel",!0),o.exit().remove(),o.each(function(f,g){l._drawPanel.call(this,l,f,g,h,c,d,e,a,b,k),l._axes._render.call(l._axes,d3.select(this),m.select(".panel-labels.panel-"+f.facetIndex()),f)})},a._renderAxisTitles=function(){var a=this.getColumn(0)[0].bounds(),b=this.getRow(0)[0].bounds(),c=this.getColumn(this._columns.length-1)[0].bounds(),d=this.getRow(this._rows.length-1)[0].bounds(),e=(d.bottom-b.top)/2+b.top,f=(c.right-a.left)/2+a.left,g=this._chart.plotBounds();this._axes._renderTitles(g,{left:[g.left,e],right:[g.right,e],top:[f,g.top],bottom:[f,g.bottom]})},a._renderPanels=function(){var a=this._chart,b=(a._plotBounds,a._g.select(".plot")),c=(a._plotBounds,function(a){a.attr("transform","translate(0,0)").each(function(a){this.__previousData__&&this.__previousData__._dataPointStyleClass!=a._dataPointStyleClass&&this.__previousData__.exit(this),a._render(this),this.__previousData__=a})}),d=function(a){a.each(function(b){b.exit(this,function(){a.remove()})})},e=b.selectAll(".geom").data(a._layers);e.exit().call(d),e.enter().append("g").classed("geom",!0),e.call(c)},a._updatePanelTitle=function(a,b,c,d,e,f,g){var h={left:0,top:0,width:0,height:0},i=d3.select(this);if(dv.util.isUndefined(b))return a._removePanelTitle.call(this,c),h;var j=i.selectAll(".panel-title."+c).data([0]),k=j.enter().append("g").classed("panel-title "+c,!0).attr("transform","translate("+d+","+e+")"),l=k.append("rect").classed("panel-title-bg",!0),m=k.append("text").classed("panel-title-label",!0).attr("text-anchor","middle");dv.ANIMATION?j.transition().duration(a._chart._duration).attr("transform","translate("+d+","+e+")"):j.attr("transform","translate("+d+","+e+")");var n=j.selectAll(".panel-title-label").text(b),o=j.selectAll(".panel-title-bg"),p=n.node().getBBox(),q=0;switch(dv.ANIMATION&&(n=n.transition().duration(a._chart._duration),o=o.transition().duration(a._chart._duration)),c){case"top":x=f/2,y=p.height,h.left=0,h.top=0,h.width=f,h.height=p.height+6;break;case"right":x=g/2,y=-f+p.height,h.left=f-(p.height+6),h.top=0,h.width=p.height+6,h.height=g,q=90;break;case"bottom":x=f/2,y=g-6,h.left=0,h.top=g-(p.height+6),h.width=f,h.height=p.height+6;break;case"left":x=-g/2,y=0+p.height,h.left=0,h.top=0,h.width=p.height+6,h.height=g,q=270}return l.attr("x",h.left).attr("y",h.top).attr("width",h.width).attr("height",h.height),m.attr("transform","rotate("+q+" 0,0)").attr("x",x).attr("y",y),n.attr("transform","rotate("+q+" 0,0)").attr("x",x).attr("y",y),o.attr("x",h.left).attr("y",h.top).attr("width",h.width).attr("height",h.height),h},a._removePanelTitle=function(a){d3.select(this).selectAll(".panel-title."+a).remove()},a._updatePanelBackground=function(a,b,c,d,e){var f=d3.select(this).selectAll(".plot-bg").data([0]);f.enter().append("rect").classed("plot-bg",!0).attr("x",b).attr("y",c).attr("width",d).attr("height",e),dv.ANIMATION&&(f=f.transition().duration(a._chart._duration)),f.attr("x",b).attr("width",d).attr("height",e)},a._addToCollection=function(a,b,c){a[b]||(a[b]=[]),a[b].push(c)},a.getPanel=function(a){return this._panels&&a<this._panels.length?this._panels[a]:null},a.getRow=function(a){return this._rows[a]},a.getColumn=function(a){return this._columns[a]},a.getTrainedScale=function(a){return this._panels.length>0?this.getPanel(0).getTrainedScale(a):this._trainedScales[a]},a.scales=function(a){return arguments.length?(this._scales=a,this):this._scales},a.space=function(a){return arguments.length?(this._space=a,this):this._space},a.titleFormat=function(a){return arguments.length?(this._titleFormat=d3.functor(a),this):this._titleFormat},a.hGap=function(a){return arguments.length?(this._hGap=a,this):this._hGap},a.vGap=function(a){return arguments.length?(this._vGap=a,this):this._vGap},a.chart=function(a){return arguments.length?(this._chart=a,this):this._chart},a}),dv.facet.scale=dv.extend(function(){function a(){}return a.domain=function(){return this._innerScale.domain()},a.range=function(a){return arguments.length?(this._range=a,this):this._range},a._applyPercentage=function(a,b){return this._range[0]+(this._range[1]-this._range[0])*a.apply(this._innerScale,b)},a.mapPropToPercent=function(a,b){return this._innerScale.mapPropToPercent(a)},a.mapValueToPercent=function(a,b){return this._innerScale.mapValueToPercent(a)},a.mapToProp=function(a,b){return this._applyPercentage(this._innerScale.mapPropToPercent,[a,b])},a.mapValue=function(a,b){return this._applyPercentage(this._innerScale.mapValueToPercent,[a,b])},a.rangeBand=function(){return this._applyPercentage(this._innerScale.rangeBand)},a.innerScaleGroup=function(a){return arguments.length?(this._innerScaleGroup=a,this):this._innerScaleGroup},a}),dv.facet.wrap=dv.facet.extend(function(){function a(){this._super(),this._facetScale=null,this._preferredAspectRatio=1,this._titleOrientation="top"}return a._prerender=function(){this._facetScale=dv.scale.ordinal().mapping(this._group).domain([]),this._super()},a._trainFacetGroups=function(a){var b=a.data()[this._facetScale.mapping()];b&&this._facetScale.domain(this._facetScale.domain().concat(b))},a._trainFreeScale=function(a,b,c,d,e){var f=function(a,c,d){return arguments.length<2&&(c=0),arguments.length<3?b._trainedScales[a]?b._trainedScales[a][c]:void 0:(b._trainedScales[a]||(b._trainedScales[a]={}),b._trainedScales[a][c]=d,d)};return this._trainScale(a,f,c,d,e)},a._showAllPanelLabelsIfFree=function(){return!0},a._configureFacets=function(){this._facetKeys=this._facetScale.domain(),this._facetMap={}},a._nestFacet=function(a){var b,c,d=this,e=a.normalizedData(),f=dv.util.filterAndZip(e),g=a.getScale("group"),h=this._group,i=this._facetScale.domain();g&&(b=g.property(),c=b?e[b]:null);for(var j=-1,k=f.length;++j<k;){var l,m=0,n=f[j];n.data.hasOwnProperty(h)&&(m=i.indexOf(n.data[h]),m>=0&&(l=i[m]+""));var o=this._facetMap[m];o||(o=dv.panel().facetIndex(m).facetKey(l).xFacetTitle(l).facet(this),this._facetMap[m]=o,this._panels.push(o)),n.panel=o}return d3.nest().key(function(a){var c="";return c+=(a.data.hasOwnProperty(h)?a.data[h]:".")+" ~ ",c+=a.hasOwnProperty(b)?a[b]:"."}).sortKeys(function(a,b){var e=d._getGroupFromFacetKey(a),f=d._getGroupFromFacetKey(b),g=-1,h=-1;return"."!==e&&(g=c.indexOf(e),0>g&&(g=c.indexOf(Number(e)))),
"."!==f&&(h=c.indexOf(f),0>h&&(h=c.indexOf(Number(f)))),g>h?1:-1}).entries(f)},a._getGroupFromFacetKey=function(a){return/.* ~ (.*)/g.exec(a)[1]},a._getFacetFromFacetKey=function(a){return/(.*) ~ .*/g.exec(a)[1]},a._ensureColumnsAndRows=function(){var a=this._panels.length,b=Math.min(this._numColumns,a),c=Math.min(this._numRows,a);if(1>b&&1>c){var d=this._chart._plotBounds,e=d.right-d.left,f=d.bottom-d.top,g=Math.min(a,Math.ceil(Math.sqrt(1*a*e/(f*this._preferredAspectRatio))));return g=isNaN(g)?1:g,[g,Math.ceil(a/g)]}return 1>b&&c>=1&&(b=Math.ceil(a/c)),b>=1&&1>c&&(c=Math.ceil(a/b)),[b,c]},a._adjustPlotBounds=function(a,b){},a._configurePanels=function(a,b){for(var c=this._chart._plotBounds,d=c.right-c.left,e=c.bottom-c.top,f=(d-(a-1)*this._hGap)/a,g=(e-(b-1)*this._vGap)/b,h=-1,i=this._panels.length;++h<i;){var j=this._panels[h],k=dv.facet.scale().innerScaleGroup(j._trainedScales.x),l=dv.facet.scale().innerScaleGroup(j._trainedScales.y),m=h%a,n=~~(h/a),o={left:0,top:0,right:f,bottom:g,width:f,height:g};this._panels[h].xOuterScale(k).yOuterScale(l).columnIndex(m).rowIndex(n).bounds(o),this._addToCollection(this._rows,n,j),this._addToCollection(this._columns,m,j)}},a._drawPanel=function(a,b,c,d,e,f,g,h,i,j){var k=b.columnIndex(),l=b.rowIndex(),m=e.rows[l],n=e.cols[k],o=a._titleOrientation;0===k&&(j.x+=d.left,0===l&&(j.y+=d.top));var p=j.y+m.top,q=j.x+n.left,r=a._titleFormat?a._titleFormat.call(this,b.xFacetTitle(),c):b.xFacetTitle(),s=a._updatePanelTitle.call(this,a,r,o,q,p,f,g);b.bounds({width:f,height:g,top:p+("top"===o?s.height:0),left:q+("left"===o?s.width:0),right:q+f+("right"===o?-s.width:0),bottom:p+g+("bottom"===o?-s.height:0)}),a._updatePanelBackground.call(this,a,q,p,f,g),k===h-1?(j.x=0,j.y+=m.top+g+m.bottom+a._vGap):j.x+=n.left+f+n.right+a._hGap},a.group=function(a){return arguments.length?(this._group=a,this):this._group},a.numColumns=function(a){return arguments.length?(this._numColumns=a,this):this._numColumns},a.numRows=function(a){return arguments.length?(this._numRows=a,this):this._numRows},a.preferredAspectRatio=function(a){return arguments.length?(this._preferredAspectRatio=a,this):this._preferredAspectRatio},a}),dv.facet.grid=dv.facet.extend(function(){function a(){this._super(),this._xFacetScale=null,this._yFacetScale=null}return a._prerender=function(){this._xFacetScale=dv.scale.ordinal().mapping(this._xGroup).domain([]),this._yFacetScale=dv.scale.ordinal().mapping(this._yGroup).domain([]),this._super()},a._trainFacetGroups=function(a){var b=a.data()[this._xFacetScale.mapping()];b&&this._xFacetScale.domain(this._xFacetScale.domain().concat(b));var c=a.data()[this._yFacetScale.mapping()];c&&this._yFacetScale.domain(this._yFacetScale.domain().concat(c))},a._trainFreeScale=function(a,b,c,d,e){var f=this,g=function(a,c,d){arguments.length<2&&(c=0),f._positionScales[a]||(f._positionScales[a]={});var e=f._positionScales[a];e[c]||(e[c]=[]);var g=e[c],h=a.indexOf("x")>=0?b.columnIndex():b.rowIndex();return arguments.length<3?g[h][c]:(g[h][c]=d,d)};return this._trainScale(a,g,c,e)},a._showAllPanelLabelsIfFree=function(){return!1},a._configureFacets=function(){var a,b,c,d=this._xFacetScale.domain(),e=this._yFacetScale.domain();this._numColumns=Math.max(this._xFacetScale.domain().length,1),this._numRows=Math.max(this._yFacetScale.domain().length,1);for(var f=-1,g=this._numRows,h=0;++f<g;){yFacetIndex=f,e&&e.length>f&&(b=e[f]);for(var i=-1,j=this._numColumns;++i<j;){xFacetIndex=i,d&&d.length>i&&(a=d[i]),c=(e.length?b:".")+" ~ "+(d.length?a:".");var k=dv.panel().facetIndex(h++).facetKey(c).columnIndex(xFacetIndex).rowIndex(yFacetIndex).xFacetTitle(a).yFacetTitle(b).facet(this);this._panels.push(k),this._addToCollection(this._rows,yFacetIndex,k),this._addToCollection(this._columns,xFacetIndex,k)}}},a._nestFacet=function(a){var b,c,d=this,e=a.normalizedData(),f=dv.util.filterAndZip(e),g=a.getScale("group"),h=this._xFacetScale.domain(),i=this._yFacetScale.domain();g&&(b=g.property(),c=b?e[b]:null);for(var j=-1,k=f.length;++j<k;){var l=f[j],m=0,n=0;l.data.hasOwnProperty(this._xGroup)&&(n=h.indexOf(l.data[this._xGroup]),0>n&&(n=0)),l.data.hasOwnProperty(this._yGroup)&&(m=i.indexOf(l.data[this._yGroup]),0>m&&(m=0)),panelIndex=m*this._numColumns+n;var o=this._panels[panelIndex];l.panel=o}return d3.nest().key(function(a){var c="";return c+=(a.data.hasOwnProperty(d._yGroup)?a.data[d._yGroup]:".")+" ~ ",c+=(a.data.hasOwnProperty(d._xGroup)?a.data[d._xGroup]:".")+" ~ ",c+=a.hasOwnProperty(b)?a[b]:"."}).sortKeys(function(a,b){var e=d._getGroupFromFacetKey(a),f=d._getGroupFromFacetKey(b),g=-1,h=-1;return"."!==e&&(g=c.indexOf(e),0>g&&(g=c.indexOf(Number(e)))),"."!==f&&(h=c.indexOf(f),0>h&&(h=c.indexOf(Number(f)))),g>h?1:-1}).entries(f)},a._getGroupFromFacetKey=function(a){return/.* ~ .* ~ (.*)/g.exec(a)[1]},a._getFacetFromFacetKey=function(a){return/(.* ~ .*) ~ .*/g.exec(a)[1]},a._ensureColumnsAndRows=function(){return[this._numColumns,this._numRows]},a._adjustPlotBounds=function(a,b){var c=this._measureTitles(this._xFacetScale.domain(),"temp-column-titles",this._chart._g)+3,d=this._measureTitles(this._yFacetScale.domain(),"temp-row-titles",this._chart._g)+3;this._chart._plotBounds;this._xTitleHeight=c,this._yTitleWidth=d,this._chart._plotBounds.top+=c,this._chart._plotBounds.right-=d},a._measureTitles=function(a,b,c){var d=this._createTitlesContainer(b,this._chart._g),e=d.selectAll(".panel-title").data(a);e.enter().append("text").text(function(a,b){return a});var f=d.node().getBBox();return d.remove(),f.height},a._createTitlesContainer=function(a,b){var c=b.selectAll("."+a).data([0]);return c.enter().append("g").classed(a,!0),c.exit().remove(),c},a._configurePanels=function(a,b){for(var c=this._chart._plotBounds,d=c.right-c.left,e=c.bottom-c.top,f=(d-(a-1)*this._hGap)/a,g=(e-(b-1)*this._vGap)/b,h=0,i=0,j=0,k=-1,l=this._panels.length;++k<l;){var m=this._panels[k],n=dv.facet.scale().innerScaleGroup(m._trainedScales.x),o=dv.facet.scale().innerScaleGroup(m._trainedScales.y),p={left:0,top:0,right:0+f,bottom:0+g,width:f,height:g};this._panels[k].xOuterScale(n).yOuterScale(o).bounds(p),h+=f+this._hGap,j++,j>=a&&(h=0,i+=g+this._vGap,j=0)}},a._drawPanel=function(a,b,c,d,e,f,g,h,i,j){var k=b.columnIndex(),l=b.rowIndex(),m=e.rows[l],n=e.cols[k];if(j.x+=n.left,0===k&&(j.x+=d.left),0===l){var o=a._titleFormat?a._titleFormat.call(this,b.xFacetTitle(),c):b.xFacetTitle();j.y=m.top+d.top,a._updatePanelTitle.call(this,a,o,"top",j.x,j.y-a._xTitleHeight,f,g)}else a._removePanelTitle.call(this,"top");if(k===a._numColumns-1){var p=a._titleFormat?a._titleFormat.call(this,b.yFacetTitle(),c):b.yFacetTitle();a._updatePanelTitle.call(this,a,p,"right",j.x+a._yTitleWidth,j.y,f,g)}else a._removePanelTitle.call(this,"right");b.bounds({width:f,height:g,top:j.y,left:j.x,right:j.x+f,bottom:j.y+g}),a._updatePanelBackground.call(this,a,j.x,j.y,f,g),j.x+=f+n.right+a._hGap,k===a._numColumns-1&&(j.x=0,j.y+=m.top+g+m.bottom+a._vGap)},a.xGroup=function(a){return arguments.length?(this._xGroup=a,this):this._xGroup},a.yGroup=function(a){return arguments.length?(this._yGroup=a,this):this._yGroup},a.aggregate=function(a){return arguments.length?(this._aggregate=a,this):this._aggregate},a}),dv.chart=dv.container.extend(function(){function a(){this._super(),this._firstRender=!1,this._data={},this._coord=dv.coord.cartesian(),this._facet=dv.facet.wrap().chart(this),this._layers=[],this._behaviors=[],this._legends=dv.guide.legends(),this._axes=dv.guide.axes()._chart(this),this._delay=d3.functor(0),this._duration=d3.functor(1e3),this._ease="cubic-in-out",this._parent=null,this._chartContainer=null,this._svgContainer=null,this._g=null,this._axisLabelContainer=null,this._panelContainer=null,this._interactionGroup=null,this._prerenderFunc=null,this._postrenderFunc=null,this._clipPlot=!1,this._width=NaN,this._height=NaN,this._plotWidth=NaN,this._plotHeight=NaN,this._calcWidth=NaN,this._calcHeight=NaN,this._calcPlotWidth=NaN,this._calcPlotHeight=NaN,this._defaultPadding=this._padding=this._plotBounds=this._guidesBounds={top:0,left:0,right:0,bottom:0},this._position="identity"}return a.render=function(){if(dv.util.isUndefined(this._data)||dv.util.isEmpty(this._data))for(var a=0;a<this._layers.length;a++)(dv.util.isUndefined(this._layers[a]._data)||dv.util.isEmpty(this._layers[a]._data))&&dv.log.error({msg:"Cannot render a chart with no data provided.",data:{chartData:this._data,geom:this._layers[a]}});return this._resolvePercentDimensions(),this._createChartContainer(),this._prerender(),this._renderLegends(),this._prerenderFunc&&this._prerenderFunc.call(this),this._facet._render(),this._postrenderFunc&&this._postrenderFunc.call(this),this._renderBehaviors(),this._clipGeoms(),this._cleanupGuides(),this.unregisterEventMap=null,this},a._resolvePercentDimensions=function(){this._calcWidth=dv.util.getPercentValue(this._width,this._parent.node().offsetWidth),this._calcHeight=dv.util.getPercentValue(this._height,this._parent.node().offsetHeight),dv.util.isFinite(this._calcWidth)?this._calcPlotWidth=dv.util.getPercentValue(this._plotWidth,this._calcWidth):(this._calcPlotWidth=dv.util.getPercentValue(this._plotWidth,this._parent.node().offsetWidth),dv.util.isFinite(this._calcPlotWidth)||(this._calcWidth=this._parent.node().offsetWidth)),dv.util.isFinite(this._calcHeight)?this._calcPlotHeight=dv.util.getPercentValue(this._plotHeight,this._calcHeight):(this._calcPlotHeight=dv.util.getPercentValue(this._plotHeight,this._parent.node().offsetHeight),dv.util.isFinite(this._calcPlotHeight)||(this._calcHeight=this._parent.node().offsetHeight))},a._finalizePlotBounds=function(){var a=this._legends._allowedDimensions(),b=this._legends._getWidth(),c=this._legends._getHeight(),d={left:Math.max(a.left,this._padding.left),top:Math.max(a.top,this._padding.top)};dv.util.isFinite(this._calcWidth)?dv.util.isFinite(this._calcPlotWidth)||(this._calcPlotWidth=this._calcWidth-this._padding.left-this._padding.right-b):this._calcWidth=this._calcPlotWidth+b+this._padding.left+this._padding.right,dv.util.isFinite(this._calcHeight)?dv.util.isFinite(this._calcPlotHeight)||(this._calcPlotHeight=this._calcHeight-this._padding.top-this._padding.bottom-c):this._calcHeight=this._calcPlotHeight+c+this._padding.top+this._padding.bottom,this._calcPlotWidth=Math.min(this._calcPlotWidth,this._calcWidth-this._padding.left-this._padding.right-b),this._calcPlotHeight=Math.min(this._calcPlotHeight,this._calcHeight-this._padding.top-this._padding.bottom-c),d.right=d.left+this._calcPlotWidth,d.bottom=d.top+this._calcPlotHeight,this.plotBounds(d),this._coord instanceof dv.coord.cartesian&&(this._plotBounds.right-=this._coord.endX(),this._plotBounds.left+=this._coord.startX()),this._chartContainer.style("width",this._calcWidth+"px").style("height",this._calcHeight+"px")},a._prerender=function(){this._trainedScales={},this._calculateStats(),this._facet._prerender();var a=this._normalizeData(this.data());this.data(a),this._axes._get("x")||this._axes._add("x",dv.guide.axis()),this._axes._get("y")||this._axes._add("y",dv.guide.axis())},a._createChartContainer=function(){this._chartContainer=this._parent.selectAll(".dv-chart-container").data([0]),this._chartContainer.enter().append("div").classed("dv-chart-container",!0),this._svgContainer=this._chartContainer.selectAll("svg").data([0]),this._svgContainer.enter().append("svg").style("height","100%").style("width","100%"),this._g=this._svgContainer.select(".group"),this._g.empty()&&(this._firstRender=!0,this._g=this._svgContainer.append("g").classed("group",!0),this._panelContainer=this._g.append("g").classed("panels",!0),this._interactionGroup=this._g.append("g").classed("interaction-group",!0),this._g.append("g").classed("behavior-under-geom",!0),this._g.append("g").classed("plot",!0),this._g.append("g").classed("behavior",!0),this._g.append("g").classed("legends",!0),this._interactionGroup.append("rect").classed("interaction-canvas",!0).classed("background",!0)),this._panelContainer||(this._panelContainer=this._g.select(".panels")),this._interactionGroup||(this._interactionGroup=this._g.select(".interaction-group")),this._axisLabelContainer=this._chartContainer.selectAll(".axes-labels").data([0]),this._axisLabelContainer.enter().append("div").classed("axes-labels",!0)},a._addRegisteredEvents=function(){var a=this;dv.util.each(a.eventMap,function(b,c){a._interactionGroup.on(c,function(){var b=d3.event,d=a._interactionGroup.node();a._shouldDispatchChartEvent(b,d)&&a.eventMap[c].callback.call(a._interactionGroup.node(),d3.event)},b.capture)}),dv.util.each(a._layers,function(a){a._addRegisteredEvents()})},a._removeRegisteredEvents=function(){var a=this;dv.util.each(a.unregisterEventMap,function(b,c){a._interactionGroup&&a._interactionGroup.on(c,null,b)}),dv.util.each(a._layers,function(a){a._removeRegisteredEvents()})},a._shouldDispatchChartEvent=function(a,b){var c=!0;if("mouseout"===a.type||"mouseover"===a.type){var d=d3.select(a.relatedTarget);if(d&&!d.empty()){var e=d.attr("class");c=!(e&&e.indexOf("-geom")>=0)}}return c},a._calculateStats=function(){},a._renderLegends=function(){var a=dv.util.isFinite(this._calcWidth)?this._calcWidth-this._padding.left-this._padding.right:this._calcPlotWidth,b=dv.util.isFinite(this._calcHeight)?this._calcHeight-this._padding.top-this._padding.bottom:this._calcPlotHeight,c={left:this._padding.left,top:this._padding.top,width:a,height:b},d={el:this._g,scales:this._facet._globalScales,firstRender:this._firstRender,duration:this._duration,delay:this._delay,ease:this._ease};this._legends._allowedDimensions(c)._render(d),this._finalizePlotBounds()},a._cleanupGuides=function(){this._legends._empty(),this._axes._empty()},a._setRanges=function(){var a=this.plotBounds(),b=this.getTrainedScale("y"),c=this.getTrainedScale("x"),d=this.coord().flip()?[a.bottom-a.top,0]:[0,a.right-a.left],e=this.coord().flip()?[0,a.right-a.left]:[a.bottom-a.top,0];dv.util.scaleRange(c,d),dv.util.scaleRange(b,e)},a.plotBounds=function(a){return arguments.length?(this._plotBounds=a,this):this._plotBounds},a._renderBehaviors=function(){var a=this._facet.getPanel(0),b=a._bounds,c=this._g.select(".behavior").attr("transform","translate(0,0)"),d=this._g.select(".behavior-under-geom").attr("transform","translate(0, 0)");this._interactionGroup.attr("transform","translate(0,0)").select(".interaction-canvas").attr("visibility","hidden").attr("width",b.right-b.left).attr("height",b.bottom-b.top).attr("x",b.left).attr("y",b.top);var e=this;dv.util.each(this._behaviors,function(a){a.underGeoms&&a.underGeoms()?a.chart(e)._render(d):a.chart(e)._render(c)})},a.guide=function(a,b,c){if(!a||""===a)throw new Error("Property argument cannot be null or empty");if("all"===a){if("none"!==b)throw new Error("'all' can only be used to set all guides to 'none' (e.g. turn off all guides)");this._legends._hide(!0),this._axes._add("x","none",0),this._axes._add("y","none",0)}a=dv.util.isArray(a)?a:[a],c=dv.util.isUndefined(c)?0:c;for(var d=dv.guide.legend(),e="",f=0;f<a.length;f++){var g=b,h=this._isPositionProperty(a[f]);if(e){if(h&&"axis"!=e)throw new Error("Cannot mix positional and non-positional guide types")}else e=h?"axis":"legend";if(g?!this._isValidGuideType(a[f],g)&&dv.util.isObject(g)&&(g=this._buildCustomGuide(g)):g=h?dv.guide.axis():d,this._isValidGuideType(a[f],g))if("none"!==g&&g.scaleIndex(c),h)this._axes._add(a[f],g,c);else{if("none"!==g){this._legends._add({props:a,guide:g});break}this._legends._remove(a)}}return this},a._isPositionProperty=function(a){return"x"===a||"y"===a},a._isValidGuideType=function(a,b){var c=this._isPositionProperty(a);return b&&("none"===b||b instanceof dv.guide.custom)||c&&b instanceof dv.guide.axis||!c&&b instanceof dv.guide.legend},a._buildCustomGuide=function(a){var b=dv.guide.custom();for(var c in a)b.setFunc(c,a[c]);return b},a.getScale=function(a,b){return arguments.length<2&&(b=0),"group"===a?this._getGroup():this._aes.hasOwnProperty(a)?this._aes[a][b]:void 0},a._getGroup=function(){if(this._aes.hasOwnProperty("group"))return this._aes.group[0];for(var a=-1,b=dv.DEFAULT_CATEGORICAL_AES.length-1;a++<b;){var c=this._aes[dv.DEFAULT_CATEGORICAL_AES[a]];if(c&&c[0]&&c[0]instanceof dv.scale.ordinal&&!dv.util.isUndefined(c[0].mapping()))return c[0]}return null},a._clipGeoms=function(){var a=this,b=this._parent.selectAll(".panel").selectAll("defs").data(function(b){return a._clipPlot?[b]:[]});b.enter().append("defs"),b.exit().remove();var c=b.selectAll("clipPath").data(function(a){return[a]});c.enter().append("clipPath").classed("dv-clip",!0),c.exit().remove(),c.attr("id",function(a){return"dv-clip"+a._facetIndex});var d=c.selectAll("rect").data(function(a){return[a]});if(d.enter().append("rect"),d.exit().remove(),d.attr("x",function(a){return a._bounds.left}).attr("y",function(a){return a._bounds.top}).attr("width",function(a){return a._bounds.width}).attr("height",function(a){return a._bounds.height}),a._clipPlot){var e=this._parent.selectAll(".series");e.attr("clip-path",function(a){var b=a.values[0],c=dv.util.isArray(b)?b[0].panel:b.panel;return"url(#dv-clip"+c._facetIndex+")"})}},a.getTrainedScale=function(a){return this._facet.getTrainedScale(a)},a.getExplicitScale=function(a,b){return void 0===b&&(b=0),this._aes[a][b]},a.parent=function(a){if(!arguments.length)return this._parent?this._parent.node():null;if(this._parent=d3.select(a),this._parent.empty())throw new Error("The DV parent element was not found.");return this},a.layers=function(a){return arguments.length?(this._layers=a,this):this._layers},a.behaviors=function(a){return arguments.length?(this._behaviors=a,this):this._behaviors},a.data=function(a){return arguments.length?(this._data=a,this):this._data},a.coord=function(a){return arguments.length?(this._coord=a,this):this._coord},a.facet=function(a){return arguments.length?(this._facet=a,this._facet.chart(this),this):this._facet},a.getPlotBounds=function(a){return this._plotBounds},a.plotWidth=function(a){return arguments.length?(this._plotWidth=a,this):this._plotWidth},a.plotHeight=function(a){return arguments.length?(this._plotHeight=a,this):this._plotHeight},a.width=function(a){return arguments.length?(this._width=a,this):this._width},a.height=function(a){return arguments.length?(this._height=a,this):this._height},a.padding=function(a){return arguments.length?(this._padding=dv.util.merge(this._defaultPadding,a),this):this._padding},a.prerender=function(a){return arguments.length?(this._prerenderFunc=a,this):this._prerenderFunc},a.postrender=function(a){return arguments.length?(this._postrenderFunc=a,this):this._postrenderFunc},a.clipPlot=function(a){return arguments.length?(this._clipPlot=a,this):this._clipPlot},a})}(),function(a){"use strict";function b(a,c){if(this instanceof b)return this;var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y=c||{},z=0,A=y.displayCount||-1,B=y.showNone,C={},D=C.value=[],E=C.origValue=[],F=C.lowerBound=[],G=C.upperBound=[],H=C.series=[],I=C.series_name=[],J=C.metric_series=[],K=C.metric_series_name=[],L=C.date=[],M=C.category=[],N=C.label=[],O=C.groups=[],P=C.facets=[],Q=C.cell=[],R=C.filter=[],S=y.showMetrics||!1,T=C.metric=[],U=a.metrics.length>1,V=!1,W=!1;for(a.filters.length>1&&a.filters.some(function(a,b,c){return b>0&&!W&&(W=a.data_store!==c[b-1].data_store),b>0&&!V&&(V=(a.info&&a.info.name||"")!==(c[b-1].info&&c[b-1].info.name||"")),V&&W}),m=0,n=a.metrics.length;n>m;++m)for(g=a.metrics[m],j=(g.name||g.id||"")+"",d=g.filter_ref,e=g.date_ref,p=A>=0?Math.min(A,d.length):d.length,o=0;p>o;++o){for(h=a.filters[d[o]],h.facet_ref||(h.facet_ref=[]),w=[],x=[],t=0,u=h.facet_ref.length;u>t;++t)v=a.facets[h.facet_ref[t]],w.push(v),x.push(v.info&&v.info.name||"");if(!h.info||0!==h.info.id||B)for(i=(h.info&&h.info.name||"")+"",l=h.data_store_name||h.data_store&&h.data_store.replace("dms/","")||"",q=0,r=e.length;r>q;++q)k=a.dates[e[q]],f=a.data[d[o]][e[q]][m],D[z]="invalid"===f.status||"transform_error"===f.status||"calc_error"===f.status?void 0:+f.val||0,E[z]="invalid"===f.status?void 0:+f.orig_val||0,F[z]="invalid"===f.status||"transform_error"===f.status?void 0:+f.lower_bound||0,G[z]="invalid"===f.status||"transform_error"===f.status?void 0:+f.upper_bound||0,L[z]=new Date(k.val),M[z]=i,N[z]=j,K[z]=(W?l+"   ":"")+j,J[z]=K[z]+":m"+g.ref_id,s=[],W&&s.push(l),M[z].length&&s.push(M[z]),I[z]=s.join("   "),0===I[z].length?I[z]=j:(S||U||!V)&&j.length&&(I[z]+=" ("+j+")"),H[z]=I[z]+":m"+g.ref_id+"f"+h.ref_id,O[z]=x,R[z]=h,T[z]=g,Q[z]=f,P[z]=w,++z;else p<d.length&&++p}return C}var c=a.rs2dv;b.noConflict=function(){return a.rs2dv=c,this},b.prototype.convert=function(){return b.apply(null,arguments)},a.rs2dv=b,"function"==typeof define&&define.amd?define(function(){return b}):"undefined"==typeof exports?a.rs2dv=b:"object"==typeof module&&module.exports?module.exports=b:exports.rs2dv=b}(this),function(a){"use strict";var b={},c=a.dv||{},d=a.d3||{},e={};e._options=null,e._eventMap={},e._changedOptions=null,e.init=function(a){return this._initDefaultOptions(),this.setOptions(a),this},e._initDefaultOptions=function(a){var b={dataAdapter:"standard",data:null,height:null,parent:null,width:null,autoResize:!1,locale:"en-US",l10n:{}};a&&this._mergeOptions(b,a),this._options=b,this._changedOptions={};for(var c in b)this._changedOptions[c]=b[c];return this._options},e._mergeOption=function(a,b,c){switch(b){case"mappings":case"formats":case"scales":a[b]=a[b]||{},this._mergeOptions(a[b],c);break;default:a[b]=c}return a},e._mergeOptions=function(a,b){for(var c in b)this._mergeOption(a,c,b[c]);return a},e._truncateLabel=function(a,b){var c=b||this.X_AXIS_LABEL_MAXLENGTH;return a.length>c?a.substring(0,c)+"...":a},e._formatNumber=function(a,b,c){var e,f,g,h,i,j="",k=this._dataAdapter.l10n.numberFormat;if("currency"==a||"percent"==a?(j=k[a].symbol,g=b>=0?k[a].positivePattern:k[a].negativePattern):g=b>=0?"{number}":k.negativePattern,"percent"==a&&(b*=100),b=Math.abs(b),i=b>=100?3:b>=10?b%1?3:2:b>=1?b%1?3:1:b%1?2:1,null!=c){var l=d.formatPrefix(b);h=l.scale(b).toFixed(c)+l.symbol}else h=b>=1e3&&1e4>b?d.format(",.0f")(b):d.format("."+i+"s")(b);return c&&b<Math.pow(10,-c)&&b>0?(f=!0,h=Math.pow(10,-c)+""):null==c&&.01>b&&b>0&&(f=!0,h="0.01"),e=g.replace(/\{number\}/i,h).replace(/\{symbol\}/i,j).replace(/,/g,k.groupSeparator).replace(/\./,k.decimalSeparator),f&&(e="<"+e),e},e._getPropMapping=function(a){return this._dataAdapter.mappings()[a]},e.setOption=function(a,b){return a in this._options?("dataAdapter"===a&&"rs2dv"===b&&(b="rs"),"clickHandler"===a&&this.on("click",b),this._mergeOption(this._options,a,b),this._changedOptions||(this._changedOptions={}),this._changedOptions[a]=b,!0):!1},e.getOption=function(a){var b=this._options;return a in b?b[a]:null},e.setOptions=function(a){for(var b in a)this.setOption(b,a[b])},e._preRender=function(){if(this._clearErrorMessage(),"autoResize"in this._changedOptions&&this._updateWindowResize(),"dataAdapter"in this._changedOptions){var a=this._changedOptions.dataAdapter;if(!this._dataAdapter||this._options.dataAdapter!==a){var c=b.dataAdapter[a];if(!c)throw new Error("No data adapters were found for data adapter type "+a);var d=c[this._type]||c.base||b.dataAdapter.standard.base;this._dataAdapter=d()}}this._dataAdapter.process(this._options,this._changedOptions)},e._render=function(){},e._postRender=function(){this._changedOptions={}},e.render=function(){return this.reset(),this._preRender(),this._render(),this._postRender(),this},e.reset=function(){},e._updateWindowResize=function(){this._options.autoResize?(this._autoResizeHandler=this._autoResizeHandler||c.util.bind(this._onAutoResize,this),b.windowResize.addHandler(this._autoResizeHandler)):b.windowResize.removeHandler(this._autoResizeHandler)},e._onAutoResize=function(){},e.RESPONSIVE_WIDTH_THRESHOLD=400,e._isSmallChart=function(a){return a<e.RESPONSIVE_WIDTH_THRESHOLD},e.handleError=function(a){var b=this._dataAdapter.l10n,c=b.labels.core.erroronrender;return"invaliddata"===a.code&&(c=b.labels.core.nodata),this._setErrorMessage(c),this},e._setErrorMessage=function(a){a&&a.length?d.select(this._options.parent).html('<div class="cv-error">'+a+"</div>"):this._clearErrorMessage()},e._clearErrorMessage=function(){d.select(this._options.parent).select(".cv-error").remove()},e.destroy=function(){this.reset(),b.windowResize.removeHandler(this._autoResizeHandler)},e.on=function(a,b){var d=b&&c.util.isFunction(b);return d?(this._eventMap=this._eventMap||{},this._eventMap[a]=b):this._eventMap&&delete this._eventMap[a],this},a.cloudViz=b,b.d3=d,b.dv=c,b.rs2dv=a.rs2dv||{},b.core=e,b.localeDefinition=function(a,c,d){var e,f,g,h;if(a=a.toLowerCase(),b._localeDefinitions=e=b._localeDefinitions||{},!(arguments.length>1)){if(h=e[a],!h)throw new Error("Locale definition for "+a+" not found.");return h}if(f=a.split("-"),f.length<=1)throw new Error("A registered CloudViz locale must be a hyphenated language culture code (e.g. en-US).");g=[a,f[0],f.join("_")],g.forEach(function(b){null==d?e[b]=c:(e[b]=e[a]||{},e[b][d]=c)})},"function"==typeof define&&define.amd?define(function(){return b}):"undefined"==typeof exports?a.cloudViz=b:"object"==typeof module&&module.exports?module.exports=b:exports.cloudViz=b}(this),function(a){"use strict";a.cloudViz.seriesState=function(){var a={},b=[],c={};return a.isSeriesEnabled=function(a,c){if(!b)return!0;var d,e,f=b.length;for(d=0;f>d;d++)if(e=b[d],e.id===a&&e.type===c)return e.enabled;return!1},a.doesSeriesStateExist=function(a,c){if(!b)return!1;var d,e,f=b.length;for(d=0;f>d;d++)if(e=b[d],e.id===a&&e.type===c)return!0;return!1},a._createStateObject=function(a,b,c,d){var e;if(arguments.length<3)throw new Error("A state object requires a label and stateType.");return arguments.length<4&&(d=!0),e={name:a,id:b,type:c,enabled:d},this.dispatch("create",e),e},a.insertState=function(a,c,d,e){b.unshift(this._createStateObject.apply(this,arguments))},a.appendState=function(a,c,d,e){b.push(this._createStateObject.apply(this,arguments))},a.enableStateByIndex=function(a,c){if(a<b.length){var d=b[a];d.enabled!==c&&(d.enabled=c,this.dispatch("enableChange",d))}},a.enableStateByTypeAndId=function(a,c,d){var e,f,g=b.length;for(e=0;g>e;e++)f=b[e],f.id===c&&f.type===a&&this.enableStateByIndex(e,d)},a.removeStatesByType=function(a){var c=this;b&&b.length&&(b=b.filter(function(b){return b.type===a?(c.dispatch("remove",b),!1):!0}))},a.on=function(a,b){if(arguments.length<1)throw new Error("series state listeners require an eventType to be specified.");var d,e=a.indexOf("."),f="";e>0&&(f=a.substring(e+1),a=a.substring(0,e)),d=c[a]||{},b?(d[f]=b,c[a]=d):delete d[f]},a.dispatch=function(a,b){var d=c[a];if(d)for(var e in d)d[e].call(this,a,b)},a.getStateObjects=function(){return b},a.areSomeSeriesDisabled=function(){return b?0===Math.min.apply(null,b.map(function(a){return+a.enabled})):!1},a.areAllSeriesDisabled=function(){return b?0===Math.max.apply(null,b.map(function(a){return+a.enabled})):!1},a}}(this),function(a){"use strict";var b=a.cloudViz||{},c=b.util=b.util||{};c.deepExtend=function(a){for(var b=Array.prototype.slice.call(arguments,1),d=-1,e=b.length;++d<e;){var f=b[d];if(f)for(var g in f)f[g]&&f[g].constructor&&f[g].constructor===Object?(a[g]=a[g]||{},c.deepExtend(a[g],f[g])):a[g]=f[g]}return a},c.createConstructor=function(a){function b(){var b=Object.create(a);return"function"==typeof b.init&&b.init.apply(b,arguments),b}return b.prototype=a,b},c.namespace=function(b,c){var d=b.split("."),e=c||a;return d.forEach(function(a){var b=e[a];b||(b=e[a]={}),e=b}),e}}(this),function(a){"use strict";var b=a.cloudViz||{},c=b.core||{},d=a.dv||{},e=a.d3||{},f=Object.create(c);f.X_AXIS_LABEL_MAXLENGTH=25,f.LEGEND_ORIENTATIONS=["top","right","left"],f._chart=null,f.clipIdCounter={count:0},f._legend=null,f._seriesState=null,f.init=function(a){return Object.getPrototypeOf(f).init.apply(this,arguments),this._seriesState=b.seriesState(),this},f._initDefaultOptions=function(a){var b={aspectRatio:null,colors:["#8cc350","#5a6eaa","#d755a5","#1ebed7","#f0a01e","#9b8ce6","#3cb5a0","#3287d2","#f0557d","#c3d250","#eb782d","#78b4f5","#5faf69","#aa5fa5","#fa5a50","#f5c841"],dateGranularity:void 0,flip:!1,interactive:!1,legendOrientation:null,legendVerticalWidth:110,legendVisible:!0,targetValues:null,targetLabel:void 0,mappings:{x:"x",y:"y",series:"series",seriesLabel:"series"},plotHeight:null,plotWidth:null,preRender:null,xAxisTitle:"",yAxisTitle:"",precision:null};return a&&this._mergeOptions(b,a),Object.getPrototypeOf(f)._initDefaultOptions.call(this,b)},f.getChart=function(){return this._chart},f.enableSeriesByIndex=function(a,b){this._seriesState.enableStateByIndex(a,b)},f._highlight=function(a,b){a.classed("cv-highlight",b)},f._getYTitleFromLabels=function(a){var b=d.util.uniq(a);return b&&1===b.length?b[0]:null},f._preRender=function(){Object.getPrototypeOf(f)._preRender.call(this);try{this._createSeriesStates()}catch(a){var b=new Error("The chart data is invalid");b.code="invaliddata",this.handleError(b)}},f._postRender=function(){Object.getPrototypeOf(f)._postRender.call(this);var a=this._options,b=e.select(a.parent);this._updateYAxisHitBox(b),this._colorDualYAxes(a,b)},f._removeYAxisHitBox=function(a){a.selectAll(".axis-y .cv-axis-hitbox").remove()},f._colorDualYAxes=function(a,b){!a.dualYAxis||this._isNormalized&&this._isNormalized()||"identity"!==this._options.position&&"dodge"!==this._options.position||(b.selectAll(".axis-y.axis-index-0 span").style("color",a.colors[0]),b.selectAll(".axis-y.axis-index-1 span").style("color",a.colors[1]),b.selectAll(".axis-title-y.axis-title-index-0").style("color",a.colors[0]),b.selectAll(".axis-title-y.axis-title-index-1").style("color",a.colors[1]))},f._createSeriesStates=function(){var a=this._options;if("data"in this._changedOptions&&this._changedOptions.data){this._seriesState.removeStatesByType("standard");var b=this._dataAdapter.data()[this._getPropMapping("series")],c=this._dataAdapter.data()[this._getPropMapping("seriesLabel")];if(b)for(var d=b.reduce(function(a,b,d){return a.ids.indexOf(b)<0&&(a.ids.push(b),a.names.push(c?c[d]:b)),a},{names:[],ids:[]}),e=d.ids.length;e--;){var f=d.names[e],g=d.ids[e];this._seriesState.insertState(f||g,g,"standard")}}"targetValues"in this._changedOptions&&a.targetValues&&(this._seriesState.removeStatesByType("target"),this._seriesState.appendState(a.targetLabel||this._dataAdapter.l10n.labels.dvcore.target,"target","target"))},f._createTargetHLines=function(){var a=this._options,b=this._chart,c=this;if(a.targetValues&&a.targetValues.length){var f,g=b.layers(),h=d.geom.hline(),i=c._seriesState.isSeriesEnabled("target","target"),j={y:[],name:[]},k=a.targetValues.length,l=[0,this._isSmallChart()?24:6],m=a.scales&&"log"===a.scales.y?d.scale.log():d.scale.linear();for(f=0;k>f;f++)j.y.push(a.targetValues[f]);h.data(j).position("identity").map("y","y",m.includeInDomain(function(){return c._valuesAreFilterable()?i:!0}).rangePadding(l)).each("start",function(a,b){e.select(this).attr("legend-type","target")}),"line"===this._type?g.unshift(h):g.push(h),b.layers(g)}},f._domainNaturallyIncludesZero=function(a){if(!a)return!1;var b=this._options,c=a.property(),d=a.naturalDomain(),e=d[0];return b.scales&&"log"===b.scales[c]?1>=e:0>=e},f._updateYAxisHitBox=function(a){var b=this,c=this._options,d=this._chart.facet().getPanel(0);if(d){var e=this._isSmallChart(),f=this._isNormalized&&this._isNormalized(),g=this._chart.getTrainedScale("y"),h=this._domainNaturallyIncludesZero(g),i=d.bounds().left,j=g.range()[1],k=g.range()[0],l=a.selectAll(".axes-labels .axis-y.axis-index-0"),m=l.selectAll(".cv-axis-hitbox").data([0]);!c.interactive||e||f||h||"identity"!==c.position?this._removeYAxisHitBox(a):(m.enter().append("div").classed("cv-axis-hitbox",!0),m.on("click",function(){c.interactive&&!e&&(b._dataAdapter._forceZero=!b._dataAdapter._forceZero,b._render(!0),b._postRender())}),"none"!==this._legend&&this._legend.isVertical()&&(i-="left"===this._legend.orientation()?this._legend._getUsedWidth():0),m.style("width",i+"px").style("height",k-j+"px").style("top",j+"px").style("left",-i+"px"),m.exit().on("click",null));
}else this._removeYAxisHitBox(a)},f._render=function(a){Object.getPrototypeOf(f)._render.apply(this,arguments);var b,c=this._options;try{if(!this._dataAdapter.isDataValid())throw b=new Error("The chart data is invalid"),b.code="invaliddata",b;if(!c.parent)throw new Error("The chart options did not contain a parent");return this._draw(a)}catch(d){this.handleError(d)}},f.reset=function(){Object.getPrototypeOf(f).reset.apply(this,arguments)},f.destroy=function(){return Object.getPrototypeOf(f).destroy.apply(this,arguments),this._options&&this._options.parent&&e.select(this._options.parent).select(".cv-wrapper").remove(),this},f._isMappedAndExistsInData=function(a){var b=this._getPropMapping(a);return b&&this._options.data[b]},f._setChartCoreOptions=function(){var a=this._options,b=this._chart,c=this,d=a.aspectRatio,f=a.width,g=a.height,h=e.select(a.parent);b.data(this._dataAdapter.data()).width(null!==d&&null!==g?g*d:f).height(null!==d&&null!==f?f/d:g);var i=h.selectAll(".cv-wrapper").data([0]);if(i.enter().insert("div",":first-child").classed("cv-wrapper",!0),i.attr("data-chart-type",this._type),i.classed({interactive:a.interactive,"right-overflow":this._adjustClipWidth,"cv-small-chart":this._isSmallChart()}),b.parent(i.node()),this._legend=this._buildLegend(),this._seriesState.on("enableChange.paths",function(a,b){c._preRender(),c._render(!0),c._postRender(),setTimeout(function(){c._updatePathStates()},10)}),this._isSmallChart())b.padding({});else{var j={left:10};a.dualYAxis&&(j.right=10),b.padding(j)}},f._draw=function(a){var b=this._chart,c=(this._options,void 0===a?!1:a);if(!b)throw new Error("DV Chart was not created");return this._setChartCoreOptions(),this._setChartTypeOptions(),this._createTargetHLines(),this._isSmallChart()?this._drawSmall():this._drawLarge(),c?b.duration(1e3):b.duration(0),this._renderChart(),this},f._drawBackground=function(){var a=this._options;if(a.interactive){var b=e.select(a.parent).select(".cv-wrapper"),c=b.selectAll(".cv-bg").data([0]),d="none"===this._legend?null:this._legend.orientation();c.enter().insert("div",":first-child").classed("cv-bg",!0);var f=this._chart,g=e.select(a.parent).select(".cv-legend"),h="none"!==this._legend&&this._legend.isVertical()||g.empty()?0:1,i=1,j=f.padding(),k=f.facet().getPanel(f.facet()._panels.length-1).bounds(),l=f.plotBounds(),m=this._chart._legends&&this._chart._legends.hasOwnProperty("_w")?this._chart._legends._w:0,n="none"!==this._legend&&("left"===d||!d&&this._legend.isVertical())?m:0,o=l.top-h-j.top,p=f._calcWidth-n-("right"===d?m:0),q=k.top+k.height-l.top+h+j.top;if(c.style("top",o+"px").style("left",n+"px").style("height",q+i+"px").style("width",p+"px"),"none"!==this._legend&&this._legend.isVertical()){var r=1,s=e.select(a.parent).selectAll(".cv-legend"),t=!g.empty()&&s.node().offsetHeight||0,u=t>=q-r;s.style("height",u?q-r+"px":null).classed("clipped",u)}}},f._drawClipping=function(){var a=this._chart,b=this._options,c=a._svgContainer,d=c.selectAll("defs").data([0]);d.enter().insert("defs",":first-child");var e="cv-clip"+this.clipIdCounter.count++,f=d.selectAll(".cv-clip").data([0]);f.enter().append("clipPath").classed("cv-clip",!0).append("rect"),f.attr("id",e);var g=f.selectAll("rect"),h=a.padding(),i=a.facet().getPanel(a.facet()._panels.length-1).bounds(),j=a.plotBounds(),k=j.left-h.left,l=j.top,m=j.right-k+h.right,n=i.top+i.height-j.top+1;b.interactive&&(m-=1,n-=1),this._adjustClipHeight&&(n+=this._adjustClipHeight),this._adjustClipWidth&&(m+=this._adjustClipWidth),g.attr("x",k).attr("y",l).attr("width",Math.max(m,0)).attr("height",Math.max(n,0)),c.selectAll(".geom").attr("clip-path",null),c.selectAll(".geom:not(.no-clip)").attr("clip-path","url(#"+e+")")},f._renderChart=function(){var a=this,b=this._options;"function"==typeof b.preRender&&b.preRender(this.getChart()),this._chart.render(),this._drawBackground(),this._drawClipping(),setTimeout(function(){a._updatePathStates()},10)},f._onAutoResize=function(){this._draw(!1)},f._setChartTypeOptions=function(){},f._drawSmall=function(a){},f._drawLarge=function(a){},f._isSmallChart=function(){return Object.getPrototypeOf(f)._isSmallChart.apply(this,[this._getChartWidth()])},f._getChartWidth=function(){var a=this._options,b=e.select(a.parent),c=b.select(".cv-wrapper");if(c.empty()&&(c=b),null!==a.plotWidth&&!d.util.isPercentString(a.plotWidth))return a.plotWidth;if(null!==a.width&&!d.util.isPercentString(a.width))return a.width;var f=c.node().offsetWidth,g=c.node().offsetHeight;return null!==a.plotWidth?parseInt(a.plotWidth,10)/100*f:null!==a.width?parseInt(a.width,10)/100*f:null!==a.aspectRatio&&null!==g?g*a.aspectRatio:f},f._getChartHeight=function(){var a=this._options;if(null!==a.plotHeight&&!d.util.isPercentString(a.plotHeight))return a.plotWidth;if(null!==a.height&&!d.util.isPercentString(a.height))return a.height;var b=e.select(a.parent).node().offsetWidth,c=e.select(a.parent).node().offsetHeight;return null!==a.plotHeight?parseInt(a.plotHeight,10)/100*c:null!==a.height?parseInt(a.height,10)/100*c:null!==a.aspectRatio&&null!==b?b/a.aspectRatio:c},f._constructScale=function(a,b){var c=this._options,e=b;if(!e){var f=c.scales&&c.scales[a];f&&"default"!==f||(f="linear"),e=d.scale[f]()}return c.interactive&&(e=this._adjustLimits(e)),"y"===a&&this._dataAdapter._forceZero&&this._applyForceZero(e),e},f._applyForceZero=function(a){var b=this._options,c=b.scales&&"log"===b.scales.y,d=c?1:0,e=c?-1:0;return a.lowerLimit(function(a,b){return d>a?a:d}),a.upperLimit(function(a,b){return b>e?b:e}),a},f._adjustLimits=function(a){var b=this;this._options;return a.includeInDomain(function(a,c){return b._valuesAreFilterable()?b._seriesState.isSeriesEnabled(a.data[b._legend.mapping()],"standard"):!0}),a},f._valuesAreFilterable=function(){return this._options.interactive&&this._seriesState.areSomeSeriesDisabled()&&!this._seriesState.areAllSeriesDisabled()},f._getEnabledValues=function(a){var b=this,c=(this._options,this._dataAdapter.data()[this._getPropMapping(a)]);if(!this._valuesAreFilterable())return c;var d=this._dataAdapter.data()[this._legend.mapping()];return c=c.filter(function(a,c){return d[c]&&b._seriesState.isSeriesEnabled(d[c],"standard")})},f._updatePathStates=function(){var a=this,b=this._options,c=e.select(b.parent);c.selectAll(".plot .series [legend-group]").classed("path-inactive",function(){if(!b.interactive)return!1;var c=e.select(this),f=c.datum(),g=d.util.isArray(f)?f[0].data:f.data,h=g[a._getPropMapping("series")];return a._seriesState.doesSeriesStateExist(h,"standard")?!a._seriesState.isSeriesEnabled(h,"standard"):c.classed("path-inactive")}),b.targetValues&&c.selectAll(".plot .series [legend-type]").classed("path-inactive",function(){if(!b.interactive)return!1;var c=e.select(this),d=c.attr("legend-type");return a._seriesState.doesSeriesStateExist("target",d)?!a._seriesState.isSeriesEnabled("target",d):c.classed("path-inactive")})},f._buildLegend=function(a,b){var c=null,d=this._options,f=e.select(d.parent).select(".cv-wrapper"),g=this._getPropMapping(a||"series"),h=this._getPropMapping(b||"seriesLabel");if(g&&h&&g!==h){var i=this._dataAdapter.data(),j=i[g],k=i[h]||j;c=[],j.forEach(function(a,b,d){d.indexOf(a)===b&&c.push(k[b])})}return d.legendVisible?d.interactive?this._buildInteractiveLegend(c):this._buildStandardLegend(c):(f.selectAll(".cv-legend").remove(),f.selectAll(".cv-bg").remove(),"none")},f._buildStandardLegend=function(a){var b=this._options,c=e.select(b.parent).select(".cv-wrapper");this._legend=null,c.selectAll(".cv-legend").remove(),c.selectAll(".cv-bg").remove();var f,g=this.LEGEND_ORIENTATIONS.indexOf(b.legendOrientation)>-1?b.legendOrientation:"top";switch(this._calculatedLegendOrientation){case"top":case"bottom":f={top:5,bottom:5,left:0,right:0};break;case"left":case"right":f={top:0,bottom:0,left:5,right:5}}var h=d.guide.legend().orientation(g).padding(f);return a&&h.labels(a),this._isSmallChart()&&h.hGap(10).vGap(2),h},f._buildInteractiveLegend=function(a){var c=this._options,d=e.select(c.parent).select(".cv-wrapper");this._legend||(this._legend=b.interactiveLegend());var f=this._dataAdapter.data()[this._getPropMapping("series")],g=f.some(function(a,b,c){return a!==c[b-1]});return g?(this._legend.parent(d.node()).orientation(c.legendOrientation).chartWidth(this._getChartWidth()).chartHeight(this._getChartHeight()).chartPadding(this._chart.padding()).validOrientations(this.LEGEND_ORIENTATIONS).legendVerticalWidth(c.legendVerticalWidth).type(this._type).seriesState(this._seriesState),a&&this._getCategoryTotal&&this._legend.totals(a.map(function(a){return this._getCategoryTotal(a)})),this._legend):(this._legend.remove(),d.selectAll(".path-inactive").classed("path-inactive",!1),"none")},f._numXTicks=function(){return function(a){return Math.max(a/120,2)}},f._yTitleFormat=function(a,b){var c,e,f=this._dataAdapter,g=f.yAxisTitle(),h=f.l10n,i=this._getYFormatType(a);return"time"===i&&(b||(b=this._getEnabledValues("y")),c=this._yTimeGranularity(b,d.guide.axis().ticks()()),c=h.time.plural[c.gran],e=g?h.labels.dvcore.yAxisTimeWithTitle:h.labels.dvcore.yAxisTimeNoTitle,g=e.replace(/\{time\}/i,c).replace(/\{title\}/i,g)),g},f._formatYValue=function(a,b,c,d){return c&&c.divisor>0&&(a/=c.divisor),this._formatNumber(b,a,d)},f._getYFormatType=function(a){var b=this._dataAdapter.formats().y;return b?d.util.isArray(b)?b[a]?b[a]:"decimal":b:"decimal"},f._tickSize=function(a){var b,c=this._options,d=c.dualYAxis&&"y"===a;return function(e){return b=c.scales&&"log"===c.scales[a]&&Math.round(Math.log(Math.abs(e))/Math.LN10*1e6)/1e6%1?10:null,b?b:d?15:null}},f._yLabelFormat=function(a){var b=this._getYFormatType(a),c=this._dataAdapter,d=this._options,e=this;return function(a,f){var g,h,i=c.l10n.time;return"time"===b&&(h=c.getTimeGranularity(a,!0),i=1!==+a?i.plural:i.singular),g=e._formatYValue(a,b,h,d.precision),h&&h.gran&&(g+=" "+i[h.gran]),g}},f._yTickFormat=function(a,b,c){var f,g,h,i,j=this,k=this._getYFormatType(a),l=this._options,m=l.scales&&"log"===l.scales.y,n=m?1:0;return"time"===k&&(b||(b=this._getEnabledValues("y")),i=j._yTimeGranularity(b,d.guide.axis().ticks()())),function(b,d,o){var p,q=e.select(this),r=o.yOuterScale().innerScaleGroup()[a],s=!1;if(0===d&&(g=!1),r||(r=o.getTrainedScale("y")),h=r.domain()[0],p=r.range()[0]-r.mapValue(b),m&&!f){var t=e.scale.log().domain(r.domain());f=t.ticks().map(t.tickFormat(5,function(a){return j._formatYValue(a,k,i,l.precision)}))}return 10>p&&(s=!0),m&&""===f[d]&&(s=!0),h>n&&!s&&!g&&l.interactive?(q.classed("arrow-container",!0),g=!0):q.classed("arrow-container",!1),s&&!c&&l.interactive?"":m?f[d]:j._formatYValue(b,k,i,l.precision)}},f._yTimeGranularity=function(a,b){if(a=a&&a.filter(function(a){return isFinite(a)})||[],b=b||1,!a.length)return null;var c=Math.max.apply(null,a),d=Math.min.apply(null,a),f=e.scale.linear().domain([d,c]).ticks(b),g=f.length?f.length>1?f[1]-f[0]:c-f[0]:c,h=f.length?g/f.length:g;return this._dataAdapter.getTimeGranularity(h)},f._xTickAnchor=function(a){return function(b,c,e){var f=a.getTrainedScale("x"),g=d.util.scaleRange(f),h=20,i=f.mapValue(b)+f.rangeBand()/2;return i-g[0]<h?"start":g[1]-i<h?"end":"middle"}},f._checkNormalized=function(){var a=this._chart,b=this._dataAdapter.l10n;this._isNormalized&&this._isNormalized()&&(a.guide("y","none",1),a.guide("y",d.guide.axis().ticks(0).tickFormat(function(a,b){return""}).title(b.labels.core.normalized)),a.padding({}))},f._formatTime=function(a,b,c){for(var d=this._dataAdapter.l10n.calendar,f={a:function(a){return d.weekdayAbbreviations[a.getDay()]},A:function(a){return d.weekdays[a.getDay()]},b:function(a){return d.monthAbbreviations[a.getMonth()]},B:function(a){return d.months[a.getMonth()]},p:function(a){return d.ampm[Math.floor(a.getHours()/12)]}},g="",h=-1,i=0,j=b.length,k=function(){var c=b.substring(i,h);c.length&&(g+=e.time.format(c)(a))};++h<j;)if(37==b.charCodeAt(h)){var l=b.charAt(h+1),m=f[l];m&&(k(),g+=m(a),h++,i=h+1)}return k(),"hour"===c&&0===g.indexOf("0")&&(g=g.slice(1)),g},f._timeGranTemplate=function(a,b){var c;switch(a){case"hour":c=b.hour;break;case"day":c=b.day;break;case"week":c=b.week;break;case"month":c=b.month;break;case"quarter":c=b.quarter;break;case"year":c=b.year;break;default:c=b.fallback}return c},f._timeSmallXFormat=function(){var a=this,b=a._dataAdapter,c=b.l10n.dateFormat.fullFormat;return function(b,d){return a._formatTime(b,c.condensed)}},f._timeXTickFormat=function(a){var b=this,c=(b._options,this._chart,b._dataAdapter),d=new Date(0),e="",f="",g=c.l10n.dateFormat,h=g.mediumFormat,i=c?c.dateGranularity():"*",j=this._timeGranTemplate(i,g.shortFormat);return function(c,g){var k,l,m,n;return c=new Date(c),0===g&&(d=new Date(0),e=null,f=null),a&&!a.call(this,c,g)?"":("hour"===i&&d.getDate()!==c.getDate()&&(k=h.day),"day"!==i&&"week"!==i||d.getMonth()===c.getMonth()||(k=h.month),"month"!==i&&"quarter"!==i||d.getYear()===c.getYear()||(k=h.year),d=c,l=b._formatTime(c,j,i),m=k?"<br/>"+b._formatTime(c,k):"<br/>&nbsp;",n=l!==e||m!==f&&k?m?l+m:l:"",e=l,f=m,n)}},a.cloudViz.dvcore=f}(this),function(a){"use strict";var b,c=[],d=function(a,b){var c=-1;return function(){c>-1&&window.clearTimeout(c),c=window.setTimeout(a,b)}},e=d(function(){c.forEach(function(a){a()})},30),f=function(a){-1==c.indexOf(a)&&c.push(a),b||(window.addEventListener("resize",e),b=!0)},g=function(a){var d=c.indexOf(a);d>-1&&c.splice(d,1),0===c.length&&b&&(window.removeEventListener("resize",e),b=!1)};a.cloudViz.windowResize={addHandler:f,removeHandler:g}}(this),function(a){"use strict";var b=a.cloudViz||{},c=b.dvcore||{},d=a.dv||{},e=a.d3||{},f=Object.create(c);f.init=function(a){return Object.getPrototypeOf(f).init.apply(this,arguments),this._type="line",this._chart=d.chart(),this._displayPoints=null,this._adjustClipHeight=6,this._adjustClipWidth=6,this._minTrendTickSpace=135,this._showRibbons=!1,this._uniqueGroups=null,this},f._initDefaultOptions=function(){var a={normalized:!1,filled:!1,position:"identity",forceZero:null,dualYAxis:!1,showAnomalies:!1,mappings:{upperRangeBand:"upper",lowerRangeBand:"lower",forecast:"forecast"},formats:{x:"decimal",y:"decimal"},scales:{x:"default",y:"default"}};return Object.getPrototypeOf(f)._initDefaultOptions.call(this,a)},f.reset=function(){Object.getPrototypeOf(f).reset.apply(this,arguments);var a=this._options,b=e.select(a.parent);b.selectAll(".behavior").text(""),b.selectAll(".behavior-under-geom").text(""),this._chart.on("mousemove.inspector",null),this._chart.on("mouseout.inspector",null),b.selectAll(".axis-y.axis-index-1").remove()},f._setChartTypeOptions=function(){var a=this._chart,b=this._options,c=this,f=[d.geom.line().each("start",function(a,b){e.select(this).attr("legend-group",a[0].stroke)}).map("stroke",this._getPropMapping("series"),d.scale.color().values(b.colors))];this._uniqueGroups=d.util.uniq(a.data()[this._getPropMapping("series")]),this._showRibbons=1==this._uniqueGroups.length&&this._isMappedAndExistsInData("upperRangeBand")&&this._isMappedAndExistsInData("lowerRangeBand"),this._showRibbons&&(f.unshift(d.geom.ribbon().map("yMin",this._getPropMapping("lowerRangeBand")).map("yMax",this._getPropMapping("upperRangeBand")).set("alpha",.15).interpolate("cardinal")),b.filled=!1),this._showRibbons&&this._isMappedAndExistsInData("forecast")&&f.push(d.geom.line().map("y",this._getPropMapping("forecast")).set("alpha",.5).set("linetype","dotted").interpolate("cardinal")),b.filled&&f.push(d.geom.area().baseline(void 0).each("start",function(a,b){e.select(this).attr("legend-group",a[0].fill)}).map("fill",this._getPropMapping("series"),d.scale.color().values(b.colors)).set("alpha",.2));var g=d.geom.point().map("stroke",this._getPropMapping("series"),d.scale.color().values(b.colors)).set("fill","#fff").set("size",7);f.push(g);var h=this._getPropMapping("group")||this._getPropMapping("series");a.layers(f).guide("stroke",this._legend).map("group",h).set("linetype",function(a,b,c){return/::incomplete::$/.test(a.data[h])?"0,4,7,0":"solid"}).position(b.position),g.each("start",function(a,b){e.select(this).classed("point-hidden",!c._shouldDisplayPoint.call(c,a)).attr("legend-group",a.stroke).classed("line-point",!0)}),this._addBehaviors(a,b),this._mapPositionScales(a,b)},f._shouldDisplayPoint=function(a){return this._showRibbons?this._isAnomalousDataPoint(a):this._shouldDisplayPoints()},f._shouldDisplayPoints=function(){if(null!==this._displayPoints)return this._displayPoints;var a=this._options,b=this._chart,c=b.layers()[1]._nestData,d=Math.max.apply(null,c.map(function(a){return a.values.length})),e=b.getTrainedScale("x").range();return this._displayPoints=a.showAnomalies&&this._showRibbons||(e[1]-e[0])/d>=60},f._isAnomalousDataPoint=function(a){return a.data[this._getPropMapping("y")]>a.data[this._getPropMapping("upperRangeBand")]||a.data[this._getPropMapping("y")]<a.data[this._getPropMapping("lowerRangeBand")]},f._addBehaviors=function(a,b){var c=this,f=e.select(b.parent),g=this._dataAdapter,h=g.formats().x;b.interactive&&a.behaviors([d.behavior.inspector().gutterPadding(0).orientation("bottom").thickness(2).label(function(a){if(g.isOvertime()){var d=g.dateGranularity(),e=g.l10n.dateFormat.fullFormat;return c._formatTime(a,c._timeGranTemplate(d,e),d)}return c._formatNumber(h,a,b.precision)}).inspectorMove(function(b,d,g,h){var i=a.getTrainedScale("stroke")[0];c._highlightHoveredPoints.call(c,f,h,i),f.selectAll(".axis-x .axis-label").style("opacity",0),f.selectAll(".axis-x-title").style("opacity",0),f.selectAll(".text-geom").style("opacity",0),c._eventMap.mouseover&&c._eventMap.mouseover.call(this,b,d,g,h,e.event)}).inspectorOut(function(){var b=a.getTrainedScale("stroke")[0];c._highlightHoveredPoints.call(c,f,null,b),f.selectAll(".axis-x .axis-label").style("opacity",1),f.selectAll(".axis-x-title").style("opacity",1),f.selectAll(".text-geom").style("opacity",1),c._eventMap.mouseout&&c._eventMap.mouseout.call(this,e.event)}).underGeoms(!0)])},f._highlightHoveredPoints=function(a,b,c){var f={},g=this,h=c.domain(),i=this._options;a.selectAll(".line-point").each(function(a){var d=e.select(this),i=c.mapValue(a.stroke),j=g._dataValuesEqual.call(g,a.x,b),k=d.datum();if(d.classed("point-hidden",j?!1:!g._shouldDisplayPoint.call(g,a)),d.style("fill",j?i:"#FFF").style("opacity",j?1:""),j){var l=d.datum().data[g._getPropMapping("series")];f[l]={yVal:k.y,scaleIndex:h.indexOf(a.stroke)}}}),a.selectAll(".cv-legend-entry").each(function(a){var b=a.id,c=f[b],h=e.select(this).select(".cv-legend-num");if(!c)return h.text("");var j,k=g._getYFormatType(c.scaleIndex),l=c.yVal;if("time"===k){var m=g._dataAdapter.l10n,n=g._yTimeGranularity(g._dataAdapter.getUniqueStrokeExtentByStroke(b),d.guide.axis().ticks()()),o=m.time.plural[n.gran],p=m.labels.dvcore.legendTime;n&&n.divisor>0&&(l/=n.divisor),j=p.replace(/\{time\}/i,o).replace(/\{value\}/i,g._formatNumber(k,l,i.precision))}else j=g._formatNumber(k,l,i.precision);h.text(j)})},f._dataValuesEqual=function(a,b){return a&&b?this._dataAdapter.isOvertime()&&a.getTime()===b.getTime()?!0:a===b:!1},f._mapPositionScales=function(a,b){var c=[0,this._isSmallChart()?24:6],e=this._constructScale("y").rangePadding(c),f=this._getPropMapping("series"),g=this._getPropMapping("y"),h=this._getPropMapping("x"),i=this;if(null===i._dataAdapter._forceZero&&b.filled&&(i._dataAdapter._forceZero=!0,this._applyForceZero(e)),b.normalized||b.dualYAxis&&("identity"===b.position||"dodge"===b.position)){var j=i._dataAdapter.uniqueStrokeValues();j.forEach(function(b,c){var d=0===c?e:e.copy();d.includeInDomain(function(a,b){return a.data[f]===i._dataAdapter.uniqueStrokeValues()[c]}),c>0&&a.map("y",g,d,c)})}else{var k=a.getExplicitScalesMap().y;k&&delete k[1]}var l=this._dataAdapter.isOvertime()?d.scale.time():"log"===b.scales.x?d.scale.log():d.scale.linear();l.rangePadding([10,10]),a.map("y",g,e,0),a.map("x",h,this._constructScale("x",l))},f._xTickFormat=function(){var a=this,b=this._dataAdapter,c=this._options,d=b.formats().x;return function(b,e){return a._formatNumber(d,b,c.precision)}},f._drawSmall=function(){var a,b,c=this._options,f=this._chart,g=this,h=this._computeExtents(),i=e.extent(this._getEnabledValues("x")),j=this._getYFormatType(0),k=d.guide.axis().tickSize(0).title(this._dataAdapter.xAxisTitle()).tickDy(h.y.length>1?-26:-14).tickAnchor(function(a,b){return b>0?"end":"start"}),l=d.guide.axis().ticks(2).title(this._dataAdapter.yAxisTitle()),m=c.dualYAxis||"stack"===c.position&&this._uniqueGroups.length>1;if(a=this._dataAdapter.isOvertime()?d.scale.time():"log"===c.scales.x?d.scale.log():d.scale.linear(),b="log"===c.scales.y?d.scale.log():d.scale.linear(),!m){var n=[d.geom.point().data(h).set("stroke","none").map("y","y",b).map("x","x",a).each("start",function(a,b){var c=a.panel.getTrainedScale("fill")[0],d=e.select(this);d.style("fill",c.mapValue(a.data.fill)).attr("legend-group",a.data.fill)}).map("group","fill").set("size",6),d.geom.text().data(h).set("stroke","none").map("y","y",b).map("x","x",a).each("start",function(a,b){var c=a.panel.getTrainedScale("fill")[0],d=e.select(this);d.style("fill",c.mapValue(a.data.fill)).attr("legend-group",a.data.fill),this.parentNode&&e.select(this.parentNode.parentNode).classed("no-clip",!0).attr("clip-path",null)}).map("group","fill").set("size","11px").set("label",function(a,b){var c=a.panel.getTrainedScale("fill")[0].domain(),e=c.indexOf(a.data.fill),f=g._yTickFormat(e,null,!0)(a.y,b,a.panel);if("time"===j){var h=g._yTimeGranularity(g._getEnabledValues("y"),d.guide.axis().ticks()());f+=" "+g._dataAdapter.l10n.time.plural[h.gran]}return f}).textAnchor(function(a,b){return a.data&&a.data.anchor||"middle"}).dy(function(a,b){return 1===h.y.length||a.y===h.y[1]?-8:15}).dx(function(a,b){return a.data&&"end"==a.data.anchor?3:0})];f.layers(f.layers().concat(n))}if(f.map("fill",this._getPropMapping("series"),d.scale.color().values(c.colors)),this._dataAdapter.isOvertime())k.tickValues(i).tickFormat(g._timeSmallXFormat()),m?l.tickFormat(this._yTickFormat(0)):l.tickFormat(function(){return""});else if(c.dualYAxis){var o=d.guide.axis().tickFormat(this._yTickFormat(1)).orientation("right").tickSize(this._tickSize("y")).tickDy(-8).tickAnchor("end").tickDx(4).ticks(3);l.tickSize(this._tickSize("y")).tickDy(-8).tickAnchor("start").tickDx(4).ticks(3),f.guide("y",o,1)}else{var p=e.extent(this._dataAdapter.data()[this._getPropMapping("x")]);k.tickValues(p).tickFormat(this._xTickFormat()),l.tickFormat(this._yTickFormat(0)),f.guide("y","none",1)}f.guide("x",k).guide("y",l),this._checkNormalized()},f._numXTicks=function(){var a=this;if(this._dataAdapter.isOvertime()){var b=this._chart._data[this._getPropMapping("x")].length;return function(c){var d=Math.max(c/b,a._minTrendTickSpace);return Math.max(Math.min(Math.floor(c/d),b),2)}}return Object.getPrototypeOf(f)._numXTicks.call(this)},f._drawLarge=function(){var a,b=this._options,c=this._chart,f=(e.select(b.parent),this._dataAdapter.getUniqueStrokeExtent(0)),g=this._dataAdapter.getUniqueStrokeExtent(1),h=d.guide.axis().ticks(this._numXTicks()).title(this._dataAdapter.xAxisTitle()).tickSize(this._tickSize("x")).tickDy(-8).tickAnchor(this._xTickAnchor(c)),i=d.guide.axis().htmlLabels(!0);if(this._dataAdapter.isOvertime()?h.tickFormat(this._timeXTickFormat()).htmlLabels(!0):h.tickFormat(this._xTickFormat()),!b.dualYAxis||"identity"!==b.position&&"dodge"!==b.position)a=this._yTickFormat(0),i.title(this._yTitleFormat(0)),i.tickSize(this._tickSize("y")),c.guide("y","none",1);else{a=this._yTickFormat(0,f),i.title(this._yTitleFormat(0,f));var j=d.guide.axis().tickFormat(this._yTickFormat(1,g)).title(this._yTitleFormat(1,g)).orientation("right").tickSize(this._tickSize("y"));i.tickSize(this._tickSize("y")),c.guide("y",j,1)}i.tickFormat(a),c.guide("x",h).guide("y",i),this._checkNormalized()},f._preRender=function(){Object.getPrototypeOf(f)._preRender.call(this),this._displayPoints=null},f._computeExtents=function(){var a=-1,b=this._options,c=this._getEnabledValues("y"),d=this._getEnabledValues("x"),e=this._getEnabledValues("series"),f=c.length,g={x:[void 0,void 0],y:[void 0,void 0],fill:[void 0,void 0],anchor:[void 0,void 0]},h=null,i=null;for(d.forEach(function(a,b){h=null===h||h>a?a:h,i=null===i||a>i?a:i});++a<f;){var j=c[a],k=d[a],l=e?e[a]:b.colors[0];(void 0===g.y[0]||j<g.y[0])&&(g.y[0]=j,g.x[0]=k,g.fill[0]=l,g.anchor[0]=+k==+h?"start":+k==+i?"end":"middle"),(void 0===g.y[1]||j>g.y[1])&&(g.y[1]=j,g.x[1]=k,g.fill[1]=l,g.anchor[1]=+k==+h?"start":+k==+i?"end":"middle")}return 0===g.y[0]&&(g.y.splice(0,1),g.x.splice(0,1),g.fill.splice(0,1),g.anchor.splice(0,1)),g},f._isNormalized=function(){var a=this._options,b=this._isSmallChart()?1:2;return a.normalized||a.dualYAxis&&this._dataAdapter.uniqueStrokeValues().length>b&&("identity"===a.position||"dodge"===a.position)},a.cloudViz.line=b.util.createConstructor(f)}(this),function(a){"use strict";var b=a.cloudViz||{},c=b.dvcore||{},d=a.dv||{},e=a.d3||{},f=Object.create(c);f.init=function(a){return Object.getPrototypeOf(f).init.apply(this,arguments),this._type="point",this._chart=d.chart(),this},f.getSelected=function(){var a=[],b=e.select(this._options.parent).selectAll(".point-geom.cv-highlight");return b.each(function(b){a.push(b)}),a},f.setSelected=function(a){var b=this,c=[],d=e.select(this._options.parent).selectAll(".point-geom").filter(a);return d.each(function(a){c.push(a)}),b._selectPoints(c),b},f._selectPoints=function(a,b){var c=this;return b&&b.accumulate?"add"===b.action?e.select(c._options.parent).selectAll(".point-geom").each(function(b){a.indexOf(b)>=0&&c._highlight(e.select(this),!0)}):"remove"===b.action&&e.select(c._options.parent).selectAll(".point-geom").each(function(b){a.indexOf(b)>=0&&c._highlight(e.select(this),!1)}):b&&0===a.length?"selectAll"===b.noneSelected&&c._highlight(e.select(c._options.parent).selectAll(".point-geom"),!0):e.select(c._options.parent).selectAll(".point-geom").each(function(b){a.indexOf(b)>=0?c._highlight(e.select(this),!0):c._highlight(e.select(this),!1)}),c},f._initDefaultOptions=function(){var a={mappings:{size:"size"},sizeTitle:"",formats:{x:"decimal",y:"decimal",size:"decimal"},scales:{x:"default",y:"default"},position:"identity",selectionEnabled:!1,selectPolicyCB:function(){return{start:null,end:null,move:null}},tooltipContent:null};return Object.getPrototypeOf(f)._initDefaultOptions.call(this,a)},f._setChartTypeOptions=function(){var a=this._chart,b=this._options,c=[];c[0]=d.geom.point().each("start",function(a,b){e.select(this).attr("legend-group",a.fill)}),a.layers(c).map("x",this._getPropMapping("x"),this._constructScale("x").rangePadding([this._isSmallChart()?10:20,this._isSmallChart()?10:20])).map("y",this._getPropMapping("y"),this._constructScale("y").rangePadding([this._isSmallChart()?10:20,this._isSmallChart()?10:20])).map("fill",this._getPropMapping("series"),d.scale.color().values(b.colors)).guide("fill",this._legend).padding({left:10}),this._dataAdapter.isBubble()?c[0].map("size",this._getPropMapping("size"),d.scale.linear().to([9,60])):c[0].set("size",10).set("alpha",.6),this._addBehaviors(a,c[0],b)},f._addBehaviors=function(a,b,c){var f,g=e.select(c.parent),h=this,i=this._getYFormatType(),j=function(a,b,c,d){return a.data.hasOwnProperty(b.mapping())?'<span class="metric-value">'+c(a.data[b.mapping()])+'</span><span class="metric-name">'+d+"</span>":""},k=function(a,b,d){var f=[];e.select(c.parent).selectAll(".point-geom").each(function(a,c){b[0][0]<=a.x&&b[1][0]>=a.x&&b[0][1]<=a.y&&b[1][1]>=a.y&&(h._seriesState.isSeriesEnabled(a.data.group,"standard")||h._seriesState.isSeriesEnabled(a.data[h._getPropMapping("series")],"standard"))&&f.push(a)});var g=h._options.selectPolicyCB.call();h._selectPoints(f,g[a]),h._eventMap.selectionStart&&"start"===a&&h._eventMap.selectionStart.call(h,f),h._eventMap.selectionEnd&&"end"===a&&h._eventMap.selectionEnd.call(h,f)};c.selectionEnabled?a.behaviors([d.behavior.brush().brushStart(k).brushMove(k).brushEnd(k)]):a.behaviors([]),!this._isSmallChart()&&c.interactive&&b.behaviors([d.behavior.voronoiRollover().pointDetectionRadius(25).content(function(a,b,d){if(c.tooltipContent)return c.tooltipContent.call(this,a,b,d);var e=this.__geom.getExplicitScale("group"),f=a.panel.xScale(a),g=a.panel.yScale(a),k=this._xGuides[f.scaleIndex()],l=(this._yGuides[g.scaleIndex()],h._dataAdapter.l10n),m=k.__scale&&k.tickFormat()?k.tickFormat():String,n=function(a){return h._formatNumber(i,a,c.precision)},o=j(a,g,n,h._dataAdapter.yAxisTitle()||l.labels.point.yScale)+j(a,f,m,h._dataAdapter.xAxisTitle()||l.labels.point.xScale);if(h._dataAdapter.isBubble()){var p=a.panel.getTrainedScale("size")[0];o+=j(a,p,String,h._dataAdapter.sizeMetricName()||l.labels.point.sizeScale)}return e&&e.mapping()&&(o='<span class="series-name">'+a.data[e.mapping()]+"</span>"+o),o}).mouseOver(function(a,b,c,d){clearTimeout(f),g.selectAll(".point-geom").classed("cv-medium-duration",!1).classed("cv-unselected",function(b){return a!==b}),g.selectAll(".cv-legend-marker").classed("cv-unselected",function(b){return b.id!==a.fill}).classed("cv-medium-duration",!1),h._eventMap.mouseover&&h._eventMap.mouseover.call(this,a,b,c,d)}).mouseOut(function(a,b,c,d){f=setTimeout(function(){g.selectAll(".point-geom, .cv-legend-marker").classed("cv-unselected",!1).classed("cv-medium-duration",!0),h._eventMap.mouseout&&h._eventMap.mouseout.call(this,a,b,c,d)},400)})])},f._drawSmall=function(){var a=this._chart,b=e.extent(this._getEnabledValues("x")),c=this,f=this._dataAdapter,g=this._options,h=f.formats().x;this._getYFormatType();a.guide("x",d.guide.axis().tickSize(0).tickValues(b).title(this._dataAdapter.xAxisTitle()).tickFormat(function(a){return c._formatNumber(h,a,g.precision)}).tickAnchor(function(a,b){return b>0?"end":"start"})).guide("y",d.guide.axis().ticks(2).title(this._dataAdapter.yAxisTitle()).tickFormat(this._yTickFormat(0)))},f._drawLarge=function(){var a=this._chart,b=function(a){return Math.max(2,Math.min(5,a/70))},c=this,e=this._dataAdapter,f=this._options,g=e.formats().x;this._getYFormatType();a.guide("x",d.guide.axis().ticks(this._numXTicks()).title(this._dataAdapter.xAxisTitle()).tickFormat(function(a){return c._formatNumber(g,a,f.precision)})).guide("y",d.guide.axis().ticks(b).tickSize(this._tickSize("y")).title(this._dataAdapter.yAxisTitle()).tickFormat(this._yTickFormat(0)))},f._postRender=function(){Object.getPrototypeOf(f)._postRender.call(this);var a=this._options,b=this._chart,c=5,d=e.select(a.parent).select(".cv-wrapper"),g=d.selectAll(".cv-bubble-size-metric").data([0]);this._dataAdapter.sizeMetricName()?(g.enter().append("div").classed("cv-bubble-size-metric",!0).html("<span>"+this._dataAdapter.sizeMetricName()+"</span>  <i></i> &ndash; <i></i>"),setTimeout(function(){var a,d,e=b.padding(),f=b.facet().getPanel(b.facet()._panels.length-1).bounds(),h=b.plotBounds(),i=(g.selectAll("span"),h.right+e.right),j=f.top+f.height,k=g.node();k&&(a=i-k.offsetWidth-c,d=j-k.offsetHeight,g.style("top",d+"px").style("left",a+"px"))},300)):g.remove()},a.cloudViz.point=b.util.createConstructor(f)}(this),function(a){"use strict";var b=a.cloudViz||{},c=b.dvcore||{},d=a.dv||{},e=a.d3||{},f=Object.create(c);f.init=function(a){return Object.getPrototypeOf(f).init.apply(this,arguments),this._type="bar",this._chart=d.chart(),this._minTickSpace=60,this},f._initDefaultOptions=function(){var a={normalized:!1,position:"dodge",dualYAxis:!1,clickHandler:null,formats:{x:"decimal",y:"decimal"},tooltipContent:null};return Object.getPrototypeOf(f)._initDefaultOptions.call(this,a)},f.reset=function(){Object.getPrototypeOf(f).reset.apply(this,arguments);var a=this._options,b=e.select(a.parent);b.selectAll(".axis-y.axis-index-1").remove()},f._setChartTypeOptions=function(){var a=this._chart,b=this._options;a.layers([d.geom.bar().each("start",function(a,b){e.select(this).attr("legend-group",a.fill)})]).map("fill",this._getPropMapping("series"),d.scale.color().values(b.colors)).guide("fill",this._legend).position(b.position).coord(d.coord.cartesian().flip(b.flip)),a._layers[0].on("click",this._eventMap.click?this._eventMap.click:null),this._addBehaviors(a.layers()[0],b),
this._mapPositionScales(a,b)},f._mapPositionScales=function(a,b){var c=this._isSmallChart(),e=[0,c?10:15],f=this._applyForceZero(this._constructScale("y")).rangePadding(e),g=this._getPropMapping("series"),h=this._getPropMapping("y"),i=(this._getPropMapping("x"),c?Math.max(.3,Math.min(.6,this._getChartWidth()/this._dataAdapter.uniqueXValues().length/200)):Math.min(.6,Math.max(.05,this._getChartWidth()/4e3))),j=c?.3:.5,k=this;if(this._dataAdapter.isOvertime()&&(i=.05),b.normalized||b.dualYAxis&&("identity"===this._options.position||"dodge"===this._options.position)){var l=k._dataAdapter.uniqueFillValues();l.forEach(function(b,c){var d=0===c?f:f.copy();d.includeInDomain(function(a,b){return a.data[g]===k._dataAdapter.uniqueFillValues()[c]}),c>0&&a.map("y",h,d,c)})}else{var m=a.getExplicitScalesMap().y;m&&delete m[1]}a.map("y",h,f,0),a.map("x",this._getPropMapping("x"),d.scale.ordinal().padding(i).outerPadding(j).reverse(b.flip))},f._addBehaviors=function(a,b){var c,f=e.select(b.parent),g=this._dataAdapter,h=this;!this._isSmallChart()&&b.interactive&&a.behaviors([d.behavior.rollover().orientation(b.flip?"top":"right").content(function(a,c,d){if(b.tooltipContent)return b.tooltipContent.call(this,a,c,d);var e=this.__geom.getExplicitScale("group"),f=a.panel.yScale(a),i=h._yLabelFormat(f.scaleIndex()),j='<span class="metric-value">'+i(a.y)+'</span><span class="metric-name">'+a.data[h._getPropMapping("seriesLabel")]+"</span>",k=g.dateGranularity(),l=g.l10n.dateFormat.fullFormat,m=g.isOvertime()?h._formatTime(new Date(a.x),h._timeGranTemplate(k,l),k):a.x;return e&&e.mapping()&&(j='<span class="series-name">'+m+"</span>"+j),j}).showTooltip(function(a,b,d,g,i){var j=e.select(this);j.classed("path-inactive")||(i._showTip.call(this,a,b,d,i),clearTimeout(c),f.selectAll(".bar-geom").classed("cv-medium-duration",!1).classed("cv-unselected",function(b){return a!==b}),f.selectAll(".cv-legend-marker").classed("cv-unselected",function(b){return b.id!==a.fill}).classed("cv-medium-duration",!1),h._eventMap.mouseover&&h._eventMap.mouseover.call(this,a,b,d,g))}).hideTooltip(function(a,b,d,g,i){var j=e.select(this);j.classed("path-inactive")||(i._removeTip.call(this,a,b,d,i),c=setTimeout(function(){f.selectAll(".bar-geom, .cv-legend-marker").classed("cv-unselected",!1).classed("cv-medium-duration",!0),h._eventMap.mouseout&&h._eventMap.mouseout.call(this,a,b,d,g)},400))})])},f._drawSmall=function(){var a,b=this._chart,c=this._options,f=c.flip?void 0:10,g=this;a=c.flip?d.guide.axis().tickDx(function(a,b){return e.select(this).select("span").node().offsetWidth}).tickDy(function(a,b){return-e.select(this).select("span").node().offsetHeight}).tickSize(0):d.guide.axis().tickSize(0).tickDy(function(a,b){return b%2===0?-8:-26}),this._dataAdapter.isOvertime()?a.tickValues(e.extent(this._dataAdapter.data()[this._getPropMapping("x")])).tickFormat(g._timeSmallXFormat()).tickAnchor(function(a,b){return b>0?"end":"start"}).tickDx(function(a,c){var d=b.getTrainedScale("x").rangeBand()/2;return c>0?d:-d}).tickDy(-8):a.tickFormat(function(a,b){return g._truncateLabel(a,f)}),b.guide("x",a.title(this._dataAdapter.xAxisTitle())).guide("y",d.guide.axis().ticks(0).tickSize(0).tickFormat(function(a,b){return""}).title(this._dataAdapter.yAxisTitle())),this._checkNormalized()},f._drawLarge=function(){var a,b=this._chart,c=this._options,e=this,f=function(a){return Math.max(2,Math.min(5,a/75))},g=d.guide.axis().tickSize(0),h=d.guide.axis().ticks(f);if(!c.dualYAxis||"identity"!==this._options.position&&"dodge"!==this._options.position)h.tickFormat(this._yTickFormat(0)).title(this._yTitleFormat(0)),b.guide("y","none",1);else{var i=e._dataAdapter.getUniqueFillExtent(0),j=e._dataAdapter.getUniqueFillExtent(1);h.tickSize(this._tickSize("y")).tickFormat(this._yTickFormat(0,i)).title(this._yTitleFormat(0,i)),a=d.guide.axis().ticks(f).tickFormat(this._yTickFormat(1,j)).title(this._yTitleFormat(1,j)).orientation("right").tickSize(this._tickSize("y")),b.guide("y",a,1)}if(c.flip?g.tickDx(-10):(g.tickDy(function(a,b){return b%2===0?-8:-26}),h.tickDx(-10),a&&a.tickDx(-10)),this._dataAdapter.isOvertime()){var k={},l=0;b._data[this._getPropMapping("x")].forEach(function(a,b){k[+new Date(a)]||(l++,k[+new Date(a)]=1)}),g.tickDy(-8).tickFormat(this._timeXTickFormat(l)).htmlLabels(!0)}else g.tickFormat(function(a,b){return e._truncateLabel(a)});b.guide("x",g.title(this._dataAdapter.xAxisTitle())).guide("y",h),this._checkNormalized()},f._timeXTickValidator=function(a){var b=this;return function(c,e){var f=b._chart.getTrainedScale("x"),g=d.util.scaleRange(f),h=g[1]-g[0],i=Math.ceil(b._minTickSpace/(h/a));return e%i===0}},f._timeXTickFormat=function(a){return Object.getPrototypeOf(f)._timeXTickFormat.call(this,this._timeXTickValidator(a))},f._isNormalized=function(){var a=this._options,b=this._isSmallChart()?1:2;return a.normalized||a.dualYAxis&&this._dataAdapter.uniqueFillValues().length>b&&("identity"===a.position||"dodge"===a.position)},a.cloudViz.bar=b.util.createConstructor(f)}(this),function(a){"use strict";var b=a.cloudViz||{},c=b.dvcore||{},d=a.dv||{},e=a.d3||{},f=Object.create(c);f.init=function(a){return Object.getPrototypeOf(f).init.apply(this,arguments),this._type="donut",this._chart=d.chart(),this},f._initDefaultOptions=function(){var a={maxSlices:6,innerRadius:"45%",outerRadius:"35%",clickHandler:null,formats:{x:"decimal",y:"decimal"},tooltipContent:null};return Object.getPrototypeOf(f)._initDefaultOptions.call(this,a)},f._buildLegend=function(){var a=this,b=this._options,c=Object.getPrototypeOf(f)._buildLegend.call(this,"x","x");if(this._dataAdapter.processLabelData(c),"none"!==c){if(1==this._dataAdapter.numberOfFacets()){var d=this._dataAdapter.labelData().cvtextvallabel.map(function(b,c){return a._yLabelFormat(0)(b)});c.values(d)}b.interactive||b.legendOrientation&&"top"!==b.legendOrientation||c.padding({bottom:20})}return c},f._getSeriesTotal=function(a){var b,c=this._dataAdapter,d=c.data(),e=d[this._getPropMapping("y")],f=d[this._getPropMapping("series")],g=f.length,h=0;for(b=0;g>b;++b)f[b]+""==a+""&&(h+=e[b]);return h},f._createSeriesStates=function(){var a=this._options;if("data"in this._changedOptions&&this._changedOptions.data){this._seriesState.removeStatesByType("standard");for(var b=d.util.uniq(this._dataAdapter.data()[this._getPropMapping("x")]),c=b.length;c--;){var e=b[c];this._seriesState.insertState(e,e,"standard")}}"targetValues"in this._changedOptions&&a.targetValues&&(this._seriesState.removeStatesByType("target"),this._seriesState.appendState(a.targetLabel||this._dataAdapter.l10n.labels.dvcore.target,"target","target"))},f._getCategoryTotal=function(a){if(1!==this._dataAdapter.numberOfFacets())return"";var b,c=this._dataAdapter.data(),d=c[this._getPropMapping("y")],e=c[this._getPropMapping("x")],f=e.length,g=0;for(b=0;f>b;++b)e[b]+""==a+""&&(g+=d[b]);return g},f._shouldHideLabels=function(a){var b=a.panel.bounds();return a.y<=.05||Math.min(b.width,b.height)/2<80},f._setChartTypeOptions=function(){var a=this._chart,b=this._dataAdapter,c=this._options,f=(e.select(c.parent),this),g=c.colors.slice(0);c.interactive&&a.padding({top:10}),b.showOtherCategory()&&g.splice(c.maxSlices-1,0,"#ccc");var h=[d.geom.bar().position("fill").set("stroke","#fff").each("start",function(a,b){e.select(this).attr("legend-group",a.fill)})];h[0].on("click",this._eventMap.click?this._eventMap.click:null);var i=f._dataAdapter.labelData();h.push(d.geom.text().data(i).map("label","cvtextperclabel").set("stroke","none").position("fill").textAnchor(function(a,b){var c=100*(a.y0+a.y/2);return 50>c?"start":c>50?"end":"middle"}).each("start",function(a,b){e.select(this).classed("slice-label",!0).classed("hidden",f._shouldHideLabels.call(f,a)).attr("dy",".35em").attr("legend-group",a.fill)}).set("alpha",function(a,b,c){return f._shouldHideLabels.call(f,a)?0:1}).dx(function(a,b){var e=a.panel.xOuterScale().range(),f=e[1]-e[0],g=f?f/2:0,h=d.util.getPercentValue(c.outerRadius,g),i=30;100*(a.y0+a.y/2);return g+h-i}).dy(function(a,b){var c=-a.panel._bounds.width/2*a.y,d=100*(a.y0+a.y/2);return 10>d&&(c-=(10-d)/2),d>90&&(c+=(10-(100-d))/2),50>=d&&d>40&&(c+=(10-(50-d))/2),d>50&&60>d&&(c-=(10-(d-50))/2),c})),a.layers(h).map("group","cvdonutorder").map("x",this._getPropMapping("series"),d.scale.ordinal()).map("y",this._getPropMapping("y"),this._constructScale("y")).map("fill",this._getPropMapping("x"),d.scale.color().values(g)).guide("fill",this._legend).guide(["x","y"],"none").coord(d.coord.polar().flip(!0).innerRadius(c.innerRadius).outerRadius(c.outerRadius)).postrender(function(){var a=e.select(c.parent).select(".cv-wrapper"),b=a.selectAll(".cv-donut-facet-labels").data([0]),g=f._dataAdapter;b.enter().append("div").classed("cv-donut-facet-labels",!0),b.exit().remove();var h=b.selectAll(".cv-donut-facet-label").data(this.facet()._panels);h.enter().append("div").classed("cv-donut-facet-label",!0);h.each(function(a,b){var h=a.bounds(),i=e.select(this),j=Math.min(h.width,h.height)/2,k=h.height/2-j,l=d.util.getPercentValue(c.innerRadius,j),m=25>l?"small":l>50?"large":"medium",n="large"===m?2*l:h.width,o="large"===m?h.left+h.width/2-n/2:h.left,p="large"===m?h.top+h.height/2-27:h.top+k-10;i.style("top",p+"px").style("width",n+"px").style("left",o+"px").classed("cv-donut-small-facet cv-donut-medium-facet cv-donut-large-facet",!1).classed("cv-donut-"+m+"-facet",!0);var q=i.selectAll(".cv-donut-label-number").data([0]);q.enter().append("div").classed("cv-donut-label-number",!0);var r=f._getSeriesTotal(a.xFacetTitle());q.text(f._yLabelFormat(a._facetIndex)(r));var s=i.selectAll(".cv-donut-label-title").data([0]);s.enter().append("div").classed("cv-donut-label-title",!0),s.text(g.yAxisTitle(a._facetIndex)),"medium"===m&&q.style("top",h.height/2-k+"px")}),h.exit().remove()}),this._addBehaviors(h[0],c)},f._addBehaviors=function(a,b){var c,f=e.select(b.parent),g=this._dataAdapter,h=this;!this._isSmallChart()&&b.interactive&&a.behaviors([d.behavior.rollover().content(function(a,c,e){if(b.tooltipContent)return b.tooltipContent.call(this,a,c,e);var f=this.__geom.getExplicitScale("group"),i=a.panel.yScale(a),j=h._yLabelFormat(i.scaleIndex()),k='<span class="metric-value">'+j(a.data[h._getPropMapping("y")])+'</span><span class="metric-name">'+a.data[h._getPropMapping("seriesLabel")]+"</span>",l=h._dataAdapter.dateGranularity(),m=g.l10n.dateFormat.fullFormat,n=d.util.isDate(a.fill)?h._formatTime(a.fill,h._timeGranTemplate(l,m),l):a.fill;return f&&f.mapping()&&(k='<span class="series-name">'+n+"</span>"+k),k}).showTooltip(function(a,b,d,g,i){var j=e.select(this);j.classed("path-inactive")||(i._showTip.call(this,a,b,d,i),clearTimeout(c),f.selectAll(".bar-geom").classed("cv-medium-duration",!1).classed("cv-unselected",function(b){return a!==b}),f.selectAll(".text-geom").classed("cv-medium-duration",!1).classed("cv-unselected",function(b){return a.group!==b.group}).classed("cv-selected",function(b){return a.group===b.group}),f.selectAll(".cv-legend-marker").classed("cv-unselected",function(b){return b.id!==a.fill}).classed("cv-medium-duration",!1),h._eventMap.mouseover&&h._eventMap.mouseover.call(this,a,b,d,g))}).hideTooltip(function(a,b,d,g,i){var j=e.select(this);j.classed("path-inactive")||(i._removeTip.call(this,a,b,d,i),c=setTimeout(function(){f.selectAll(".bar-geom, .cv-legend-marker").classed("cv-unselected",!1).classed("cv-medium-duration",!0),f.selectAll(".text-geom").classed("cv-unselected cv-selected",!1).classed("cv-medium-duration",!0),h._eventMap.mouseout&&h._eventMap.mouseout.call(this,a,b,d,g)},400))})])},f._drawSmall=function(){var a=this._chart;this._options;a.facet(d.facet.wrap().group(this._getPropMapping("series")).scales("free").numColumns(1).titleFormat(void 0))},f._drawLarge=function(){var a=this._chart;a.facet(d.facet.wrap().group(this._getPropMapping("series")).scales("free").numColumns(3).titleFormat(void 0))},a.cloudViz.donut=b.util.createConstructor(f)}(this),function(a){"use strict";a.cloudViz.interactiveLegend=function(){var b,c,d,e,f,g,h,i,j,k,l,m,n,o=10,p=110,q=110,r=["top","right","left"],s=!0,t={};return t._render=function(a,b,c){this._initSVG(b),this._sizeAndPositionLegendEntries(),this._positionLegend()},t._initSVG=function(e){m=d3.select(b).selectAll(".cv-legend").data([0]),m.enter().append("div").classed("cv-legend",!0),l=this._createLegendEntries(m,e),k=Math.floor(this._getLegendContainingWidth()/l.size()),r.indexOf(c)>-1?this._calculatedLegendOrientation=c:this._calculatedLegendOrientation="top";var f=a.cloudViz.core._isSmallChart(d);switch(p>k&&!f&&("top"==this._calculatedLegendOrientation||"bottom"==this._calculatedLegendOrientation)&&(this._calculatedLegendOrientation="left"),this._calculatedLegendOrientation){case"top":case"bottom":k=Math.max(k,p),m.style("height",null),g=!1;break;case"left":case"right":k=q,g=!0}r.forEach(dv.util.bind(function(a){m.classed(a,this._calculatedLegendOrientation===a)},this))},t._getAdjustedDimensions=function(a){m.node();switch(this._calculatedLegendOrientation){case"top":a.top+=this._getUsedHeight();break;case"right":a.width-=this._getUsedWidth();break;case"left":a.left+=this._getUsedWidth();break;case"bottom":a.height-=this._getUsedHeight()}return a},t._createLegendEntries=function(a,b){var c,d,e,f,g=j.getStateObjects();for(e in b)f=b[e][0],n=f._mapping;c=a.selectAll(".cv-legend-entry").data(g),d=c.enter().append("div").attr("class",function(a){return"cv-legend-entry cv-legend-"+a.type+"-entry"}),d.append("div").classed("cv-legend-title",!0);var k=d.append("div").classed("cv-legend-details",!0);return k.append("div").classed("cv-legend-marker",!0),k.append("div").classed("cv-legend-num",!0),c.exit().on("click",null).remove(),c.each(function(a,b){var c=d3.select(this);c.select(".cv-legend-title").text(a.name),c.select(".cv-legend-num").text(h&&h.length>b?h[b]:""),c.select(".cv-legend-marker").attr("class","cv-legend-marker "+i).style("background-color",function(a){var b=f.mapValue(a.id);return b?b:null})}),c.classed("inactive",function(a,b){return s&&!a.enabled}),c.on("click",function(a,b){s&&j.enableStateByIndex(b,!a.enabled)}),c},t._onSeriesEnableChange=function(a,b){s&&l.filter(function(a){return a.id===b.id&&a.type===b.type}).classed("inactive",!b.enabled)},t._positionLegend=function(){var a={top:0,left:0};switch(this._calculatedLegendOrientation){case"bottom":a.top=e-m.node().offsetHeight;break;case"right":a.left=d-q}m.style("top",a.top+"px").style("left",a.left+"px")},t._sizeAndPositionLegendEntries=function(){if(g)l.each(function(a,b,c){d3.select(this).style("width",k+"px").select(".cv-legend-title").style("height",null)});else{var a,b,c=0,d=!1,e=l[0].length,f=e*k,h=this._getLegendContainingWidth(),i=0;h>f&&f+e>h&&(i=h-f),m.style("width",f>h&&!g?h+"px":""),l.each(function(e,f,g){a=d3.select(this);var h=k;i>0&&(h+=1,i-=1),a.style("width",h+"px"),b=a.select(".cv-legend-title").style("height",null).node().offsetHeight,b!==c&&(d=!0,c=Math.max(b,c))}),d&&l.selectAll(".cv-legend-title").style("height",c+"px")}},t._getLegendContainingWidth=function(){return d},t._getUsedWidth=function(){return g?q+o:0},t._getUsedHeight=function(){return g?0:m.node().offsetHeight||0},t.destroy=function(){m.remove()},t.parent=function(a){return arguments.length?(b=a,t):b},t.minLegendEntryWidth=function(a){return arguments.length?(p=a,t):p},t.legendVerticalWidth=function(a){return arguments.length?(q=+a,t):q},t.values=function(a){return arguments.length?(h=a,t):h},t.type=function(a){return arguments.length?(i=a,t):i},t.chartWidth=function(a){return arguments.length?(d=a,t):d},t.chartHeight=function(a){return arguments.length?(e=a,t):e},t.chartPadding=function(a){return arguments.length?(f=a,t):f},t.seriesState=function(a){return arguments.length?(j=a,j.on("enableChange.legend",this._onSeriesEnableChange),t):j},t.validOrientations=function(a){return arguments.length?(r=a,t):r},t.orientation=function(a){return arguments.length?(c=a,t):c},t.interactive=function(a){return arguments.length?(s=a,t):s},t.mapping=function(){return n},t.isVertical=function(){return g},t}}(this),function(a){"use strict";d3.anomaly=function(){function a(a,b){for(var c in b)a[c]=b[c];return a}function b(){var a=W.append("g").classed("temp-axis",!0);t(a,$[0],$[1]),F=c(a),N=$[0]-F.left-F.right,M=$[1]-F.top-F.bottom,a.remove()}function c(a){var b=a.node().getBBox(),c=Math.abs(b.x),d=Math.abs(b.y);return{left:c,top:d,right:b.width-$[0]-c,bottom:b.height-$[1]-d}}function d(){var a=e(E,function(a){return Date.parse(a[T])},[K,J]),b=e(E,function(a){return a[U]});fa.domain(a);var c=fa.ticks(da,I),d=+c[1]-+c[0];a[1]=d+ +c[c.length-1],a[0]=+c[0]>a[0]?+c[0]-d:a[0],fa.domain(a),S=fa.ticks(da,I);var f=Math.max(Math.abs(b[0]),Math.abs(b[1]));ba?(ga.domain([0,f]),L=d3.scale.linear().domain([-f,f])):(ga.domain([-f,f]),L=d3.scale.linear().domain(ga.domain())),L.domain([0,.1,.2,.3,.4,.5,.6,.7,.8,.9,1].map(L.invert)),L.range(["#3C476F","#485485","#53659C","#6C7CAF","#99A2BC","#C5C5C5","#ACC997","#90C867","#7CBC4B","#6FA744","#64913E"])}function e(a,b,c){var d=[];return arguments.length<3||void 0===c[0]&&void 0===c[1]?d=d3.extent(a,b):(d[0]=void 0===c[0]?d3.min(a,b):c[0],d[1]=void 0===c[1]?d3.max(a,b):c[1]),d}function f(){R=d3.svg.brush().x(fa).y(ga).on("brushstart",g).on("brush",h).on("brushend",i)}function g(a){j()}function h(a){W.selectAll(".extent").style("opacity",1),j()}function i(a){W.selectAll(".extent").style("opacity",0),j()}function j(){var a=R.extent(),b={left:Math.min(fa(a[0][0]),fa(a[1][0])),right:Math.max(fa(a[0][0]),fa(a[1][0])),top:Math.min(ga(a[0][1]),ga(a[1][1])),bottom:Math.max(ga(a[0][1]),ga(a[1][1]))},c=W.selectAll(".anom-anomaly").filter(function(a,c){return l({left:a.bounds.x,right:a.bounds.x+a.bounds.width,top:a.bounds.y,bottom:a.bounds.y+a.bounds.height},b)});X&&k(c[0],X[0])||(X=c,ea.select(c))}function k(a,b){if(a.length!=b.length)return!1;for(var c=0,d=a.length;d>c;c++)if(-1===b.indexOf(a[c]))return!1;return!0}function l(a,b){return!(b.left>a.right||b.right<a.left||b.top>a.bottom||b.bottom<a.top)}function m(){V=d3.select(ca);var a=V.selectAll("svg").data([E]);a.enter().append("svg"),a.exit().remove(),a.attr("width",$[0]).attr("height",$[1]);var b=a.selectAll(".anom-container").data([0]);return b.enter().append("g").classed("anom-container",!0),b}function n(){Q=ga.ticks(aa);var a=Q[1]-Q[0];Q.push(a+Q[Q.length-1]),ba||Q.unshift(Q[0]-a),E=o(E),p(E);var b=q(E);return r(Q,b),b}function o(a,b){var c=fa.domain();return a.filter(function(a){var b=new Date(a[T]);return b>=c[0]&&b<c[1]})}function p(a){a.sort(function(a,b){return a=new Date(a[T]),b=new Date(b[T]),b>a?-1:a>b?1:0})}function q(a){return d3.nest().key(function(a){for(var b=Date.parse(a[T]),c=0,d=-1,e=S.length;++d<e&&!(+S[d]>+b);)c=d;return+S[c]}).entries(a)}function r(a,b){b.forEach(function(b){b.values=d3.layout.histogram().bins(a).value(function(a){return ba?Math.abs(a[U]):a[U]})(b.values),P=b.values[0].dx})}function s(a){var b=new Date(0),c=S.length,d=Math.max(Math.ceil((S.length-1)/(a/70)),1),e=d3.time.format("%b %e, %Y"),f=d3.time.format("%b %e"),g=d3.time.format("%a %e"),h=d3.time.format("%I:%M %p");return function(a,i){var j="";return i===c-1||i%d!==0?"":(0===i||b.getYear()!==a.getYear()?j=e(a):b.getMonth()!==a.getMonth()?j=f(a):b.getDate()!==a.getDate()?j=g(a):b.getHours()!==a.getHours()&&(j=h(a)),b=a,j)}}function t(a,b,c){var d=S.length,e=S.length>1&&+S[1]-+S[0]<=ja;fa.rangeRound([0,b]),ga.rangeRound([c,0]);var f=a.selectAll(".anom-axes").data([0]);f.enter().append("g").classed("anom-axes",!0);var g=f.selectAll(".anom-axis").data(["x","y"]);g.enter().append("g").attr("class",function(a){return"anom-"+a+" anom-axis"});var h=f.selectAll(".anom-x").attr("transform","translate(0,"+c+")").call(d3.svg.axis().scale(fa).ticks(da,I).orient("bottom").tickSize(-c).tickPadding(20).tickFormat(s(b)));h.selectAll("text").style("text-anchor","start"),h.selectAll("line").style("opacity",function(a,b){return b===d-1?0:e&&(6===a.getDay()||1===a.getDay())&&0===a.getHours()&&d-1>b?.3:null});var i=f.selectAll(".anom-y").call(d3.svg.axis().scale(ga).tickValues(Q).orient("left").tickSize(-b).tickPadding(10).tickFormat(function(a,b){return 0===b||b===Math.floor(Q.length/2)||b===Q.length-1?Math.round(1e5*a)/1e5+"%":""}));ba||i.selectAll("line").filter(function(a,b){return 0===a}).style("stroke-dasharray","4 4").style("opacity",.7)}function u(){var a=Math.round(Q.length>1?ga(Q[0])-ga(Q[1]):M)-1,b=Math.round(y(a))-1,c=W.selectAll(".anom-plot").data([O]);c.enter().append("g").classed("anom-plot",!0),c.exit().remove();var d=c.selectAll(".anom-column").data(function(a){return a});d.enter().append("g").classed("anom-column",!0),d.exit().remove(),d.attr("transform",function(a){return"translate("+fa(+a.key)+",0)"});var e=d.selectAll(".anom-row").data(function(a){return a.values});e.enter().append("g").classed("anom-row",!0),e.exit().remove(),e.attr("transform",function(b,c){return"translate(0,"+(ga(Q[c])-a)+")"});var f=e.selectAll(".anom-anomaly").data(function(a){return a}),g=f.enter().append("g").classed("anom-anomaly",!0);f.attr("transform",function(c,d){var e=x(ba?Math.abs(c[U]):c[U]);return c[U]>=0&&(e+=P),c.bounds={x:fa(Date.parse(c[T]))+(d*(b+ia)+ia),y:ga(e),width:b,height:a},"translate("+(d*(b+ia)+ia)+",0)"}),f.exit().remove(),g.append("rect").classed("anom-cell",!0).attr("x",b/2).attr("y",a/2).attr("width",0).attr("height",0),f.selectAll(".anom-cell").attr("fill",function(a){var b=x(ba?Math.abs(a[U]):a[U]);return ba&&a[U]<0&&(b*=-1),L(b)}).transition().duration(500).attr("x",0).attr("y",0).attr("width",b).attr("height",a);var h=g.append("g").classed("anom-select",!0);h.append("path").classed("outer-border",!0),h.append("path").classed("inner-border",!0);var i=f.selectAll(".anom-select");i.select(".outer-border").attr("d",w(0,0,b+.5,a+.5,1)),b>3&&i.select(".inner-border").attr("d",w(0,0,b+1,a+1,2));var j=g.append("rect").classed("anom-hit-area",!0);j.on("mouseover",function(a,b){ea.mouseover(this,a,b)}).on("mouseout",function(a,b){ea.mouseout(this,a,b)}).on("mousedown",function(a,b){R.clear();var c=d3.mouse(W.node()),d=fa.invert(c[0]),e=ga.invert(c[1]);R.extent([[d,e],[d,e]])}).on("click",function(a,b){ea.select(d3.select(this))}).style("cursor","crosshair").style("opacity",0).attr("x",0).attr("y",0).attr("width",b).attr("height",a)}function v(){var a=W.selectAll(".anom-plot").data([0]);a.enter().append("g").classed("anom-plot",!0),a.exit().remove(),a.call(R)}function w(a,b,c,d,e){return"M"+e+","+e+"L"+(c-2*e)+","+e+"L"+(c-2*e)+","+(d-2*e)+"L"+e+","+(d-2*e)+"z"}function x(a){for(var b=-1,c=Q.length;++b<c;){if(a>=0&&Q[b]+P>a)return Q[b];if(0>a&&Q[b]+P>a)return Q[b]+P}return Q[0]}function y(a){var b=(S.length>1?fa(S[1])-fa(S[0]):N)-ha,c=z();return G=b/c,G>a?a:G}function z(){var a=0;return O.forEach(function(b){b.values.forEach(function(b){a=Math.max(b.length,a)})}),a}function A(a){if(void 0===Z[a])throw new B(a);return Z[a]}function B(a){this.type="MappingNotDefinedException",this.message="The mapping for property "+a+" was not defined.",this.toString=function(){return this.type+" - "+this.message}}function C(){this.type="EmptyDataException",this.message="The data is empty or null",this.toString=function(){return this.type+" - "+this.message}}function D(){this.type="ParentNotSpecifiedException",this.message="A p was not specified for this visualization",this.toString=function(){return this.type+" - "+this.message}}var E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y={},Z={x:"date",y:"deviation"},$=[50,25],_=!0,aa=6,ba=!1,ca=null,da=7,ea=d3.dispatch("select","mouseover","mouseout"),fa=d3.time.scale(),ga=d3.scale.linear(),ha=8,ia=1,ja=864e5;return d3.rebind(Y,ea,"on"),Y.data=function(a){return arguments.length?(E=a,X=null,Y):E},Y.mappings=function(b){return arguments.length?(Z=a(Z,b),Y):Z},Y.xUpperLimit=function(a){return arguments.length?(J=a,Y):J},Y.xLowerLimit=function(a){return arguments.length?(K=a,Y):K},Y.normalizePositive=function(a){return arguments.length?(ba=a,Y):ba},Y.xTicks=function(a,b){if(!arguments.length)return void 0!==b?[da,I]:this.xTicks;var c=!!(a&&a.constructor&&a.call&&a.apply);return da=c?d3.functor(a):a,I=c?b:void 0,this},Y.bins=function(a){return arguments.length?(aa=a,Y):aa},Y.size=function(a){return arguments.length?($=a,Y):$},Y.interactive=function(a){return arguments.length?(_=a,Y):_},Y.parent=function(a){return arguments.length?(ca=a,Y):ca},Y.anomalyWidth=function(){return G},Y.anomalyHeight=function(){return H},Y.layout=function(){if(!Y.data()||!Y.data().length)throw new C;if(!Y.parent())throw new D;return T=A("x"),U=A("y"),d(),f(),W=m(),O=n(),ga.domain([Q[0],Q[Q.length-1]]),b(),W.attr("transform","translate("+F.left+","+F.top+")"),t(W,N,M),v(),u(),Y},Y.nodes=function(a){if(!V)throw new Error("layout must be called before nodes may be requested.");V.selectAll(".anom-anomaly").each(a)},Y}}(this),function(a){"use strict";var b=a.cloudViz||{},c=b.core||{},d=a.dv||{},e=a.d3||{},f=Object.create(c),g=400;f.init=function(a){return this._type="pathing",this._initDefaultOptions(),this.setOptions(a),this._pathLocked=null,this._pathedObj=null,this._activePaths=[],this._lineLocked=null,this._lastSide=0,this},f._initDefaultOptions=function(){var a="Visits",b={mappings:{},colors:["#3287d2","#9b8ce6","#d755a5","#fa5a50","#f0a01e","#c3d250","#5faf69","#1ebed7","#5a6eaa","#78b4f5","#aa5fa5","#f0557d","#e8782d","#f5c841","#8cc350","#3cb5a0","#286eaf","#826ee1","#b93282","#f04641","#e18c00","#a0b400","#50965a","#00a0be","#465a87","#4196e6","#964196","#dc3c69","#dc5f00","#e6b43c","#7daf4b","#32a08c"],nodeWidth:100,minNodeHeight:1,avgNodeHeight:30,padding:{top:80,left:30,right:30,bottom:20},metricName:a,minNodeHorzPadding:80,nodeVertPadding:34,iterations:32,pivotNode:null,collapseNode:null,expandNode:null,pathSelected:null};return Object.getPrototypeOf(f)._initDefaultOptions.call(this,b)},f._onAutoResize=function(){this.render()},f.reset=function(){Object.getPrototypeOf(f).reset.apply(this,arguments)},f._preRender=function(){Object.getPrototypeOf(f)._preRender.apply(this);var a=this._options,b=e.select(a.parent),c=a.padding,d=b.selectAll(".pathing-cv-info-wrapper").data([0]);d.enter().insert("div",":first-child").classed("pathing-cv-info-wrapper",!0);var g=d.selectAll(".pathing-cv-wrapper").data([0]);g.enter().insert("div",":first-child").classed("pathing-cv-wrapper",!0);var h=g.selectAll(".pathing-cv-container").data([0]);h.enter().insert("div",":first-child").classed("pathing-cv-container",!0);var i=h.selectAll(".pathing-svg").data([0]);i.enter().append("svg").classed("pathing-svg",!0);var j=i.selectAll(".pathing-svg-container").data([0]);j.enter().append("g").classed("pathing-svg-container",!0),j.attr("transform","translate("+c.left+","+c.top+")");var k=d.selectAll(".pathing-cv-info-pane").data([0]);k.enter().append("div").classed("pathing-cv-info-pane",!0),k.exit().remove();var l=k.selectAll(".info-pane-content").data([0]);l.enter().append("div").classed("info-pane-content",!0),l.exit().remove();var m=l.selectAll(".pathing-cv-info-title").data([0]);m.enter().append("div").classed("pathing-cv-info-title",!0),m.exit().remove();var n=l.selectAll(".pathing-cv-info-value").data([0]);n.enter().append("div").classed("pathing-cv-info-value",!0),n.exit().remove();var o=l.selectAll(".pathing-cv-info-paths").data([0]);o.enter().append("div").classed("pathing-cv-info-paths",!0),o.exit().remove(),this._sizeChart(),this._createGradients(i);var p=this._pathedObj;this._changedOptions&&this._changedOptions.data&&p?this._isDataObjNode(p.data)?this._unlockNode(p.data,p.elem)():this._unlockLink(p.data,p.elem)():(h.on("mousemove.node",null).on("click.node",null).on("click.link",null),this._removePathOverlays(h),this._removeNodeOptions(!0),this._defaultInformation())},f._render=function(){if(Object.getPrototypeOf(f)._render.apply(this),this._dataAdapter.isValidPathingData()){this._createDiagram();var a=this._pathedObj;this._activePaths.length&&a&&(this._isDataObjNode(a.data)?(this._renderNodePaths(a.data,a.elem,!0),this._showNodeOptions(a.data,a.elem)):this._renderLinkPaths(a.data,a.elem,!0))}},f._postRender=function(){Object.getPrototypeOf(f)._postRender.apply(this)},f._sizeChart=function(a){clearTimeout(this._wrapperAnimation),clearTimeout(this._scrollAnimation);var b=this._options,c=this._dataAdapter.data(),f=e.select(b.parent),g=f.selectAll(".pathing-cv-info-wrapper"),h=g.selectAll(".pathing-cv-wrapper"),i=h.selectAll(".pathing-cv-container"),j=g.selectAll(".pathing-cv-info-pane"),k=b.parent.offsetWidth,l=b.parent.offsetHeight,m=d.util.getPercentValue(b.width,k),n=d.util.getPercentValue(b.height,l),o=m-parseInt(j.style("width"),10),p=b.padding,q=c&&c.nodes||[],r=this._numColumns=q.length&&Math.max.apply(null,q.map(function(a){return a.column}))+1||1,s=[],t=0;c.nodes.forEach(function(a,b){s[a.column]?s[a.column]++:s[a.column]=1}),t=s.length&&Math.max.apply(null,s)||0;var u=o-2,v=n-2,w=r*b.nodeWidth+(r-1)*b.minNodeHorzPadding+p.left+p.right,x=t*b.avgNodeHeight+t*b.nodeVertPadding+p.top+p.bottom,y=w>o,z=x>n;h.classed("is-wider",y),y&&(u=w,v-=20),h.classed("is-taller",z),z&&(v=x,u-=20),g.style("width",m+"px").style("height",n+"px"),h.style("width",o+"px").style("height",n+"px"),i.style("width",u+"px").style("height",v+"px")},f._getInnerDimensions=function(){var a=this._options,b=a.padding,c=e.select(a.parent).select(".pathing-cv-container"),d=parseInt(c.style("width"),10),f=parseInt(c.style("height"),10);return[d-b.right-b.left,f-b.top-b.bottom]},f._createDiagram=function(){var a=this._options,b=this._dataAdapter.data(),c=e.select(a.parent).selectAll(".pathing-cv-container"),d=parseInt(c.style("width"),10),f=parseInt(c.style("height"),10),g=this._path=e.pathing().nodeWidth(a.nodeWidth).nodePadding(a.nodeVertPadding).size(this._getInnerDimensions()).nodes(b.nodes).links(b.links).minNodeHeight(a.minNodeHeight).layout(a.interations);if(!b.nodes.some(function(a){return 0!==a.column})){var h=g.nodeWidth(),i=a.padding;b.nodes.forEach(function(a){a.x+=(d-i.left-i.right)/2-h/2})}var j=this._updateLinks(g,b.links);this._updateNodes(g,b.nodes,j,f);var k=e.select(a.parent).select(".pathing-svg").node();k.style.display="none";k.offsetHeight;k.style.display=""},f._updateNodes=function(a,b,c,d){var f=this,h=this._options,i=e.select(h.parent).select(".pathing-svg-container"),j=(this._options.onNodeSelect,this._options.padding,!this._changedOptions||!this._changedOptions.data),k=j?0:g,l=i.selectAll(".node-container").data([0]);l.enter().append("g").classed("node-container",!0),l.exit().remove();var m=l.selectAll(".node").data(b,this._dataAdapter.nodeKey()),n=a.nodeWidth();m.enter().append("g").classed("hide-node",!0).attr("transform",function(a){return"translate("+a.x+",0)"}),m.on("mouseover.node",function(a,b){f._showNodePaths(a,this)}).on("mouseout.node",function(a,b){f._hideNodePaths()}).on("click.node",function(a,b){f._activateNode(a,this)});var o=m.exit();o.classed("hide-node",!0).on("mouseover.node",null).on("mouseout.node",null).on("click.node",null).transition().duration(k).style("opacity",0).attr("transform",function(a){return"translate("+a.x+",0)"}),setTimeout(function(){o.remove()},k),m.transition().duration(k).attr("transform",function(a){return"translate("+a.x+","+a.y+")"});var p=this._numColumns;m.each(function(b,c){function d(a){var b=!0,c=!1,d=!1;p>1&&(c=0===a.column,d=p-1===a.column,b=!(c||d)),e.select(this).attr("x",b?n/2:c?2:n-4).attr("text-anchor",b?"middle":c?"start":"end")}function f(a){var b=20,c=10,d="";return a.length<b?a:a.slice(0,b-c)+d+a.slice(a.length-c)}var g=e.select(this),h=g.classed("hide-node");g.attr("class","node"),g.classed("hide-node",h),g.classed("filter","E_0"===b.id),g.classed("exit-filter","X_0"===b.id),b.classname&&g.classed(b.classname,!0);var i=g.selectAll(".node-bg").data([b]);i.enter().append("rect").classed("node-bg",!0),i.exit().remove(),i.attr("width",n),i.transition().duration(k).attr("height",function(a){return a.dy});var j=g.selectAll(".node-title").data([b]);j.enter().append("text").classed("node-title",!0).attr("y",-5).attr("transform",null),j.exit().remove(),j.each(d),j.text(function(a){return f(a.label);
});var l=g.selectAll(".node-total").data([b]);l.enter().append("text").classed("node-total",!0).attr("y",15).attr("transform",null),l.exit().remove(),l.each(d),l.text(function(a){return e.format(",.0f")(a.value)});var m=g.selectAll(".node-hit-area").data([b]);m.enter().append("rect").classed("node-hit-area",!0),m.exit().remove(),m.attr("height",function(a){return a.dy+4}).attr("y",-4).attr("width",a.nodeWidth()).style("opacity",0),setTimeout(function(){g.classed("hide-node",!1)},k)})},f.gradientCounter={count:0},f._updateLinks=function(a,b){var c=this._options,d=this,f=e.select(c.parent).select(".pathing-svg-container"),h=e.select(c.parent).selectAll("svg"),i=h.selectAll("defs").data([0]),j=!this._changedOptions||!this._changedOptions.data,k=j?0:g;i.enter().append("defs");var l=i.selectAll(".path-fills").data([0]),m=(l.enter().append("g").classed("path-fills",!0),f.selectAll(".link-container").data([0]));m.enter().append("g").classed("link-container",!0),m.exit().remove();var n=f.selectAll(".path-overlay-container").data([0]);n.enter().append("g").classed("path-overlay-container",!0),n.exit().remove();var o=m.selectAll("path").data(b,this._dataAdapter.linkKey());o.enter().append("path").classed("hide-link",!0),o.on("mouseover.link",function(a,b){d._showLinkPaths(a,this)}).on("mouseout.link",function(a,b){d._hideLinkPaths()}).on("click.link",function(a,b){d._activateLink(a,this)});var p=o.exit();return p.classed("hide-link",!0).on("click.link",null).on("mouseover.link",null).on("mouseout.link",null),setTimeout(function(){p.remove()},k),o.each(function(b,c){var d=e.select(this),f=d.classed("hide-link");d.attr("class",function(a){return a.source?a.target?"link":"exit":"entry"}),d.classed("hide-link",f),d.classed("hide-link")?(d.attr("d",a.link()(b)),setTimeout(function(){d.classed("hide-link",!1)},k)):d.transition().duration(k).attr("d",a.link()(b)),b.source&&"E_0"===b.source.id?d.classed("entry-path",!0):b.target&&"X_0"===b.target.id&&d.classed("exit-path",!0);var g=b.source&&"E_0"===b.source.id,h=b.target&&"X_0"===b.target.id;d.classed("filter",g),d.classed("exit-filter",h)}),o},f._createGradients=function(a){var b=a.selectAll("style").data([0]);b.enter().append("style"),b.text(function(a){var b=".pathing-svg .exit { fill: url(#exitFill); } \n";return b+=".pathing-svg .entry { fill: url(#entryFill); } \n",b+=".pathing-svg .exit:hover { fill: url(#exitHighlightFill); } \n",b+=".pathing-svg .entry:hover { fill: url(#entryHighlightFill); } \n",b+=".pathing-svg .pivot-entry { mask: url(#pivotEnterMask); } \n",b+=".pathing-svg .pivot-exit { mask: url(#pivotExitMask); } \n",b+=".pathing-svg .link-container .entry-path { fill: url(#entryGradient); } \n",b+=".pathing-svg .link-container .exit-path { fill: url(#exitGradient); } \n"});var c=a.selectAll("defs").data([0]);c.enter().append("defs");var d=c.selectAll(".bounce-fills").data([0]),e=d.enter().append("g").classed("bounce-fills",!0),f=e.append("linearGradient").attr("id","pivotEnterGrad");f.append("stop").attr("offset","0%").style("stop-color","#fff").style("stop-opacity",0),f.append("stop").attr("offset","50%").style("stop-color","#fff").style("stop-opacity",0),f.append("stop").attr("offset","70%").style("stop-color","#fff").style("stop-opacity",.5),f.append("stop").attr("offset","100%").style("stop-color","#fff").style("stop-opacity",1);var g=e.append("mask").attr("id","pivotEnterMask").attr("x","0").attr("y","0").attr("width","1").attr("height","1").attr("maskUnits","objectBoundingBox").attr("maskContentUnits","objectBoundingBox");g.append("rect").attr("x","0").attr("y","0").attr("width","1").attr("height","1").attr("fill","url(#pivotEnterGrad)");var h=e.append("linearGradient").attr("id","pivotExitGrad").attr("x1","100%").attr("y1","0%").attr("x2","0%").attr("y2","0%");h.append("stop").attr("offset","0%").style("stop-color","#fff").style("stop-opacity",0),h.append("stop").attr("offset","50%").style("stop-color","#fff").style("stop-opacity",0),h.append("stop").attr("offset","70%").style("stop-color","#fff").style("stop-opacity",.5),h.append("stop").attr("offset","100%").style("stop-color","#fff").style("stop-opacity",1);var i=e.append("mask").attr("id","pivotExitMask").attr("x","0").attr("y","0").attr("width","1").attr("height","1").attr("maskUnits","objectBoundingBox").attr("maskContentUnits","objectBoundingBox");i.append("rect").attr("x","0").attr("y","0").attr("width","1").attr("height","1").attr("fill","url(#pivotExitGrad)");var j=e.append("linearGradient").attr("id","entryGradient").attr("x1","0%").attr("y1","100%").attr("x2","100%").attr("y2","100%");j.append("stop").attr("offset","0%").style("stop-color","#8cc350"),j.append("stop").attr("offset","100%").style("stop-color","#3287D2");var k=e.append("linearGradient").attr("id","exitGradient").attr("x1","0%").attr("y1","100%").attr("x2","100%").attr("y2","100%");k.append("stop").attr("offset","0%").style("stop-color","#3287D2"),k.append("stop").attr("offset","100%").style("stop-color","#cc2539");var l=e.append("linearGradient").attr("id","exitFill").attr("x1","0%").attr("y1","0%").attr("x2","0%").attr("y2","100%");l.append("stop").attr("offset","0%").style("stop-color","#FA5A50").style("stop-opacity",.5),l.append("stop").attr("offset","85%").style("stop-color","#FA5A50").style("stop-opacity",.5),l.append("stop").attr("offset","100%").style("stop-color","#FA5A50").style("stop-opacity",.1);var m=e.append("linearGradient").attr("id","exitHighlightFill").attr("x1","0%").attr("y1","0%").attr("x2","0%").attr("y2","100%");m.append("stop").attr("offset","0%").style("stop-color","#FA5A50").style("stop-opacity",1),m.append("stop").attr("offset","85%").style("stop-color","#FA5A50").style("stop-opacity",1),m.append("stop").attr("offset","100%").style("stop-color","#FA5A50").style("stop-opacity",.1);var n=e.append("linearGradient").attr("id","entryFill").attr("x1","0%").attr("y1","0%").attr("x2","0%").attr("y2","100%");n.append("stop").attr("offset","0%").style("stop-color","#58AF5E").style("stop-opacity",.1),n.append("stop").attr("offset","15%").style("stop-color","#58AF5E").style("stop-opacity",.5),n.append("stop").attr("offset","100%").style("stop-color","#58AF5E").style("stop-opacity",.5);var o=e.append("linearGradient").attr("id","entryHighlightFill").attr("x1","0%").attr("y1","0%").attr("x2","0%").attr("y2","100%");o.append("stop").attr("offset","0%").style("stop-color","#58AF5E").style("stop-opacity",.1),o.append("stop").attr("offset","15%").style("stop-color","#58AF5E").style("stop-opacity",1),o.append("stop").attr("offset","100%").style("stop-color","#58AF5E").style("stop-opacity",1)},f._setOptionContainerContent=function(a,b){var c,d=this._options,e="",f=0,g=a.classed("is-last-column"),h=this._dataAdapter,i=h.l10n.labels.pathing,j=[{id:"expand",label:i.expand,valid:d.expandNode&&h.canExpandNode(b)},{id:"pivot",label:i.focus,valid:d.pivotNode&&h.canPivotNode(b)},{id:"collapse",label:i.collapse,valid:d.collapseNode&&h.canCollapseNode(b)}];if(g&&j.reverse(),j=j.filter(function(a){return a.valid}),d.expandNode||d.collapseNode||d.pivotNode)for(var k=0,l=j.length;l>k;++k)c=j[k],e+='<a class="cv-node-option cv-node-option'+(g?l-f-1:f)+" cv-node-"+c.id+'"><i class="'+c.id+'"></i><span>'+c.label+"</span></a>",++f;e='<div class="cv-node-options num-options-'+f+'">'+e+"</div>",a.html(e)},f._activateNode=function(a,b){var c=this;if(this._pathLocked&&a===this._pathLocked.data){c._unlockNode(a,b)();var d=e.mouse(b)[0]>=c._options.nodeWidth/2?1:-1;if(!a.isPivot||d===c._lastSide)return}this._setPathLocked({data:a,elem:b}),e.select(c._options.parent).select(".pathing-cv-container").on("click.node",null).on("click.link",null),e.selectAll(".cv-node-active").classed("cv-node-active",!1),e.selectAll(".cv-link-active").classed("cv-link-active",!1),e.select(b).classed("cv-node-active",!0),this._renderNodePaths(a,b),this._showNodeOptions(a,b),this._showInformation(a,b),this._scrollToElem(b),setTimeout(function(){e.select(c._options.parent).select(".pathing-cv-container").on("click.node",c._unlockNode(a,b))},10)},f._showNodePaths=function(a,b){this._pathLocked||this._renderNodePaths(a,b)},f._renderNodePaths=function(a,b,c){function d(){i=k._activePaths=l.filter(function(b){var c=b.nodes.indexOf(a._pid);return j>0&&c+1<b.nodes.length||0>j&&c>0}),h=k._dataAdapter.nodePathData(i,a,j),k._createPathOverlays(h)}function f(){var a=0;try{a=e.mouse(b)[0]}catch(c){}var f=a>=k._options.nodeWidth/2?1:-1;f!==j&&(k._lastSide=j=f,d())}var g=e.select(this._options.parent).select(".pathing-cv-container");if(clearTimeout(this._hidePathOverlaysTimer),g.on("mousemove.node",null),!this._pathedObj||this._pathedObj.data!==a||c){this._setPathedObj({data:a,elem:b});var h,i,j=0,k=this,l=this._dataAdapter.nodePaths(a);a.isPivot?c?(j=k._lastSide,d()):(f(),k._pathLocked||g.on("mousemove.node",function(a,b){f()})):(k._lastSide=0,k._activePaths=l,h=this._dataAdapter.nodePathData(l,a,j),k._createPathOverlays(h)),setTimeout(function(){g.classed("path-overlays",!0)},1)}},f._showNodeOptions=function(a,b){var c=this._numColumns,d=e.select(this._options.parent).select(".pathing-cv-container"),f=d.node(),g=this._options,h=50,i=e.select(b).select(".node-bg").node(),j=f.getBoundingClientRect(),k=i.getBoundingClientRect(),l=k.top-j.top,m=k.left-j.left+g.nodeWidth/2,n=d.select(".cv-path-node-options");n.empty()?n=d.append("div").classed("cv-path-node-options",!0).attr("node",a._pid):n.attr("node")==a._pid&&n.classed("is-open")||(this._removeNodeOptions(),h=300,n=d.append("div").classed("cv-path-node-options",!0).attr("node",a._pid)),n.classed("is-last-column",c>1&&c-1===a.column).style("top",l+"px").style("left",m+"px"),this._setOptionContainerContent(n,a),setTimeout(function(){n.classed("is-open",!0)},h)},f._formatMetricValue=function(a){return this._formatNumber("decimal",a.value)+" "+this._options.metricName},f._formatPathInformation=function(a){var b=this._options,c=this,d=b.colors;return function(b,e){var f=c._dataAdapter.getPathEnd(b),g=f&&f.value?f.value:a,h="",i=b.values[0],j=i/g;return e%=d.length,h+='<span class="pathing-path-marker" style="background-color: '+d[e]+'"></span>',h+='<span class="pathing-path-value"><span class="pathing-path-num">'+c._formatNumber("decimal",i)+'</span> <span class="pathing-path-perc">'+c._formatNumber("percent",j)+"</span></span>"}},f._highlightPath=function(a,b,c){var d=this._options,f=d.parent,g=e.event,h=!g||g&&"click"===g.type,i=e.select(f).selectAll(".path-overlay-container"),j=e.select(f).selectAll(".pathing-cv-info-pane"),k=i.selectAll(".link.path"+b),l=i.selectAll(".link:not(.path"+b+")");if(h){if(this._lineLocked===a)return this._setLineLock(null),this._removeHightlightPath();this._setLineLock(a),j.selectAll(".locked").classed("locked",!1),e.select(c).classed("locked",!0)}else if(this._lineLocked)return;i.selectAll(".link.inactive").classed("inactive",!1),l.classed("inactive",!0),k.classed("active",!0)},f._setLineLock=function(a){this._options;this._lineLocked!==a&&(this._lineLocked=a,this._callPathSelected(a))},f._setPathedObj=function(a){this._pathedObj=a},f._setPathLocked=function(a){this._options;this._pathLocked!==a&&(this._pathLocked=a,this._callPathSelected())},f._callPathSelected=function(a){var b={},c=this._options,d=this._pathLocked&&this._pathLocked.data||{};a&&(b.path=a.nodes+""),"undefined"!=typeof d._pid&&(b.node=d._pid,b.side=this._lastSide),("undefined"!=typeof d.source||"undefined"!=typeof d.target)&&(b.source=d.source?d.source._pid:null,b.target=d.target?d.target._pid:null),"function"==typeof c.pathSelected&&c.pathSelected(b,this._pathLocked,a)},f._removeHightlightPath=function(){if(!this._lineLocked){var a=this._options,b=a.parent,c=e.select(b).selectAll(".pathing-cv-info-pane"),d=e.select(b).selectAll(".path-overlay-container").selectAll(".link");d.classed("inactive",!1).classed("active",!1),c.selectAll(".locked").classed("locked",!1)}},f._showInformation=function(a,b){var c=this,d=(this._options,this._isDataObjNode(a)),f=this._dataAdapter.l10n.labels.pathing,g=e.select(this._options.parent).select(".pathing-cv-info-pane"),h=g.selectAll(".pathing-cv-info-title"),i=g.selectAll(".pathing-cv-info-value"),j=g.selectAll(".pathing-cv-info-paths");this._setLineLock(null),this._removeHightlightPath();var k,l=this._formatMetricValue(a),m=!1;if(d)k=a.label,l=this._formatMetricValue(a),m=a.column==this._numColumns-1;else{var n=f.percOfNode;if(a.source)if(a.target){var o=this._dataAdapter,p=o.getPathDirection(o.data().paths[a.paths[0]]),q=0>p?a.target:a.source;k=f.nodeToNode.replace(/\{source\}/i,a.source.label).replace(/\{target\}/i,a.target.label),l=this._formatMetricValue(a)+'<span class="perc">'+n.replace(/\{perc\}/i,this._formatNumber("percent",a.value/q.value)).replace(/\{label\}/i,q.label)+"</span>"}else k=f.nodeExits.replace(/\{label\}/i,a.source.label),l=this._formatMetricValue(a)+'<span class="perc">'+n.replace(/\{perc\}/i,this._formatNumber("percent",a.value/a.source.value)).replace(/\{label\}/i,a.source.label)+"</span>";else k=f.nodeEntries.replace(/\{label\}/i,a.target.label),l=this._formatMetricValue(a)+'<span class="perc">'+n.replace(/\{perc\}/i,this._formatNumber("percent",a.value/a.target.value)).replace(/\{label\}/i,a.target.label)+"</span>"}g.classed("is-last-column",m),h.html(k),i.html(l);var r=j.selectAll(".pathing-cv-path-title").data([0]);r.enter().append("span").classed("pathing-cv-path-title",!0),r.html(this._dataAdapter.activePathsTitle(this._activePaths));var s=j.selectAll(".pathing-cv-path-info").data(this._activePaths);s.enter().append("span").classed("pathing-cv-path-info",!0),s.on("click.line",function(a,b){c._highlightPath(a,b,this)}).on("mouseover.line",function(a,b){c._highlightPath(a,b,this)}).on("mouseout.line",function(a,b){c._removeHightlightPath()}).html(this._formatPathInformation(a.value)),s.exit().on("click.line",null).on("mouseover.line",null).on("mouseout.line",null).remove()},f._defaultInformation=function(){this._setLineLock(null),this._removeHightlightPath();var a=e.select(this._options.parent).select(".pathing-cv-info-pane"),b=a.selectAll(".pathing-cv-info-title"),c=a.selectAll(".pathing-cv-info-value"),d=a.selectAll(".pathing-cv-info-paths"),f=this._dataAdapter.l10n.labels.pathing,g="<p>"+f.help1+"</p>";g+="<p>"+f.help2+"</p>",g+="<p>"+f.help3+"</p>",g+='<p><span class="cv-node-option"><i class="pivot"></i></span><span class="cv-option-title">'+f.focus+"</span></p>",g+="<p>"+f.focusHelp+"</p>",g+='<p><span class="cv-node-option"><i class="expand"></i></span><span class="cv-option-title">'+f.expand+"</span></p>",g+="<p>"+f.expandHelp+"</p>",g+='<p><span class="cv-node-option"><i class="collapse"></i></span><span class="cv-option-title">'+f.collapse+"</span></p>",g+="<p>"+f.collapseHelp+"</p>",b.html(f.title),c.html('<div class="help">'+g+"</div>"),d.html("")},f._scrollToElem=function(a){function b(a,b){return function(){var c=null!==a?e.interpolateNumber(g.node().scrollLeft,a):null,d=null!==b?e.interpolateNumber(g.node().scrollTop,b):null;return function(a){null!==c&&(g.node().scrollLeft=c(a)),null!==d&&(g.node().scrollTop=d(a))}}}var c=this._options,d=e.select(this._options.parent).select(".pathing-cv-container"),f=d.node(),g=e.select(c.parent).select(".pathing-cv-wrapper"),h=e.select(a),i=h.selectAll(".node-bg").empty()?h.node():h.select(".node-bg").node(),j=f.getBoundingClientRect(),k=i.getBoundingClientRect(),l=k.top-j.top,m=k.left-j.left+c.nodeWidth/2;if(g.classed("is-wider")||g.classed("is-taller")){var n=null,o=null;if(g.classed("is-wider")){var p=parseInt(g.style("width"),10),q=parseInt(d.style("width"),10);n=Math.min(q-p,Math.max(0,m-p/2))}if(g.classed("is-taller")){var r=parseInt(g.style("height"),10),s=parseInt(d.style("height"),10);o=Math.min(s-r,Math.max(0,l+40-r/2))}e.transition().duration(300).tween("scroll",b(n,o))}},f._unlockNode=function(a,b){var c=this;return function(d,f){c._setPathLocked(null),e.select(c._options.parent).select(".pathing-cv-container").on("click.node",null),c._deactivateNode(e.event,a,b)}},f._deactivateNode=function(a,b,c){var d=e.select(a.target),f=this._options,g=b||{};e.select(c).classed("cv-node-active",!1),this._removeNodeOptions(!1),this._defaultInformation(),this._hideNodePaths(),"click"===a.type&&(d.classed("cv-node-option")||(d=e.select(d.node().parentNode)),d.classed("cv-node-expand")&&"function"==typeof f.expandNode&&f.expandNode(g),d.classed("cv-node-collapse")&&"function"==typeof f.collapseNode&&f.collapseNode(g),d.classed("cv-node-pivot")&&"function"==typeof f.pivotNode&&f.pivotNode(g))},f._removeNodeOptions=function(a){var b=e.selectAll(".cv-path-node-options");b.classed("is-open",!1),setTimeout(function(){b.remove()},a?0:300)},f._hideNodePaths=function(){var a=e.select(this._options.parent).select(".pathing-cv-container");a.on("mousemove.node",null),this._pathLocked||this._removePathOverlays(a)},f._activateLink=function(a,b){var c=this;return this._pathLocked&&a===this._pathLocked.data?void c._unlockLink(a,b):(this._setPathLocked({data:a,elem:b}),e.select(c._options.parent).select(".pathing-cv-container").on("click.node",null).on("click.link",null),e.selectAll(".cv-node-active").classed("cv-node-active",!1),e.selectAll(".cv-link-active").classed("cv-link-active",!1),e.select(b).classed("cv-link-active",!0),this._removeNodeOptions(),this._renderLinkPaths(a,b),this._showInformation(a,b),this._scrollToElem(b),void setTimeout(function(){e.select(c._options.parent).select(".pathing-cv-container").on("click.link",c._unlockLink(a,b))},10))},f._showLinkPaths=function(a,b){this._pathLocked||this._renderLinkPaths(a,b)},f._renderLinkPaths=function(a,b,c){if(clearTimeout(this._hidePathOverlaysTimer),!this._pathedObj||this._pathedObj.data!==a||c){this._setPathedObj({data:a,elem:b});var d=this._dataAdapter;this._activePaths=d.linkSortActivePaths(a),this._createPathOverlays(d.linkPathData(this._activePaths));var f=e.select(this._options.parent).select(".pathing-cv-container");setTimeout(function(){f.classed("path-overlays",!0)},1)}},f._unlockLink=function(a,b){var c=this;return function(d,f){c._setPathLocked(null),e.select(c._options.parent).select(".pathing-cv-container").on("click.link",null),c._deactivateLink(e.event,a,b)}},f._deactivateLink=function(a,b,c){e.select(this._options.parent).select(".pathing-cv-container");e.select(c).classed("cv-link-active",!1),this._defaultInformation(),this._hideLinkPaths()},f._hideLinkPaths=function(){var a=e.select(this._options.parent).select(".pathing-cv-container");this._pathLocked||this._removePathOverlays(a)},f._createPathOverlays=function(a){var b=this._options,c=this._path,d=e.select(b.parent).select(".path-overlay-container"),f=d.selectAll("path").data(a);f.enter().append("path"),f.exit().remove(),f.attr("class",function(a){var b=a.pivotStart?" pivot-entry":a.pivotEnd?" pivot-exit":"";return"link path"+a.path+b}).attr("d",c.link()).attr("style",function(a,c){var d=a.path%b.colors.length;return"fill: "+b.colors[d]+";"}).sort(function(a,b){return a||b?a?b?b.dy-a.dy:-1:1:0})},f._removePathOverlays=function(a){clearTimeout(this._hidePathOverlaysTimer),this._setPathedObj(null),this._hidePathOverlaysTimer=setTimeout(function(){a.classed("path-overlays",!1)},20)},f._isDataObjNode=function(a){return"undefined"!=typeof a._pid},f.setActivePath=function(a){var b=this._options,c=this,d=this._dataAdapter.data();a=a||{};var f,g,h="undefined"!=typeof a.node;if(h?f=d.nodesById[a.node]:(f=d.links.filter(function(b){return(!b.source&&!a.source||b.source&&a.source&&b.source._pid+""===a.source)&&(!b.target&&!a.target||b.target&&a.target&&b.target._pid+""===a.target)}),f=f.length&&f[0]||null),g=h?".node":".link",f){var i,j=!1;j=d.paths.some(function(b){return i=b.nodes,b.nodes.toString()===a.path}),e.select(b.parent).selectAll(g).each(function(a,d){if(a===f){if(h?c._activateNode(a,this):c._activateLink(a,this),!j)return;e.select(b.parent).selectAll(".pathing-cv-path-info").filter(function(a,b){a.nodes.toString()===i.toString()&&c._highlightPath(a,b,this)})}})}},a.cloudViz.pathing=b.util.createConstructor(f)}(this),function(a){"use strict";d3.pathing=function(){function a(){m.forEach(function(a){a.sourceLinks=[],a.targetLinks=[],a.entryLinks=[],a.exitLinks=[]}),n.forEach(function(a){var b=a.source,c=a.target;null!==b&&"number"==typeof b&&(b=a.source=m[a.source]),null!==c&&"number"==typeof c&&(c=a.target=m[a.target]),null!==b&&null!==c?(b.sourceLinks.push(a),c.targetLinks.push(a)):null===b?c.entryLinks.push(a):b.exitLinks.push(a)})}function b(){function a(a){return a.sourceLinks&&a.sourceLinks.length||a.targetLinks&&a.targetLinks.length||a.exitLinks&&a.exitLinks.length||a.entryLinks&&a.entryLinks.length}m.forEach(function(a){a.hasOwnProperty("total")?a.value=a.total:a.value=Math.max(d3.sum(a.sourceLinks,h)+d3.sum(a.exitLinks,h),d3.sum(a.targetLinks,h)+d3.sum(a.entryLinks,h))}),m.sort(function(b,c){var d=a(b),e=a(c);return d&&!e?-1:e&&!d?1:c.value-b.value})}function c(){var a=[],b=l[0]-j;m.forEach(function(b){b.x=b.column,b.dx=j,a.indexOf(b.column)<0?(a.push(b.column),b.columnIndex=a.length-1):b.columnIndex=a.indexOf(b.column)}),o=a.length,d(o>1?b/(o-1):b)}function d(a){m.forEach(function(b){b.x*=a})}function e(a){function b(){var a=d3.min(i,function(a){var b=d3.sum(a,h)||1;return(l[1]-(a.length-1)*k)/b});i.forEach(function(b){b.forEach(function(b,c){b.y=c,b.row=c,b.dy=Math.max(p,b.value*a)})}),n.forEach(function(b){b.dy=b.value*a})}function c(a){function b(a){return g(a.source)*a.value}i.forEach(function(c,d){c.forEach(function(c){if(c.targetLinks.length){var d=d3.sum(c.targetLinks,b)/d3.sum(c.targetLinks,h);c.y+=(d-g(c))*a}})})}function d(a){function b(a){return g(a.target)*a.value}i.slice().reverse().forEach(function(c){c.forEach(function(c){if(c.sourceLinks.length){var d=d3.sum(c.sourceLinks,b)/d3.sum(c.sourceLinks,h);c.y+=(d-g(c))*a}})})}function e(){i.forEach(function(a){var b,c,d,e=0,g=a.length;for(a.sort(f),d=0;g>d;++d)b=a[d],c=e-b.y,c>0&&(b.y+=c),e=b.y+b.dy+k;if(c=e-k-l[1],c>0)for(e=b.y-=c,d=g-2;d>=0;--d)b=a[d],c=b.y+b.dy+k-e,c>0&&(b.y-=c),e=b.y})}function f(a,b){return a.y-b.y}var i=d3.nest().key(function(a){return a.x}).sortKeys(d3.ascending).entries(m).map(function(a){return a.values});b(),e();for(var j=1;a>0;--a)d(j*=.99),e(),c(j),e()}function f(){function a(a,b){return a.source.y-b.source.y}function b(a,b){return a.target.y-b.target.y}m.forEach(function(c){c.sourceLinks.sort(b),c.targetLinks.sort(a)}),m.forEach(function(a){var b=0,c=0;a.entryLinks.forEach(function(a){a.ty=c,c+=a.dy}),a.sourceLinks.forEach(function(a){a.sy=b,b+=a.dy}),a.targetLinks.forEach(function(a){a.ty=c,c+=a.dy}),a.exitLinks.forEach(function(a){a.sy=b,b+=a.dy})})}function g(a){return a.y+a.dy/2}function h(a){return a.value}var i={},j=24,k=8,l=[1,1],m=[],n=[],o=NaN,p=0;return i.nodeWidth=function(a){return arguments.length?(j=+a,i):j},i.nodePadding=function(a){return arguments.length?(k=+a,i):k},i.nodes=function(a){return arguments.length?(m=a,i):m},i.links=function(a){return arguments.length?(n=a,i):n},i.size=function(a){return arguments.length?(l=a,i):l},i.numColumns=function(){return o},i.minNodeHeight=function(a){return arguments.length?(p=a,i):p},i.layout=function(d){return a(),b(),c(),e(d),f(),i},i.relayout=function(){return f(),i},i.link=function(){function a(a){var c,d,e,f,g,h,i,j,k,l,m,n,o,p=5,q=15;return n=o=Math.min(a.dy+p,q),null===a.source?(c=a.target.x-n,d=a.target.x,j=a.target.y-p,k=a.target.y+a.dy,"M"+c+","+j+"h"+n+"v"+(k-j)+"c-"+n+",0,-"+n+",-"+o/2+",-"+n+",-"+o+"z"):null===a.target?(c=a.source.x+a.source.dx,d=a.source.x+a.source.dx+n,j=a.source.y+a.source.dy-a.dy,k=a.source.y+a.source.dy+p,"M"+d+","+k+"h-"+n+"v-"+(k-j)+"c"+n+",0,"+n+","+o/2+","+n+","+o+"V"+k+"z"):(c=a.source.x+a.source.dx,d=a.target.x,e=d3.interpolateNumber(c,d),f=e(b),g=e(1-b),h=g+(a.dy<15?a.source.y<a.target.y?-1*a.dy:a.dy:0),i=f+(a.dy<15?a.source.y<a.target.y?-1*a.dy:a.dy:0),j=a.source.y+a.sy,k=a.target.y+a.ty,l=k+a.dy,m=j+a.dy,"M"+c+","+j+"C"+f+","+j+" "+g+","+k+" "+d+","+k+"v"+a.dy+"C"+h+","+l+" "+i+","+m+" "+c+","+m+"Z")}var b=.5;return a.curvature=function(c){return arguments.length?(b=+c,a):b},a},i}}(this),function(a){"use strict";function b(a){var b=[],c=!0;for(var d in a){for(var e=a[d],f=-1,g=e.length;++f<g;){var h,i=e[f];c?(h={},b.push(h)):h=b[f],h[d]=i}c=!1}return b}var c=a.cloudViz||{},d=c.core||{},e=a.dv||{},f=a.d3||{},g=Object.create(d);g.init=function(a){return this._type="anomaly",a=a||{},this._initDefaultOptions(),this.setOptions(a),this._initializeAnomaly(),this},g._initDefaultOptions=function(a){var b={mappings:{x:"date",y:"deviation",category:"metric"},bins:12,xTicks:7,xTickInterval:void 0,xUpperLimit:void 0,xLowerLimit:void 0,normalizePositive:!1,onMouseOverAnomaly:null,onMouseOutAnomaly:null,onSelectAnomalies:null};return Object.getPrototypeOf(g)._initDefaultOptions.call(this,b)},g._render=function(){this._configureAnomaly(),this._anom.layout()},g._initializeAnomaly=function(){var a=this._options,b=a.mappings,c=this;this._anom=f.anomaly().on("mouseover",function(d,e,g){c._anom.nodes(function(a,c){f.select(this).transition().duration(750).style("opacity",a[b.category]===e[b.category]?.8:.2)}),a.onMouseOverAnomaly&&a.onMouseOverAnomaly.call(d,e,g)}).on("mouseout",function(b,d,e){c._anom.nodes(function(a,b){f.select(this).transition().duration(750).style("opacity",1)}),a.onMouseOutAnomaly&&a.onMouseOutAnomaly.call(b,d,e)}).on("select",function(b){c._anom.nodes(function(a,b){f.select(this).classed("selected",!1)}),b.classed("selected",!0),a.onSelectAnomalies&&a.onSelectAnomalies.call(b)})},g._configureAnomaly=function(){var a=this._options,c=e.util.getPercentValue(a.width,a.parent.offsetWidth),d=e.util.getPercentValue(a.height,a.parent.offsetHeight);this._anom.data(b(a.data)).parent(a.parent).mappings(a.mappings).bins(a.bins).size([c,d]).xUpperLimit(a.xUpperLimit).xLowerLimit(a.xLowerLimit).normalizePositive(a.normalizePositive).xTicks(a.xTicks,a.xTickInterval)},g._onAutoResize=function(){this.render()},g.chart=function(){return this._anom},a.cloudViz.anomaly=c.util.createConstructor(g)}(this),function(a){"use strict";d3.choropleth=function(){function a(){this.type="EmptyDataException",this.message="The data is empty or null",this.toString=function(){return this.type+" - "+this.message}}function b(){this.type="ParentNotSpecifiedException",this.message="A parent was not specified for this visualization",this.toString=function(){return this.type+" - "+this.message}}var c,d,e,f,g,h,i,j,k,l,m,n,o=["#fae6be","#eb782d","#dc283c","#640046"],p=["#c7b797","#b85e23","#a81e2e","#300022"],q=["#faf0c8","#d2dc73","#5faf69","#00505A"],r=["#c7bf9f","#a0a858","#437d4a","#002226"],s=["#d2e6fb","#7dafe6","#286eaf","#1e5a8c"],t=["#b0d5fb","#63a0e4","#1c68af","#10528a"],u={},v=[],w=[0,1],x=(m-n)*w[0],y=(m-n)*w[1],z=!1,A={top:0,left:0,right:0,bottom:40};return u.layout=function(){var c=this;if(!u.data())throw new a;if(!u.parent())throw new b;v=u.determineSize(j),u.calcRange(),g=u.createSVGContainer(),"string"==typeof j.geoJson?d3.json(j.geoJson,function(a){c._layoutWithData.call(c,a)}):this._layoutWithData(j.geoJson)},u._layoutWithData=function(a){u.drawGeos(a),j.interactive&&u.drawTooltip(),u.drawLegend(j.theme,a)},u.determineSize=function(a){var b=a.parent,c=a.width?a.width:b.offsetWidth,d=a.height?a.height:b.offsetHeight;return c=c?c:700,d=d?d:450,[c,d]},u.calcRange=function(){for(var a in j.data.values)"undefined"==typeof m&&(m=j.data.values[a],n=j.data.values[a]),j.data.values[a]>m&&(m=j.data.values[a]),j.data.values[a]<n&&(n=j.data.values[a])},u.drawLegend=function(a,b){var d=9,e=12,g=35,i=Math.min(v[0]-A.left,630)-25,k=(v[0]-A.left-i)/2,l=i-2*g-2*e,x=[],y=[];"undefined"!=typeof a&&"salmonRun"==a?(x=o,y=p):"undefined"!=typeof a&&"blueOcean"==a?(x=s,y=t):(x=q,y=r);var B=h.selectAll(".legend").data([c]);B.enter().append("g").classed("legend",!0),B.attr("transform","translate("+k+","+(v[1]-24)+")");var C=B.selectAll("defs").data([a]);C.enter().append("defs"),C.exit().remove();var D=C.selectAll("#defaultGradient-"+a).data([a]);D.enter().append("linearGradient").attr("id","defaultGradient-"+a),D.exit().remove();var E=C.selectAll("#darkGradient-"+a).data([a]);E.enter().append("linearGradient").attr("id","darkGradient-"+a),E.exit().remove();var F=["0%","33%","67%","100%"],G=function(a,b,c){var d=a.selectAll("stop").data(b);d.enter().append("stop").attr("class",function(a,b){return"stop"+b}),d.attr("offset",function(a){return a}).attr("stop-color",function(a,b){return c[b]})};G(D,F,x),G(E,F,y);var H=B.selectAll(".grad-bg").data([c]);H.enter().append("rect").classed("grad-bg",!0),H.attr("x",g+e).attr("y",0).attr("rx",d/2).attr("ry",d/2).attr("width",l).attr("height",d);var I=B.selectAll(".grad-rect").data([c]);I.enter().append("rect").classed("grad-rect",!0),I.classed("grad-rect",!0).attr("x",g+e).attr("y",0).style("stroke","url(#darkGradient-"+a+")").style("fill","url(#defaultGradient-"+a+")").attr("width",l).attr("height",d);var J=f.selectAll(".legend-label").data([n,m]);if(J.enter().append("div").attr("class",function(a,b){return"legend-label "+(b?"max":"min")}),J.style("left",function(a,b){return b?null:k+"px"}).style("right",function(a,b){return b?k+"px":null}).text(function(a,b){return j.formatFunction(b?m:n)}),j.interactive){var K=d3.svg.brush().x(d3.scale.linear().range([0,l])).extent(w).on("brushstart",function(){z=!0}).on("brushend",function(){z=!1}).on("brush",function(){w=K.extent(),h.selectAll(".grad-rect").attr("width",(w[1]-w[0])*l).attr("x",l*w[0]+g+e),u.drawGeos(b)}),L=9,M=26,N=B.selectAll(".brush").data([c]);N.enter().append("g").classed("brush",!0),N.attr("transform","translate("+(g+e)+",0)").call(K);var O=N.selectAll(".resize"),P=O.selectAll(".handle").data(function(a){return a});P.enter().append("rect").classed("handle",!0),P.attr("transform","translate("+-(L/2)+","+-L+")").attr("rx",L/3).attr("ry",L/3).attr("width",L).attr("height",M)}},u.drawTooltip=function(a){var b=null==a||null==a.value;l=f.selectAll(".tooltip").data(b?[]:[a]),l.enter().append("div").classed("tooltip",!0),l.exit().classed("visible",!1),setTimeout(function(){l.classed("visible",!0)},10);var c=l.selectAll(".tooltip-back").data([a]);c.enter().append("div").classed("tooltip-back",!0);var d=c.selectAll(".tt-name").data(function(a){return[a.name]});d.enter().append("p").classed("tt-name",!0),d.text(function(a){return a});var e=c.selectAll(".tt-value").data(function(a){return[a.value]});e.enter().append("p").classed("tt-value",!0),e.text(function(a){return j.formatFunction(a)});var g=c.selectAll(".tt-metric").data("undefined"!=typeof j.metric?[j.metric]:[]);g.enter().append("p").classed("tt-metric",!0),g.text(function(a){return a}),g.exit().remove()},u.hideTooltip=function(){u.drawTooltip({})},u.showTooltip=function(a){"value"in a&&a.value?u.drawTooltip(a):u.hideTooltip()},u.drawGeos=function(a){var b,d=null,f=(Math.min(v[0],v[1]),v[0]-A.left-A.right),l=v[1]-A.top-A.bottom,p=1,r=[0,0];k=j.projection?d3.geo[j.projection]():d3.geo.equirectangular(),k.scale(p).translate(r);var t=d3.geo.path().projection(k),B=t.bounds(a);p=.95/Math.max((B[1][0]-B[0][0])/f,(B[1][1]-B[0][1])/l),r=[(f-p*(B[1][0]+B[0][0]))/2,(l-p*(B[1][1]+B[0][1]))/2];var C=p*((B[1][1]-B[0][1])/l)*l,D=p*((B[1][0]-B[0][0])/f)*f;if(k.scale(p).translate(r),t=t.projection(k),j.interactive){var E=d3.behavior.zoom(),F=4;i.call(E.scaleExtent([1,F]).translate([f/2,l/2]).scale(1).on("zoom",function(){if(d3.event){var a=d3.event.translate,b=d3.event.scale,c=f/2*b,d=l/2*b,e=a[0]-c,h=a[1]-d,i=D/6,j=C/6,k=-c-i,m=f-c+i,n=-d-j,o=l-d+j;e=Math.min(e,m),e=Math.max(e,k),h=Math.min(h,o),h=Math.max(h,n),a[0]=e+c,a[1]=h+d,E.translate(a),g.attr("transform","translate("+e+","+h+") scale("+b+")")}}))}x=(m-n)*w[0]+n,y=(m-n)*w[1]+n,b=[x,(y-x)/3+x,(y-x)/3*2+x,y],e.selectAll(".legend-label.min").text(function(a,b){return j.formatFunction(x)}),e.selectAll(".legend-label.max").text(function(a,b){return j.formatFunction(y)}),d="salmonRun"==j.theme?d3.scale.linear().domain(b).range(o):"blueOcean"==j.theme?d3.scale.linear().domain(b).range(s):d3.scale.linear().domain(b).range(q);var G=function(a){return"undefined"==typeof c.values[a.properties.GEO_ID]||c.values[a.properties.GEO_ID]<x||c.values[a.properties.GEO_ID]>y?"#ddd":d(c.values[a.properties.GEO_ID]);
},H=function(a,b){if(!z){var d=a.properties.GEO_ID,e=h.selectAll("#"+d),f=e.node();f.parentNode.appendChild(f),e.classed("selected",!0),u.showTooltip({name:a.properties.name,id:a.properties.GEO_ID,value:c.values[a.properties.GEO_ID]})}},I=function(a,b){if(!z){var c=a.properties.GEO_ID,d=h.selectAll("#"+c),e=d.node();e.parentNode;d.classed("selected",!1),u.hideTooltip()}},J=g.selectAll(".geo").data(a.features,function(a){return a.properties.GEO_ID});J.enter().append("path").classed("geo",!0).attr("id",function(a,b){return a.properties.GEO_ID}).attr("vector-effect","non-scaling-stroke").on("mouseover.choro",j.interactive?H:null).on("mouseout.choro",j.interactive?I:null),J.exit().on("mouseover.choro",null).on("mouseout.choro",null),J.attr("d",t).style("fill",G)},u.createSVGContainer=function(){e=d3.select(d),f=e.selectAll(".cv-choropleth").data([c]),f.enter().append("div").classed("cv-choropleth",!0),f.style("width",v[0]+"px").style("height",v[1]+"px"),h=f.selectAll("svg").data([c]),h.enter().append("svg").attr("width","100%").attr("height","100%"),h.exit().remove();var a=h.selectAll("#plotClip").data([0]);a.enter().append("clipPath").attr("id","plotClip").append("rect"),a.select("rect").attr("x",A.left).attr("y",A.top).attr("width",v[0]-A.left-A.right).attr("height",v[1]-A.top-A.bottom);var b=h.selectAll(".container-bg").data([c]);b.enter().append("rect").classed("container-bg",!0).attr("width","100%").attr("height","100%"),i=h.selectAll(".zoom-container").data([c]),i.enter().append("g").classed("zoom-container",!0).attr("clip-path","url(#plotClip)");var g=i.selectAll(".zoom-container-plot-bg").data([c]);g.enter().append("rect").classed("zoom-container-plot-bg",!0),g.attr("x",A.left).attr("y",A.top).attr("width",v[0]-A.left-A.right).attr("height",v[1]-A.top-A.bottom);var j=i.selectAll(".choro-container").data([c]);return j.enter().append("g").classed("choro-container",!0),j},u.data=function(a){return arguments.length?(c=a,u):c},u.parent=function(a){return arguments.length?(d=a,u):d},u.options=function(a){return arguments.length?(j=a,u):j},u},d3.choropleth.gradIdCounter=0}(this),function(a){"use strict";var b=a.cloudViz||{},c=b.core||{},d=(a.dv||{},a.d3||{}),e=Object.create(c);e.init=function(a){return this._type="choropleth",a=a||{},this._initDefaultOptions(),this.setOptions(a),this._initChoropleth(),this},e._initDefaultOptions=function(a){var b={geoJson:null,theme:"sunnyDay",metric:"",projection:"equirectangular",format:"decimal",interactive:!0};return Object.getPrototypeOf(e)._initDefaultOptions.call(this,b)},e._render=function(){this._configure(),this._choro.layout()},e._initChoropleth=function(){this._choro=d.choropleth()},e._configure=function(){var a=this,b=this._options,c=this._dataAdapter;b.formatFunction=function(c){return a._formatNumber(b.format,c)},b.metric=c.metric(),b.format=c.format(),b.data=c.data(),this._choro.data(this._options.data).parent(this._options.parent).options(this._options)},a.cloudViz.choropleth=b.util.createConstructor(e)}(this),function(a){"use strict";function b(a,b){for(var c=new Array(a[1].length||0),d=0;d<c.length;++d)c[d]=a[0]*a[1][d]+b[0]*b[1][d];return c}a.venn=function(b,c,d){d=d||{},d.distance=d.distance||0,d.maxIterations=d.maxIterations||500;var e=d.lossFunction||a.lossFunction,f=d.layoutFunction||a.greedyLayout;b=f(b,c,d.distance);for(var g=new Array(2*b.length),h=0;h<b.length;++h)g[2*h]=b[h].x,g[2*h+1]=b[h].y;var i=0,j=a.fmin(function(a){i+=1;for(var d=new Array(b.length),f=0;f<b.length;++f)d[f]={x:a[2*f],y:a[2*f+1],radius:b[f].radius,size:b[f].size};return e(d,c)},g,d),k=j.solution;for(h=0;h<b.length;++h)b[h].x=k[2*h],b[h].y=k[2*h+1];return b},a.distanceFromIntersectArea=function(b,c,d){return Math.min(b,c)*Math.min(b,c)*Math.PI<d?Math.abs(b-c):a.bisect(function(a){return window.circleIntersection.circleOverlap(b,c,a)-d},0,b+c)},a.getDistanceMatrix=function(b,c,d){var e,f=[];for(e=0;e<b.length;++e){f.push([]);for(var g=0;g<b.length;++g)f[e].push(0)}for(e=0;e<c.length;++e){var h=c[e];if(2===h.sets.length){var i=h.sets[0],j=h.sets[1],k=Math.sqrt(b[i].size/Math.PI),l=Math.sqrt(b[j].size/Math.PI),m=a.distanceFromIntersectArea(k,l,h.size)+d;f[i][j]=f[j][i]=m}}return f},a.greedyLayout=function(b,c,d){function e(a,b){return b.size-a.size}function f(a){return a.set in q}function g(a,c){b[c].x=a.x,b[c].y=a.y,q[c]=!0}var h,i,j,k={};for(i=0;i<b.length;++i)k[i]=[],b[i].radius=Math.sqrt(b[i].size/Math.PI),b[i].x=b[i].y=0;for(i=0;i<c.length;++i){var l=c[i];if(2===l.sets.length){var m=l.sets[0],n=l.sets[1];k[m]&&k[n]&&(k[m].push({set:n,size:l.size}),k[n].push({set:m,size:l.size}))}}var o=[];for(h in k)if(k.hasOwnProperty(h)){var p=0;for(i=0;i<k[h].length;++i)p+=k[h][i].size;o.push({set:h,size:p})}if(!o.length)return b;o.sort(e);var q={};g({x:0,y:0},o[0].set);var r=a.getDistanceMatrix(b,c,d);for(i=1;i<o.length;++i){var s=o[i].set,t=k[s].filter(f);if(h=b[s],t.sort(e),0===t.length)throw"Need overlap information for set "+h;var u=[];for(j=0;j<t.length;++j){var v=b[t[j].set],w=r[s][t[j].set];u.push({x:v.x+w,y:v.y}),u.push({x:v.x-w,y:v.y}),u.push({y:v.y+w,x:v.x}),u.push({y:v.y-w,x:v.x});for(var x=j+1;x<t.length;++x)for(var y=b[t[x].set],z=r[s][t[x].set],A=window.circleIntersection.circleCircleIntersection({x:v.x,y:v.y,radius:w},{x:y.x,y:y.y,radius:z}),B=0;B<A.length;++B)u.push(A[B])}var C=1e50,D=u[0];for(j=0;j<u.length;++j){b[s].x=u[j].x,b[s].y=u[j].y;var E=a.lossFunction(b,c);C>E&&(C=E,D=u[j])}g(D,s)}return b},a.classicMDSLayout=function(b,c){for(var d=a.getDistanceMatrix(b,c,0),e=window.mds.classic(d),f=0;f<b.length;++f)b[f].x=e[f][0],b[f].y=e[f][1],b[f].radius=Math.sqrt(b[f].size/Math.PI);return b},a.lossFunction=function(a,b){function c(b){return b.map(function(b){return a[b]})}for(var d=0,e=0;e<b.length;++e){var f,g=b[e];if(2==g.sets.length){var h=a[g.sets[0]],i=a[g.sets[1]];f=null==h||null==i?0:window.circleIntersection.circleOverlap(h.radius,i.radius,window.circleIntersection.distance(h,i))}else f=window.circleIntersection.intersectionArea(c(g.sets));var j=null==g.weight?1:g.weight;d+=j*(f-g.size)*(f-g.size)}return d},a.scaleSolution=function(a,b,c,d){var e=function(b){var c=Math.max.apply(null,a.map(function(a){return a[b]+a.radius})),d=Math.min.apply(null,a.map(function(a){return a[b]-a.radius}));return{max:c,min:d}};b-=2*d,c-=2*d;for(var f=e("x"),g=e("y"),h=f.max-f.min,i=g.max-g.min,j=h?b/h:0,k=i?c/i:0,l=Math.min(k,j),m=0;m<a.length;++m){var n=a[m];n.radius=l*n.radius,n.x=d+(n.x-f.min)*l,n.y=d+(n.y-g.min)*l}return a.scaling=l,a},a.bisect=function(a,b,c,d){d=d||{};var e=d.maxIterations||100,f=d.tolerance||1e-10,g=a(b),h=a(c),i=c-b;if(g*h>0)throw"initial bisect points must have opposite signs";if(0===g)return b;if(0===h)return c;for(var j=0;e>j;++j){i/=2;var k=b+i,l=a(k);if(l*g>=0&&(b=k),Math.abs(i)<f||0===l)return k}return b+i},a.fmin=function(a,c,d){d=d||{};var e=d.maxIterations||200*c.length,f=d.nonZeroDelta||1.1,g=d.zeroDelta||.001,h=d.minErrorDelta||1e-5,i=d.rho||1,j=d.chi||2,k=d.psi||-.5,l=d.sigma||.5,m=d.callback,n=c.length,o=new Array(n+1);o[0]=c,o[0].fx=a(c);for(var p=0;n>p;++p){var q=c.slice();q[p]=q[p]?q[p]*f:g,o[p+1]=q,o[p+1].fx=a(q)}for(var r=function(a,b){return a.fx-b.fx},s=0;e>s&&(o.sort(r),m&&m(o),!(Math.abs(o[0].fx-o[n].fx)<h));++s){var t=new Array(n);for(p=0;n>p;++p){t[p]=0;for(var u=0;n>u;++u)t[p]+=o[u][p];t[p]/=n}var v=o[n],w=b([1+i,t],[-i,v]);w.fx=a(w);var x=w;if(w.fx<=o[0].fx){var y=b([1+j,t],[-j,v]);y.fx=a(y),y.fx<w.fx&&(x=y)}else if(w.fx>=o[n-1].fx){var z,A=!1;if(w.fx<=v.fx?(z=b([1+k,t],[-k,v]),z.fx=a(z),z.fx<v.fx?x=z:A=!0):(z=b([1-k*i,t],[k*i,v]),z.fx=a(z),z.fx<=w.fx?x=z:A=!0),A)for(p=1;p<o.length;++p)o[p]=b([1-l,o[0]],[l-1,o[p]]),o[p].fx=a(o[p])}o[n]=x}return o.sort(r),{f:o[0].fx,solution:o[0]}},a.drawD3Diagram=function(b,c,d,e,f){f=f||{};var g=d3.scale.category10(),h=f.circleFillColours||g,i=f.circleStrokeColours||h,j=f.circleStrokeWidth||function(a){return 0},k=f.textFillColours||g,l=f.textStrokeColours||k,m=f.opacity||.3,n=f.padding||6;c=a.scaleSolution(c,d,e,n);var o=b.append("svg").attr("width",d).attr("height",e),p=o.selectAll("circle").data(c).enter().append("g"),q=p.append("circle").attr("r",function(a){return a.radius}).style("fill-opacity",m).attr("cx",function(a){return a.x}).attr("cy",function(a){return a.y}).style("stroke",function(a,b){return i(b)}).style("stroke-width",function(a,b){return j(b)}).style("fill",function(a,b){return h(b)}),r=p.append("text").attr("x",function(a){return a.x}).attr("y",function(a){return a.y}).attr("text-anchor","middle").style("stroke",function(a,b){return l(b)}).style("fill",function(a,b){return k(b)}).text(function(a){return a.label});return{svg:o,nodes:p,circles:q,text:r}},a.updateD3Diagram=function(b,c){var d=b.select("svg"),e=parseInt(d.attr("width"),10),f=parseInt(d.attr("height"),10);c=a.scaleSolution(c,e,f,6),b.selectAll("circle").data(c).transition().duration(400).attr("cx",function(a){return a.x}).attr("cy",function(a){return a.y}).attr("r",function(a){return a.radius}),b.selectAll("text").data(c).transition().duration(400).attr("x",function(a){return a.x}).attr("y",function(a){return a.y})}}(window.venn=window.venn||{}),function(a){"use strict";function b(b){for(var c=[],d=0;d<b.length;++d)for(var e=d+1;e<b.length;++e)for(var f=a.circleCircleIntersection(b[d],b[e]),g=0;g<f.length;++g){var h=f[g];h.parentIndex=[d,e],c.push(h)}return c}var c=1e-10;a.intersectionArea=function(d,e){var f,g=b(d),h=g.filter(function(b){return a.containedInCircles(b,d)}),i=0,j=0,k=[];if(h.length>1){var l=a.getCenter(h);for(f=0;f<h.length;++f){var m=h[f];m.angle=Math.atan2(m.x-l.x,m.y-l.y)}h.sort(function(a,b){return b.angle-a.angle});var n=h[h.length-1];for(f=0;f<h.length;++f){var o=h[f];j+=(n.x+o.x)*(o.y-n.y);for(var p={x:(o.x+n.x)/2,y:(o.y+n.y)/2},q=null,r=0;r<o.parentIndex.length;++r)if(n.parentIndex.indexOf(o.parentIndex[r])>-1){var s=d[o.parentIndex[r]],t=Math.atan2(o.x-s.x,o.y-s.y),u=Math.atan2(n.x-s.x,n.y-s.y),v=u-t;0>v&&(v+=2*Math.PI);var w=u-v/2,x=a.distance(p,{x:s.x+s.radius*Math.sin(w),y:s.y+s.radius*Math.cos(w)});(null===q||q.width>x)&&(q={circle:s,width:x,p1:o,p2:n})}k.push(q),i+=a.circleArea(q.circle.radius,q.width),n=o}}else{var y=d[0];for(f=1;f<d.length;++f)d[f].radius<y.radius&&(y=d[f]);var z=!1;for(f=0;f<d.length;++f)if(a.distance(d[f],y)>Math.abs(y.radius-d[f].radius)){z=!0;break}z?i=j=0:(i=y.radius*y.radius*Math.PI,k.push({circle:y,p1:{x:y.x,y:y.y+y.radius},p2:{x:y.x-c,y:y.y+y.radius},width:2*y.radius}))}return j/=2,e&&(e.area=i+j,e.arcArea=i,e.polygonArea=j,e.arcs=k,e.innerPoints=h,e.intersectionPoints=g),i+j},a.containedInCircles=function(b,d){for(var e=0;e<d.length;++e)if(a.distance(b,d[e])>d[e].radius+c)return!1;return!0},a.circleIntegral=function(a,b){var c=Math.sqrt(a*a-b*b);return b*c+a*a*Math.atan2(b,c)},a.circleArea=function(b,c){return a.circleIntegral(b,c-b)-a.circleIntegral(b,-b)},a.distance=function(a,b){return Math.sqrt((a.x-b.x)*(a.x-b.x)+(a.y-b.y)*(a.y-b.y))},a.circleOverlap=function(b,c,d){if(d>=b+c)return 0;if(d<=Math.abs(b-c))return Math.PI*Math.min(b,c)*Math.min(b,c);var e=b-(d*d-c*c+b*b)/(2*d),f=c-(d*d-b*b+c*c)/(2*d);return a.circleArea(b,e)+a.circleArea(c,f)},a.circleCircleIntersection=function(b,c){var d=a.distance(b,c),e=b.radius,f=c.radius;if(d>=e+f||d<=Math.abs(e-f))return[];var g=(e*e-f*f+d*d)/(2*d),h=Math.sqrt(e*e-g*g),i=b.x+g*(c.x-b.x)/d,j=b.y+g*(c.y-b.y)/d,k=-(c.y-b.y)*(h/d),l=-(c.x-b.x)*(h/d);return[{x:i+k,y:j-l},{x:i-k,y:j+l}]},a.getCenter=function(a){for(var b={x:0,y:0},c=0;c<a.length;++c)b.x+=a[c].x,b.y+=a[c].y;return b.x/=a.length,b.y/=a.length,b}}(window.circleIntersection=window.circleIntersection||{}),function(a){"use strict";var b=a.cloudViz||{},c=b.core||{},d=a.dv||{},e=a.d3||{},f=Object.create(c);f.init=function(a){var c=this;return this._type="venn",a=a||{},this._initDefaultOptions(),this.setOptions(a),this._cvWrapper=null,this._seriesState=b.seriesState(),this._seriesState.on("enableChange.venn",function(a,b){c._onEnableState(b)}),this._dvColorScale=d.scale.ordinal(),this},f._initDefaultOptions=function(a){var b={colors:["#8cc350","#d755a5","#1ebed7","#f0a01e","#9b8ce6","#3cb5a0","#3287d2","#f0557d","#c3d250","#eb782d","#78b4f5","#5faf69","#aa5fa5","#fa5a50","#f5c841","#5a6eaa"],legendVerticalWidth:110,duration:500,distance:0};return this._margins={top:0,left:0,right:0,bottom:0},Object.getPrototypeOf(f)._initDefaultOptions.call(this,b)},f._render=function(){this._id=Math.floor(1e4*Math.random()),this._determineSize(),this._initScales(),this._draw()},f._draw=function(){var a=this._options.data;a.distance=this._options.distance,this._initSVG(),this._createStates(),this._parsedSetNotation=this._parseSetNotation(a.notation),this._overlapMap=this._createOverlapMap(a.sets,a.overlaps);var b=this._drawLegend();this._positionContainer(b);var c=this._configureSets(a),d=this._generateOverlayCombinations(c,this._parsedSetNotation);this._drawCircles(c,d)},f._onAutoResize=function(){this.render()},f._determineSize=function(a){var b=this._options,c=(this._dataAdapter.data(),b.parent.offsetWidth),e=b.parent.offsetHeight,f=d.util.getPercentValue(b.width,c)||c,g=d.util.getPercentValue(b.height,e)||e;this._size=[f,g]},f._initScales=function(){this._dvColorScale.range(this._options.colors)},f._parseSetNotation=function(a){var b=[];if(!a)return b;var c,d,e=a.split("|"),f=/\d+/g,g=e.length;for(c=0;g>c;c++){d=e[c];var h,i=d.match(f),j=[],k=i.length;for(h=0;k>h;h++)j.push(+i[h]);b.push(j)}return b},f._initSVG=function(){var a=this._options,b=e.select(a.parent);this._cvWrapper=b.selectAll(".cv-wrapper.cv-venn").data([0]),this._cvWrapper.enter().append("div").classed("cv-wrapper cv-venn",!0),this._cvWrapper.style("width",this._size[0]+"px").style("height",this._size[1]+"px");var c=this._cvWrapper.selectAll(".svg-wrapper").data([0]);c.enter().append("div").classed("svg-wrapper",!0);var d=c.selectAll("svg").data([0]);d.enter().append("svg"),this._d3Container=d.selectAll("g").data([0]),this._d3Container.enter().append("g")},f._positionContainer=function(a){this._size[0]-=a.left+a.right,this._size[1]-=a.top+a.bottom,this._cvWrapper.select(".svg-wrapper").style({"margin-left":a.left+"px","margin-top":a.top+"px","margin-right":a.right+"px","margin-bottom":a.bottom+"px",height:this._size[1]+"px"}),this._cvWrapper.selectAll(".cv-legend").style("height",a.left||a.right?this._size[1]-1+"px":null)},f._configureSets=function(b){this._options;b=this._sanitizeOverlaps(b);var c,d,e=a.venn.scaleSolution(a.venn.venn(b.sets,b.overlaps,{distance:b.distance}),this._size[0],this._size[1],7),f=e.length;for(c=0;f>c;c++)d=e[c],d.index=c;return e},f._combine=function(a,b,c){arguments.length<3?c=a.length-1:c--,arguments.length<2&&(b=1);for(var d=function(a,b,c,e){if(0===a)return void(c.length>0&&(e[e.length]=c));for(var f=0;f<b.length;f++)d(a-1,b.slice(f+1),c.concat([b[f]]),e)},e=[],f=b;c+1>=f;f++)d(f,a,[],e);return e},f._intersect=function(a,b){for(var c=[],d=0;d<a.length;d++)for(var e=0;e<b.length;e++)if(a[d]==b[e]){c.push(a[d]);break}return c},f._union=function(a,b){for(var c={},d=a.length-1;d>=0;--d)c[a[d]]=a[d];for(var e=b.length-1;e>=0;--e)c[b[e]]=b[e];var f=[];for(var g in c)c.hasOwnProperty(g)&&f.push(c[g]);return f.sort(function(a,b){return a-b}),f},f._generateOverlayCombinations=function(b,c){var d=this,e={},f=[],g=[];c.sort(function(a,b){return b.length-a.length}),c.forEach(function(a,b){var c=a.join("-");f=f.concat(d._combine(a,1)),f.forEach(function(b,f){var g,h=b.join("-"),i=e[h]||{};i.fill||(g=d._intersect(a,b),i.fill=g.join("-")===c),e[h]=i})});for(var h in e){var i,j=h.split("-"),k=[],l=j.length;for(i=0;l>i;i++){var m=b[j[i]];m&&k.push(b[j[i]])}var n={};k.length>1&&a.circleIntersection.intersectionArea(k,n),k.length?n.area=Math.PI*Math.pow(k[0].radius,2):n.area=0,g.push({key:h,fill:e[h].fill,area:n.area})}return g.sort(function(a,b){var c=b.area-a.area;return c?c:a.key.length-b.key.length}),g},f._sanitizeOverlaps=function(a){var b,c,d,e,f,g,h,i=a.sets,j=a.overlaps,k=[],l=i.length,m=j.length,n={},o=function(a,b){return+a-+b};for(d=0;m>d;d++)g=j[d],g.sets.sort(o),n[g.sets.join("-")]=g;for(b=0;l>b;b++)for(e=i[b],c=b+1;l>c;c++)f=i[c],h=!1,n.hasOwnProperty(b+"-"+c)&&"0"!==n[b+"-"+c].size||k.push({sets:[b,c],size:0});return a.overlaps=j.concat(k),a},f._createOverlapMap=function(a,b){var c,d,e={},f=function(a,b){return a-b},g=a.length;for(c=0;g>c;c++)d=a[c],e[c]=d.size;var h,i=b.length;for(c=0;i>c;c++)h=b[c],h.sets.sort(f),e[h.sets.join("-")]=h.size;return e},f._drawCircles=function(a,b){this._drawSetHitAreas(a),this._createClipPaths(a,b),this._drawFilledRegions(b),this._drawPadding(a),this._drawSetFills(a),this._drawBorders(a),this._makePlotFit(a)},f._drawSetHitAreas=function(a){var b=this,c=this._options,d=this._d3Container.selectAll(".set-hit-areas-container").data([a]);d.enter().append("g").classed("set-hit-areas-container",!0),d.exit().remove();var e=d.selectAll("circle").data(function(a){return a});e.enter().append("circle").attr("r",0).attr("cx",function(a){return a.x}).attr("cy",function(a){return a.y}).attr("tooltip",function(a){return a.tooltip}),e.exit().remove(),e.sort(function(a,b){return b.radius-a.radius}).on("mouseover",function(a,c){b._seriesState.enableStateByTypeAndId("standard",a.index,!0)}).on("mouseout",function(a,c){b._seriesState.enableStateByTypeAndId("standard",a.index,!1)}).transition().duration(c.duration).attr("r",function(a){return Math.max(a.radius-1,0)}).attr("cx",function(a){return a.x}).attr("cy",function(a){return a.y})},f._createClipPaths=function(a,b){var c=this,d=this._cvWrapper.select("svg").selectAll("defs").data(b.length?[0]:[]);d.enter().insert("defs",":first-child"),d.exit().remove();var e=d.selectAll("clipPath").data(b);e.enter().append("clipPath"),e.exit().remove(),e.attr("id",function(a){return"clip-"+c._id+"-"+a.key});var f=e.selectAll("circle").data(function(b){if(!b.key||!b.key.length)return[];var c=b.key.split("-"),d={circleIndex:c.shift()};return c.length&&(d.maskId=c.join("-")),a&&a[d.circleIndex]?[d]:[]});f.enter().append("circle"),f.exit().remove(),f.attr("clip-path",function(a){return a.hasOwnProperty("maskId")?"url(#clip-"+c._id+"-"+a.maskId+")":null}).attr("r",function(b){return a[b.circleIndex].radius}).attr("cx",function(b){return a[b.circleIndex].x}).attr("cy",function(b){return a[b.circleIndex].y}).style("fill","#FFF")},f._drawFilledRegions=function(a){var b=this,c=this._options,d=this._d3Container.selectAll(".filled-regions").data(a?[a]:[]);d.enter().append("g").classed("filled-regions",!0),d.exit().remove();var e=d.selectAll(".fill-region").data(function(a){return a});e.enter().append("rect").classed("fill-region",!0),e.exit().remove(),e.attr("clip-path",function(a){return"url(#clip-"+b._id+"-"+a.key+")"}).style("opacity",1e-6).attr("width",b._size[0]).attr("height",b._size[1]).classed("overlay",function(a){return a.fill}).on("mouseover",function(a,c){b._seriesState.enableStateByTypeAndId("highlight","audience",!0)}).on("mouseout",function(a,c){b._seriesState.enableStateByTypeAndId("highlight","audience",!1)}).transition().delay(c.duration).duration(c.duration).style("opacity",1)},f._drawPadding=function(a){var b=this._options,c=this._d3Container.selectAll(".padding-container").data([a]);c.enter().append("g").classed("padding-container",!0),c.exit().remove();var d=c.selectAll("circle").data(function(a){return a});d.enter().append("circle").attr("r",0).attr("cx",function(a){return a.x}).attr("cy",function(a){return a.y}),d.exit().remove(),d.transition().duration(b.duration).attr("r",function(a){return a.radius}).attr("cx",function(a){return a.x}).attr("cy",function(a){return a.y})},f._drawSetFills=function(a){var b=this,c=this._options,d=this._d3Container.selectAll(".set-fills-container").data([a]);d.enter().append("g").classed("set-fills-container",!0),d.exit().remove();var e=d.selectAll("circle").data(function(a){return a});e.enter().append("circle").attr("r",0).attr("cx",function(a){return a.x}).attr("cy",function(a){return a.y}),e.exit().remove(),e.style("fill",function(a,c){return b._dvColorScale.mapValue(c)}).transition().duration(c.duration).attr("r",function(a){return Math.max(a.radius-3,0)}).attr("cx",function(a){return a.x}).attr("cy",function(a){return a.y})},f._drawBorders=function(a){var b=this,c=this._options,d=this._d3Container.selectAll(".border-container").data([a]);d.enter().append("g").classed("border-container",!0),d.exit().remove();var e=d.selectAll("circle").data(function(a){return a});e.enter().append("circle").attr("r",0).attr("cx",function(a){return a.x}).attr("cy",function(a){return a.y}),e.exit().remove(),e.style("stroke",function(a,c){return b._dvColorScale.mapValue(c)}).classed("predicted",function(a){return a.predicted}).transition().duration(c.duration).attr("r",function(a){return a.radius}).attr("cx",function(a){return a.x}).attr("cy",function(a){return a.y})},f._createStates=function(){var a=this._options,b=a.data.sets;if("data"in this._changedOptions&&this._changedOptions.data){this._seriesState.removeStatesByType("standard"),this._seriesState.removeStatesByType("highlight"),this._seriesState.appendState(this._dataAdapter.l10n.labels.venn.definedAudience,"audience","highlight",!1);var c,d,e=b.length,f=[];for(c=0;e>c;c++)d=b[c],f.push(c),this._seriesState.appendState(d.label||c,c,"standard",!1);this._dvColorScale.domain(f)}},f._drawLegend=function(){var a=this._options,c=this;this._legend||(this._legend=b.interactiveLegend()),this._legend.parent(this._cvWrapper.node()).orientation("bottom").chartWidth(this._size[0]).chartHeight(this._size[1]).chartPadding({left:0,top:0,right:0,bottom:0}).validOrientations(["bottom","left"]).legendVerticalWidth(a.legendVerticalWidth).type("line").seriesState(this._seriesState).interactive(!1).values(this._calculateValues(this._options.data.sets,this._overlapMap,this._parsedSetNotation))._render(null,{fill:[this._dvColorScale]});var d=this._legend._getUsedWidth(),e=this._legend._getUsedHeight(),f=0!==e,g=this._cvWrapper.selectAll(".cv-legend-entry").on("mouseover",function(a){c._seriesState.enableStateByTypeAndId(a.type,a.id,!0)}).on("mouseout",function(a){c._seriesState.enableStateByTypeAndId(a.type,a.id,!1)});return f&&g.style("width",function(a,b){return c._size[0]/(c._options.data.sets.length+1)+"px"}),{left:d,bottom:e,right:0,top:0}},f._onEnableState=function(a){this._cvWrapper.selectAll(".set-fills-container circle").style("display",function(b,c){return"standard"===a.type&&a.id===c&&a.enabled?"block":"none"}),this._cvWrapper.selectAll(".border-container circle").classed("muted",function(b,c){return a.id!==c&&a.enabled}),this._cvWrapper.selectAll(".filled-regions rect").classed("muted",function(b,c){return"standard"===a.type&&a.enabled}),this._cvWrapper.selectAll(".padding-container circle").style("display",function(b,c){return"highlight"===a.type&&a.enabled?"none":"block"}),this._cvWrapper.selectAll(".cv-legend-entry").classed("inactive",function(b){return a.enabled&&(b.id!==a.id||b.type!==a.type)})},f._calculateValues=function(a,b,c){var d,e,f=[this._formatNumber("decimal",this._calculateHighlightedValue(a,b,c))],g=a.length;for(d=0;g>d;d++)e=a[d],f.push(e.sizeText?e.sizeText:this._formatNumber("decimal",e.size));return f},f._calculateHighlightedValue=function(a,b,c){var d=function(a,c,e,f){var g,h,i=this._combine(c,f,f),j=i.length,k=f%2?1:-1;for(g=0;j>g;g++){h=i[g];var l,m,n,o=h.length,p=[];for(l=0;o>l;l++)m=h[l],p=this._union(a[m],p);n=p.join("-"),e+=(b.hasOwnProperty(n)?b[n]:0)*k}return f++,f<=a.length&&(e=d.call(this,a,c,e,f)),e},e=function(a){var b,c=[];for(b=0;a>b;b++)c.push(b);return c};return d.call(this,c,e(c.length),0,1)},f._makePlotFit=function(a){var b=(this._options,{x:0,y:0}),c=0,d=0,e=4;a.forEach(function(a){c=Math.max(c,a.x+a.radius),d=Math.max(d,a.y+a.radius)}),this._size[0]-c>this._size[1]-d?b.x=(this._size[0]-c)/2-e:b.y=(this._size[1]-d)/2-e,this._cvWrapper.select("g").attr("transform","translate("+b.x+","+b.y+")")},a.cloudViz.venn=b.util.createConstructor(f)}(this),function(a){"use strict";var b=a.cloudViz||{},c=b.core||{},d=a.dv||{},e=a.d3||{},f=Object.create(c);f.init=function(a){return this._type="sunburst",this._hiddenNodes=[],this._outRangeNodes=[],this._invalidNodes=[],this._initDefaultOptions(),this.setOptions(a),this},f._initDefaultOptions=function(){var a={otherColor:"#ccc",otherGrayColor:"#999",outRangeColor:"#5a5a5a",metricColor:"#fff",seqColors:["#faf0c8","#d2dc73","#5faf69","#00505A"],seqColorsHeat:["#5a6eaa","#3287d2","#3cb5a0","#5faf69","#8cc350","#c3d250","#f5c841","#f0a01e","#eb782d","#fa5a50"],colors:["#3287d2","#9b8ce6","#d755a5","#fa5a50","#f0a01e","#c3d250","#5faf69","#1ebed7","#5a6eaa","#78b4f5","#aa5fa5","#f0557d","#e8782d","#f5c841","#8cc350","#3cb5a0","#286eaf","#826ee1","#b93282","#f04641","#e18c00","#a0b400","#50965a","#00a0be","#465a87","#4196e6","#964196","#dc3c69","#dc5f00","#e6b43c","#7daf4b","#32a08c"],padding:{top:10,bottom:60,left:10,right:10}};return Object.getPrototypeOf(f)._initDefaultOptions.call(this,a)},f._onAutoResize=function(){this.resize()},f.resize=function(){e.select(this._options.parent).selectAll(".sunburst-cv").node()&&(this._sizeChart(),this._render(!0))},f.reset=function(){Object.getPrototypeOf(f).reset.apply(this,arguments)},f._preRender=function(){if(this._paths){var a,b,c=this._oldKeys=this._dataAdapter.getDataByPathKey();for(a in c)b=c[a],c[a]={xo:b.x,dxo:b.dx,yo:b.y,dyo:b.dy}}Object.getPrototypeOf(f)._preRender.apply(this);var d=this._options,g=this,h=this._dataAdapter,i=h.l10n.labels.sunburst,j=e.select(d.parent);h.getSecondaryMetricIndex()&&g._hideNode(h.data(),g._invalidNodes,function(a){return g._isInvalidNode(a)});var k=this._hiddenNodes,l=h.getDataByPathKey();this._hiddenNodes=[],k.forEach(function(a,b){var c=h.getPathKey(a);l[c]&&g._hideNode(l[c],g._hiddenNodes)});var m=this._zoomedPath;this._zoomedPath=null,m&&(m=l[h.getPathKey(m)],this._zoomedPath=this._oldZoomed=m);var n=this._lockedNode;if(this._lockedNode=null,n&&("path"===n.type&&(n.data=l[h.getPathKey(n.data)],n.data&&(this._oldLockedNode=n)),"category"===n.type)){var o=h.categories().some(function(a){return n.data&&n.data.name===a.name?(n.data=a,!0):!1});o&&(this._oldLockedNode=n)}var p=j.selectAll(".sunburst-cv").data([0]);p.enter().insert("div",":first-child").classed("sunburst-cv",!0);var q=p.selectAll(".sunburst-cv-wrapper").data([0]);q.enter().insert("div",":first-child").classed("sunburst-cv-wrapper",!0);var r=q.selectAll(".sunburst-cv-container").data([0]);r.enter().insert("div",":first-child").classed("sunburst-cv-container",!0);var s=r.selectAll(".sunburst-svg").data([0]);s.enter().append("svg").classed("sunburst-svg",!0);var t=s.selectAll(".sunburst-svg-container").data([0]);t.enter().append("g").classed("sunburst-svg-container",!0);var u=q.selectAll(".sunburst-cv-label").data([0]);u.enter().append("div").classed("sunburst-cv-label",!0);var v=u.selectAll(".sunburst-cv-label-wrap").data([0]);v.enter().append("div").classed("sunburst-cv-label-wrap",!0);var w=v.selectAll(".sunburst-cv-label-metric").data([0]);w.enter().append("div").classed("sunburst-cv-label-metric",!0);var x=v.selectAll(".sunburst-audiences").data([0]);x.enter().append("div").classed("sunburst-audiences",!0),x.exit().remove();var y=p.selectAll(".sunburst-cv-actions-pane").data([0]);y.enter().append("div").classed("sunburst-cv-actions-pane",!0),y.exit().remove();var z=y.selectAll(".actions-pane-zoomout").data([0]);z.enter().append("div").classed("actions-pane-zoomout",!0).classed("actions-pane-action",!0),z.html('<i class="icon zoomout"></i><span>'+i.zoomout+"</span>"),z.on("click",function(){g._zoomPath(h.data())}),z.exit().remove();var A=y.selectAll(".actions-pane-hidden").data([0]);A.enter().append("div").classed("actions-pane-hidden",!0).classed("actions-pane-action",!0),A.html('<i class="icon hide"></i><span>'+g._hideLabelText()+"</span>"),A.on("click",function(){g._unhidePaths()}),A.exit().remove();var B=q.selectAll(".sunburst-cv-sec-viz").data([0]),C=B.enter().append("div").classed("sunburst-cv-sec-viz",!0);C.append("span").classed("title",!0);var D=C.append("span").classed("bar",!0);D.append("span").classed("button",!0).classed("color",!0).append("span"),D.append("span").classed("button",!0).classed("height",!0).append("span"),D.append("span").classed("button",!0).classed("both",!0).append("span"),B.selectAll(".button.color").on("click",function(){h.setSecondaryMetricType("color"),g._secondaryMetricChanged()}).selectAll("span").html(i.color),B.selectAll(".button.height").on("click",function(){h.setSecondaryMetricType("height"),g._secondaryMetricChanged()}).selectAll("span").html(i.height),B.selectAll(".button.both").on("click",function(){h.setSecondaryMetricType("both"),g._secondaryMetricChanged()}).selectAll("span").html(i.both),B.exit().remove();var E=q.selectAll(".sunburst-cv-secondary").data([0]);E.enter().append("div").classed("sunburst-cv-secondary",!0),E.exit().remove();var F=E.selectAll(".sunburst-cv-color").data([0]);F.enter().append("div").classed("sunburst-cv-color",!0),F.exit().remove();var G=p.selectAll(".sunburst-cv-info-pane").data([0]);G.enter().append("div").classed("sunburst-cv-info-pane",!0),G.exit().remove();var H=G.selectAll(".info-pane-content").data([0]);H.enter().append("div").classed("info-pane-content",!0),H.exit().remove();var I=H.selectAll(".info-pane-categories").data([0]);I.enter().append("div").classed("info-pane-categories",!0).append("div").classed("pane-title",!0).append("span"),I.exit().remove();var J=H.selectAll(".sunburst-audiences").data([0]);J.enter().append("div").classed("sunburst-audiences",!0).append("div").classed("pane-title",!0).append("span").text(i.audience),J.exit().remove();var K=H.selectAll(".info-pane-actions").data([0]);K.enter().append("div").classed("info-pane-actions",!0),K.exit().remove();var L=H.selectAll(".info-pane-metrics").data([0]),M=L.enter().append("div").classed("info-pane-metrics",!0);M.append("div").classed("pane-title",!0).classed("pri-metric",!0).append("span"),M.append("div").classed("info-pane-metrics-labels",!0).classed("pri-metric-labels",!0),M.append("div").classed("pane-title",!0).classed("sec-metric",!0).append("span"),M.append("div").classed("info-pane-metrics-labels",!0).classed("sec-metrics-labels",!0).append("span").classed("sec-metrics-help",!0),M.append("div").classed("pane-title",!0).classed("rank-chart",!0).append("span"),M.append("div").classed("info-pane-metrics-chart",!0),L.exit().remove();var N=H.selectAll(".info-pane-extra").data([0]);N.enter().append("div").classed("info-pane-extra",!0),N.exit().remove();var O=p.selectAll(".sunburst-cv-mobile-scroll").data([0]);O.enter().append("div").classed("sunburst-cv-mobile-scroll",!0),O.html(i.mobilescroll),O.exit().remove(),this._sizeChart(),p.classed("hiddenpaths",!!this._hiddenNodes.length)},f._render=function(a){Object.getPrototypeOf(f)._render.apply(this);var b=this._options,c=this._dataAdapter,d=c.data(),g=e.select(b.parent).selectAll(".sunburst-cv"),h=g.selectAll(".sunburst-cv-container"),i=h.selectAll(".sunburst-svg-container"),j=parseInt(h.style("width"),10),k=parseInt(h.style("height"),10),l=this._radius=Math.min(j,k)/2,m=this._isMobileSize(),n=d.categories.length+1,o=this._ringDivisor=1/n,p=m?20:140,q=this._centerRadius=Math.ceil(p/2/Math.cos(Math.PI/4));i.attr("transform","translate("+j/2+","+k/2+")"),!a&&this._yScale&&(this._oldYScale=this._yScale),!a&&this._xScale&&(this._oldXScale=this._xScale);var r=this._xScale=e.scale.linear().domain(this._oldXScale?this._oldXScale.domain():[0,1]).range([0,2*Math.PI]),s=this._yScale=e.scale.linear().domain([0,o,1]).range([0,q,l]);this._arc=e.svg.arc().startAngle(function(a){return Math.max(0,Math.min(2*Math.PI,r(a.x)))}).endAngle(function(a){return Math.max(0,Math.min(2*Math.PI,r(a.x+a.dx)))}).innerRadius(function(a){return Math.max(0,s(a.y))}).outerRadius(function(a){return Math.max(0,s(a.y+a.dy))});this._layoutPaths(a);var t=e.select(b.parent).select(".sunburst-cv-label"),u=Math.ceil(q*Math.cos(Math.PI/4)*2),v=u,w=b.padding.top+Math.floor(k/2-v/2),x=b.padding.left+Math.floor(j/2-u/2);m?t.style("top","").style("left","").style("width","").style("height",""):t.style("top",w+"px").style("left",x+"px").style("width",u+"px").style("height",v+"px"),
this._updateDetails(this._lockedNode),c.isDataEmpty()?this._setErrorMessage(c.l10n.labels.core.nodata):c.isSizeEmpty()?this._setErrorMessage(c.l10n.labels.sunburst.emptyFirstMetric):this._clearErrorMessage()},f._getHiddenNodes=function(){return this._hiddenNodes.concat(this._outRangeNodes,this._invalidNodes)},f._adjustDataSize=function(a,b,c){var d=(this._options,this),f=this._dataAdapter,g=a.depth-1,h=this._zoomedPath,i=.15,j=f.getStackedMetricIndex();if(g>=0&&a.metrics&&a.metrics[j]){a.y-=b;var k=a.metrics[j].value,l=c[g],m=l.max,n=Math.min(0,l.min),o=e.scale.linear().domain([n,m]).range([i,1]),p=o(k)*a.dy;(m===n||h&&h.depth>a.depth)&&(p=a.dy),b+=a.dy-p,a.dy=p}a.children&&a.children.length&&a.children.forEach(function(a){d._adjustDataSize(a,b,c)})},f._getLevelUniqueNodes=function(a,b,c){function d(a){if(!h||h.depth!==a.depth||h===a){if(a.depth===b){if(!c&&e.indexOf(a)>=0)return;if(g.indexOf(a.name)>=0)return;return f.push(a),void g.push(a.name)}a.children&&a.children.length&&a.children.forEach(function(a){d(a)})}}var e=(this._dataAdapter,this._getHiddenNodes()),f=[],g=[],h=this._zoomedPath;return d(a),f||[]},f._layoutPaths=function(a){var b=this._options,c=(this._arc,this),d=this._dataAdapter,f=d.data(),g=this._getHiddenNodes(),h=e.select(b.parent).selectAll(".sunburst-svg-container"),i=e.layout.partition().value(function(a){return g.indexOf(a)<0?a.size:0}).sort(function(a,b){return d.isOther(a)?1:d.isOther(b)?-1:b.size-a.size});a&&c._paths&&c._paths.each(function(a){a.xo=a.x,a.dxo=a.dx,a.yo=a.y,a.dyo=a.dy});var j=i.nodes(f),k=this._paths=h.selectAll("path").data(j,d.getPathKey);k.enter().insert("path",":first-child"),k.attr("data-sid",function(a,b){return a._sid}).on("click",function(a,b){c._lockNode({data:a,type:"path"})}).on("dblclick",function(a,b){c._zoomPath(a)}).on("mouseenter",function(a,b){c._lockedNode||c._isTouch()||c._highlightNode({data:a,type:"path"})});var l=k.exit().classed("removing",!0);setTimeout(function(){l.remove()},501),c.setColorScale(),this._updatePathColors(),c._buildColorSlider();var m;if(m=d.getStackedMetric()){var n,o=d.getStackedMetricIndex(),p=(this._zoomedPath,!1);if(p){var q=c.getMetricCategoryMinMax(o);n=Array.apply(null,new Array(f.categories.length)).map(function(){return q})}else n=f.categories.map(function(a,b){return c.getMetricCategoryMinMax(o,b)});c._adjustDataSize(f,0,n)}if(this._oldKeys){var r,s,t=this._oldYScale,u=t.domain(),v=this._yScale,w=v.domain();c._paths.each(function(a){r=d.getPathKey(a),(s=c._oldKeys[r])&&(a.xo=s.xo,a.dxo=s.dxo,a.yo=v.invert(t(s.yo)),d.isRoot(a)?a.dyo=v.invert(t(s.dyo)):a.dyo=v.invert(t(u[1]+s.dyo))-w[1])}),this._oldKeys=null}k.each(function(a){d.getPathKey(a);"undefined"==typeof a.xo&&(a.xo=a.x,a.dxo=a.dx,a.yo=0,a.dyo=0)}),k.transition().duration(500).attrTween("d",this._changeTween(!0)),h.on("mouseleave",function(a,b){c._lockedNode||c._isTouch()||c._unhighlightNode()}),a||(this._oldLockedNode?this._lockNode(this._oldLockedNode):this._unlockNode(),this._oldLockedNode=null,this._updateZoomPathStyles(this._oldZoomed),this._oldZoomed=null)},f._isMobileSize=function(){var a=this._options,b=a.parent.offsetWidth,c=d.util.getPercentValue(a.width,b);return 640>c},f._isTouch=function(){return"ontouchstart"in document.documentElement},f._postRender=function(){Object.getPrototypeOf(f)._postRender.apply(this)},f._sizeChart=function(a){var b=this._options,c=(this._dataAdapter.data(),e.select(b.parent)),f=c.selectAll(".sunburst-cv"),g=f.selectAll(".sunburst-cv-wrapper"),h=g.selectAll(".sunburst-cv-container"),i=(f.selectAll(".sunburst-cv-info-pane"),f.selectAll(".sunburst-cv-mobile-scroll")),j=b.parent.offsetWidth,k=b.parent.offsetHeight,l=d.util.getPercentValue(b.width,j),m=d.util.getPercentValue(b.height,k),n=this._isMobileSize(),o=l+(n?0:-250),p=n?Math.min(o,m):m,q=b.padding,r=o-2-(q.left+q.right),s=p-2-(q.top+q.bottom);f.style("width",l+"px").style("height",m+"px").classed("is-desktop",!n).classed("not-touch",!this._isTouch()),g.style("width",o+"px").style("height",p+"px"),h.style("width",r+"px").style("height",s+"px"),h.style("padding-top",q.top+"px").style("padding-left",q.left+"px"),i.style("top",m-30+"px").classed("visible",!f.node().scrollTop).classed("show",p+130>=m),f.on("scroll",function(){i.classed("visible",!f.node().scrollTop)})},f._buildColorSlider=function(){var a=this._options,b=this,c=this._dataAdapter,d=e.select(a.parent).selectAll(".sunburst-cv-color");if(!c.getColorMetric())return d.text("");var f=(c.data(),c.getColorMetric()),g=(this._colorExtent,b._colorExtentMin),h=b._colorExtentMax,i=e.select(a.parent).selectAll(".sunburst-cv-container"),j=parseInt(i.style("width"),10),k=j/2,l=c.seqColors(),m=Math.round(100/(l.length-1)),n=[],o=12,p=10,q=9,r=40,s=o+2*p+2,t=k,u=t-2*r-2*q;l.forEach(function(a,b){n.push(b*m+"%")}),d.style("width",t+"px");var v=d.selectAll(".legend-title").data([0]);v.enter().insert("div",":first-child").classed("legend-title",!0),v.text(f.name);var w=d.selectAll(".color-slider-legend").data([0]);w.enter().append("div").classed("color-slider-legend",!0),w.style("width",t+"px").style("height",s+"px");var x=w.selectAll(".color-slider").data([0]);x.enter().append("svg").classed("color-slider",!0).style("height",s+"px").style("width","100%");var y=x.selectAll("style").data([0]);y.enter().append("style"),y.text(function(a){var b=".sunburst-cv .sunburst-cv-color .grad-rect { fill: url(#backGradient); \n";return b});var z=x.selectAll("defs").data([0]);z.enter().append("defs");var A=z.selectAll("#backGradient").data([0]);A.enter().append("linearGradient").attr("id","backGradient");var B=function(a,b,c){var d=a.selectAll("stop").data(b);d.enter().append("stop").attr("class",function(a,b){return"stop"+b}),d.attr("offset",function(a){return a}).attr("stop-color",function(a,b){return c[b]})};B(A,n,l);var C=x.selectAll(".grad-rect").data([0]);C.enter().append("rect").classed("grad-rect",!0),C.attr("x",r+q).attr("y",p).attr("rx",o/2).attr("ry",o/2).attr("width",u).attr("height",o);var D=w.selectAll(".legend-label").data(["min","max"]);D.enter().append("div").attr("class",function(a){return"legend-label "+a}),D.style("left",function(a){return("min"===a?0:r+2*q+u)+"px"}).style("width",r+"px").text(function(a){var c="min"===a?g:h;return c=null===c?"min"===a?"-":"+":b._formatNumber(f.format,c)})},f._isNodeOutsideRange=function(a){var b=(this._dataAdapter,this),c=a.children||[],d=c.some(function(a){return!b._isNodeOutsideRange(a)});return!d&&this.isOutsideRange(a)},f._isInvalidNode=function(a){return this._dataAdapter.isOther(a)},f._hideLabelText=function(){var a=this._hiddenNodes.length,b=this._dataAdapter.l10n.labels.sunburst,c=1===a?b.hidden:b["hidden2+"];return c.replace(/\{value\}/i,a)},f._hideNode=function(a,b,c){var d=this;b.indexOf(a)>-1||((c&&c(a)||!c)&&b.push(a),a.children&&a.children.length&&a.children.forEach(function(a){d._hideNode(a,b,c)}))},f._hidePath=function(a,b,c){var d=this._options,f=this._dataAdapter;this._paths;this._hideNode(a,b,c),this._layoutPaths(!0),this._lockedNode&&b.indexOf(this._lockedNode.data)>-1&&this._unlockNode(),this._zoomedPath&&b.indexOf(this._zoomedPath)>-1&&this._zoomPath(f.data());var g=this._hiddenNodes.length,h=e.select(d.parent);h.selectAll(".actions-pane-hidden").selectAll("span").html(this._hideLabelText()),h.selectAll(".sunburst-cv").classed("hiddenpaths",!!g)},f._unhidePaths=function(){this._hiddenNodes=[],this._layoutPaths(!0),e.select(this._options.parent).selectAll(".sunburst-cv").classed("hiddenpaths",!1)},f._zoomPath=function(a){this._canZoomIn(a)&&(this._zoomedPath=a,this._layoutPaths(!0),this._updateZoomPathStyles(a),this._updateDetails(this._lockedNode))},f._updateZoomPathStyles=function(a){var b=this,c=e.select(this._options.parent).selectAll(".sunburst-cv");c.classed("zoomed",a&&a.depth>0),c.selectAll(".sunburst-cv-container").selectAll("path").each(function(c){e.select(this).classed("beyondzoom",c&&a&&c!==a&&c.depth>0&&(c.depth<=a.depth||!b._hasAncestorNode(c,a))),e.select(this).classed("zoomed",c===a)})},f._changeTween=function(a){var b=this._xScale,c=this._yScale,d=this._zoomedPath||this._dataAdapter.data(),f=this._arc,g=this._radius,h=this._ringDivisor,i=this._centerRadius,j=(this._dataAdapter.categories(),e.interpolate(b.domain(),[d.x,d.x+d.dx])),k=e.interpolate(c.domain(),d.y?[0,h,d.y,1]:[0,h,1]),l=e.interpolate(c.range(),d.y?[0,i,i,g]:[0,i,g]);return function(d,g){var h=e.interpolate({x:d.xo,dx:d.dxo,y:d.yo,dy:d.dyo},d);return g?function(b){return f(a?h(b):d)}:function(e){return b.domain(j(e)),c.domain(k(e)).range(l(e)),f(a?h(e):d)}}},f._updatePathColors=function(){var a=this,b=(this._dataAdapter,this._getHiddenNodes()),c=e.select(this._options.parent).selectAll(".sunburst-cv"),d=c.classed("node-highlighted");this._paths.style("fill",function(b){var c=e.select(this),f=d&&!c.classed("highlighted");return a.getNodeColor(b,f)}).classed("hidden",function(a){return b.indexOf(a)>=0})},f._lockNode=function(a){var b=this,c=(b._options,b._lockedNode);return c&&c.data===a.data&&c.type===a.type?b._unlockNode(a):(b._lockedNode=a,b._highlightNode(a),b._updateLockedState(a),void setTimeout(function(){e.select(b._options.parent).select(".sunburst-cv-wrapper").on("click.cvpath",function(){e.event&&e.event.target&&"path"===e.event.target.nodeName||b._unlockNode()})},10))},f._unlockNode=function(a){var b=this;b._options;b._lockedNode=null,b._updateLockedState(),a&&!b._isTouch()?b._highlightNode(a):b._unhighlightNode(),e.select(b._options.parent).select(".sunburst-cv-container").on("click.cvpath",null)},f._highlightNode=function(a){var b=this,c=a&&a.type||"path",d=a&&a.data||null,f=this._getAncestorNodes(d),g={};g.category=function(a){return a.depth===d.index+1},g.item=function(a){return a&&d&&a.name===d.name},g.path=function(a){return f.indexOf(a)>=0||b._lockedNode&&a.parent===d};var h=e.select(this._options.parent).selectAll(".sunburst-cv");h.classed("node-highlighted",!0),h.selectAll(".sunburst-cv-container").selectAll("path").each(function(a){e.select(this).classed("highlighted",g[c](a))}),b._lockedNode||h.selectAll(".info-pane-category").each(function(a){e.select(this).classed("disabled","category"===c&&a!==d)}),this._updateDetails(a),this._updatePathColors()},f._unhighlightNode=function(){this._removeHighlights(),this._updateDetails()},f._removeHighlights=function(){var a=e.select(this._options.parent);a.selectAll(".sunburst-cv").classed("node-highlighted",!1).selectAll("path").classed("highlighted",!1),a.selectAll(".info-pane-category").classed("disabled",!1),this._updatePathColors()},f._secondaryMetricChanged=function(){var a=this,b=this._dataAdapter,c=b.l10n.labels.sunburst,d=b.getSecondaryMetricIndex();a._outRangeNodes=[],d?a._hidePath(b.data(),a._invalidNodes,function(b){return a._isInvalidNode(b)}):(a._invalidNodes=[],a._layoutPaths(!0));var f=e.select(this._options.parent);f.selectAll(".sunburst-cv").classed("secondary-metric",!!d);var g=f.selectAll(".sunburst-cv-sec-viz");g.selectAll(".button").classed("active",!1);var h=b.getSecondaryMetricType();h&&g.selectAll(".button."+h).classed("active",!0);var i=b.getSecondaryMetric(),j=i&&i.name||null;g.selectAll(".title").html(j?c.mapmetric.replace(/\{metric\}/i,j):""),this._updateDetails(this._lockedNode),this._updateMetricState()},f._updateDetails=function(a){a&&"item"===a.type||(this._setChartMetrics(a),this._setDetailsMetrics(a),this._setDetailsAudiences(a),this._setDetailsCategories(a),this._setDetailsActions(a))},f._setDetailsCategories=function(a){var b=this,c=this._dataAdapter,d=c.l10n.labels.sunburst,f=(c.data(),c.categories()),g=e.select(this._options.parent).select(".info-pane-categories"),h=Math.max(0,b._zoomedPath?b._zoomedPath.depth-1:0),i=a&&"path"===a.type&&b._lockedNode?[]:f.slice(h),j=i.length,k=a||{},l=g.selectAll(".info-pane-category").data(i),m=l.enter().append("div").classed("info-pane-category",!0).classed("inactive",!0);g.select(".pane-title").select("span").text(1===j.length?d.category:d["category2+"]),l.each(function(a,c){var f=e.select(this);f.text(""),b._createRingMarker(f,j,c),f.append("span").classed("name",!0).html(a&&a.name||""),f.append("span").classed("top",!0).html("("+d.topresults.replace(/\{value\}/i,a.top)+")"),"path"===k.type?f.classed("disabled",!b._lockedNode&&k.data&&k.data.depth-1!==c-h):b._lockedNode&&"category"===b._lockedNode.type&&f.classed("disabled",a!==b._lockedNode.data)}),setTimeout(function(){m.classed("inactive",!1)},1);var n=l.exit().classed("inactive",!0).on("mouseenter",null).on("mouseleave",null).on("click",null);setTimeout(function(){n.remove()},400),l.on("mouseenter",function(a,c){b._lockedNode||b._isTouch()||b._highlightNode({data:a,type:"category"})}),l.on("mouseleave",function(a,c){b._lockedNode||b._isTouch()||b._unhighlightNode()}),l.on("click",function(a,c){b._lockNode({data:a,type:"category"})}),g.classed("empty",!i.length)},f._setDetailsAudiences=function(a){var b=this,c=this._dataAdapter,d=a&&a.type||"",f=a&&a.data||null,g="category"===d,h=c.data(),i=g?this._getLevelUniqueNodes(h,f.index+1,!1):this._getAncestorNodes(f),j=g?function(a,b){return b}:function(a,b){return a&&a.depth||0},k=c.categories(),l=e.select(this._options.parent).selectAll(".sunburst-audiences"),m=i&&i[0]||h,n=h===m,o=!i||n?[]:i.slice();l.each(function(a){var c=e.select(this),d=o.slice(),f=e.select(c.node().parentNode).classed("sunburst-cv-label-wrap");g||f?g&&f&&(d=[]):(b._lockedNode||(d=[]),d.reverse());var h=c.selectAll(".sunburst-audience").data(d,j),i=h.enter().append("span").classed("sunburst-audience",!0).classed("inactive",!0);i.append("span").classed("marker",!0).style("background-color","#dcdcdc"),i.append("span").classed("category",!0),i.append("span").classed("name",!0),h.each(function(a,d){var h=e.select(this),i=k[a.depth-1];if(h.select(".marker").style("background-color",b.getNodeColor(a)),h.select(".category").classed("hidden",g||f).text(!g&&i&&i.name||""),h.select(".name").text(a.name),h.classed("to-remove",!1).attr("my-name",a.name).attr("my-depth",a.depth),h.on("mouseenter",function(a,c){b._isTouch()||b._highlightNode({data:a,type:"item"})}),h.on("mouseleave",function(a,c){b._isTouch()||(b._lockedNode?b._highlightNode(b._lockedNode):b._unhighlightNode())}),!f){var j=e.select(h.node().cloneNode(!0)).style("height","").classed("test",!0).classed("inactive",!1);c.node().appendChild(j.node()),h.attr("my-height",parseInt(j.style("height"),10)),j.remove()}}),h.order(),setTimeout(function(){h.each(function(a,b){var c=e.select(this);c.classed("inactive",!1),f||c.style("height",c.attr("my-height")+"px")})},1);var l=h.exit().classed("inactive",!0).style("height","").classed("to-remove",!0).on("mouseenter",null).on("mouseleave",null).on("click",null);setTimeout(function(){l.each(function(a,b){var c=e.select(this);c.classed("to-remove")&&c.remove()})},400),c.classed("empty",!d.length)})},f._setDetailsActions=function(a){function b(){g._zoomPath(g._lockedNode.data)}function c(){g._zoomPath(i)}function d(){g._hidePath(g._lockedNode.data,g._hiddenNodes)}function f(){var a=g._lockedNode.data,b=g._hiddenNodes;a&&g._hidePath(i,b,function(c){return c.name===a.name||b.indexOf(c.parent)>=0})}var g=this,h=this._dataAdapter,i=h.data(),j=e.select(this._options.parent).select(".info-pane-actions"),k=j.selectAll(".info-pane-actions-chart").data([0]);k.enter().append("div").classed("info-pane-actions-chart",!0).classed("info-pane-actions-pane",!0);var l=j.selectAll(".info-pane-actions-extra").data([0]);l.enter().append("div").classed("info-pane-actions-extra",!0).classed("info-pane-actions-pane",!0);var m=[],n=h.l10n.labels.sunburst;if(a&&"path"===a.type&&g._lockedNode){var o=a.data,p=g._canZoomIn(o),q=o===i;g._lockedNode?q||(p?m.push({click:b,className:"zoomin",icon:"zoomin",label:n.zoomin}):g._canZoomOut(o)&&m.push({click:c,className:"zoomout",icon:"zoomout",label:n.zoomout}),m.push({click:d,className:"hide",icon:"hide",label:n.hide}),m.push({click:f,className:"hideallname",icon:"hide",label:n.hideall})):(q||m.push({click:!1,icon:"more",label:n.moreAction}),p&&m.push({click:!1,icon:"zoomin",label:n.zoomAction}))}var r=g._getExtraActions(a),s=!!m.length,t=!!r.length;j.classed("full-width",!s&&t||!t&&s),j.classed("empty",!s&&!t),g._buildActionsPane(k,m),g._buildActionsPane(l,r);var u=j.selectAll(".hideallname");u.on("mouseenter",function(){g._isTouch()||g._highlightNode({data:g._lockedNode.data,type:"item"})}),u.on("mouseleave",function(a,b){g._isTouch()||(g._lockedNode?g._highlightNode(g._lockedNode):g._unhighlightNode())})},f._buildActionsPane=function(a,b){var c=a.selectAll(".info-pane-action").data(b),d=c.enter().append("a").classed("info-pane-action",!0).classed("inactive",!0);d.append("i").classed("icon",!0),d.append("span"),c.each(function(b,c){var d=e.select(this);d.select(".icon").attr("class","icon").classed(b.icon,!0),d.select("span").text(b.label),d.attr("class","info-pane-action"+(d.classed("inactive")?" inactive":"")+(b.click||b.href?" action":" help")),b.click?d.on("click",b.click):d.on("click",null),b.href?d.attr("href",b.href):d.attr("href",null),b.className&&d.classed(b.className,!0);var f=e.select(d.node().cloneNode(!0)).style("height","").classed("test",!0).classed("inactive",!1);a.node().appendChild(f.node()),d.attr("my-height",parseInt(f.style("height"),10)),f.remove()}),setTimeout(function(){c.each(function(a,b){var c=e.select(this);c.style("height",c.attr("my-height")+"px").classed("inactive",!1)})},1);var f=c.exit().classed("inactive",!0).style("height","").classed("to-remove",!0).on("click",null);return setTimeout(function(){f.each(function(a,b){var c=e.select(this);c.classed("to-remove")&&c.remove()})},400),!!b.length},f._setDetailsMetrics=function(a){var b=e.select(this._options.parent).select(".info-pane-metrics"),c=b.select(".pri-metric-labels"),d=b.select(".sec-metrics-labels"),f=b.select(".info-pane-metrics-chart"),g=this._dataAdapter,h=g.data(),i=h.metrics.slice(0,1),j=h.metrics.slice(1),k=g.categories(),l=g.l10n.labels.sunburst,m=a&&"path"===a.type?a.data:null,n=m||h,o=m&&m.children&&m.children.length&&this._lockedNode;b.classed("total",!o),b.selectAll(".pane-title").each(function(a,b){var c=e.select(this),d=c.select("span");return c.classed("pri-metric")?d.text(l.primarymetric):c.classed("sec-metric")?(c.classed("hidden",!j.length),d.text(j.length?1===j.length?l.secondarymetric:l["secondarymetric2+"]:"")):void(c.classed("rank-chart")&&d.text(o?k[m.depth]&&k[m.depth].name:""))}),b.selectAll(".sec-metrics-help").each(function(a,b){e.select(this).text(1===j.length?l.secondarymetrichelp:l["secondarymetrichelp2+"]).classed("hidden",!j.length)}),this._setNodeMetricLabels(c,n,i,!!m),this._setNodeMetricLabels(d,n,j,!!m),this._setNodeMetricChart(f,this._lockedNode?m:null)},f._setChartMetrics=function(a){var b=e.select(this._options.parent).select(".sunburst-cv-label-wrap"),c=this._dataAdapter.data(),d=c.metrics.slice(),f=a&&"path"===a.type?a.data:c;d.length>1&&(d.length=1),this._setNodeMetricLabels(b,f,d,!1)},f._setNodeMetricLabels=function(a,b,c,d){var f=this,g=this._dataAdapter,h=g.data(),i=g.l10n.labels.sunburst,j=a.classed("pri-metric-labels")||a.classed("sunburst-cv-label-wrap"),k=a.selectAll(".sunburst-cv-label-metric").data(c);k.enter().append("div").classed("sunburst-cv-label-metric",!0);d=b&&b.children&&b.children.length&&this._lockedNode?d:!1,k.each(function(a,c){var k=e.select(this),l=f.getNodeValue(b,j?c:c+1),m=f.getNodeValue(h,j?c:c+1),n="percent"===a.format,o=g.isOther(b)&&!j||0===m,p=n?l:l/f.getNodeValue(h,j?c:c+1),q=j||c+1===g.getSecondaryMetricIndex(),r=d&&q,s=null!==l&&!n&&!o&&b!==h;k.classed("active",q);var t=k.selectAll(".sunburst-cv-label-icon").data([a]);t.enter().append("i"),t.each(function(b){e.select(this).attr("class","sunburst-cv-label-icon icon").classed(a.icon||(j?"donut":"stack"),!0)});var u=k.selectAll(".sunburst-cv-label-number").data([a]);u.enter().append("span").classed("sunburst-cv-label-number",!0),u.html(o?"":f._formatValue(a,l)).classed("hidden",o);var v=k.selectAll(".sunburst-cv-label-name").data([a]);v.enter().append("span").classed("sunburst-cv-label-name",!0).append("span"),v.select("span").html(s?i.percmetric.replace(/\{percent\}/i,f._formatNumber("percent",p)).replace(/\{metric\}/i,a.name):a.name);var w=f.getMetricMaskNum(j?c:c+1),x=v.selectAll(".sunburst-cv-label-marker").data([a]);x.enter().insert("svg",":first-child").classed("sunburst-cv-label-marker",!0).append("rect").attr("width",12).attr("height",12),x.classed("hidden",!r).select("rect").attr("style",null===w?"":"mask: url(#diagmask"+w+");"),k.on("click",j?null:function(){g.setSecondaryMetricIndex(c+1),f._secondaryMetricChanged()})}),k.exit().remove()},f._formatValue=function(a,b,c){if("time"!==a.format)return this._formatNumber(a.format,b);var d=b,e=this._dataAdapter,f=c?e.l10n.time.abbreviation:1===d?e.l10n.time.singular:e.l10n.time.plural,g=e.getTimeGranularity(d,!0);return this._formatNumber(a.format,d/g.divisor)+" "+f[g.gran]},f._setNodeMetricChart=function(a,b){function c(a,b){return 0===b||b===g.getSecondaryMetricIndex()}var f=this,g=this._dataAdapter,h=g.data(),i=f._getHiddenNodes(),j=b&&b.children||[],k=j.filter(function(a){return i.indexOf(a)<0}),l=[],m=[],n=[],o=[],p=[],q=[],r={x:l,y:m,fill:n,metric:o,format:q,node:p},s=h.metrics.slice(),t=s.filter(c),u=t.map(function(a){return a.name});k.reverse().forEach(function(a){var b;s.forEach(function(d,e){c(d,e)&&null!==(b=f.getNodeValue(a,e))&&(m.push(b),l.push(a.name),n.push(d.name),o.push(d.name),q.push(d.format),p.push(a))})});var v=!!m.length,w=a.selectAll(".info-pane-chart-svg").data([0]);if(w.enter().append("div").classed("info-pane-chart-svg",!0),w.exit().remove(),a.classed("hidden",!v),v){var x=15,y=25,z=.05,A=t.length,B=k.length,C=A*x+y,D=y/C,E=Math.ceil(A*B*x/(1-D));w.style("height",E+"px");var F=d.chart().layers([d.geom.bar().map("group","fill").set("fill",function(a,b){return f.getNodeColor(a.data.node)}).each("start",function(a,b){var c=f.getMetricMaskNum(u.indexOf(a.data.metric));e.select(this).attr("mask",null===c?"":"url(#diagmask"+c+")")}).on("click",function(a){f._selectChildFromRanked(a)}).dodgePadding(z),d.geom.text().map("label","y").map("group","fill").set("fill","#4b4b4b").textFormat(function(a,b){return a?f._formatValue({format:this.__data__.data.format},a,!0):""}).textAnchor("start").set("fill","#4b4b4b").dx(4).dy(5).on("click",function(a){f._selectChildFromRanked(a)})]).coord(d.coord.cartesian().flip(!0)).data(r).position("dodge").guide("x",d.guide.axis().tickDx(function(a,b){return e.select(this).select("span").node().offsetWidth}).tickDy(function(a,b){return-A*x/2-e.select(this).select("span").node().offsetHeight/2}).tickSize(0).tickAnchor("end")).guide("y",d.guide.axis().ticks(0).tickSize(0).tickFormat(function(a,b){return""})).map("x","x",d.scale.ordinal().padding(D)).width("100%").height(E).duration(400).padding({top:2,right:65}).parent(w.node());u.forEach(function(a,b){var c=d.scale.linear().lowerLimit(0);c.includeInDomain(function(a,c){return a.data.metric===u[b]}),F.map("y","y",c,b)}),F.render();var G=w.select("svg").selectAll("defs").data([0]);G.enter().append("defs");var H=[45],I=G.selectAll("pattern").data(H),J=I.enter().append("pattern").attr("id",function(a,b){return"diag"+b}).attr("patternUnits","userSpaceOnUse").attr("width","3").attr("height","3").attr("patternTransform",function(a,b){return"rotate("+a+" 2 2)"});J.append("rect").attr("x","0").attr("y","0").attr("width","3").attr("height","3").attr("style","fill:#fff;"),J.append("path").attr("d","M -1,0 l 10,0").attr("style","stroke:#222; fill:none; stroke-width: 3px;");var K=G.selectAll("mask").data(H);K.enter().append("mask").attr("id",function(a,b){return"diagmask"+b}).attr("x","0").attr("y","0").append("rect").attr("x","0").attr("y","0").attr("width","100%").attr("height","1").attr("style",function(a,b){return"stroke:none; fill:url(#diag"+b+")"}),G.selectAll("mask").selectAll("rect").attr("height",E)}else w.style("height","0px")},f._selectChildFromRanked=function(a){var b=this._lockedNode.data,c=a.data.x;if(b&&b.children&&b.children.length){var d,e,f=b.children.length,g=null;for(d=0;f>d;++d)if((e=b.children[d]).name===c){g=e;break}g&&this._lockNode({data:g,type:"path"})}},f._createRingMarker=function(a,b,c){var d,f,g,h=a.append("svg").classed("category-ring",!0),i=h.append("g").attr("transform","translate(12,12)"),j=parseInt(h.style("width"),10),k=j/2,l=2,m=1,n=k-l*b-m*(b-1);for(g=0;b>g;++g)d=n+(l+m)*g,f=d+l,i.append("path").classed("active",g===c).attr("d",e.svg.arc().innerRadius(d).outerRadius(f).startAngle(0).endAngle(2*Math.PI))},f._canZoomIn=function(a){var b=this._dataAdapter.data(),c=this._zoomedPath;return a!==b&&a!==c||a===b&&b!==c&&!!c},f._canZoomOut=function(a){return a===this._zoomedPath},f._getAncestorNodes=function(a){var b=[],c=a;if(!a)return b;for(;c.parent;)b.push(c),c=c.parent;return b.length||(b=[a]),b},f._hasAncestorNode=function(a,b){if(!a||!b||a.depth<b.depth||a===b)return!1;for(var c=a;c.parent;){if(c.parent===b)return!0;c=c.parent}return!1},f._getInfoPaneHeight=function(a){var b,c=0;return e.selectAll(a.node().childNodes).each(function(a,d){b=e.select(this),c+=parseInt(b.style("height"),10)+parseInt(b.style("padding-bottom"),10)+parseInt(b.style("padding-top"),10)}),c},f._updateLockedState=function(a){var b=this;b._eventMap["sunburst.locked"]&&b._eventMap["sunburst.locked"].call(this,a,b._dataAdapter.data())},f._updateMetricState=function(){var a=this,b=a._dataAdapter;a._eventMap["sunburst.metric"]&&a._eventMap["sunburst.metric"].call(this,b.getSecondaryMetricIndex(),b.getSecondaryMetricType(),b.data())},f._getExtraActions=function(a){var b=this;return b._eventMap["sunburst.actions"]?b._eventMap["sunburst.actions"].call(this,a,!!this._lockedNode,b._dataAdapter.data()):[]},f.getNodeValue=function(a,b){return a?a.metrics&&a.metrics.length&&a.metrics[b]&&"undefined"!=typeof a.metrics[b].value?a.metrics[b].value:b>0?null:"undefined"!=typeof a.size?a.size:a.value:0},f.getMetricCategoryMinMax=function(a,b){function c(g){if(!i||i.depth!==g.depth||i===g){if("undefined"==typeof b||g.depth===b+1){if(f.isOther(g))return;if(h.indexOf(g)>=0)return;var j=e.getNodeValue(g,a);if("undefined"==typeof d?d={min:j,max:j}:(d.min=Math.min(d.min,j),d.max=Math.max(d.max,j)),b)return}g.children&&g.children.length&&g.children.forEach(function(a){c(a)})}}var d,e=this,f=this._dataAdapter,g=f.data(),h=this._getHiddenNodes(),i=this._zoomedPath;return c(g),d||null},f.getNodeColor=function(a,b){var c,d=this._dataAdapter,e=this.getColorScale(a);return a.depth?(c=d.isOther(a)?d.otherColor():d.getColorMetric()?this.isOutsideRange(a)?d.outRangeColor():e(a.metrics[d.getColorMetricIndex()].value):e(a.name),b&&(c=this._grayColor(c,a)),c):d.metricColor()},f._grayColor=function(a,b){var c=this._dataAdapter;if(c.isOther(b))return c.otherGrayColor();var d=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,e=a&&a.match(d);if(!e)return a;var f=[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)],g=Math.round(.21*f[0]+.71*f[1]+.07*f[2]);return"#"+((1<<24)+(g<<16)+(g<<8)+g).toString(16).slice(1)},f.getMetricMaskNum=function(a){return 0===a?null:0},f.isOutsideRange=function(a){var b=this._dataAdapter,c=b.getColorMetric(),d=b.getColorMetricIndex();if(!c||!a||!a.metrics||"percent"!==c.format)return!1;var e=a.metrics[d].value;return e>this._colorExtentMax||e<this._colorExtentMin},f.getColorScale=function(a){var b,c=this._dataAdapter;return(b=c.getColorMetric())?"percent"===b.format?this._colorScale:this._categoryColorScales[a.depth-1]:this._colorScale},f._createColorScale=function(a,b,c,d){var f=this._dataAdapter,g=f.seqColors(),h=(b-c)*a[0]+c,i=(b-c)*a[1]+c,j=i-h,k=g.length-1;d&&(this._colorExtent=a,this._colorExtentMin=h,this._colorExtentMax=i);for(var l=[h],m=1;k>m;++m)l.push(j/k*m+h);return l.push(i),e.scale.linear().domain(l).range(g).clamp(!0)},f.setColorScale=function(a){a=a||[0,1];var b,c=this,d=this._dataAdapter,f=d.data();if(!(b=d.getColorMetric()))return void(this._colorScale=e.scale.ordinal().domain(d.uniques()).range(d.colors()));var g,h=d.getColorMetricIndex();return"percent"===b.format?(g=c.getMetricCategoryMinMax(h),void(this._colorScale=this._createColorScale(a,g.max,g.min,!0))):(g=f.categories.map(function(a,b){return c.getMetricCategoryMinMax(h,b)}),this._categoryColorScales=g.map(function(b,d){return c._createColorScale(a,b.max,b.min,!d)}),this._colorExtentMin=null,void(this._colorExtentMax=null))},a.cloudViz.sunburst=b.util.createConstructor(f)}(this),function(a){"use strict";var b=a.cloudViz||{},c=b.core||{},d=a.dv||{},e=a.d3||{},f=Object.create(c);f.init=function(a){return this._type="flower",this._initDefaultOptions(),this.setOptions(a),this.colorScale=d.scale.color()._d3Scale,this},f._initDefaultOptions=function(){var a={animationDuration:500,labelFormatter:null,clickHandler:null,onlyUseThreePetalLengths:!0,isEmotionChart:!0,mouseoverCallback:[null,null],horizontalPadding:70,verticalPadding:30,text_offset:5};return Object.getPrototypeOf(f)._initDefaultOptions.call(this,a)},f._onAutoResize=function(){this._render()},f.resize=function(){this._render()},f.reset=function(){Object.getPrototypeOf(f).reset.apply(this,arguments)},f._preRender=function(){Object.getPrototypeOf(f)._preRender.apply(this)},f._setUpLayer=function(a,b){this["layer"+b]=a.selectAll(".flower-cv-svg-group-layer"+b).data([0]),this["layer"+b].enter().append("g").classed("flower-cv-svg-group-layer"+b,!0)},f.sprintf=function(a,b){return a.replace(/\{([\w]+)\}/gi,function(a,c){return b[c]})},f._render=function(){Object.getPrototypeOf(f)._render.apply(this);var a=this;this._parent=e.select(this._options.parent);var b=this._parent.selectAll(".cv-wrapper.cv-flower").data([0]);b.enter().append("div").classed("cv-wrapper cv-flower",!0);var c=b.selectAll(".flower-cv-svg").data([0]);c.enter().append("svg").classed("flower-cv-svg",!0),this._svg_group=c.selectAll(".flower-cv-svg-group").data([0]),this._svg_group.enter().append("g").classed("flower-cv-svg-group",!0),this._setUpLayer(this._svg_group,1),this._setUpLayer(this._svg_group,2),this._setUpLayer(this._svg_group,3),this._setUpLayer(this._svg_group,4),this._setUpLayer(this._svg_group,5),this._setUpLayer(this._svg_group,6);var g=this._options.width||parseInt(this._parent.style("width"),10),h=this._options.height||parseInt(this._parent.style("height"),10);b.style("width",g+"px").style("height",h+"px");var i=g/2,j=h/2;this._svg_group.attr("transform",this.sprintf("translate({width},{height})",{width:i,height:j}));var k=a._dataAdapter.data(),l=i-this._options.horizontalPadding,m=j-this._options.verticalPadding,n=this._options.labelFormatter||function(b){b.append("tspan").attr("class","flower-cv-petal-label").text(function(a){return a.label+" "}),b.append("tspan").attr("class","flower-cv-petal-label-value").text(function(b){return a._formatNumber("percent",b.value/a._total,0)})},o=this._options.mouseoverCallback[0]||function(){e.select(this).attr("opacity",1)},p=this._options.mouseoverCallback[1]||function(a){e.select(this).attr("opacity",a.petal_opacity).attr("fill",a.petal_color)};this._is_single_mode=this._options.onlyUseThreePetalLengths,this._petal_size=Math.min(l,m),this._circle_size=.676*this._petal_size/2,this._arc_thickness=.027*this._petal_size,this._arc_half_angle=360/k.length/2+.5,this._petal_count=k.length;var q=e.scale.linear().domain([55,185]).range([9,12]).clamp(!0);this._font_size=q(this._petal_size);var r=[{offset_y:1,fixed_offset_y:0,offset_x:0,location:"middle"},{offset_y:1,fixed_offset_y:0,offset_x:-1.5,location:"middle"},{offset_y:0,fixed_offset_y:-2.5,offset_x:-.8,location:"start"},{offset_y:-1,fixed_offset_y:-9,offset_x:-1.5,location:"middle"},{offset_y:-1,fixed_offset_y:-9,offset_x:0,location:"middle"},{offset_y:-1,fixed_offset_y:-9,offset_x:1.5,location:"middle"},{offset_y:0,fixed_offset_y:-2.5,offset_x:.8,location:"end"},{offset_y:1,fixed_offset_y:0,offset_x:1.5,location:"middle"}];this._total=e.sum(k,function(a){return a.value});var s=e.scale.linear().domain([0,k.length]).range([0,360]);this._getTextOffsetIndex=e.scale.linear().domain([0,360]).rangeRound([0,8]).clamp(!0),this._getSizeZeroToThree=e.scale.linear().domain([0,e.max(k,function(a){
return a.value})]).rangeRound([0,3]),this._getPetalSize=e.scale.linear().domain([e.min(k,function(a){return a.value}),e.max(k,function(a){return a.value})]).rangeRound([this._circle_size+this._arc_thickness+10,this._petal_size]),d.util.each(k,function(b,c){b.angle=s(c),a._addPetalSizes(b)}),this._getTextOffsetScale=function(a){var b=this._getTextOffsetIndex(a);return 8==b&&(b=0),r[b]};var t=this.layer1.selectAll(".flower-cv-gray-petals").data(k);t.enter().append("path").attr("class","flower-cv-gray-petals").attr("transform",function(a){return"rotate("+a.angle+")"}).attr("d",a._makePetal(0,0,0,0)).attr("opacity",0),t.transition().duration(a._options.animationDuration).attr("transform",function(a){return"rotate("+a.angle+")"}).attr("d",function(b){return a._makePetal(0,0,0,b.full_petal)}).attr("opacity",function(a){return 3==a.petal_size_number?0:1}),t.exit().transition().duration(a._options.animationDuration).attr("d",a._makePetal(0,0,0,0)).attr("opacity",0).remove();var u=this.layer2.selectAll(".flower-cv-color-petals").data(k);u.enter().append("path").attr("class","flower-cv-color-petals").attr("transform",function(a){return"rotate("+a.angle+")"}).attr("opacity",function(a){return a.petal_opacity}).attr("d",a._makePetal(0,0,0,0)).attr("fill",function(a){return a.petal_color}).on("mouseover",o).on("mouseout",p).on("click",function(b){a._options.clickHandler&&a._options.clickHandler(b)}),u.transition().duration(a._options.animationDuration).attr("d",function(b){return a._makePetal(0,0,0,b.petal_size)}).attr("transform",function(a){return"rotate("+a.angle+")"}).attr("fill",function(a){return a.petal_color}).attr("opacity",function(a){return a.petal_opacity}),u.exit().transition().duration(a._options.animationDuration).attr("d",a._makePetal(0,0,0,0)).attr("opacity",0).remove();var v=this.layer3.selectAll(".flower-cv-white-arcs").data(k),w=e.svg.arc().innerRadius(0).outerRadius(this._circle_size+this._arc_thickness+1).startAngle(-a._arc_half_angle*(Math.PI/180)).endAngle(a._arc_half_angle*(Math.PI/180));v.enter().append("path").attr("class","flower-cv-white-arcs").attr("transform",function(a){return"rotate("+a.angle+")"}).attr("fill","white"),v.transition().duration(a._options.animationDuration).attr("d",w).attr("transform",function(a){return"rotate("+a.angle+")"}),v.exit().remove(),w=e.svg.arc().innerRadius(0).outerRadius(this._circle_size+this._arc_thickness).startAngle(-(a._arc_half_angle-1)*(Math.PI/180)).endAngle((a._arc_half_angle-1)*(Math.PI/180));var x=this.layer4.selectAll(".flower-cv-color-arcs").data(k);x.enter().append("path").attr("class","flower-cv-color-arcs").attr("d",w).attr("transform",function(a){return"rotate("+a.angle+")"}).attr("fill",function(a){return a.arc_color}),x.transition().duration(a._options.animationDuration).attr("d",w).attr("fill",function(a){return a.arc_color}).attr("transform",function(a){return"rotate("+a.angle+")"}),x.exit().remove();var y=this.layer5.selectAll(".flower-cv-petal-labels").data(k);y.enter().append("text").attr("class","flower-cv-petal-labels").attr("x",0).attr("y",0).attr("text-anchor",function(b){return a._getTextOffsetScale(b.angle).location}).attr("dx",function(b){return a._getTextOffsetScale(b.angle).offset_x*-a._options.text_offset}).attr("dy",function(b){return a._getTextOffsetScale(b.angle).offset_y*-a._options.text_offset-a._getTextOffsetScale(b.angle).fixed_offset_y}).style("font-size",a._font_size).attr("transform",function(a){return"rotate("+a.angle+") rotate("+-a.angle+", 0, 0)"}).attr("opacity",0),y.style("font-size",a._font_size+"px").attr("text-anchor",function(b){return a._getTextOffsetScale(b.angle).location}).attr("dx",function(b){return a._getTextOffsetScale(b.angle).offset_x*-a._options.text_offset}).attr("dy",function(b){return a._getTextOffsetScale(b.angle).offset_y*-a._options.text_offset-a._getTextOffsetScale(b.angle).fixed_offset_y}).selectAll("*").remove(),n(y),y.transition().duration(a._options.animationDuration).attr("y",function(a){return a.petal_size}).attr("transform",function(a){return"rotate("+a.angle+") rotate("+-a.angle+", 0, "+a.petal_size+")"}).attr("opacity",function(a){return 0===a.petal_number_size?0:1}),y.exit().remove();var z=this.layer6.selectAll(".flower-cv-main-circle").data([1]);z.enter().append("circle").attr("class","flower-cv-main-circle").attr("cx",0).attr("cy",0),z.transition().duration(a._options.animationDuration).attr("r",a._circle_size)},f._makePetal=function(a,b,c,d){var e=this._circle_size+this._arc_thickness+1,f=2*e*Math.PI/this._petal_count/2,g=f/(2*e*Math.PI)*360,h=Math.cos(g*Math.PI/180)*e,i=Math.sin(g*Math.PI/180)*e;b=-h;var j=a-i,k=a+i,l=-1*(d-b)*.6,m=-1*(d-b),n=.2*m,o=["M",j,b,"C",j-n,b-l,a,d,c,d,"C",c,d,k+n,b-l,k,b];return o.join(" ")},f._addPetalSizes=function(a){a.color||(a.color=this.colorScale(a.label));var b=this._getSizeZeroToThree(a.value);this._is_single_mode||0===b&&(b=1),0===a.value&&(b=0);var c=.9,d=a.color,e=d,f=this._petal_size,g=-1*f;switch(b){case 0:c=0,e="#e6e6e6",f=0,d=d;break;case 3:c=.9;break;case 2:c=.75,f=.795*f;break;case 1:c=.5,f=.6*f}this._is_single_mode||(f=this._getPetalSize(a.value)),0===a.value&&(f=0),f*=-1,a.petal_opacity=c,a.petal_size=f,a.petal_color=d,a.full_petal=g,a.petal_number_size=b,a.arc_color=e},a.cloudViz.flower=b.util.createConstructor(f)}(this),function(a){"use strict";var b=a.cloudViz||{},c=b.dvcore||{},d=a.dv||{},e=a.d3||{},f=Object.create(c);f.init=function(a){return Object.getPrototypeOf(f).init.apply(this,arguments),this._type="funnel",this._chart=d.chart(),this._avgColor="#b1b1b1",this},f._initDefaultOptions=function(){var a={averageSeries:null,averageSeriesLabel:null,disableAverage:!1,normalized:!0,formats:{x:"decimal",y:"decimal"},tooltipContent:null};return Object.getPrototypeOf(f)._initDefaultOptions.call(this,a)},f.reset=function(){Object.getPrototypeOf(f).reset.apply(this,arguments)},f._setChartTypeOptions=function(){var a=this._chart,b=this._options,c=this,f=this._dataAdapter,g=this._getPropMapping("series"),h=0,i=100,j=28,k=this._isNormalized()&&!f.isSingleSeries()?j:30,l=this._getChartWidth()-2*k,m=.05,n=f.getNumBarsPerStep(),o=f.getNumSteps(),p=o*(n+1)-1,q=Math.min(Math.max(h,l/p),i),r=f.isSingleSeries()?q/3:q,s=q>=36?12:q>=28?10:0,t=n*q+r,u=r/t,v=q===i?(l-(t*o-r))/2/t:0;this._stepWidth=n*q,this._stepPadding=r;var w=[d.geom.bar().data(f.currentStepData()).dodgePadding(m).each("start",function(a,b){e.select(this).attr("legend-group",a.fill)}),d.geom.bar().data(f.previousStepData()).dodgePadding(m).set("alpha",.15).each("start",function(a,b){e.select(this).attr("legend-group",a.fill)}),d.geom.text().data(f.textStepData()).each("start",function(a,b){e.select(this).attr("legend-group",a.group).classed("cv-funnel-text")}).map("label","cv_label").map("group",g).set("fill","#666").textAnchor("middle").dy(-5).textFormat(function(a){return c._formatNumber("percent",a)}).set("size",s)];if(f.isSingleSeries()&&w.splice(1,1),!b.interactive&&f.averageStepData()&&(!f.isAvgCalculated()||!f.isSingleSeries())){var x={x:[0],y:[0],cvfake:["cvfakeline"]};w.push(d.geom.line().data(x).map("stroke","cvfake",d.scale.color().values([this._avgColor])));var y=this._legend;a.guide("stroke",this._buildStandardLegend([f.averageDataLabel()])),this._legend=y}a.layers(w).data({}).map("fill",g,d.scale.color().values(b.colors)).map("x",this._getPropMapping("x"),d.scale.ordinal().padding(u).outerPadding(v).reverse(b.flip)).guide("fill",this._legend).position("dodge").padding(this._isNormalized()&&!f.isSingleSeries()?{left:k-j,right:k}:{left:k,right:k}),a._layers[0].on("click",this._eventMap.click?this._eventMap.click:null),this._addBehaviors(a.layers()[f.isSingleSeries()?0:1],b),this._mapPositionScales(a,b)},f._mapPositionScales=function(a,b){var c=this,d=[0,25],f=this._applyForceZero(this._constructScale("y")).rangePadding(d),g=this._getPropMapping("series"),h=this._getPropMapping("y"),i=c._dataAdapter;if(i.useAvgMaxValue()){var j=i.averageStepData(),k=e.extent(j[c._getPropMapping("y")])[1];f.upperLimit(function(a,b){var c=b>0?b:0;return k>c?k:c})}if(b.normalized){var l=c._dataAdapter.uniqueFillValues();l.forEach(function(b,d){var e=0===d?f:f.copy();e.includeInDomain(function(a,b){return a.data[g]===c._dataAdapter.uniqueFillValues()[d]}),d>0&&a.map("y",h,e,d)})}a.map("y",h,f,0)},f._addBehaviors=function(a,b){var c,f=e.select(b.parent),g=this._dataAdapter,h=this,i=g.l10n.labels.funnel;!this._isSmallChart()&&b.interactive&&a.behaviors([d.behavior.rollover().orientation(b.flip?"top":"right").content(function(a,c,d){if(b.tooltipContent)return b.tooltipContent.call(this,a,c,d);var e,f,j,k,l=(this.__geom.getExplicitScale("group"),a.panel.yScale(a)),m=h._yLabelFormat(l.scaleIndex()),n=a.data.cv_tt_val,o=a.data.cv_tt_pval,p=g.getStepName(a.x),q=g.isSingleSeries()&&g.isAvgCalculated()?null:g.averageStepData();q&&(k=g.averageDataLabel(),e=q[h._getPropMapping("x")].indexOf(a.x),f=q[h._getPropMapping("y")][e],j=q[h._getPropMapping("y")][e>0?e-1:0]);var r='<span class="cv-tooltip-content"><span class="cv-funnel-title">'+i.step+'</span><span class="cv-funnel-series-name">'+p+'</span><span class="cv-funnel-title">'+i.segment+'</span><span class="cv-funnel-metric-name">'+a.data[h._getPropMapping("seriesLabel")]+'</span><span class="cv-funnel-title">'+i.conversion+'</span><span class="cv-funnel-percent-value">'+h._formatYValue(o?n/o:0,"percent")+'</span><span class="cv-funnel-metric-value">'+m(n)+"</span>";return q&&(r+='<span class="cv-funnel-sub-title">'+k+'</span><span class="cv-funnel-percent-value">'+h._formatYValue(j?f/j:0,"percent")+'</span><span class="cv-funnel-metric-value">'+m(f)+"</span>"),r+='<span class="cv-funnel-title">'+i.fallout+'</span><span class="cv-funnel-percent-value">'+h._formatYValue(o?1-n/o:0,"percent")+'</span><span class="cv-funnel-metric-value">'+m(o-n)+"</span>",q&&(r+='<span class="cv-funnel-sub-title">'+k+'</span><span class="cv-funnel-percent-value">'+h._formatYValue(j?1-f/j:0,"percent")+'</span><span class="cv-funnel-metric-value">'+m(j-f)+"</span>"),r+"</span>"}).showTooltip(function(a,b,d,g,i){var j=e.select(this);j.classed("path-inactive")||(i._showTip.call(this,a,b,d,i),clearTimeout(c),f.selectAll(".bar-geom").classed("cv-medium-duration",!1).classed("cv-unselected",function(b){return a.x!==b.x||a.fill!==b.fill}),f.selectAll(".text-geom").classed("cv-medium-duration",!1).classed("cv-unselected",function(b){return a.x!==b.x||a.fill!==b.group}),f.selectAll(".cv-legend-marker").classed("cv-unselected",function(b){return b.id!==a.fill}).classed("cv-medium-duration",!1),f.selectAll(".avg-geom").classed("cv-unselected",!0).classed("cv-medium-duration",!1),h._eventMap.mouseover&&h._eventMap.mouseover.call(this,a,b,d,g))}).hideTooltip(function(a,b,d,g,i){var j=e.select(this);j.classed("path-inactive")||(i._removeTip.call(this,a,b,d,i),c=setTimeout(function(){f.selectAll(".bar-geom, .text-geom, .cv-legend-marker, .avg-geom").classed("cv-unselected",!1).classed("cv-medium-duration",!0),h._eventMap.mouseout&&h._eventMap.mouseout.call(this,a,b,d,g)},400))})])},f._getStepLabel=function(a,b){var c=this._dataAdapter,d=c.getSingleSeriesStepValue(a,b),e=c.getStepName(a),f='<div class="cv-funnel-step-label" style="width: '+Math.floor(this._stepWidth)+'px">';return"undefined"!=typeof d&&(f+='<span class="cv-funnel-step-label-value">'+this._yLabelFormat(0)(d)+"</span>"),f+='<span class="cv-funnel-step-label-name">'+e+"</span>",f+"</div>"},f._drawSmall=function(){this._drawLarge()},f._drawLarge=function(){var a=this._chart,b=(this._options,this),c=this._dataAdapter,e=d.guide.axis();if(e.htmlLabels(!0).tickSize(0).tickAnchor("middle").tickFormat(function(a,c){return b._getStepLabel(a,c)}).title(this._dataAdapter.xAxisTitle()),a.guide("x",e).guide("y","none"),!c.isSingleSeries()){var f=a.padding();this._checkNormalized(),a.padding(f)}},f._renderChart=function(){Object.getPrototypeOf(f)._renderChart.call(this),this._drawAllLine()},f._drawAllLine=function(){var a=this._chart,b=(this._options,this._dataAdapter),c=this._isNormalized(),d=a.getTrainedScale("x"),f=a.getTrainedScale("y"),g=b.averageStepData(),h=(b.mappings(),this._getPropMapping("series"),this._getPropMapping("seriesLabel"),this._getPropMapping("x")),i=this._getPropMapping("y"),j=Math.min(this._stepPadding/2,5),k=[];if(g){var l=b.getUniqueFillExtent(0)[1],m=e.extent(g[i])[1],n=c?l||m:Math.max(l,m),o=e.scale.linear().domain([0,m]).range([0,n]);g[h].forEach(function(a,b){var e=g[i][b],h=f.mapValue(c?o(e):e);k.push({x:d.mapValue(a)-j,y:h}),k.push({x:d.mapValue(a)+d.rangeBand()+j,y:h})})}var p=e.select(a.parent()).selectAll("svg").selectAll(".cv-funnel-avg-group").data([0]);p.enter().insert("g",".group").classed("cv-funnel-avg-group",!0);var q=p.selectAll(".avg-group-line").data([0]);q.enter().append("g").classed("avg-group-line series",!0);var r=p.selectAll(".avg-group-point").data([0]);r.enter().append("g").classed("avg-group-point series",!0);var s=e.svg.line().x(function(a){return a.x}).y(function(a){return a.y}),t=a.duration(),u=a.ease(),v=q.selectAll(".avg-line").data([k]);v.enter().append("path").classed("avg-line avg-geom",!0),v.attr("legend-group",b.averageSeries()).transition().duration(t).ease(u).attr("d",s).style("stroke",this._avgColor),v.exit().remove();var w=r.selectAll(".avg-dot").data(k);w.enter().append("circle").classed("avg-dot avg-geom",!0),w.attr("legend-group",b.averageSeries()).style("stroke",this._avgColor).transition().duration(t).ease(u).attr("cx",s.x()).attr("cy",s.y()).attr("r",3),w.exit().remove()},f._createSeriesStates=function(){if(Object.getPrototypeOf(f)._createSeriesStates.call(this),"data"in this._changedOptions&&this._changedOptions.data){var a=this._dataAdapter;this._seriesState.removeStatesByType("funnel-average"),a.averageStepData()&&this._seriesState.insertState(a.averageDataLabel(),a.averageSeries(),"funnel-average")}},f._updatePathStates=function(){Object.getPrototypeOf(f)._updatePathStates.call(this);var a=this,b=this._options,c=this._dataAdapter,d=c.averageSeries();e.select(b.parent).selectAll(".cv-funnel-avg-group .series [legend-group]").classed("path-inactive",function(){if(!b.interactive)return!1;var c=e.select(this),f=c.attr("legend-group");return f===d&&a._seriesState.doesSeriesStateExist(f,"funnel-average")?!a._seriesState.isSeriesEnabled(f,"funnel-average"):c.classed("path-inactive")})},f._isNormalized=function(){return this._options.normalized},a.cloudViz.funnel=b.util.createConstructor(f)}(this),function(a){"use strict";function b(a,b,e,f){return d(c(a,b,e,f))-d(e)-d(f)-Math.PI/2}function c(a,b,c,d){return c+a(b)*(d-c)}function d(a){return a*Math.PI/180}function e(a,b,c){return Math.max(b,Math.min(c,a))}function f(a,b,c){var d=[];if(c&&b.length>1){for(var e,f,h=g(a.domain()),i=-1,j=b.length,k=(b[1]-b[0])/++c;++i<j;)for(e=c;--e>0;)(f=+b[i]-e*k)>=h[0]&&d.push(f);for(--i,e=0;++e<c&&(f=+b[i]+e*k)<h[1];)d.push(f)}return d}function g(a){var b=a[0],c=a[a.length-1];return c>b?[b,c]:[c,b]}var h=a.cloudViz||{},i=h.core||{},j=a.dv||{},k=a.d3||{},l=Object.create(i),m=.15,n=.05,o=.09,p=1+n,q=.05,r=.025,s=2,t=14,u=.1,v=.75,w=null,x=null;l.init=function(a){return this._type="gauge",a=a||{},this._initDefaultOptions(),this.setOptions(a),this},l._initDefaultOptions=function(a){var b={duration:750,percentOpen:u,showNeedle:!0,showAxis:!0,ticks:5,tickSubdivisions:0,format:"decimal",fillColor:"#3284d4",minValue:0,maxValue:10,colors:[{color:"#ff3400",alpha:1,from:"0%",to:"33%"},{color:"#faca00",alpha:1,from:"33%",to:"66%"},{color:"#68b672",alpha:1,from:"66%",to:"100%"}],metric:"",value:0};return this._margins={top:0,left:0,right:0,bottom:0},Object.getPrototypeOf(l)._initDefaultOptions.call(this,b)},l.render=function(){return Object.getPrototypeOf(l).render.call(this,arguments),this._determineSize(),this._initScales(),this._draw(),this},l._onAutoResize=function(){this.render()},l._determineSize=function(a){var b=this._options,c=b.parent,d=b.width?b.width:c.offsetWidth,e=b.height?b.height:c.offsetHeight,f=Math.max(u,Math.min(v,b.percentOpen));b.showNeedle&&(this._margins.bottom=.05*e),this._maxAngle=180*(1-f),this._minAngle=-180*(1-f),d-=this._margins.left+this._margins.right,this._size=[d,e],this._radius=Math.min(d-this._margins.left-this._margins.right,e-this._margins.top-this._margins.bottom)/2},l._initScales=function(){var a=this._options;if(a.minValue>a.maxValue)throw new Error("The minimum value is greater than the maximum value.");this._scale=k.scale.linear().domain([a.minValue,a.maxValue]).range([0,1])},l._draw=function(){this._initSVG(),this._drawTrack(),this._drawAxis(),this._drawSelectedIndicator(),this._drawLabels()},l._initSVG=function(){var a=this._options,b=k.select(a.parent);w=b.selectAll(".cv-wrapper.cv-gauge").data([0]),w.enter().append("div").classed("cv-wrapper cv-gauge",!0),w.style("width",this._size[0]+"px").style("height",this._size[1]+"px");var c=w.selectAll(".chart-wrapper").data([0]);c.enter().append("div").classed("chart-wrapper",!0);var d=c.selectAll("svg").data([0]);d.enter().append("svg"),x=d.selectAll("g").data([0]),x.enter().append("g"),x.attr("transform","translate("+(this._size[0]-this._margins.left-this._margins.right)/2+","+(this._size[1]-this._margins.top-this._margins.bottom)/2+")")},l._drawTrack=function(){var a=this,b=this._options,c=k.svg.arc().innerRadius(this._radius*(1-n-m)).outerRadius(this._radius*(1-n)).startAngle(function(b,c){var e=j.util.isPercentString(b.from)?parseInt(b.from,10)/100:a._scale(b.from),f=(a._maxAngle-a._minAngle)*e+a._minAngle;return d(f)}).endAngle(function(b,c){var e=j.util.isPercentString(b.to)?parseInt(b.to,10)/100:a._scale(b.to),f=(a._maxAngle-a._minAngle)*e+a._minAngle;return d(f)}),e=x.selectAll(".arc").data([0]);e.enter().append("g").classed("arc",!0);var f=e.selectAll("path").data(b.colors);f.enter().append("path"),f.exit().remove(),f.attr("fill",function(a,b){return a.color}).attr("opacity",function(a,b){return a.hasOwnProperty("alpha")?a.alpha:1}).attr("d",c)},l._drawAxis=function(){var a=this,d=this._options,g=this._scale.ticks(d.ticks),h=function(b,d,e,f){return function(g){g.attr("x1",0).attr("y1",s).attr("x2",0).attr("y2",a._radius*f+s).attr("transform",function(f){c(b,f,d,e);return"rotate("+c(b,f,d,e)+") translate(0,"+(a._radius*(m+n)-a._radius)+")"})}},i=x.selectAll(".axis").data(d.showAxis?[0]:[]);i.enter().append("g").classed("axis",!0),i.exit().remove();var j=i.selectAll(".tick").data(g);j.enter().append("line").classed("tick",!0),j.exit().remove(),j.call(h(this._scale,this._minAngle,this._maxAngle,q));var k=f(this._scale,g,d.tickSubdivisions),l=i.selectAll(".minor-tick").data(k);l.enter().append("line").classed("minor-tick",!0),l.exit().remove(),l.call(h(this._scale,a._minAngle,a._maxAngle,r));var o=i.selectAll(".tick-label").data(g);o.enter().append("text").classed("tick-label",!0),o.exit().remove(),o.attr("transform",function(d){var e=c(a._scale,d,a._minAngle,a._maxAngle),f=b(a._scale,d,a._minAngle,a._maxAngle),g=(a._radius-t)*(1-m-n-q),h=Math.cos(f)*g,i=Math.sin(f)*g;return-10>e&&e>-170&&(h-=3),e>10&&170>e&&(h+=3),"translate("+h+","+i+")"}).attr("text-anchor",function(b){var d=c(a._scale,b,a._minAngle,a._maxAngle);return d>-10&&10>d?"middle":0>d?null:"end"}).attr("dy",".35em").style("font-size",e(.05*a._radius,8,14)+"px").text(function(b){return a._formatNumber(d.format,b)})},l._drawSelectedIndicator=function(){var a=this._options;this._drawNeedle(a.showNeedle?[a.value]:[]),this._drawProgressFill(a.showNeedle?[]:[a.value])},l._drawNeedle=function(a){var b=this,d=this._options,e=this._radius*o/2,f=this._radius*p,g=x.selectAll(".needle").data(a);g.enter().append("path").classed("needle",!0).attr("transform","rotate("+b._minAngle+")"),g.exit().remove(),g.attr("d","M"+e/2+"-"+e+"L0-"+f+"L-"+e/2+"-"+e+"C-"+.8257*e+"-"+.8212*e+"-"+1.035*e+"-"+e/2*.9448+"-"+1.035*e+"-1C-"+1.035*e+","+e/2*.9078+"-"+.5796*e+","+.9314*e+",0,"+.9314*e+"S"+1.035*e+","+e/2*.9078+","+1.035*e+"-1C"+1.035*e+"-"+e/2*.9448+","+.8257*e+"-"+.8212*e+","+e/2+"-"+e+"z").transition().duration(d.duration).ease("cubic-in-out").attrTween("transform",function(a){var e=this,f=Math.min(d.maxValue,Math.max(d.minValue,a)),g=c(b._scale,f,b._minAngle,b._maxAngle),h=void 0===this.__previousD__?b._minAngle:this.__previousD__,i=k.interpolate(h,g);return function(a){return e.__previousD__=i(a),"rotate("+e.__previousD__+")"}})},l._drawProgressFill=function(a){var b=this,e=this._options,f=k.svg.arc().innerRadius(this._radius*(1-n-m)).outerRadius(this._radius*(1-n)).startAngle(d(b._minAngle)).endAngle(function(a){return d(c(b._scale,a,b._minAngle,b._maxAngle))}),g=x.selectAll(".progress").data(a);g.enter().append("path").classed("progress",!0),g.exit().remove(),g.attr("fill",e.fillColor).transition().duration(e.duration).attrTween("d",function(a){var b=this,c=Math.min(e.maxValue,Math.max(e.minValue,a)),d=void 0===this.__previousD__?e.minValue:this.__previousD__,g=k.interpolate(d,c);return function(a){return b.__previousD__=g(a),f(b.__previousD__)}})},l._drawLabels=function(){var a=this,c=this._options,d=void 0===c.value?[]:[c.value],f=void 0===c.metric?[]:[c.metric],g=b(this._scale,c.minValue,this._minAngle,this._maxAngle),h=b(this._scale,c.maxValue,this._minAngle,this._maxAngle),i=this._radius*(1-m-n),j=(this._radius-t)*(1-m-n-q),k=Math.cos(g)*j+this._radius,l=Math.cos(h)*j+this._radius,o=Math.sin(g)*i+this._radius,p=w.selectAll(".label-container").data([0]);p.enter().append("div").classed("label-container",!0),p.style("left",this._size[0]/2-this._radius+"px");var r=p.selectAll(".label-title").data(f);r.enter().append("span").classed("label-title",!0),r.exit().remove(),r.style("font-size",e(.1*this._radius,11,18)+"px").classed("multiline-ellipsis",!c.showNeedle).text(String);var s=p.selectAll(".label-number").data(d),u=Math.max(o,1.1*this._radius);if(s.enter().append("span").classed("label-number",!0).style("line-height",this._radius*m+"px"),s.exit().remove(),s.style("left",k+"px").style("width",l-k+"px").style("font-size",this._radius*m+"px").text(function(b){return a._formatNumber(c.format,b)}),c.showNeedle)r.style("top",u+.2*this._radius+"px").style("left",0).style("width",2*this._radius+"px"),s.style("top",u+"px");else{var v=2.3*e(.1*this._radius,11,20),x=this._radius*(1-n);r.style("top",x+"px").style("left",this._radius*(m+n+q+.3)+"px").style("width",this._radius*(1-m-n-q-.3)*2+"px").style("height",v+"px"),s.style("top",Math.max(x+v,u)+"px")}},a.cloudViz.gauge=h.util.createConstructor(l)}(this),function(a){"use strict";function b(a){return"<span class='series-name'>"+a.parent.name+"</span><span class='metric-value'>"+a.value+"</span><span class='metric-name'>"+a.name+"</span>"}function c(a){a.style("left",function(a){return s(a.x)+1+"px"}).style("top",function(a){return a.children&&!a.parent?0:t(a.y)+1-o+"px"}).style("width",function(a){return s(a.x+a.dx)-s(a.x)-2+"px"}).style("height",function(a){return a.children?null:t(a.y+a.dy)-t(a.y)-2+"px"})}function d(a){a.style("background-color",function(a){return a.children||!a.parent?null:u(a.parent.name)})}var e,f,g,h=a.cloudViz||{},i=h.core||{},j=a.dv||{},k=a.d3||{},l=Object.create(i),m=0,n=0,o=25,p=0,q=0,r=0,s=k.scale.linear(),t=k.scale.linear(),u=k.scale.ordinal(),v=!0;l.init=function(a){return this._type="treemap",a=a||{},this._initDefaultOptions(),this.setOptions(a),this},l._initDefaultOptions=function(a){var c={colors:["#8cc350","#5a6eaa","#d755a5","#1ebed7","#f0a01e","#9b8ce6","#3cb5a0","#3287d2","#f0557d","#c3d250","#eb782d","#78b4f5","#5faf69","#aa5fa5","#fa5a50","#f5c841"],layout:"squarify",duration:750,tooltipContent:b};return Object.getPrototypeOf(l)._initDefaultOptions.call(this,c)},l.reset=function(){},l._preRender=function(){this._determineSize(this._options.data),this._configureScales(this._options.data),this._configureLayout()},l._render=function(){return this._initContainer(),this._draw(this._options.data),v=!1,this},l._postRender=function(){},l._determineSize=function(a){var b=this._options,c=b.parent;m=j.util.getPercentValue(b.width,c.offsetWidth),n=j.util.getPercentValue(b.height,c.offsetHeight)},l._configureScales=function(a){var b=this._options;u.domain(a.map(function(a){return a.name})).range(b.colors);var c=a.hasOwnProperty("dx")?[a.x,a.x+a.dx]:[0,m],d=a.hasOwnProperty("dy")?[a.y,a.y+a.dy]:[0,n];s.domain(c).range([1,m-2]),t.domain(d).range([1,n-2])},l._configureLayout=function(){g=k.layout.treemap().sticky(!0).value(function(a){return a.value||0}).sort(function(a,b){return a.value-b.value}).mode(this._options.layout).round(!1)},l._initContainer=function(){var a=this._options,b=k.select(a.parent).selectAll(".cv-wrapper.cv-treemap").data([0]);b.enter().append("div").classed("cv-wrapper cv-treemap",!0),e=b.selectAll(".chart-wrapper").data([0]),e.enter().append("div").classed("chart-wrapper",!0).style("position","relative"),e.style("width",m+"px").style("height",n+"px"),f=e.selectAll(".node-container").data([0]),f.enter().append("div").classed("node-container",!0).style("overflow","hidden"),f.style("width",m+"px").style("height",n+"px")},l._draw=function(a){var b,h=this,i=this._options,l={children:this._options.data},s=g.size([m,n+o]).padding([o,p,r,q]).nodes(l),t=(s.filter(function(a){return!a.children}),s.filter(function(a){return a.parent&&a.children}),f.selectAll(".cv-node").data(s)),u=t.enter().append("div").classed("cv-node",!0).on("click",function(a,c){if(a.depth>0){var d=(k.select(this),[]);if(a.children){d=f.selectAll(".second-level").filter(function(b){return a.children.indexOf(b)>=0}),d[0].push(this);var e=f.selectAll(".cv-node.selected"),g=[];g=e[0].indexOf(this)>=0?e[0].filter(function(a){var b=d[0].indexOf(a)>=0;return!b}):d[0].concat(e[0]),d[0]=g,h._selectNodes(d)}else{d=f.selectAll(".cv-node.selected");var i,j=d[0].indexOf(this);if(j>=0){d[0].splice(j,1),i=h._getParentNode(this);var l=d[0].indexOf(i);l>=0&&(b=0,i.__data__.children.forEach(function(a){d.each(function(c){c==a&&b++})}),i.__data__.children.length-1===b&&d[0].splice(l,1))}else d[0].push(this),i=h._getParentNode(this),b=0,i.__data__.children.forEach(function(a){d.each(function(c){c==a&&b++})}),i.__data__.children.length===b&&d[0].push(i);h._selectNodes(d)}h._eventMap.click&&h._eventMap.click.call(this,a,c,k.event)}}).on("mouseover",function(a,b){if(!a.children){var c=k.select(this),d={x:a.x+a.dx/4,y:a.y+a.dy/2-o,width:a.dx/2,height:a.dy/2},f={x:0,y:0,width:e.node().getBoundingClientRect().width,height:e.node().getBoundingClientRect().height},g=null;c.classed("hovered",!0),g=i.tooltipContent.call(this,a,b),j.showTooltip(d,f,g,"top",5,e),h._eventMap.mouseover&&h._eventMap.mouseover.call(this,a,b,k.event)}}).on("mouseout",function(a,b){if(!a.children){var c=k.select(this);c.classed("hovered",!1),j.removeTooltip(e),h._eventMap.mouseout&&h._eventMap.mouseout.call(this,a,b,k.event)}});u.append("div"),u.call(c).call(d),t.exit().remove(),t.classed("root-level",function(a){return a.depth===l.depth}).classed("first-level",function(a){return a.depth===l.depth+1}).classed("second-level",function(a){return a.depth===l.depth+2}).call(d).call(c),t.select("div").text(function(a){var b=a.hasOwnProperty("name")&&a.parent===l?a.name:null,c=a.hasOwnProperty("label")&&a.parent===l?a.label:null;return c||b}).style("opacity",function(a){return a.dx<50||a.dy<25?0:1})},l._selectNodes=function(a){var b=f.selectAll(".cv-node.selected");b.classed("selected",!1),a.classed("selected",!0)},l._getParentNode=function(a){var b,c=k.select(this._options.parent).selectAll(".first-level");return c[0].forEach(function(c){c.__data__.children.indexOf(a.__data__)>=0&&(b=c)}),b},l.setSelected=function(a){var b=this,c=k.select(this._options.parent).selectAll(".second-level").filter(a);return c[0].forEach(function(a){var d=b._getParentNode(a),e=0;d&&(d.__data__.children.forEach(function(a){c.each(function(b){b==a&&e++})}),d.__data__.children.length===e&&c[0].push(d))}),b._selectNodes(c),b},l.getSelected=function(){var a=[],b=f.selectAll(".second-level.cv-node.selected");return b&&b[0].forEach(function(b){a.push(b.__data__)}),a},a.cloudViz.treemap=h.util.createConstructor(l)}(this),function(a){"use strict";function b(a,b,c){if(!a.sprite){n.clearRect(0,0,(k<<5)/m,l/m);var d=0,e=0,f=0,g=0,h=0,i=b.length;for(--c;++c<i;){if(a=b[c],n.save(),n.font=a.style+" "+a.weight+" "+~~((a.size+1)/m)+"px "+a.font,f=n.measureText(a.text+"m").width*m,g=a.size<<1,a.rotate){var o=Math.sin(a.rotate*j),p=Math.cos(a.rotate*j),q=f*p,r=f*o,s=g*p,t=g*o;f=Math.max(Math.abs(q+t),Math.abs(q-t))+31>>5<<5,g=~~Math.max(Math.abs(r+s),Math.abs(r-s))}else f=f+31>>5<<5;if(g>h&&(h=g),d+f>=k<<5&&(d=0,e+=h,h=0),e+g>=l)break;n.translate((d+(f>>1))/m,(e+(g>>1))/m),a.rotate&&n.rotate(a.rotate*j),n.fillText(a.text,0,0),a.padding&&(n.lineWidth=2*a.padding,n.strokeText(a.text,0,0)),n.restore(),a.width=f,a.height=g,a.xoff=d,a.yoff=e,a.x1=f>>1,a.y1=g>>1,a.x0=-a.x1,a.y0=-a.y1,a.hasText=!0,d+=f}for(var u=n.getImageData(0,0,(k<<5)/m,l/m).data,v=0,w=[];--c>=0;)if(a=b[c],a.hasText){f=a.width;var x=f>>5;for(g=a.y1-a.y0,v=0;g*x>v;v++)w[v]=0;if(d=a.xoff,null==d)return;e=a.yoff;for(var y=0,z=-1,A=0;g>A;A++){for(v=0;f>v;v++){var B=x*A+(v>>5),C=u[(e+A)*(k<<5)+(d+v)<<2]?1<<31-v%32:0;w[B]|=C,y|=C}y?z=A:(a.y0++,g--,A--,e++)}a.y1=a.y0+z,a.sprite=w.slice(0,(a.y1-a.y0)*x)}}}function c(a,b,c){c>>=5;for(var d,e=a.sprite,f=a.width>>5,g=a.x-(f<<4),h=127&g,i=32-h,j=a.y1-a.y0,k=(a.y+a.y0)*c+(g>>5),l=0;j>l;l++){d=0;for(var m=0;f>=m;m++)if((d<<i|(f>m?(d=e[l*f+m])>>>h:0))&b[k+m])return!0;k+=c}return!1}function d(a,b){var c=a[0],d=a[1];b.x+b.x0<c.x&&(c.x=b.x+b.x0),b.y+b.y0<c.y&&(c.y=b.y+b.y0),b.x+b.x1>d.x&&(d.x=b.x+b.x1),b.y+b.y1>d.y&&(d.y=b.y+b.y1)}function e(a,b){return a.x+a.x1>b[0].x&&a.x+a.x0<b[1].x&&a.y+a.y1>b[0].y&&a.y+a.y0<b[1].y}function f(a){var b=a[0]/a[1];return function(a){return[b*(a*=.1)*Math.cos(a),a*Math.sin(a)]}}function g(a){var b=4,c=b*a[0]/a[1],d=0,e=0;return function(a){var f=0>a?-1:1;switch(Math.sqrt(1+4*f*a)-f&3){case 0:d+=c;break;case 1:e+=b;break;case 2:d-=c;break;default:e-=b}return[d,e]}}function h(a){for(var b=[],c=-1;++c<a;)b[c]=0;return b}d3.wordcloud=function(){function a(a,b,d){for(var f,g,h,i=([{x:0,y:0},{x:q[0],y:q[1]}],b.x),j=b.y,k=Math.sqrt(q[0]*q[0]+q[1]*q[1]),l=n(q),m=Math.random()<.5?1:-1,o=-m;(f=l(o+=m))&&(g=~~f[0],h=~~f[1],!(Math.min(g,h)>k));)if(b.x=i+g,b.y=j+h,!(b.x+b.x0<0||b.y+b.y0<0||b.x+b.x1>q[0]||b.y+b.y1>q[1])&&(!d||!c(b,a,q[0]))&&(!d||e(b,d))){for(var p,r=b.sprite,s=b.width>>5,t=q[0]>>5,u=b.x-(s<<4),v=127&u,w=32-v,x=b.y1-b.y0,y=(b.y+b.y0)*t+(u>>5),z=0;x>z;z++){p=0;for(var A=0;s>=A;A++)a[y+A]|=p<<w|(s>A?(p=r[z*s+A])>>>v:0);y+=t}return delete b.sprite,!0}return!1}var f,g,i,j,k,l,m,n,p={},q=[256,256],r=[0,90],s=1/0,t=d3.dispatch("word","end"),u=null,v=d3.scale.category20();return p.draw=function(){k=p.createSVGContainer();var a=l.append("g").attr("transform","translate("+[q[0]/2,q[1]/2]+")").selectAll("text").data(f);a.enter().append("text").attr("transform",function(a){return"translate("+[a.x,a.y]+")rotate("+a.rotate+")"}).style("fill",function(a,b){return v(b)}).attr("text-anchor","middle").style("font-size",function(a){return a.size+"px"}).style("font-family",function(a){return a.font}).text(function(a){return a.text})},p.start=function(){function c(){for(var c,h=+new Date;+new Date-h<s&&++j<i&&u;)c=f[j],c.x=q[0]*(Math.random()+.5)>>1,c.y=q[1]*(Math.random()+.5)>>1,b(c,f,j),c.hasText&&a(e,c,g)&&(k.push(c),t.word(c),g?d(g,c):g=[{x:c.x+c.x0,y:c.y+c.y0},{x:c.x+c.x1,y:c.y+c.y1}],c.x-=q[0]>>1,c.y-=q[1]>>1);j>=i&&(p.stop(),t.end(k,g))}var e=h((q[0]>>5)*q[1]),g=null,i=f.length,j=-1,k=[];return f.forEach(function(a,b){a.font=m.fontFamily,a.style="normal",a.weight="normal",m.allowIntermediateAngles?a.rotate=Math.random()*(r[1]-r[0])+r[0]:a.rotate=~~(2*Math.random())*(r[1]-r[0])-r[0],a.padding=m.padding}),f.sort(function(a,b){return b.size-a.size}),u&&clearInterval(u),u=setInterval(c,0),c(),p},p.stop=function(){return u&&(clearInterval(u),u=null),p},p.timeInterval=function(a){return arguments.length?(s=null==a?1/0:a,p):s},p.createSVGContainer=function(){return i=d3.select(g),j=i.selectAll(".cv-wordcloud").data([f]),j.enter().append("div").classed("cv-wordcloud",!0),
j.style("width",q[0]+"px").style("height",q[1]+"px"),l=j.selectAll("svg").data([f]),l.enter().append("svg").attr("width","100%").attr("height","100%"),l.exit().remove(),l},p.data=function(a){return arguments.length?(f=a,p):f},p.parent=function(a){return arguments.length?(g=a,p):g},p.size=function(a){return arguments.length?(q=[+a[0],+a[1]],p):q},p.options=function(a){return arguments.length?(m=a,n=o[m.spiral+""]||m.spiral,p):m},p.rotateRange=function(a){return arguments.length?(r=a,p):r},p.setCallback=function(a,b){return p.on(a,b),p},d3.rebind(p,t,"on")};var i,j=Math.PI/180,k=64,l=2048,m=1;i=document.createElement("canvas"),i.width=1,i.height=1,m=Math.sqrt(i.getContext("2d").getImageData(0,0,1,1).data.length>>2),i.width=(k<<5)/m,i.height=l/m;var n=i.getContext("2d");n.fillStyle=n.strokeStyle="red",n.textAlign="center";var o={archimedean:f,rectangular:g};d3.wordcloud.gradIdCounter=0}(this),function(a){"use strict";var b=a.cloudViz||{},c=b.dvcore||{},d=a.dv||{},e=a.d3||{},f=Object.create(c);f.init=function(a){return Object.getPrototypeOf(f).init.apply(this,arguments),this._type="wordcloud",this._chart=d.chart(),a=a||{},this._initDefaultOptions(),this.setOptions(a),this._initWordcloud(),this},f._initDefaultOptions=function(){var a={fontFamily:"Impact",spiral:"archimedean",size:[800,400],rotateRange:[0,0],allowIntermediateAngles:!1,padding:1};return Object.getPrototypeOf(f)._initDefaultOptions.call(this,a)},f._initWordcloud=function(){this._wordcloud=e.wordcloud()},f._render=function(){this._configure()},f._configure=function(){var a=this._options;a.data=this._dataAdapter.data(),this._wordcloud.data(a.data).parent(a.parent).options(a).size(a.size).rotateRange(a.rotateRange).setCallback("end",this._wordcloud.draw).start()},a.cloudViz.wordcloud=b.util.createConstructor(f)}(this),function(a){"use strict";var b=a.cloudViz,c=a.dv,d=b.util.namespace("cloudViz.dataAdapter.standard"),e={};e._isDataValid=null,e.process=function(a,c){this._options=a,this.l10n=b.util.deepExtend({},b.localeDefinition(a.locale),a.l10n||{}),("data"in c||"mappings"in c)&&this._validateData(a.data,a.mappings)&&this._processOptions(a,c)},e._processOptions=function(a,b){},e._determineOvertime=function(a){var b=this.mappings(),d=a[b.x];return d&&d.length?c.util.isDate(d[0])||/^(\d{4}|[+\-]\d{6})(?:-(\d{2})(?:-(\d{2}))?)?(?:T(\d{2}):(\d{2})(?::(\d{2})(?:\.(\d{3}))?)?(?:(Z)|([+\-])(\d{2})(?::(\d{2}))?)?)?$/.test(d[0]):!1},e._calculateDateGranularity=function(a){var b=this.mappings(),c=a[b.x];if(!c||!c.length)return"*";c=c.map(function(a){return new Date(a)});var d=Math.min.apply(Math,c),e=Math.max.apply(Math,c),f=(e-d)/1e3,g=f/c.length;return this.getTimeGranularity(g).gran},e.getTimeGranularity=function(a,b){var c="second",d=1;return a?(b?a>=(d=31536e3)?c="year":a>=(d=2678400)?c="month":a>=(d=604800)?c="week":a>=(d=86400)?c="day":a>=(d=3600)?c="hour":a>=(d=60)?c="minute":(c="second",d=1):a<=(d=1)?c="second":a<=(d=60)?c="minute":a<=(d=3600)?c="hour":a<=(d=86400)?c="day":a<=(d=604800)?c="week":a<=(d=2678400)?c="month":(c="year",d=31536e3),{gran:c,divisor:d}):{gran:c,divisor:d}},e._getYTitleFromLabels=function(a){var b=c.util.uniq(a);return b&&1===b.length?b[0]:null},e.data=function(){return this._options.data},e.mappings=function(){return this._options.mappings},e.formats=function(){return this._options.formats},e.xAxisTitle=function(){return this._options.xAxisTitle||null},e.yAxisTitle=function(){return this._options.yAxisTitle||null},e.dateGranularity=function(){return this._processedOptions.dateGranularity},e.isDataValid=function(){return this._validateData(this._options.data,this._options.mappings)},e._validateData=function(a,b){if(!a)return!1;for(var c in a)if(a[c].length)return!0;return!1},d.baseObj=e,d.base=b.util.createConstructor(e)}(this),function(a){"use strict";var b=a.cloudViz,c=b.util.namespace("cloudViz.dataAdapter.standard"),d=Object.create(c.baseObj);d._processOptions=function(a,b){var c=this._processedOptions=Object.create(a),e=this.data(),f=this.mappings();null==c.isOvertime&&(c.isOvertime=this._determineOvertime(e),c.isOvertime&&(c.dateGranularity=c.dateGranularity||this._calculateDateGranularity(e))),this._uniqueFillValues=this._processUniqueFillValues(e,f),this._uniqueFillExtents=this._processUniqueFillExtents(e,f,this._uniqueFillValues),this._uniqueXValues=this._processUniqueXValues(e,f,c.isOvertime),Object.getPrototypeOf(d)._processOptions.call(this,c,b)},d.isOvertime=function(){return this._processedOptions.isOvertime},d.uniqueFillValues=function(){return this._uniqueFillValues||[]},d.uniqueFillExtents=function(){return this._uniqueFillExtents},d.uniqueXValues=function(){return this._uniqueXValues||[]},d.getUniqueFillExtent=function(a){var b=this._uniqueFillValues[a];return b?this._uniqueFillExtents[b]:null},d.getUniqueFillExtentByFill=function(a){return this._uniqueFillExtents[a]},d._processUniqueFillValues=function(a,b){var c=a[b.series];return c?dv.util.uniq(c):[]},d._processUniqueFillExtents=function(a,b,c){var d=a[b.series],e=a[b.y],f={};return e.map(function(a,b){var c=d[b];isFinite(a)&&null!==a&&(f[c]||(f[c]=[a,a]),f[c][0]=Math.min(a,f[c][0]),f[c][1]=Math.max(a,f[c][1]))}),f},d._processUniqueXValues=function(a,b,c){if(c)return[];var d=a[b.x];return d?dv.util.uniq(d):[]},c.barObj=d,c.bar=b.util.createConstructor(d)}(this),function(a){"use strict";var b=a.cloudViz,c=b.util.namespace("cloudViz.dataAdapter.standard"),d=Object.create(c.baseObj);a.d3||{};d._processOptions=function(a,b){Object.getPrototypeOf(d)._processOptions.apply(this,arguments)},d._validateData=function(a,b){return a?!0:!1},d.data=function(){return this._options.data},d.metric=function(){return this._options.metric},d.format=function(){return this._options.format},c.choroplethObj=d,c.choropleth=b.util.createConstructor(d)}(this),function(a){"use strict";var b=a.cloudViz,c=b.util.namespace("cloudViz.dataAdapter.standard"),d=Object.create(c.barObj);d._processOptions=function(a,b){this._processCategories(a),Object.getPrototypeOf(d)._processOptions.call(this,this._processedOptions,b)},d._processCategories=function(a){var b,c,d,e=Object.create(a),f=Object.create(a.data),g=a.mappings,h=g.y,i=g.x,j=g.series,k=g.seriesLabel||j,l=[],m=f[h].length,n=[],o=[],p={};for(b=0;m>b;++b){l[b]={};for(c in f){if(d=f[c][b],c===j)if(n.length){if(d!==n[n.length-1]){if(n.length===this.maxFacets){m--,b--,l.pop();break}n[n.length]=d,o[o.length]=f[k][b],p[d]=n.length}}else n=[d],o=[f[k][b]],p[d]=n.length;l[b][c]=d}}this.numFacets=n.length,l.sort(function(a,b){return a[j]===b[j]?b[h]-a[h]:p[a[j]]-p[b[j]]});for(c in f)f[c]=[];f.cvdonutorder=[];var q,r,s=0,t=this._options.maxSlices;for(this.otherIncluded=!1,b=0,m=l.length;m>b;++b)if(r=l[b][j],r!==q&&(s=0,q=r),s==t-1&&m>b+1&&l[b+1][j]===r){for(c in f)f[c]||(f[c]=[]),f[c][b]=l[b][c];this.otherIncluded=!0,f[i][b]=this.l10n.labels.core.other,++s,f.cvdonutorder[b]=b}else if(s>=t)f[h][b-1]+=l[b][h],l.splice(b,1),m=l.length,--b,++s;else{++s;for(c in f)f[c][b]=l[b][c];f.cvdonutorder[b]=b}e.yAxisTitle=a.yAxisTitle||o,e.data=f,this._processedOptions=e},d.processLabelData=function(a){var b=this.data(),c=this.mappings(),d=this._labelData=Object.create(b),e={},f={},g=d[c.series],h=d[c.y],i=d[c.x];g.forEach(function(b,c){void 0===e[b]&&(e[b]=0),void 0===f[b]&&(f[b]=0),e[b]+=h[c],(!a.isSeriesEnabled||a.isSeriesEnabled(i[c]))&&(f[b]+=h[c])});var j,k,l,m,n=d.cvtextvalue=[],o=d.cvtextperclabel=[],p=d.cvtextvallabel=[],q={};h.forEach(function(b,c){j=g[c],k=parseFloat(b)/e[j]*100,p[c]=b,o[c]=(k%1!==0?k.toFixed(1):k)+"%",m=!a.isSeriesEnabled||a.isSeriesEnabled(i[c]),l=parseFloat(b)/f[j]*100,void 0===q[j]&&(q[j]=0),n[c]=m?q[j]+l/2:0,q[j]+=m?l:0})},d.data=function(){return this._processedOptions.data},d.labelData=function(){return this._labelData},d.yAxisTitle=function(a){var b=this._processedOptions.yAxisTitle;return b instanceof Array&&b.length>a&&(b=b[a]),b},d.showOtherCategory=function(){return this.otherIncluded},d.numberOfFacets=function(){return this.numFacets},c.donutObj=d,c.donut=b.util.createConstructor(d)}(this),function(a){"use strict";var b=a.cloudViz,c=b.util.namespace("cloudViz.dataAdapter.standard"),d=Object.create(c.baseObj);d._processOptions=function(a,b){var c=this._processedOptions=Object.create(a),e=this.data(),f=this.mappings();this._forceZero=a.forceZero,this._uniqueStrokeValues=this._processUniqueStrokeValues(e,f),this._uniqueStrokeExtents=this._processUniqueStrokeExtents(e,f),null==c.isOvertime&&(c.isOvertime=this._determineOvertime(e),c.isOvertime&&(c.dateGranularity=c.dateGranularity||this._calculateDateGranularity(e))),Object.getPrototypeOf(d)._processOptions.call(this,c,b)},d.isOvertime=function(){return this._processedOptions.isOvertime},d.uniqueStrokeValues=function(){return this._uniqueStrokeValues||[]},d.uniqueStrokeExtents=function(){return this._uniqueStrokeExtents},d.getUniqueStrokeExtent=function(a){var b=this._uniqueStrokeValues[a];return b?this._uniqueStrokeExtents[b]:null},d.getUniqueStrokeExtentByStroke=function(a){return this._uniqueStrokeExtents[a]},d._processUniqueStrokeValues=function(a,b){var c=a[b.series];return c?dv.util.uniq(c):[]},d._processUniqueStrokeExtents=function(a,b){var c=a[b.series],d=a[b.y],e={};return d.map(function(a,b){var d=c[b];isFinite(a)&&null!==a&&(e[d]||(e[d]=[a,a]),e[d][0]=Math.min(a,e[d][0]),e[d][1]=Math.max(a,e[d][1]))}),e},c.lineObj=d,c.line=b.util.createConstructor(d)}(this),function(a){"use strict";var b=a.cloudViz,c=b.util.namespace("cloudViz.dataAdapter.standard"),d=Object.create(c.baseObj);d.sizeMetricName=function(){return this._options&&this._options.sizeTitle||null},d.isBubble=function(){var a=this.mappings().size;return a&&a.length},c.pointObj=d,c.point=b.util.createConstructor(d)}(this),function(a){"use strict";var b=a.cloudViz,c=b.util.namespace("cloudViz.dataAdapter.standard"),d=Object.create(c.baseObj);d._processOptions=function(a,b){var c=this._processedOptions=Object.create(a),e=JSON.parse(JSON.stringify(a.data));e.nodesById=[],e.nodes.map(function(a,b){return a._pid=b,e.nodesById[b]=a,a}),e.links=[],e.linksById=[];var f,g,h,i,j,k=this;e.paths=e.paths.filter(function(a){return a.values instanceof Array||(a.values=Array.apply(null,new Array(a.nodes.length-1)).map(function(){return a.values})),a.values.some(function(a){return 0>=a})?!1:(a.nodes.map(function(a){return null!==a?e.nodes[a]._pid:null}),!0)}),e.paths.forEach(function(a,b){a.nodes.forEach(function(c,d){return d?(f=a.nodes[d-1],g=c,d===a.nodes.length-1&&null!==g&&(e.nodesById[g].isPathEnd=!0,e.nodesById[g].isPathStart&&(e.nodesById[g].isPivot=!0)),h=a.values[d-1],i=k._generateLinkId(f,g),void((j=e.linksById[i])?(j.value+=h,j.paths.push(b)):(j={source:f,target:g,value:h,paths:[b]},e.linksById[i]=j,e.links.push(j)))):(f=a.nodes[d],void(null!==f&&(e.nodesById[f].isPathStart=!0,e.nodesById[f].isPathEnd&&(e.nodesById[f].isPivot=!0))))})}),c.data=e,Object.getPrototypeOf(d)._processOptions.apply(this,arguments)},d.data=function(){return this._processedOptions.data},d.nodeKey=function(){return function(a,b){return a.column+":"+a.row}},d.linkKey=function(){return function(a,b){var c=a.target,d=a.source,e=c?c.column+":"+c.row:"null",f=d?d.column+":"+d.row:"null";return f+"-"+e}},d.pathingTitle=function(){return""},d.getPathEnd=function(a){return null},d.getPathDirection=function(a){return 0},d.activePathsTitle=function(a){return a&&a.length?this.l10n.labels.pathing["path2+"]:""},d.isValidPathingData=function(){var a=this.data();return a&&a.nodes&&a.paths&&a.nodes.length?!0:!1},d._generateLinkId=function(a,b){return a+"-"+b},d._sortPaths=function(a,b){var c=this.data();return function(d,e){function f(a,b,g){var h=a+g,i=b+g,j=h<d.nodes.length&&h>=0?d.nodes[h]:-1,k=i<e.nodes.length&&i>=0?e.nodes[i]:-1;if(-1!==j&&null!==j&&(j=c.nodes.indexOf(c.nodesById[j])),-1!==k&&null!==k&&(k=c.nodes.indexOf(c.nodesById[k])),null===j&&null===k)return 0;if(null===j)return g>0?1:-1;if(null===k)return g>0?-1:1;if(-1===j&&-1===k)return 0;if(-1===j)return 1;if(-1===k)return-1;var l=j-k;return 0!==l?l:f(h,i,g)}var g=d.nodes.indexOf(a._pid),h=e.nodes.indexOf(a._pid),i=f(g,h,b);return 0===i&&(i=f(g,h,-b)),0!==i?i:e.nodes.length-d.nodes.length}},d._generatePathLinks=function(a,b,c){var d,e,f,g,h,i,j,k,l=this.data(),m=this,n=[];return a&&a.nodes?(a.nodes.forEach(function(c,o,p){o&&(d=a.nodes[o-1],e=c,f=l.nodesById[d]||null,g=l.nodesById[e]||null,h=a.values[o-1],i=null,o>1&&(i=l.linksById[m._generateLinkId(a.nodes[o-2],d)]),j=l.linksById[m._generateLinkId(d,e)],k=h/j.value*j.dy,f&&n.push({dy:k,sy:i?i.ty+i.offset-k:j.sy+j.offset,ty:g?j.sy+j.offset:f.dy-k,source:{x:f.x,y:f.y,dx:0},target:{x:f.x+f.dx,y:f.y},value:h,path:b,pivotStart:f.isPivot}),n.push({dy:k,sy:j.sy+j.offset,ty:j.ty+j.offset,source:f,target:g,value:h,path:b}),o+1===p.length&&g&&n.push({dy:k,sy:j.ty+j.offset,ty:j.ty+j.offset,source:{x:g.x,y:g.y,dx:0},target:{x:g.x+g.dx,y:g.y},value:h,path:b,pivotEnd:g.isPivot}),j.offset+=k)}),n):n},d.nodePaths=function(a){var b=this.data(),c=b.paths.filter(function(b){return-1!==b.nodes.indexOf(a._pid)});return c},d.nodePathData=function(a,b){var c=this.data(),d=this,e=[],f=c.links;return f.forEach(function(a){a.offset=0}),a.sort(d._sortPaths(b,-1)),a.forEach(function(a,c){e=e.concat(d._generatePathLinks(a,c,b))}),e},d.linkSortActivePaths=function(a){var b,c=this.data(),d=c.paths,e=a.source?a.source:a.target;return c.links.forEach(function(a){a.offset=0}),b=a.paths.map(function(a){return d[a]}),b.sort(this._sortPaths(e,-1)),b},d.linkPathData=function(a){var b=[],c=this;return a.forEach(function(a,d){b=b.concat(c._generatePathLinks(a,d))}),b},d.canExpandNode=function(a){return!0},d.canCollapseNode=function(a){return!0},d.canPivotNode=function(a){return!0},c.pathingObj=d,c.pathing=b.util.createConstructor(d)}(this),function(a){"use strict";var b=a.cloudViz,c=b.util.namespace("cloudViz.dataAdapter.standard"),d=Object.create(c.baseObj);a.d3||{};d._processOptions=function(a,b,c){function e(a){return a.metrics&&a.metrics.length&&a.metrics[0]&&"undefined"!=typeof a.metrics[0].value?a.metrics[0].value:a.children&&a.children.length?a.children.reduce(function(a,b){return a+e(b)},0):0}function f(a,b){return e(b)-e(a)}function g(a,b){if(a.size="undefined"==typeof a.size?e(a):a.size,a.children&&a.children.length){if(b<k.categories.length){var c=k.categories[b],d=a.children.length;c.top="undefined"!=typeof c.top?Math.max(c.top,d):d}if("undefined"!=typeof a.size&&"percent"!==l.format){var h=a.children.reduce(function(a,b){return a+e(b)},0);a.size>h&&a.children.push({id:"cv-sb-other",name:m,size:a.size-h})}a.children.sort(f),a.children.forEach(function(a){g(a,b+1)})}}function h(a,b,c){var d,e,f=n[b]||(n[b]=[]),g=a.length;for(d=0;g>d;++d)e=a[d],e._sid=c+"s"+d,m!==e.name&&(e.name&&(f[f.length]=e.name),e.children&&e.children.length&&h(e.children,b+1,e._sid))}var i=c||this._processedOptions||{},j=this._processedOptions=Object.create(a),k=JSON.parse(JSON.stringify(j.data)),l=k.metrics[0]||{name:"",format:"int"},m=this.l10n.labels.core.other;g(k,0);var n=[];h([k],0,""),k.name=l.name,n.push([l.name]),k.categories.forEach(function(a,b){a.index=b}),j.uniques=n.reduce(function(a,b){var c=b.reduce(function(a,b){return a.indexOf(b)<0?a.push(b)&&a:a},[]);return a.concat(c)},[]),j.data=k,j.categories=k.categories,j.colorMetricIndex=i.colorMetricIndex,j.stackedMetricIndex=i.stackedMetricIndex,j.secondaryMetricIndex=i.secondaryMetricIndex,j.secondaryMetricType=i.secondaryMetricType,j.seqColors=j.seqColors,Object.getPrototypeOf(d)._processOptions.apply(this,arguments)},d.data=function(){return this._processedOptions.data},d.categories=function(){return this._processedOptions.categories},d.uniques=function(){return this._processedOptions.uniques},d.colors=function(){return this._processedOptions.colors},d.seqColors=function(){return this._processedOptions.seqColors},d.metricColor=function(a){return this._processedOptions.metricColor},d.otherColor=function(a){return this._processedOptions.otherColor},d.otherGrayColor=function(a){return this._processedOptions.otherGrayColor},d.outRangeColor=function(a){return this._processedOptions.outRangeColor},d.isOther=function(a){return a.name===this.l10n.labels.core.other},d.isRoot=function(a){return!a.parent},d.isDataEmpty=function(){var a=this.data();return!(a&&a.children&&a.children.length)},d.isSizeEmpty=function(){return!this.data().size},d._validateData=function(a){return a&&a.children&&a.children.length?!0:!1},d.getPathKey=function(a,b){return a&&a._sid||b},d.getDataByPathKey=function(){function a(c){c&&(b=d.getPathKey(c,null),b&&(e[b]=c),c.children&&c.children.forEach(a))}var b,c=this.data(),d=this,e={};return a(c),e},d.getColorMetric=function(){var a=this._processedOptions.colorMetricIndex;return a?this.data().metrics[a]:null},d.getColorMetricIndex=function(){return this._processedOptions.colorMetricIndex},d.setColorMetricIndex=function(a){this._processedOptions.colorMetricIndex===a&&(a=null),this._processedOptions.secondaryMetricIndex=a,this.setSecondaryMetricType("color")},d.getStackedMetric=function(){var a=this._processedOptions.stackedMetricIndex;return a?this.data().metrics[a]:null},d.getStackedMetricIndex=function(){return this._processedOptions.stackedMetricIndex},d.setStackedMetricIndex=function(a){this._processedOptions.stackedMetricIndex===a&&(a=null),this._processedOptions.secondaryMetricIndex=a,this.setSecondaryMetricType("height")},d.getSecondaryMetricType=function(){return this._processedOptions.secondaryMetricType},d.setSecondaryMetricType=function(a){var b=this.getSecondaryMetricIndex()||1,c=this._processedOptions;switch(c.secondaryMetricIndex=b,c.secondaryMetricType=a,a){case"color":c.colorMetricIndex=b,c.stackedMetricIndex=null;break;case"height":c.colorMetricIndex=null,c.stackedMetricIndex=b;break;case"both":c.colorMetricIndex=b,c.stackedMetricIndex=b;break;default:c.colorMetricIndex=null,c.stackedMetricIndex=null,c.secondaryMetricIndex=null,c.secondaryMetricType=null}},d.getSecondaryMetric=function(){var a=this._processedOptions.secondaryMetricIndex;return a?this.data().metrics[a]:null},d.getSecondaryMetricIndex=function(){return this._processedOptions.secondaryMetricIndex},d.setSecondaryMetricIndex=function(a){this._processedOptions.secondaryMetricIndex===a&&(a=null),this._processedOptions.secondaryMetricIndex=a,this.setSecondaryMetricType(a?this.getSecondaryMetricType()||"height":null)},c.sunburstObj=d,c.sunburst=b.util.createConstructor(d)}(this),function(a){"use strict";var b=a.cloudViz,c=b.util.namespace("cloudViz.dataAdapter.standard"),d=Object.create(c.baseObj);a.d3||{};d._processOptions=function(a,b){var c=this._processedOptions=Object.create(a),e=a.data;a.isEmotionChart&&(e=this._getEmotionData(a.data)),c.data=e,Object.getPrototypeOf(d)._processOptions.call(this,c,b)},d._getEmotionData=function(a){var b=this.l10n.labels.flower,c=[{index:"joy",label:b.joy,color:"#e6b43c"},{index:"admiration",label:b.admiration,color:"#7daf4b"},{index:"fear",label:b.fear,color:"#50965a"},{index:"surprise",label:b.surprise,color:"#00a0be"},{index:"sadness",label:b.sadness,color:"#286eaf"},{index:"disgust",label:b.disgust,color:"#964196"},{index:"anger",label:b.anger,color:"#f04641"},{index:"anticipation",label:b.anticipation,color:"#dc5f00"}],d={};return dv.util.each(a,function(a){d[a.index]=a}),dv.util.each(c,function(a){d[a.index]?a.value=d[a.index].value||0:a.value=0}),c},d._validateData=function(a,b){return a?!0:!1},d.data=function(){return this._processedOptions.data},c.flowerObj=d,c.flower=b.util.createConstructor(d)}(this),function(a){"use strict";var b=a.cloudViz,c=b.util.namespace("cloudViz.dataAdapter.standard"),d=Object.create(c.barObj);d._processOptions=function(a,b){var c=this._processedOptions=Object.create(a);this._processStepData(c),Object.getPrototypeOf(d)._processOptions.call(this,c,b)},d.data=function(){return this._processedOptions.data},d.mappings=function(){return this._processedOptions.mappings},d.seriesLabelKey=function(){return"cv:fnl:seriesLabel"},d.averageStepData=function(){return this._processedOptions.avgStepData},d.averageDataLabel=function(){return this._processedOptions.avgStepLabel},d.averageSeries=function(){return this._processedOptions.averageSeries},d.previousStepData=function(){return this._processedOptions.prevStepData},d.currentStepData=function(){return this._processedOptions.curStepData},d.textStepData=function(){return this._processedOptions.txtStepData},d.getNumSteps=function(){return this._processedOptions.numSteps},d.getNumBarsPerStep=function(){return this._processedOptions.numBarsPerStep},d.useAvgMaxValue=function(){if(!this.averageStepData())return!1;var a=this.uniqueFillExtents(),b=!Object.keys(a).some(function(b,c,d){return 0!==a[b][0]||0!==a[b][1]});return b||!this._processedOptions.normalized},d._stepDelimiter=":::",d.getStepName=function(a){return a&&a.slice(0,a.indexOf(this._stepDelimiter))||""},d.isSingleSeries=function(){return 1===this.getNumBarsPerStep()},d.isAvgCalculated=function(){return this._processedOptions.avgStepDataCalc},d.getSingleSeriesStepValue=function(a,b){return this.isSingleSeries()?this.currentStepData()[this.mappings().y][b]:void 0},d._processStepData=function(a){var b=this.mappings(),c=this,d=a.data,e=b.series,f=b.seriesLabel,g=this.seriesLabelKey(),h=b.x,i=b.y,j=a.averageSeries,k=j&&d[e].indexOf(j)>=0,l=a.avgStepDataCalc=!k,m=a.avgStepData=a.disableAverage||!k&&!l?null:{cv_tt_val:[],cv_tt_pval:[]},n=a.prevStepData={cv_tt_val:[],cv_tt_pval:[]},o=a.data=a.curStepData={cv_tt_val:[],cv_tt_pval:[]},p=a.txtStepData={cv_label:[]},q={},r={};m&&(m[i]=[],m[h]=[],m[e]=[],m[g]=[]),n[i]=[],n[h]=[],n[e]=[],n[g]=[],o[i]=[],o[h]=[],o[e]=[],o[g]=[],p[i]=[],p[h]=[],p[e]=[],p[g]=[],a.numBarsPerStep=d[e].reduce(function(b,c,d){return b.indexOf(c)<0&&(a.disableAverage||c!==j)&&b.push(c),b},[]).length,d[i].forEach(function(b,l){var s,t=d[e][l],u=q[t];"undefined"==typeof u?(q[t]=u=[],s=b):s=u[u.length-1];var v=d[h][l]+c._stepDelimiter+u.length;if(r[v]=r[v]?r[v]+b:b,k&&m&&t===j)return m[i].push(b),m[h].push(v),m[e].push(d[e][l]),m[g].push(a.avgStepLabel=a.averageSeriesLabel?a.averageSeriesLabel:d[f][l]),m.cv_tt_val.push(b),m.cv_tt_pval.push(s),void u.push(b);var w=o[i].length;n[i].push(s),o[i].push(b),p[i].push(b),p.cv_label.push(s?b/s:0),o.cv_tt_val[w]=n.cv_tt_val[w]=b,o.cv_tt_pval[w]=n.cv_tt_pval[w]=s,n[h][w]=o[h][w]=p[h][w]=v,n[e][w]=o[e][w]=p[e][w]=d[e][l],n[g][w]=o[g][w]=p[g][w]=d[f][l],u.push(b)});var s=null;m&&l&&(a.averageSeries="cv:fnl:avg"),a.numSteps=o[h].reduce(function(b,d,f){if(b.indexOf(d)<0&&(b.push(d),m&&l)){var j=r[d]/a.numBarsPerStep;null===s&&(s=j),m[i].push(j),m[h].push(d),m[e].push(a.averageSeries),m[g].push(a.avgStepLabel=a.averageSeriesLabel?a.averageSeriesLabel:c.l10n.labels.funnel.average),m.cv_tt_val.push(j),m.cv_tt_pval.push(s),s=j}return b},[]).length;var t=Object.create(a.mappings);t.seriesLabel=g,a.mappings=t},c.funnelObj=d,c.funnel=b.util.createConstructor(d)}(this),function(a){"use strict";var b=a.cloudViz,c=b.util.namespace("cloudViz.dataAdapter.standard"),d=Object.create(c.baseObj);a.d3||{};d._processOptions=function(a,b){Object.getPrototypeOf(d)._processOptions.apply(this,arguments)},d._validateData=function(a,b){return a?!0:!1},d.data=function(){return this._options.data},c.wordcloudObj=d,c.wordcloud=b.util.createConstructor(d)}(this),function(a){"use strict";var b=a.cloudViz,c=b.util.namespace("cloudViz.dataAdapter.rs"),d=Object.create(b.dataAdapter.standard.baseObj);d._getYFormats=function(a,b,c){var d=[];if(!(a&&a.metric&&b&&b.series&&c))return d;for(var e=a.metric.length,f=0;e>f;f++){var g=a.metric[f],h=a[b.series],i=c.indexOf(h[f]);d[i]=g.type}return d},d.mappings=function(){return this._processedOptions.mappings},d.formats=function(){return this._processedOptions.formats},c.baseObj=d,c.base=b.util.createConstructor(d)}(this),function(a){"use strict";var b=a.cloudViz,c=b.util.namespace("cloudViz.dataAdapter.rs"),d=Object.create(b.dataAdapter.standard.barObj);d._processOptions=function(a,b){var c=this._processedOptions=Object.create(a);c.isOvertime=this._determineOvertime(c.data),c.yAxisTitle=a.yAxisTitle||this._getYAxisTitle(c.data),c.dateGranularity=this._getTimeGranularity(c.data),this._processData(c),this._updateMappings(c),Object.getPrototypeOf(d)._processOptions.call(this,c,b),c.formats={x:a.formats.x,y:this._getYFormats(c.data,c.mappings,this.uniqueFillValues())}},d.isOvertime=function(){return this._processedOptions.isOvertime},d.xAxisTitle=function(){return null},d.yAxisTitle=function(){return this._processedOptions.yAxisTitle},d.dateGranularity=function(){return this._processedOptions.dateGranularity},d.data=function(){return this._processedOptions.data},d.mappings=function(){return this._processedOptions.mappings},d.formats=function(){return this._processedOptions.formats},d._determineOvertime=function(a){var b=a.date,c=a.metric&&a.metric.some(function(a){return a&&a.date_ref&&a.date_ref.length>1});return b&&b.length&&c},d._getYAxisTitle=function(a){return this._getYTitleFromLabels(a.label)},d._processData=function(a){if(!a.isOvertime){var b,c=Object.create(a.data),d=c.cell.length,e=null,f=null;for(c.group=[],b=0;d>b;++b)f=e,e=c.cell[b],c.group[b]=c.series[b],f&&"incomplete"===e.status&&"incomplete"!==f.status&&(c.group[b]+="::incomplete::");a.data=c}},d._updateMappings=function(a){var b=Object.create(a.mappings);a.isOvertime?(b.x="date",b.y="value",b.group="group",b.series="series",b.seriesLabel="series_name"):(b.x="category",b.y="value",b.series="metric_series",b.seriesLabel="metric_series_name"),a.mappings=b},d._getTimeGranularity=function(a){return a.metric[0].date_range.gran};var e=c.baseObj;d._getYFormats=e._getYFormats,c.bar=b.util.createConstructor(d)}(this),function(a){"use strict";var b=a.cloudViz,c=b.util.namespace("cloudViz.dataAdapter.rs"),d=Object.create(b.dataAdapter.standard.choroplethObj);a.d3||{};d._processOptions=function(a,b){var c=this._processedOptions=Object.create(a);this._processData(c,a),Object.getPrototypeOf(d)._processOptions.call(this,c,b)},d._processData=function(a,b){for(var c,d,e,f,g=b.data,h=g.data,i=g.metrics,j=g.filters,k=(g.dates,{values:{}}),l=0,m=i.length;m>l;++l){e=i[l],c=e.filter_ref,d=e.date_ref;for(var n=0,o=c.length;o>n;++n){f=j[c[n]];for(var p=0,q=d.length;q>p;++p)k.values[(f.info||{}).geo_id]=h[c[n]][d[p]][l].val}}a.data=k,a.metric=e.name,a.format=e.type},d.data=function(){return this._processedOptions.data},d.metric=function(){return this._processedOptions.metric},d.format=function(){return this._processedOptions.format},d._validateData=function(a,b){return a?!0:!1},d.data=function(){return this._processedOptions.data},c.choropleth=b.util.createConstructor(d)}(this),function(a){"use strict";var b=a.cloudViz,c=b.util.namespace("cloudViz.dataAdapter.rs"),d=Object.create(b.dataAdapter.standard.donutObj);d._processOptions=function(a,b){var c=this._processedOptions=Object.create(a);this._updateMappings(c),Object.getPrototypeOf(d)._processOptions.call(this,c,b),c.formats={x:a.formats.x,y:this._getYFormats(c.data,c.mappings,this.uniqueFillValues())}},d.mappings=function(){return this._processedOptions.mappings},d.formats=function(){return this._processedOptions.formats},d._updateMappings=function(a){var b=Object.create(a.mappings);b.x="category",b.y="value",b.series="metric_series",b.seriesLabel="metric_series_name",a.mappings=b};var e=c.baseObj;d._getYFormats=e._getYFormats,c.donut=b.util.createConstructor(d)}(this),function(a){"use strict";var b=a.cloudViz,c=b.util.namespace("cloudViz.dataAdapter.rs"),d=Object.create(b.dataAdapter.standard.lineObj);d._processOptions=function(a,b){var c=this._processedOptions=Object.create(a);c.isOvertime=this._determineOvertime(c.data),c.yAxisTitle=a.yAxisTitle||this._getYAxisTitle(c.data),c.dateGranularity=this._getTimeGranularity(c.data),this._updateMappings(c),this._processMultiMetric(c),this._processIncompleteData(c),Object.getPrototypeOf(d)._processOptions.call(this,c,b),c.formats={x:a.formats.x,y:c.isOvertime?this._getYFormats(c.data,c.mappings,this.uniqueStrokeValues()):a.formats.y}},d.data=function(){return this._processedOptions.data},d.mappings=function(){return this._processedOptions.mappings},d.formats=function(){return this._processedOptions.formats},d.xAxisTitle=function(){return this._processedOptions.xAxisTitle},d.yAxisTitle=function(){return this._processedOptions.yAxisTitle},d.isOvertime=function(){return this._processedOptions.isOvertime},d.dateGranularity=function(){return this._processedOptions.dateGranularity},d._determineOvertime=function(a){return+a.date[0]!==+a.date[a.date.length-1]},d._getYAxisTitle=function(a){return this._getYTitleFromLabels(a.label)},d._getTimeGranularity=function(a){return this.isOvertime()?a.metric[0].date_range.gran:"*"},d._processMultiMetric=function(a){if(!a.isOvertime){var b,c,d,e=a.data,f={series:[]},g=[],h=[];for(b=0,c=e.label.length;c>b;++b)d=e.label[b],f[d]||(g.push(d),e.metric&&e.metric.length?h.push(e.metric[b].type):h.push(null),f[d]=[]),f[d].push(e.value[b]),f.series[f[d].length-1]=e.category[b];var i={x:g[0],y:g[1]},j={x:h[0],y:{0:h[1]}};if(e.groups&&e.groups.length&&e.groups[0].length){var k,l,m=e.groups.length,n=[];for(k=0;m>k;++k)l=e.groups[k],n[k]=l.join("-");f.facet_group=n,i.series="facet_group"}g.length>2&&(i.size=g[2],j.size=h[2],a.sizeMetricName=a.sizeTitle||g[2]),a.data=f,a.mappings=i,a.formats=j,a.xAxisTitle=a.xAxisTitle||g[0],a.yAxisTitle=a.yAxisTitle||g[1]}},d._updateMappings=function(a){var b=Object.create(a.mappings);b.x="date",b.y="value",b.group="series",b.series="series",b.seriesLabel="series_name",a.mappings=b},d._processIncompleteData=function(a){if(a.isOvertime&&a.data.cell&&"stack"!==a.position&&"fill"!==a.position){var b,c,d=a.data,e=a.mappings,f=d.cell.length,g=null,h=null;for(d.cv_rs_group=d.cv_rs_group||[],b=0;f>b;++b)if(h=g,g=d.cell[b],d.cv_rs_group[b]=d.cv_rs_group[b]||d.series[b],!(d.cv_rs_group[b].indexOf("::incomplete::")>=0)){if(h&&"incomplete"===g.status&&"incomplete"!==h.status){for(c in d)d[c].splice(b,0,d[c][b-1]);d.cv_rs_group[b]+="::incomplete::",++f,++b}d.cv_rs_group[b]+="incomplete"===g.status?"::incomplete::":""}e.group="cv_rs_group"}};var e=c.baseObj;d._getYFormats=e._getYFormats,c.line=b.util.createConstructor(d)}(this),function(a){"use strict";var b=a.cloudViz,c=b.util.namespace("cloudViz.dataAdapter.rs"),d=Object.create(b.dataAdapter.standard.pointObj);d._processOptions=function(a,b){var c,e,f,g=this._processedOptions=Object.create(a),h=a.data,i={series:[]},j=[],k=[];for(c=0,e=h.label.length;e>c;++c)f=h.label[c],i[f]||(j.push(f),h.metric&&h.metric.length?k.push(h.metric[c].type):k.push(null),i[f]=[]),i[f].push(h.value[c]),i.series[i[f].length-1]=h.category[c];var l={x:j[0],y:j[1]},m={x:k[0],y:k[1]};if(h.groups&&h.groups.length&&h.groups[0].length){var n,o,p=h.groups.length,q=[];for(n=0;p>n;++n)o=h.groups[n],q[n]=o.join("-");i.group=q,l.series="group"}else l.series="series";j.length>2&&(l.size=j[2],m.size=k[2],g.sizeMetricName=a.sizeTitle||j[2]),g.data=i,g.mappings=l,g.formats=m,g.xAxisTitle=a.xAxisTitle||j[0],g.yAxisTitle=a.yAxisTitle||j[1],Object.getPrototypeOf(d)._processOptions.apply(this,arguments)},d.data=function(){return this._processedOptions.data},d.mappings=function(){return this._processedOptions.mappings},d.formats=function(){return this._processedOptions.formats},d.xAxisTitle=function(){return this._processedOptions.xAxisTitle},d.yAxisTitle=function(){return this._processedOptions.yAxisTitle},d.sizeMetricName=function(){return this._processedOptions.sizeMetricName},c.point=b.util.createConstructor(d)}(this),function(a){"use strict";var b=a.cloudViz,c=b.util.namespace("cloudViz.dataAdapter.rs"),d=Object.create(b.dataAdapter.standard.pathingObj),e=4;d._processOptions=function(a,b){function c(a){return"E"===a}function e(a){return"X"===a}var f,g,h,i,j,k,l,m,n,o,p,q=Object.create(a),r=q.data,s={},t=s.nodes=[],u=s.paths=[],v={},w=this.l10n.labels.pathing,x=0;for(g in r.filters)if(f=r.filters[g],h=this._getFilterId(f)){if(i=f.info&&f.info.name||"",j=this._getFilterChild(f),k=j&&j.op||null,k&&"previous"!==k&&"next"!==k&&(j=k=null),
l=j&&j.val?[].concat(j.val):[],o=0,"previous"===k){if(l.some(c)){var y="E_0";v[y]||(m={label:w.entry,id:y,column:o,index:t.length,filters:[]},t[t.length]=m,v[y]=m)}o=l.length}if("next"===k){if(l.some(e)){var z="X_0";v[z]||(m={label:w.exit,id:z,column:o,index:t.length,filters:[]},t[t.length]=m,v[z]=m)}o=0-l.length}if(n=h+"_"+o,v[n]){v[n].filters.push(f);continue}if(p="0"===String(h)&&(w.exit===String(i)||w.entry===String(i)))continue;if("0"===String(h))continue;m={label:i,id:n,column:o,index:t.length,filters:[f]},t[t.length]=m,x=Math.min(x,o),v[n]=m}if(0!==x)for(var A in t)m=t[A],m.column-=x;var B,C,D,E,F,G,H,I,J,K,L,M,N;for(F=0,G=r.metrics.length;G>F;++F)for(B=r.metrics[F],C=B.filter_ref,D=B.date_ref,H=0,I=C.length;I>H;++H)for(g=C[H],f=r.filters[g],J=0,K=D.length;K>J;++J)E=D[J],L=r.dates[E],M=r.data[g][E][F],"invalid"!==M.status&&((m=this._getSingleNode(f,v))?m.total=+M.val:(N=this._createPath(f,v),N&&N.length&&(u[u.length]={nodes:N,values:+M.val||0})));u.sort(function(a,b){return b.nodes.length-a.nodes.length});var O,P,Q,R,S,T;for(O=0,P=u.length;P>O;++O)for(S=u[O],Q=0,R=u.length;R>Q;++Q)O!==Q&&(T=u[Q],T.nodes.length!==S.nodes.length&&-1!==this._getPathString(S.nodes).indexOf(this._getPathString(T.nodes))&&(T.values-=S.values));s.paths=u=u.filter(function(a){return a.values}),q.data=s;var U=a.data.metrics;q.pathingTitle=U&&U.length&&U[0].name,Object.getPrototypeOf(d)._processOptions.call(this,q,b)},d.nodeKey=function(){return function(a,b){return a.id}},d.linkKey=function(){return function(a,b){return(a.source?a.source.id:"null")+"-"+(a.target?a.target.id:"null")}},d.pathingTitle=function(){return this._processedOptions.pathingTitle},d.getPathEnd=function(a){function b(a){return a&&(a.isPivot||"E_0"===a.id||"X_0"===a.id)}if(!a||!a.nodes||!a.nodes.length)return null;if(1===a.nodes.length)return a.nodes[0];var c=a.nodes,d=this._processedOptions.data,e=d.nodesById,f=e[c[0]],g=e[c[c.length-1]];return b(f)?f:b(g)?g:null},d.getPathDirection=function(a){var b=this.getPathEnd(a);return b?b._pid===a.nodes[0]?1:-1:0},d.activePathsTitle=function(a){if(!a||!a.length)return"";var b=this.getPathEnd(a[0]),c=this.l10n.labels.pathing;if(!b)return c["path2+"];var d=1===this.getPathDirection(a[0])?c.pathFromNode:c.pathToNode;return d.replace(/\{path\}/i,a.length>1?c["path2+"]:c.path).replace(/\{label\}/i,b.label)},d._getSingleNode=function(a,b){var c=this._getFilterId(a),d=a.filter_def&&a.filter_def.length&&a.filter_def[0]||null,e=d&&d.op||null,f=this._getFilterChild(a),g=f&&f.op||null;return"select"!==e&&"equals"!==e&&"id"!==e||"previous"===g||"next"===g?!1:b[c+"_0"]},d._getPathString=function(a){return a.map(function(a){return null===a?"null":a}).toString()},d._createPath=function(a,b){var c=this._getFilterId(a),d=this._getFilterChild(a),e=d&&d.op||null;if(e&&"previous"!==e&&"next"!==e)return[];var f=d&&d.val?[].concat(d.val):[];if(!f.length)return f;var g="previous"===d.op,h="0"===c,i=g?0:h?0-f.length+1:0-f.length;return g?f.push(c):f.unshift(c),this._mapNodeIds(i,f,b)},d._mapNodeIds=function(a,b,c){if(!isFinite(a)||!c)return[];a=+a;var d,e=!1,f=!1,g=b&&b.map&&b.map(function(b){return"0"===b?null:(d=b+"_"+a,c[d]?(++a,e=!0,+c[d].index):(f=!0,null))});return e&&!f?g:[]},d._getFilterId=function(a){return a.info&&(a.info.id||0===a.info.id)?a.info.id+"":null},d._getFilterChild=function(a){var b=a.filter_def&&a.filter_def.length&&a.filter_def[0]||null;return b&&b.child&&b.child.length&&b.child[0]||null},d.canExpandNode=function(a){var b=a.entryLinks.length+a.targetLinks.length,c=a.exitLinks.length+a.sourceLinks.length,d=Math.abs(parseInt(a.id.split("_")[1],10));return d>=e?!1:c&&"E_0"===a.id?!1:b&&"X_0"===a.id?!1:b&&c?!1:!0},d.canCollapseNode=function(a){var b=a.entryLinks.length+a.targetLinks.length,c=a.exitLinks.length+a.sourceLinks.length,d=parseInt(a.id.split("_")[1],10);return"E_0"===a.id||"X_0"===a.id?!1:0===d&&(c||b)||d>0&&c||0>d&&b},d.canPivotNode=function(a){var b=(a.entryLinks.length+a.targetLinks.length,a.exitLinks.length+a.sourceLinks.length,Math.abs(parseInt(a.id.split("_")[1],10)));if(0!==b)return!0;var c=this.data(),d=c.nodes.map(function(a){return parseInt(a.id.split("_")[1],10)}),e=0;return d.some(function(a){return 0===a&&e++,e>1?!0:!1})?!0:!1},c.pathingObj=d,c.pathing=b.util.createConstructor(d)}(this),function(a){"use strict";var b=a.cloudViz,c=b.util.namespace("cloudViz.dataAdapter.rs"),d=Object.create(b.dataAdapter.standard.sunburstObj);d._processOptions=function(a,b){function c(a){var b=a&&"id"===a.op?[a.val]:[];return a&&a.child&&a.child[0]?c(a.child[0]).concat(b):b}function e(a){return a&&a.child&&a.child[0]?e(a.child[0])+1:0}function f(a){var b=a&&a.filter_def&&a.filter_def[0]||null;return e(b)}function g(a,b){var c=f(a.filter),d=f(b.filter);return c===d?b.cell[0].val-a.cell[0].val:c-d}var h,i,j,k,l,m,n,o,p,q,r,s,t,u=this._processedOptions,v=this._processedOptions=Object.create(a),w=a.data,x={children:[],categories:[],metrics:w.metrics.map(function(a,b){return{id:a.id,icon:a.icon,name:a.name||a.id,format:a.type,categories:[]}})};if(h=w.metrics[0]){for(p=[],i=h.filter_ref,j=h.date_ref,l=0,m=i.length;m>l;++l)for(t=i[l],s=w.filters[t],n=0,o=j.length;o>n;++n)k=j[n],q=w.dates[k],r=w.data[t][k],r[0]&&"invalid"!==r[0].status&&(s.info&&0===s.info.id||p.push({filter:s,cell:r}));p.sort(g);var y,z,A,B,C,D={};p.forEach(function(a){if(s=a.filter,r=a.cell,A=s&&s.filter_def&&s.filter_def[0]||null,B=c(A),C=B.length,y=B.join("-"),!y.length&&!s.info)return void r.forEach(function(a,b){x.metrics[b].value=+a.val});if(a={id:s.info.id,pid:y?y+"-"+s.info.id:s.info.id,name:s.info.name,metrics:r.map(function(a){return{value:+a.val}}),category:s.info.category||A&&A["var"]||void 0,filtervar:A&&A["var"]||void 0,children:[]},s.info.orig_name&&(a.orig_name=s.info.orig_name),r.forEach(function(a,b){var c=x.metrics[b];c.min="undefined"!=typeof c.min?Math.min(c.min,+a.val):+a.val,c.max="undefined"!=typeof c.max?Math.max(c.max,+a.val):+a.val;var d;(d=c.categories[C])?(d.min=Math.min(d.min,+a.val),d.max=Math.max(d.max,+a.val)):c.categories[C]={min:+a.val,max:+a.val}}),y&&(z=D[y]))z.children.push(a);else{if(B.length)return;x.children.push(a)}D[a.pid]=a,x.categories[C]={name:s.info.category||A&&A["var"]||x.categories[C]}})}v.data=x,Object.getPrototypeOf(d)._processOptions.call(this,v,b,u)},d._validateData=function(a){if(!a)return!1;for(var b in a)if(a[b].length)return!0;return!1},d.getPathKey=function(a,b){return a&&a._sid?a.pid?a.pid:a._sid:0},c.sunburst=b.util.createConstructor(d)}(this),function(a){"use strict";var b=a.cloudViz,c=b.util.namespace("cloudViz.dataAdapter.rs"),d=Object.create(b.dataAdapter.standard.flowerObj);d._processOptions=function(a,b){var c=this._processedOptions=Object.create(a);c.data=this._parseData(a.data),Object.getPrototypeOf(d)._processOptions.call(this,c,b)},d._parseData=function(a){if(!a.metric.length)return[];var b=[],c=a.metric[0].id;return dv.util.each(a.metric,function(d,e){if(d.id==c){var f=a.filter[e].info.name,g=a.value[e];b.push({index:f.toLowerCase(),label:f,value:g})}}),b},d.formats=function(){return this._processedOptions.formats},c.flower=b.util.createConstructor(d)}(this),function(a){"use strict";var b=a.cloudViz,c=b.util.namespace("cloudViz.dataAdapter.rs"),d=Object.create(b.dataAdapter.standard.funnelObj);d._processOptions=function(a,b){var c=this._processedOptions=Object.create(a);this._processData(c),this._updateMappings(c),Object.getPrototypeOf(d)._processOptions.call(this,c,b)},d.data=function(){return this._processedOptions.data},d.mappings=function(){return this._processedOptions.mappings},d.formats=function(){return this._processedOptions.formats},d._processData=function(a){a.data=Object.create(a.data)},d._updateMappings=function(a){var b=Object.create(a.mappings);b.x="category",b.y="value",b.series="metric_series",b.seriesLabel="metric_series_name",a.mappings=b},c.funnel=b.util.createConstructor(d)}(this),function(a){"use strict";var b=a.cloudViz,c=b.util.namespace("cloudViz.dataAdapter.rs"),d=Object.create(b.dataAdapter.standard.wordcloudObj);a.d3||{};d._processOptions=function(a,b){var c=this._processedOptions=Object.create(a);this._processData(c,a),Object.getPrototypeOf(d)._processOptions.call(this,c,b)},d._processData=function(a,b){a.data=b.data},d.data=function(){return this._processedOptions.data},d._validateData=function(a,b){return a?!0:!1},d.data=function(){return this._processedOptions.data},c.wordcloud=b.util.createConstructor(d)}(this),function(a){"use strict";a.cloudViz.localeDefinition("de-DE",{monthAbbreviations:["Jan","Feb","Mrz","Apr","Mai","Juni","Juli","Aug","Sep","Okt","Nov","Dez"],months:["Januar","Februar","Mrz","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],weekdayAbbreviations:["So","Mo","Di","Mi","Do","Fr","Sa"],weekdays:["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"],ampm:["AM","PM"]},"calendar"),a.cloudViz.localeDefinition("de-DE",{core:{nodata:"Das Diagramm enthlt keine Daten.",erroronrender:"Hoppla! Ein Fehler ist aufgetreten und das Diagramm konnte nicht gerendert werden.",other:"Sonstige",normalized:"Normalisiert"},dvcore:{target:"Zielgruppe",yAxisTimeNoTitle:"{time}",yAxisTimeWithTitle:"{title} (in {time})",legendTime:"{value} {time}"},point:{xScale:"X",yScale:"Y",sizeScale:"Gre"},pathing:{entry:"Einstieg",exit:"Ausstieg","entry2+":"Einstiege","exit2+":"Ausstiege",path:"Pfad","path2+":"Pfade",expand:"Erweitern",focus:"Fokus",collapse:"Reduzieren",title:"Pfaderstellungs-diagramm",nodeEntries:"Einstiege fr {label}",nodeExits:"Ausstiege fr {label}",nodeToNode:"{source}  {target}",percOfNode:"{perc} von {label}",pathToNode:"{path} zu {label}",pathFromNode:"{path} aus {label}",help1:"Dieses Diagramm stellt Pfade dar, die von einem Status in einen anderen bernommen wurden.",help2:"Jeder Knoten in Form eines Feldes reprsentiert einen Status im Pfad.",help3:"Durch Tippen oder Klicken auf einen Knoten werden zustzliche Optionen zum ndern des Diagramms angezeigt:",focusHelp:"Zeigt Pfade an, die am Knoten ein- oder ausgehen.",expandHelp:"Zeigt zustzliche Pfade an, die am Knoten ein- oder ausgehen.",collapseHelp:"Entfernt Pfade, die am Knoten ein- oder ausgehen."},sunburst:{audience:"Zielgruppe","audience2+":"Zielgruppen",category:"Kategorie","category2+":"Kategorien",metric:"Metrik","metric2+":"Metriken",primarymetric:"Primre Metrik",secondarymetric:"Sekundre Metrik","secondarymetric2+":"Sekundre Metriken",secondarymetrichelp:"Klicken Sie auf die Metrik, um die Hhe zu ndern.","secondarymetrichelp2+":"Klicken Sie auf die Metriken, um die Hhe zu ndern.",emptyFirstMetric:"Die erste Metrik enthlt keine Werte. Whlen Sie eine andere Metrik.",total:"Gesamt",zoomAction:"Doppelklicken, um zu vergrern.",moreAction:"Klicken Sie hier fr weitere Optionen.",zoomin:"Nahansicht",zoomout:"Weitansicht",hide:"Ausblenden",hideall:"Alles ausblenden",hideother:"Sonstige ausblenden",hidden:"{value} verborgenes Element","hidden2+":"{value} verborgene Elemente",topresults:"Top {value}",color:"Farbe",height:"Hhe",both:"Beide",none:"Keine",mapmetric:"{metric} anzeigen als:",percmetric:"{percent} der {metric}",mobilescroll:"&#x25BC  scrollen Sie, um Details anzuzeigen."},flower:{joy:"Freude",admiration:"Bewunderung",fear:"Angst",surprise:"berraschung",sadness:"Traurigkeit",disgust:"Emprung",anger:"Wut",anticipation:"Vorausschtzung"},venn:{definedAudience:"Definierte Zielgruppe"},funnel:{step:"Schritt",segment:"Segment",conversion:"Konversion",fallout:"Trichteranalyse",average:"Durchschnitt"}},"labels"),a.cloudViz.localeDefinition("de-DE",{shortFormat:{hour:"%H",day:"%e",week:"%e",month:"%b",quarter:"%b",year:"%Y",fallback:"%e"},mediumFormat:{hour:"%H",day:"%a %e",week:"%a %e",month:"%b",quarter:"%b",year:"%Y",fallback:"%a %e"},longFormat:{hour:"%H Uhr %a %e",day:"%A %e",week:"%A %e",month:"%B",quarter:"%B",year:"%Y",fallback:"%H Uhr %a %e"},fullFormat:{hour:"%H Uhr %a %e",day:"%A, %e. %B",week:"%A, %e. %B",month:"%B %Y",quarter:"%B %Y",year:"%Y",fallback:"%e %b, %Y",condensed:"%d/%m/%Y"}},"dateFormat"),a.cloudViz.localeDefinition("de-DE",{decimalSeparator:",",groupSeparator:" ",negativePattern:"-{number}",percent:{symbol:"%",positivePattern:"{number} {symbol}",negativePattern:"-{number} {symbol}"},currency:{symbol:"",positivePattern:"{number} {symbol}",negativePattern:"-{number} {symbol}"}},"numberFormat"),a.cloudViz.localeDefinition("de-DE",{singular:{second:"Sekunde",minute:"Minute",hour:"Stunde",day:"Tag",week:"Woche",month:"Monat",year:"Jahr"},plural:{second:"Sekunden",minute:"Minuten",hour:"Stunden",day:"Tagen",week:"Wochen",month:"Monate",year:"Jahre"},abbreviation:{second:"s",minute:"min",hour:"h",day:"d",week:"w",month:"mon",year:"y"}},"time")}(this),function(a){"use strict";a.cloudViz.localeDefinition("en-US",{monthAbbreviations:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdayAbbreviations:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],ampm:["AM","PM"]},"calendar"),a.cloudViz.localeDefinition("en-US",{core:{nodata:"The chart has no data",erroronrender:"Oops! There was an error and the chart could not be rendered.",other:"Other",normalized:"Normalized"},dvcore:{target:"Target",yAxisTimeNoTitle:"{time}",yAxisTimeWithTitle:"{title} (in {time})",legendTime:"{value} {time}"},point:{xScale:"X",yScale:"Y",sizeScale:"Size"},pathing:{entry:"Entry",exit:"Exit","entry2+":"Entries","exit2+":"Exits",path:"Path","path2+":"Paths",expand:"Expand",focus:"Focus",collapse:"Collapse",title:"Pathing Chart",nodeEntries:"{label} Entries",nodeExits:"{label} Exits",nodeToNode:"{source}  {target}",percOfNode:"{perc} of {label}",pathToNode:"{path} to {label}",pathFromNode:"{path} from {label}",help1:"This chart represents paths taken from one state to another.",help2:"Each node, shaped as a box, represents a state in the path.",help3:"Tapping or clicking a node will provide additional options to modify the chart:",focusHelp:"Shows paths coming into and going out of node",expandHelp:"Shows additional paths coming or going from the node",collapseHelp:"Removes paths coming or going from the node"},sunburst:{audience:"Audience","audience2+":"Audiences",category:"Category","category2+":"Categories",metric:"Metric","metric2+":"Metrics",primarymetric:"Primary Metric",secondarymetric:"Secondary Metric","secondarymetric2+":"Secondary Metrics",secondarymetrichelp:"Click metric to toggle height","secondarymetrichelp2+":"Click metrics to toggle height",emptyFirstMetric:"The first metric has no values. Please pick a different metric.",total:"Total",zoomAction:"Double-click to Zoom in.",moreAction:"Click for more options.",zoomin:"Zoom In",zoomout:"Zoom Out",hide:"Hide",hideall:"Hide All",hideother:"Hide Other",hidden:"{value} Hidden Item","hidden2+":"{value} Hidden Items",topresults:"top {value}",color:"Color",height:"Height",both:"Both",none:"None",mapmetric:"Show {metric} as:",percmetric:"{percent} of {metric}",mobilescroll:"&#x25BC scroll for details"},flower:{joy:"Joy",admiration:"Admiration",fear:"Fear",surprise:"Surprise",sadness:"Sadness",disgust:"Disgust",anger:"Anger",anticipation:"Anticipation"},venn:{definedAudience:"Defined Audience"},funnel:{step:"Step",segment:"Segment",conversion:"Conversion",fallout:"Fallout",average:"Average"}},"labels"),a.cloudViz.localeDefinition("en-US",{shortFormat:{hour:"%I %p",day:"%e",week:"%e",month:"%b",quarter:"%b",year:"%Y",fallback:"%e"},mediumFormat:{hour:"%I %p",day:"%a %e",week:"%a %e",month:"%b",quarter:"%b",year:"%Y",fallback:"%a %e"},longFormat:{hour:"%I %p %a %e",day:"%A %e",week:"%A %e",month:"%B",quarter:"%B",year:"%Y",fallback:"%I %p %a %e"},fullFormat:{hour:"%I %p %a %e",day:"%A %e %B",week:"%A %e %B",month:"%B %Y",quarter:"%B %Y",year:"%Y",fallback:"%b %e, %Y",condensed:"%m/%d/%Y"}},"dateFormat"),a.cloudViz.localeDefinition("en-US",{decimalSeparator:".",groupSeparator:",",negativePattern:"-{number}",percent:{symbol:"%",positivePattern:"{number}{symbol}",negativePattern:"-{number}{symbol}"},currency:{symbol:"$",positivePattern:"{symbol}{number}",negativePattern:"-{symbol}{number}"}},"numberFormat"),a.cloudViz.localeDefinition("en-US",{singular:{second:"second",minute:"minute",hour:"hour",day:"day",week:"week",month:"month",year:"year"},plural:{second:"seconds",minute:"minutes",hour:"hours",day:"days",week:"weeks",month:"months",year:"years"},abbreviation:{second:"s",minute:"min",hour:"h",day:"d",week:"w",month:"mon",year:"y"}},"time")}(this),function(a){"use strict";a.cloudViz.localeDefinition("es-ES",{monthAbbreviations:["en.","febr.","mzo.","abr.","my.","jun.","jul.","ag.","sept.","oct.","nov.","dic."],months:["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"],weekdayAbbreviations:["dom.","lun.","mart.","mirc.","juev.","vier.","sb."],weekdays:["domingo","lunes","martes","mircoles","jueves","viernes","sbado"],ampm:["a. m.","p. m."]},"calendar"),a.cloudViz.localeDefinition("es-ES",{core:{nodata:"El grfico no contiene datos",erroronrender:"Se ha producido un error y no se ha podido procesar el grfico.",other:"Otro",normalized:"Normalizado"},dvcore:{target:"Destino",yAxisTimeNoTitle:"{time}",yAxisTimeWithTitle:"{title} (en {time})",legendTime:"{value} {time}"},point:{xScale:"X",yScale:"Y",sizeScale:"Tamao"},pathing:{entry:"Entrada",exit:"Salida","entry2+":"Entradas","exit2+":"Salidas",path:"Ruta","path2+":"Rutas",expand:"Expandir",focus:"Enfoque",collapse:"Contraer",title:"Grfico de ruta",nodeEntries:"Entradas de {label}",nodeExits:"Salidas de {label}",nodeToNode:"{source}  {target}",percOfNode:"{perc} de {label}",pathToNode:"{path} a {label}",pathFromNode:"{path} de {label}",help1:"Este grfico representa las rutas que se pueden tomar para ir de un estado a otro.",help2:"Los nodos, con forma de caja, representan un estado en la ruta.",help3:"Al hacer clic o tocar un nodo, se mostrarn opciones adicionales para modificar el grfico:",focusHelp:"Muestra las rutas de ida al nodo o de vuelta",expandHelp:"Muestra rutas adicionales de ida al nodo o de vuelta",collapseHelp:"Suprime las rutas de ida al nodo o de vuelta"},sunburst:{audience:"Audiencia","audience2+":"Audiencias",category:"Categora","category2+":"Categoras",metric:"Mtrica","metric2+":"Mtrica",primarymetric:"Mtrica principal",secondarymetric:"Mtrica secundaria","secondarymetric2+":"Mtricas secundarias",secondarymetrichelp:"Haga clic en la mtrica para alternar la altura","secondarymetrichelp2+":"Haga clic en las mtricas para alternar la altura",emptyFirstMetric:"La primera mtrica no contiene ningn valor. Elija otra mtrica.",total:"Total",zoomAction:"Doble clic para aumentar.",moreAction:"Haga clic para ver ms opciones.",zoomin:"Acercar",zoomout:"Alejar",hide:"Ocultar",hideall:"Ocultar todo",hideother:"Ocultar otro",hidden:"{value} elemento oculto","hidden2+":"{value} elementos ocultos",topresults:"{value} principales",color:"Color",height:"Altura",both:"Ambos",none:"Ninguno",mapmetric:"Mostrar {metric} como:",percmetric:"{percent} de {metric}",mobilescroll:"&#x25BC desplcese para ms detalles"},flower:{joy:"Alegra",admiration:"Admiracin",fear:"Miedo",surprise:"Sorpresa",sadness:"Tristeza",disgust:"Desagrado",anger:"Enfado",anticipation:"Expectacin"},venn:{definedAudience:"Audiencia definida"},funnel:{step:"Paso",segment:"Segmento",conversion:"Conversin",fallout:"Visita en el orden previsto",average:"Promedio"}},"labels"),a.cloudViz.localeDefinition("es-ES",{shortFormat:{hour:"%H",day:"%e",week:"%e",month:"%b",quarter:"%b",year:"%Y",fallback:"%e"},mediumFormat:{hour:"%H",day:"%a %e",week:"%a %e",month:"%b",quarter:"%b",year:"%Y",fallback:"%a %e"},longFormat:{hour:"%Hh %a %e",day:"%A %e",week:"%A %e",month:"%B",quarter:"%B",year:"%Y",fallback:"%Hh %a %e"},fullFormat:{hour:"%Hh %I %p",day:"%A %e de %B",week:"%A %e de %B",month:"%B %Y",quarter:"%B %Y",year:"%Y",fallback:"%e %b, %Y",condensed:"%d/%m/%Y"}},"dateFormat"),a.cloudViz.localeDefinition("es-ES",{decimalSeparator:",",groupSeparator:" ",negativePattern:"-{number}",percent:{symbol:"%",positivePattern:"{number} {symbol}",negativePattern:"-{number} {symbol}"},currency:{symbol:"",positivePattern:"{number} {symbol}",negativePattern:"-{number} {symbol}"}},"numberFormat"),a.cloudViz.localeDefinition("es-ES",{singular:{second:"segundo",minute:"minuto",hour:"hora",day:"da",week:"semana",month:"mes",year:"ao"},plural:{second:"segundos",minute:"minutos",hour:"horas",day:"das",week:"semanas",month:"meses",year:"aos"},abbreviation:{second:"s",minute:"min",hour:"h",day:"d",week:"w",month:"mon",year:"y"}},"time")}(this),function(a){"use strict";a.cloudViz.localeDefinition("fr-FR",{monthAbbreviations:["Janv.","Fvr.","Mars","Avr.","Mai","Juin","Juill.","Aot","Sept.","Oct.","Nov.","Dc."],months:["janvier","fvrier","mars","avril","mai","juin","juillet","aot","septembre","octobre","novembre","dcembre"],weekdayAbbreviations:["Dim.","Lun.","Mar.","Mer.","Jeu.","Ven.","Sam."],weekdays:["Dimanche","Lundi","Mardi","Mercredi","Jeudi","Vendredi","Samedi"],ampm:["AM","PM"]},"calendar"),a.cloudViz.localeDefinition("fr-FR",{core:{nodata:"Le graphique ne contient aucune donne",erroronrender:"Une erreur sest produite, impossible de restituer le graphique.",other:"Autre",normalized:"Normalis"},dvcore:{target:"Cible",yAxisTimeNoTitle:"{time}",yAxisTimeWithTitle:"{title} (en {time})",legendTime:"{value} {time}"},point:{xScale:"X",yScale:"Y",sizeScale:"Taille"},pathing:{entry:"Entre",exit:"Sortie","entry2+":"Entres de","exit2+":"Sorties de",path:"Chemin daccs","path2+":"Chemins daccs",expand:"Dvelopper",focus:"Mise au point",collapse:"Rduire",title:"Graphique du cheminement",nodeEntries:"Entres {label}",nodeExits:"Sorties {label}",nodeToNode:"{source}  {target}",percOfNode:"{perc} de {label}",pathToNode:"{path}  {label}",pathFromNode:"{path} de {label}",help1:"Ce graphique reprsente les chemins daccs rcuprs dun tat  un autre.",help2:"Chaque nud, en forme de cadre, reprsente un tat dans le chemin daccs.",help3:"Le fait dappuyer ou de cliquer sur un nud fournit dautres options pour modifier le graphique:",focusHelp:"Prsente les chemins daccs issus du nud ou y parvenant",expandHelp:"Prsente des chemins daccs supplmentaires issus du nud ou y parvenant.",collapseHelp:"Supprime les chemins daccs supplmentaires issus du nud ou y parvenant."},sunburst:{audience:"Audience","audience2+":"Audiences",category:"Catgorie","category2+":"Catgories",metric:"Mesure","metric2+":"Mesures",primarymetric:"Mesure principale",secondarymetric:"Mesure secondaire","secondarymetric2+":"Mesures secondaires",secondarymetrichelp:"Cliquer sur une mesure pour activer/dsactiver la hauteur","secondarymetrichelp2+":"Cliquer sur des mesures pour activer/dsactiver la hauteur",emptyFirstMetric:"La premire mesure na aucune valeur. Slectionnez une autre mesure.",total:"Total",zoomAction:"Double-cliquez pour effectuer un zoom avant.",moreAction:"Cliquez pour plus doptions.",zoomin:"Zoom avant",zoomout:"Zoom arrire",hide:"Masquer",hideall:"Tout masquer",hideother:"Masquer autres",hidden:"{value} lment masqu","hidden2+":"{value} lments masqus",topresults:"{value} premiers",color:"Couleur",height:"Hauteur",both:"Les deux",none:"Nant",mapmetric:"Afficher {metric} comme:",percmetric:"{percent} des {metric}",mobilescroll:"Dfilement &#x25BC pour plus de dtails"},flower:{joy:"Joie",admiration:"Admiration",fear:"Peur",surprise:"Surprise",sadness:"Tristesse",disgust:"Dgot",anger:"Colre",anticipation:"Anticipation"},venn:{definedAudience:"Audience dfinie"},funnel:{step:"Etape",segment:"Segment",conversion:"Conversion",fallout:"Abandons",average:"Moyenne"}},"labels"),a.cloudViz.localeDefinition("fr-FR",{shortFormat:{hour:"%H",day:"%e",week:"%e",month:"%b",quarter:"%b",year:"%Y",fallback:"%e"},mediumFormat:{hour:"%H",day:"%a %e",week:"%a %e",month:"%b",quarter:"%b",year:"%Y",fallback:"%a %e"},longFormat:{hour:"%H h %a %e",day:"%A %e",week:"%A %e",month:"%B",quarter:"%B",year:"%Y",fallback:"%H h %a %e"},fullFormat:{hour:"%H h %a %e",day:"%A %e %B",week:"%A %e %B",month:"%B %Y",quarter:"%B %Y",year:"%Y",fallback:"%e %b %Y",condensed:"%d/%m/%Y"}},"dateFormat"),a.cloudViz.localeDefinition("fr-FR",{decimalSeparator:",",groupSeparator:" ",negativePattern:"-{number}",percent:{symbol:"%",positivePattern:"{number} {symbol}",negativePattern:"-{number} {symbol}"},currency:{symbol:"",positivePattern:"{number} {symbol}",negativePattern:"-{number} {symbol}"}},"numberFormat"),a.cloudViz.localeDefinition("fr-FR",{singular:{second:"seconde",minute:"minute",hour:"heure",day:"jour",week:"semaine",month:"mois",year:"anne"},plural:{second:"secondes",minute:"minutes",hour:"heures",day:"jours",week:"semaines",month:"mois",year:"annes"},abbreviation:{second:"s",minute:"min",hour:"h",day:"d",week:"w",month:"mon",year:"y"}},"time")}(this),function(a){"use strict";a.cloudViz.localeDefinition("ja-JP",{monthAbbreviations:["1","2","3","4","5","6","7","8","9","10","11","12"],months:["1","2","3","4","5","6","7","8","9","10","11","12"],weekdayAbbreviations:["","","","","","",""],weekdays:["","","","","","",""],ampm:["",""]},"calendar"),a.cloudViz.localeDefinition("ja-JP",{core:{nodata:"",erroronrender:"",other:"",normalized:""},dvcore:{target:"Target",yAxisTimeNoTitle:"{time}",yAxisTimeWithTitle:"{title} ({time})",legendTime:"{value} {time}"},point:{xScale:"X",yScale:"Y",sizeScale:"Size"},pathing:{entry:"",exit:"","entry2+":"","exit2+":"",path:"","path2+":"",expand:"",focus:"",collapse:"",title:"",nodeEntries:"{label} ",nodeExits:"{label} ",nodeToNode:"{source}  {target}",percOfNode:"{label}{perc}",pathToNode:"{label}{path}",pathFromNode:"{label}{path}",help1:"",help2:"",help3:"",focusHelp:"",expandHelp:"",collapseHelp:""},sunburst:{audience:"","audience2+":"",category:"","category2+":"",metric:"","metric2+":"",primarymetric:"",secondarymetric:"","secondarymetric2+":"",secondarymetrichelp:"","secondarymetrichelp2+":"",emptyFirstMetric:"",total:"",zoomAction:"",moreAction:"",zoomin:"",zoomout:"",hide:"",hideall:"",hideother:"",hidden:"{value} ","hidden2+":"{value} ",topresults:"{value}",color:"",height:"",both:"",none:"",mapmetric:"{metric}:",percmetric:"{metric}{percent}",mobilescroll:"&#x25BC "},flower:{joy:"",admiration:"",fear:"",surprise:"",sadness:"",disgust:"",anger:"",anticipation:""},venn:{definedAudience:""},funnel:{step:"",segment:"",conversion:"",fallout:"",average:""}},"labels"),a.cloudViz.localeDefinition("ja-JP",{shortFormat:{hour:"%p %I ",day:"%e",week:"%e",month:"%b",quarter:"%b",year:"%Y",fallback:"%e"},mediumFormat:{hour:"%p %I ",day:"%e  (%a)",week:"%e  (%a)",month:"%b",quarter:"%b",year:"%Y",fallback:"%e  (%a)"},longFormat:{hour:"%e  (%a) %p %I ",day:"%e  (%a)",week:"%e  (%a)",month:"%B",quarter:"%B",year:"%Y",fallback:"%e  (%a) %p %I "},fullFormat:{hour:"%e  (%a) %p %I ",day:"%B %e%A",week:"%B %e%A",month:"%Y  %B",quarter:"%Y  %B",year:"%Y",fallback:"%Y  %b %e ",condensed:"%Y/%m/%d"}},"dateFormat"),a.cloudViz.localeDefinition("ja-JP",{decimalSeparator:".",groupSeparator:",",negativePattern:"-{number}",percent:{symbol:"%",positivePattern:"{number}{symbol}",negativePattern:"-{number}{symbol}"},currency:{symbol:"",positivePattern:"{symbol}{number}",negativePattern:"-{symbol}{number}"}},"numberFormat"),a.cloudViz.localeDefinition("ja-JP",{singular:{second:"",minute:"",hour:"",day:"",week:"",month:"",year:""},plural:{second:"",minute:"",hour:"",day:"",week:"",month:"",year:""},abbreviation:{second:"",minute:"",hour:"",day:"",week:"",month:"",year:""}},"time")}(this),function(a){"use strict";a.cloudViz.localeDefinition("ko-KR",{monthAbbreviations:["1","2","3","4","5","6","7","8","9","10","11","12"],months:["1","2","3","4","5","6","7","8","9","10","11","12"],weekdayAbbreviations:["","","","","","",""],weekdays:["","","","","","",""],ampm:["",""]},"calendar"),a.cloudViz.localeDefinition("ko-KR",{core:{nodata:"  .",erroronrender:"     .",other:"",normalized:""},dvcore:{target:"",yAxisTimeNoTitle:"{time}",yAxisTimeWithTitle:"{title}({time})",legendTime:"{value}{time}"},point:{xScale:"X",yScale:"Y",sizeScale:""},pathing:{entry:"",exit:"","entry2+":"","exit2+":"",path:"","path2+":"",expand:"",focus:"",collapse:"",title:"  ",nodeEntries:"{label} ",nodeExits:"{label} ",nodeToNode:"{source}  {target}",percOfNode:"{label} {perc}",pathToNode:"{label}  {path}",pathFromNode:"{label}  {path}",help1:"        .",help2:"       .",help3:"         .",focusHelp:"    ",expandHelp:"     ",collapseHelp:"    "},sunburst:{audience:"","audience2+":"",category:"","category2+":"",metric:"","metric2+":"",primarymetric:" ",secondarymetric:" ","secondarymetric2+":" ",secondarymetrichelp:"   ","secondarymetrichelp2+":"   ",emptyFirstMetric:"    .   .",total:"",zoomAction:"   .",moreAction:"   .",zoomin:"",zoomout:"",hide:"",hideall:" ",hideother:" ",hidden:"{value}  ","hidden2+":"{value}  ",topresults:" {value}",color:"",height:"",both:" ",none:"",mapmetric:"{metric}  :",percmetric:"{metric}  {percent} ",mobilescroll:"&#x25BC    ."},flower:{joy:"",admiration:"",fear:"",surprise:"",sadness:"",disgust:"",anger:"",anticipation:""},venn:{definedAudience:" "},funnel:{step:"",segment:"",conversion:"",fallout:"",average:""}},"labels"),a.cloudViz.localeDefinition("ko-KR",{shortFormat:{hour:"%p %I",day:"%e",week:"%e",month:"%b",quarter:"%b",year:"%Y",fallback:"%e"},mediumFormat:{hour:"%p %I",day:"%a %e",week:"%a %e",month:"%b",quarter:"%b",year:"%Y",fallback:"%a %e"},longFormat:{hour:"%e %a %p %I",day:"%A %e",week:"%A %e",month:"%B",quarter:"%B",year:"%Y",fallback:"%e %a %p %I"},fullFormat:{hour:"%e %a %p %I",day:"%B %e, %A",week:"%B %e, %A",month:"%Y  %B",quarter:"%Y %B",year:"%Y",fallback:"%Y %b %e",condensed:"%Y/%m/%d"}},"dateFormat"),a.cloudViz.localeDefinition("ko-KR",{decimalSeparator:".",groupSeparator:",",negativePattern:"-{number}",percent:{symbol:"%",positivePattern:"{number}{symbol}",negativePattern:"-{number}{symbol}"},currency:{symbol:"",positivePattern:"{symbol}{number}",negativePattern:"-{symbol}{number}"}},"numberFormat"),a.cloudViz.localeDefinition("ko-KR",{singular:{second:"",minute:"",hour:"",day:"",week:"",month:"",year:""},plural:{second:"",minute:"",hour:"",day:"",week:"",month:"",year:""},abbreviation:{second:"",minute:"",hour:"",day:"",week:"",month:"",year:""}},"time")}(this),function(a){"use strict";a.cloudViz.localeDefinition("pt-BR",{monthAbbreviations:["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"],months:["janeiro","fevereiro","maro","abril","maio","junho","julho","agosto","setembro","outubro","novembro","dezembro"],weekdayAbbreviations:["Dom","Seg","Ter","Qua","Qui","Sex","Sb"],weekdays:["Domingo","Segunda-feira","Tera-feira","Quarta-feira","Quinta-feira","Sexta-feira","Sbado"],
ampm:["AM","PM"]},"calendar"),a.cloudViz.localeDefinition("pt-BR",{core:{nodata:"O grfico no possui dados",erroronrender:"Ops! Houve um erro e o grfico no pde ser processado.",other:"Outro",normalized:"Normalizado"},dvcore:{target:"Meta",yAxisTimeNoTitle:"{time}",yAxisTimeWithTitle:"{title} (em {time})",legendTime:"{value} {time}"},point:{xScale:"X",yScale:"Y",sizeScale:"Tamanho"},pathing:{entry:"Entrada",exit:"Sair","entry2+":"Entradas","exit2+":"Sadas",path:"Caminho","path2+":"Caminhos",expand:"Expandir",focus:"Foco",collapse:"Recolher",title:"Grfico de criao de caminho",nodeEntries:"{label} Entradas",nodeExits:"{label} Sadas",nodeToNode:"{source}  {target}",percOfNode:"{perc} de {label}",pathToNode:"{path} para {label}",pathFromNode:"{path} de {label}",help1:"Esse grfico representa os caminhos tomados de um estado para outro.",help2:"Cada n, formado como uma caixa representa um estado no caminho.",help3:"Tocar ou clicar em um n fornecer opes adicionais para modificar o grfico:",focusHelp:"Mostra os caminhos entrando ou saindo do n",expandHelp:"Mostra caminhos adicionais entrando ou saindo do n",collapseHelp:"Remove os caminhos saindo ou entrando no n"},sunburst:{audience:"Pblico-alvo","audience2+":"Pblicos-alvos",category:"Categoria","category2+":"Categorias",metric:"Mtrica","metric2+":"Mtricas",primarymetric:"Mtrica principal",secondarymetric:"Mtrica secundria","secondarymetric2+":"Mtricas secundrias",secondarymetrichelp:"Clique na mtrica para alternar a altura","secondarymetrichelp2+":"Clique nas mtricas para alternar a altura",emptyFirstMetric:"A primeira mtrica no tem valores. Esolha uma mtrica diferente.",total:"Total",zoomAction:"Clique duas vezes para aumentar o zoom.",moreAction:"Clique para ver mais opes.",zoomin:"Ampliar",zoomout:"Reduzir",hide:"Ocultar",hideall:"Ocultar tudo",hideother:"Ocultar outro",hidden:"{value} Item oculto","hidden2+":"{value} itens ocultos",topresults:"principais {value}",color:"Cor",height:"Altura",both:"Ambos",none:"Nenhum",mapmetric:"Mostrar {metric} como:",percmetric:"{percent} de {metric}",mobilescroll:"&#x25BC role para ver os detalhes"},flower:{joy:"Alegria",admiration:"Admirao",fear:"Medo",surprise:"Problemas",sadness:"Tristeza",disgust:"Repulsa",anger:"Raiva",anticipation:"Antecipao"},venn:{definedAudience:"Pblico-alvo definido"},funnel:{step:"Etapa",segment:"Segmento",conversion:"Converso",fallout:"Fallout",average:"Mdia"}},"labels"),a.cloudViz.localeDefinition("pt-BR",{shortFormat:{hour:"%H",day:"%e",week:"%e",month:"%b",quarter:"%b",year:"%Y",fallback:"%e"},mediumFormat:{hour:"%H",day:"%a %e",week:"%a %e",month:"%b",quarter:"%b",year:"%Y",fallback:"%a %e"},longFormat:{hour:"%Hh %a %e",day:"%A %e",week:"%A %e",month:"%B",quarter:"%B",year:"%Y",fallback:"%Hh %a %e"},fullFormat:{hour:"%Hh %a %e",day:"%A, %e de %B",week:"%A, %e de %B",month:"%B %Y",quarter:"%B %Y",year:"%Y",fallback:"%e %b, %Y",condensed:"%Y/%m/%d"}},"dateFormat"),a.cloudViz.localeDefinition("pt-BR",{decimalSeparator:",",groupSeparator:" ",negativePattern:"-{number}",percent:{symbol:"%",positivePattern:"{number} {symbol}",negativePattern:"-{number} {symbol}"},currency:{symbol:"R$",positivePattern:"{number} {symbol}",negativePattern:"-{number} {symbol}"}},"numberFormat"),a.cloudViz.localeDefinition("pt-BR",{singular:{second:"segundo",minute:"minuto",hour:"hora",day:"da",week:"semana",month:"ms",year:"ano"},plural:{second:"segundos",minute:"minutos",hour:"horas",day:"dias",week:"semanas",month:"meses",year:"anos"},abbreviation:{second:"s",minute:"min",hour:"h",day:"d",week:"w",month:"mon",year:"y"}},"time")}(this),function(a){"use strict";a.cloudViz.localeDefinition("zh-CN",{monthAbbreviations:["1 ","2 ","3 ","4 ","5 ","6 ","7 ","8 ","9 ","10 ","11 ","12 "],months:["1 ","2 ","3 ","4 ","5 ","6 ","7 ","8 ","9 ","10 ","11 ","12 "],weekdayAbbreviations:["","","","","","",""],weekdays:["","","","","","",""],ampm:["",""]},"calendar"),a.cloudViz.localeDefinition("zh-CN",{core:{nodata:"",erroronrender:"",other:"",normalized:""},dvcore:{target:"",yAxisTimeNoTitle:"{time}",yAxisTimeWithTitle:"{title}{time}",legendTime:"{value} {time}"},point:{xScale:"X",yScale:"Y",sizeScale:""},pathing:{entry:"",exit:"","entry2+":"","exit2+":"",path:"","path2+":"",expand:"",focus:"",collapse:"",title:"",nodeEntries:"{label} ",nodeExits:"{label} ",nodeToNode:"{source}  {target}",percOfNode:"{perc}  {label}",pathToNode:" {label}  {path}",pathFromNode:" {label}  {path}",help1:"",help2:"",help3:"",focusHelp:"",expandHelp:"",collapseHelp:""},sunburst:{audience:"","audience2+":"",category:"","category2+":"",metric:"","metric2+":"",primarymetric:"",secondarymetric:"","secondarymetric2+":"",secondarymetrichelp:"","secondarymetrichelp2+":"",emptyFirstMetric:"",total:"",zoomAction:"",moreAction:"",zoomin:"",zoomout:"",hide:"",hideall:"",hideother:"",hidden:"{value} ","hidden2+":"{value} ",topresults:" {value}",color:"",height:"",both:"",none:"",mapmetric:"{metric} :",percmetric:"{percent}  {metric}",mobilescroll:"&#x25BC "},flower:{joy:"",admiration:"",fear:"",surprise:"",sadness:"",disgust:"",anger:"",anticipation:""},venn:{definedAudience:""},funnel:{step:"",segment:"",conversion:"",fallout:"",average:""}},"labels"),a.cloudViz.localeDefinition("zh-CN",{shortFormat:{hour:"%p %I",day:"%e",week:"%e",month:"%b",quarter:"%b",year:"%Y",fallback:"%e"},mediumFormat:{hour:"%p %I",day:"%a %e",week:"%a %e",month:"%b",quarter:"%b",year:"%Y",fallback:"%a %e"},longFormat:{hour:"%e  %a %p %I",day:"%A %e",week:"%A %e",month:"%B",quarter:"%B",year:"%Y",fallback:"%e  %a %p %I"},fullFormat:{hour:"%e  %a %p %I",day:"%B %e %A",week:"%B %e %A",month:"%Y %B",quarter:"%Y %B",year:"%Y",fallback:"%Y %b %e ",condensed:"%Y/%m/%d"}},"dateFormat"),a.cloudViz.localeDefinition("zh-CN",{decimalSeparator:".",groupSeparator:",",negativePattern:"-{number}",percent:{symbol:"%",positivePattern:"{number}{symbol}",negativePattern:"-{number}{symbol}"},currency:{symbol:"",positivePattern:"{symbol}{number}",negativePattern:"-{symbol}{number}"}},"numberFormat"),a.cloudViz.localeDefinition("zh-CN",{singular:{second:"",minute:"",hour:"",day:"",week:"",month:"",year:""},plural:{second:"",minute:"",hour:"",day:"",week:"",month:"",year:""},abbreviation:{second:"",minute:"",hour:"",day:"",week:"",month:"",year:""}},"time")}(this),function(a){"use strict";a.cloudViz.localeDefinition("zh-TW",{monthAbbreviations:["1 ","2 ","3 ","4 ","5 ","6 ","7 ","8 ","9 ","10 ","11 ","12 "],months:["1 ","2 ","3 ","4 ","5 ","6 ","7 ","8 ","9 ","10 ","11 ","12 "],weekdayAbbreviations:["","","","","","",""],weekdays:["","","","","","",""],ampm:["",""]},"calendar"),a.cloudViz.localeDefinition("zh-TW",{core:{nodata:"",erroronrender:"",other:"",normalized:""},dvcore:{target:"",yAxisTimeNoTitle:"{time}",yAxisTimeWithTitle:"{title} ({time})",legendTime:"{value} {time}"},point:{xScale:"X",yScale:"Y",sizeScale:""},pathing:{entry:"",exit:"","entry2+":"","exit2+":"",path:"","path2+":"",expand:"",focus:"",collapse:"",title:"",nodeEntries:"{label} ",nodeExits:"{label} ",nodeToNode:"{source}  {target}",percOfNode:"{perc}  {label}",pathToNode:" {label}  {path}",pathFromNode:" {label}  {path}",help1:"",help2:"",help3:":",focusHelp:"",expandHelp:"",collapseHelp:""},sunburst:{audience:"","audience2+":"",category:"","category2+":"",metric:"","metric2+":"",primarymetric:"",secondarymetric:"","secondarymetric2+":"",secondarymetrichelp:"","secondarymetrichelp2+":"",emptyFirstMetric:"",total:"",zoomAction:"",moreAction:"",zoomin:"",zoomout:"",hide:"",hideall:"",hideother:"",hidden:"{value} ","hidden2+":"{value} ",topresults:" {value} ",color:"",height:"",both:"",none:"",mapmetric:" {metric} :",percmetric:"{percent}  {metric}",mobilescroll:"&#x25BC "},flower:{joy:"",admiration:"",fear:"",surprise:"",sadness:"",disgust:"",anger:"",anticipation:""},venn:{definedAudience:""},funnel:{step:"",segment:"",conversion:"",fallout:"",average:""}},"labels"),a.cloudViz.localeDefinition("zh-TW",{shortFormat:{hour:"%p %I",day:"%e",week:"%e",month:"%b",quarter:"%b",year:"%Y",fallback:"%e"},mediumFormat:{hour:"%p %I",day:"%a %e",week:"%a %e",month:"%b",quarter:"%b",year:"%Y",fallback:"%a %e"},longFormat:{hour:"%e  %a %p %I",day:"%A %e",week:"%A %e",month:"%B",quarter:"%B",year:"%Y",fallback:"%e  %a %p %I"},fullFormat:{hour:"%e  %a %p %I",day:"%B %e %A",week:"%B %e %A",month:"%Y  %B",quarter:"%Y %B",year:"%Y",fallback:"%Y %b %e ",condensed:"%Y/%m/%d"}},"dateFormat"),a.cloudViz.localeDefinition("zh-TW",{decimalSeparator:".",groupSeparator:",",negativePattern:"-{number}",percent:{symbol:"%",positivePattern:"{number}{symbol}",negativePattern:"-{number}{symbol}"},currency:{symbol:"NT$",positivePattern:"{symbol}{number}",negativePattern:"-{symbol}{number}"}},"numberFormat"),a.cloudViz.localeDefinition("zh-TW",{singular:{second:"",minute:"",hour:"",day:"",week:"",month:"",year:""},plural:{second:"",minute:"",hour:"",day:"",week:"",month:"",year:""},abbreviation:{second:"",minute:"",hour:"",day:"",week:"",month:"",year:""}},"time")}(this),function(a){"use strict";a.cloudViz.localeDefinition("zz-ZZ",{monthAbbreviations:["[g] _Jan_","[q] _Feb_","[r] _Mar_","[n] _Apr_","[p] _May_","[k] _Jun_","[l] _Jul_","[i] _Aug_","[j] _Sep_","[h] _Oct_","[o] _Nov_","[m] _Dec_"],months:["[1] _January_","[2] _February_","[3] _March_","[x] _April_","[y] _May_","[z] _June_","[0] _July_","[s] _August_","[t] _September_","[u] _October_","[v] _November_","[w] _December_"],weekdayAbbreviations:["[+] _Sun_","[4] _Mon_","[5] _Tue_","[6] _Wed_","[7] _Thu_","[8] _Fri_","[9] _Sat_"],weekdays:["[BB] _Sunday_","[BA] _Monday_","[/] _Tuesday_","[BC] _Wednesday_","[BD] _Thursday_","[BE] _Friday_","[BF] _Saturday_"],ampm:["[e] _AM_","[f] _PM_"]},"calendar"),a.cloudViz.localeDefinition("zz-ZZ",{core:{nodata:"[BH] _The chart has no data_",erroronrender:"[BG] _Oops! There was an error and the chart could not be rendered._",other:"[BJ] _Other_",normalized:"[BI] _Normalized_"},dvcore:{target:"[BL] _Target_",yAxisTimeNoTitle:"[BK] _{time}_",yAxisTimeWithTitle:"[BN] _{title} (in {time})_",legendTime:"[BM] _{value} {time}_"},point:{xScale:"[Bp] _X_",yScale:"[Br] _Y_",sizeScale:"[Bq] _Size_"},pathing:{entry:"[Be] _Entry_",exit:"[Bg] _Exit_","entry2+":"[Bn] _Entries_","exit2+":"[Bb] _Exits_",path:"[BZ] _Path_","path2+":"[Bf] _Paths_",expand:"[BX] _Expand_",focus:"[BW] _Focus_",collapse:"[Bj] _Collapse_",title:"[Bc] _Pathing Chart_",nodeEntries:"[Cz] _{label} Entries_",nodeExits:"[C0] _{label} Exits_",nodeToNode:"[Cy] _{source}  {target}_",percOfNode:"[Ba] _{perc} of {label}_",pathToNode:"[Bo] _{path} to {label}_",pathFromNode:"[Bd] _{path} from {label}_",help1:"[BY] _This chart represents paths taken from one state to another._",help2:"[Bh] _Each node, shaped as a box, represents a state in the path._",help3:"[Bk] _Tapping or clicking a node will provide additional options to modify the chart:_",focusHelp:"[Bm] _Shows paths coming into and going out of node_",expandHelp:"[Bi] _Shows additional paths coming or going from the node_",collapseHelp:"[Bl] _Removes paths coming or going from the node_"},sunburst:{audience:"[Ci] _Audience_","audience2+":"[Ce] _Audiences_",category:"[Ch] _Category_","category2+":"[Cf] _Categories_",metric:"[Cd] _Metric_","metric2+":"[Cg] _Metrics_",primarymetric:"[Cj] _Primary Metric_",secondarymetric:"[Cl] _Secondary Metric_","secondarymetric2+":"[Ck] _Secondary Metrics_",secondarymetrichelp:"[Cm] _Click metric to toggle height_","secondarymetrichelp2+":"[Cn] _Click metrics to toggle height_",emptyFirstMetric:"[B2] _The first metric has no values. Please pick a different metric._",total:"[B7] _Total_",zoomAction:"[By] _Double-click to Zoom in._",moreAction:"[B5] _Click for more options._",zoomin:"[Bz] _Zoom In_",zoomout:"[Bs] _Zoom Out_",hide:"[Bt] _Hide_",hideall:"[Bw] _Hide All_",hideother:"[Bu] _Hide Other_",hidden:"[B4] _{value} Hidden Item_","hidden2+":"[B0] _{value} Hidden Items_",topresults:"[B8] _top {value}_",color:"[Bx] _Color_",height:"[Bv] _Height_",both:"[B6] _Both_",none:"[B3] _None_",mapmetric:"[B9] _Show {metric} as:_",percmetric:"[B1] _{percent} of {metric}_",mobilescroll:"[Co] _&#x25BC scroll for details_"},flower:{joy:"[BU] _Joy_",admiration:"[BT] _Admiration_",fear:"[BQ] _Fear_",surprise:"[BR] _Surprise_",sadness:"[BO] _Sadness_",disgust:"[BP] _Disgust_",anger:"[BV] _Anger_",anticipation:"[BS] _Anticipation_"},venn:{definedAudience:"[B+] _Defined Audience_"},funnel:{step:"[C3] _Step_",segment:"[C4] _Segment_",conversion:"[C1] _Conversion_",fallout:"[C5] _Fallout_",average:"[C2] _Average_"}},"labels"),a.cloudViz.localeDefinition("zz-ZZ",{shortFormat:{hour:"[Z] _%I %p_",day:"%e",week:"%e",month:"%b",quarter:"%b",year:"[d] _%Y_",fallback:"%e"},mediumFormat:{hour:"[S] _%I %p_",day:"[Q] _%a %e_",week:"[T] _%a %e_",month:"%b",quarter:"%b",year:"[U] _%Y_",fallback:"[V] _%a %e_"},longFormat:{hour:"[P] _%I %p %a %e_",day:"[M] _%A %e_",week:"[O] _%A %e_",month:"[L] _%B_",quarter:"[K] _%B_",year:"[J] _%Y_",fallback:"[N] _%I %p %a %e_"},fullFormat:{hour:"[D] _%I %p %a %e_",day:"[C] _%A %e %B_",week:"[B] _%A %e %B_",month:"[G] _%B %Y_",quarter:"[E] _%B %Y_",year:"[I] _%Y_",fallback:"[F] _%b %e, %Y_",condensed:"[H] _%m/%d/%Y_"}},"dateFormat"),a.cloudViz.localeDefinition("zz-ZZ",{decimalSeparator:"[CC] _._",groupSeparator:"[CD] _,_",negativePattern:"[CE] _-{number}_",percent:{symbol:"[CF] _%_",positivePattern:"[CG] _{number}{symbol}_",negativePattern:"[CH] _-{number}{symbol}_"},currency:{symbol:"[B/] _$_",positivePattern:"[CA] _{symbol}{number}_",negativePattern:"[CB] _-{symbol}{number}_"}},"numberFormat"),a.cloudViz.localeDefinition("zz-ZZ",{singular:{second:"[CX] _second_",minute:"[CY] _minute_",hour:"[CZ] _hour_",day:"[CV] _day_",week:"[Ca] _week_",month:"[Cb] _month_",year:"[CW] _year_"},plural:{second:"[CS] _seconds_",minute:"[CP] _minutes_",hour:"[Cc] _hours_",day:"[CR] _days_",week:"[CQ] _weeks_",month:"[CT] _months_",year:"[CU] _years_"},abbreviation:{second:"[CJ] _s_",minute:"[CO] _min_",hour:"[CK] _h_",day:"[CI] _d_",week:"[CL] _w_",month:"[CM] _mon_",year:"[CN] _y_"}},"time")}(this);